[INFO] - 03-16 18:11:13 - [main.get_net:27]: Creating net: 
FashionRecommenderParam: {
  factory: FashionRecommenderParam,
  name: FashionRecommender,
  num_users: 53,
  backbone: resnet34,
  embd_dim: 128,
  num_transformer_layers: 3,
  num_heads: 2,
  num_proto: 64,
  dropout: 0.3,
  num_points: 0,
  num_seeds: 1,
  loss_weight: {
    rank_loss: 1.0,
    l1reg: 0.01,
    l2reg: 0.001,
  },
  use_visual: True,
  use_semantic: False,
  use_nn_feature: False,
  max_items: 3,
  drop_path_rate: 0.1,
  margin: 0.5,
  temperature: 0.1,
  l2_scale: 0.01,
  l1_scale: 0.001,
  proto_reg_weight: 0.1,
  momentum: 0.9,
  curriculum_epochs: 50,
}
[INFO] - 03-16 18:11:17 - [main.train:254]: Validation data: OutfitLoaderParam: {
  factory: OutfitLoaderParam,
  phase: valid,
  readers: [
    {
      reader: TensorLMDB,
      path: ./outfit-datasets/polyvore-u/processed/features/resnet34,
      data_transform: None,
    },
  ],
  dataset: {
    data_mode: PointwiseOutfit,
    pos_mode: Fix,
    neg_mode: Fix,
    pos_param: {},
    neg_param: {},
  },
  num_types: 3,
  max_items: 3,
  num_users: 53,
  num_fitb_choices: 4,
  batch_size: 128,
  num_workers: 0,
  drop_last: False,
  shuffle: False,
  pos_fn: ./outfit-datasets/polyvore-u/processed/original/tuples_53\valid_pos,
  neg_fn: ./outfit-datasets/polyvore-u/processed/original/tuples_53\valid_neg,
}
[INFO] - 03-16 18:11:17 - [outfit_datasets.dataloader.__init__:28]: Loading [32mvalid[0m data
[INFO] - 03-16 18:11:17 - [outfit_datasets.dataloader.__init__:29]: DataLoader: batch size ([32m128[0m), number of workers ([32m0[0m)
[INFO] - 03-16 18:11:17 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_53\valid_pos
[INFO] - 03-16 18:11:17 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mvalid positive[0m tuples with shape: [32m(1051, 8)[0m
[INFO] - 03-16 18:11:17 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_53\valid_neg
[INFO] - 03-16 18:11:17 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mvalid negative[0m tuples with shape: [32m(10510, 8)[0m
[INFO] - 03-16 18:11:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:11:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:11:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:11:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:11:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:11:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:11:17 - [outfit_datasets.dataloader.__init__:28]: Loading [32mtrain[0m data
[INFO] - 03-16 18:11:17 - [outfit_datasets.dataloader.__init__:29]: DataLoader: batch size ([32m128[0m), number of workers ([32m0[0m)
[INFO] - 03-16 18:11:17 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_53\train_pos
[INFO] - 03-16 18:11:17 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mtrain positive[0m tuples with shape: [32m(10712, 8)[0m
[INFO] - 03-16 18:11:17 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_53\train_neg
[INFO] - 03-16 18:11:18 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mtrain negative[0m tuples with shape: [32m(107120, 8)[0m
[INFO] - 03-16 18:11:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:11:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:11:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:11:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:11:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:11:18 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7260, 4988, 5158]
[INFO] - 03-16 18:11:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:11:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=300.
[INFO] - 03-16 18:11:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:11:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:11:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:11:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:11:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:11:19 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7216, 4982, 5142]
[INFO] - 03-16 18:11:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:12:30 - [main.backward:225]: Epoch 1/300 - Iteration 50/199 - Time 1.433 batch, 1.203 data, 0.248 forward
[INFO] - 03-16 18:12:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:12:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0220 (0.0221)
[INFO] - 03-16 18:12:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5975 (0.5773)
[INFO] - 03-16 18:12:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -59.5241 (-77.7116)
[INFO] - 03-16 18:12:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.5047 (29.6131)
[INFO] - 03-16 18:12:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 305.6035 (304.3484)
[INFO] - 03-16 18:12:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:12:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4766 (0.4920)
[INFO] - 03-16 18:12:49 - [main.backward:225]: Epoch 1/300 - Iteration 100/199 - Time 0.901 batch, 0.683 data, 0.227 forward
[INFO] - 03-16 18:12:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0217)
[INFO] - 03-16 18:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5988 (0.5783)
[INFO] - 03-16 18:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -100.9155 (-80.4429)
[INFO] - 03-16 18:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.6638 (30.5412)
[INFO] - 03-16 18:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 304.1100 (304.2696)
[INFO] - 03-16 18:12:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5391 (0.5084)
[INFO] - 03-16 18:13:02 - [main.backward:225]: Epoch 1/300 - Iteration 150/199 - Time 0.688 batch, 0.473 data, 0.221 forward
[INFO] - 03-16 18:13:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:13:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0220 (0.0216)
[INFO] - 03-16 18:13:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5938 (0.5776)
[INFO] - 03-16 18:13:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -117.3683 (-80.5505)
[INFO] - 03-16 18:13:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.7588 (30.5397)
[INFO] - 03-16 18:13:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.4434 (305.3731)
[INFO] - 03-16 18:13:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:13:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4219 (0.5339)
[INFO] - 03-16 18:13:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:13:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:13:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:13:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:13:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:13:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:13:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:13:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:14.752
[INFO] - 03-16 18:13:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:14.753
[INFO] - 03-16 18:13:28 - [main.summary_metrics:168]: Epoch 1/300 - Test Results:
{'auc': 0.5056198899371068,
 'f1': 0.06434446057087566,
 'loss': 0.6930725798616868,
 'ndcg': 0.2695852930049622,
 'precision': 0.09622641509433962,
 'recall': 0.04834905660377359}
[INFO] - 03-16 18:13:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:02:09.778
[INFO] - 03-16 18:13:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:13:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:13:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:13:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:13:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:13:28 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7253, 5012, 5164]
[INFO] - 03-16 18:13:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:13:30 - [main.backward:225]: Epoch 2/300 - Iteration 1/199 - Time 1.853 batch, 1.628 data, 1.509 forward
[INFO] - 03-16 18:13:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:13:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0218)
[INFO] - 03-16 18:13:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5960 (0.5805)
[INFO] - 03-16 18:13:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -123.1162 (-80.5758)
[INFO] - 03-16 18:13:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.0180 (30.8750)
[INFO] - 03-16 18:13:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.9656 (305.7736)
[INFO] - 03-16 18:13:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:13:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4922 (0.4845)
[INFO] - 03-16 18:13:44 - [main.backward:225]: Epoch 2/300 - Iteration 51/199 - Time 0.300 batch, 0.089 data, 0.236 forward
[INFO] - 03-16 18:13:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0215)
[INFO] - 03-16 18:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5964 (0.5971)
[INFO] - 03-16 18:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -134.2140 (-132.4692)
[INFO] - 03-16 18:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.8889 (30.8926)
[INFO] - 03-16 18:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 305.4180 (305.9687)
[INFO] - 03-16 18:13:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5469 (0.5413)
[INFO] - 03-16 18:13:56 - [main.backward:225]: Epoch 2/300 - Iteration 101/199 - Time 0.276 batch, 0.065 data, 0.224 forward
[INFO] - 03-16 18:13:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:13:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0217 (0.0216)
[INFO] - 03-16 18:13:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6010 (0.5982)
[INFO] - 03-16 18:13:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -136.1372 (-132.8858)
[INFO] - 03-16 18:13:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.7988 (30.7783)
[INFO] - 03-16 18:13:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 304.2467 (305.5009)
[INFO] - 03-16 18:13:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:13:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.5364)
[INFO] - 03-16 18:14:09 - [main.backward:225]: Epoch 2/300 - Iteration 151/199 - Time 0.266 batch, 0.054 data, 0.220 forward
[INFO] - 03-16 18:14:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:14:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0221 (0.0216)
[INFO] - 03-16 18:14:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5979 (0.5973)
[INFO] - 03-16 18:14:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -126.5027 (-132.5601)
[INFO] - 03-16 18:14:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.8160 (30.7371)
[INFO] - 03-16 18:14:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 304.5013 (306.0706)
[INFO] - 03-16 18:14:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:14:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4453 (0.5331)
[INFO] - 03-16 18:14:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:14:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:14:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:14:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:14:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:14:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:14:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:14:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.344
[INFO] - 03-16 18:14:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.344
[INFO] - 03-16 18:14:24 - [main.summary_metrics:168]: Epoch 2/300 - Test Results:
{'auc': 0.5038993055555556,
 'f1': 0.06686018384131592,
 'loss': 0.6931144599794591,
 'ndcg': 0.2693523810920007,
 'precision': 0.09999999999999998,
 'recall': 0.05023584905660377}
[INFO] - 03-16 18:14:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[2] Complete. Time taken: 00:00:57.004
[INFO] - 03-16 18:14:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:14:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:14:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:14:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:14:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:14:25 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7212, 4980, 5126]
[INFO] - 03-16 18:14:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:14:27 - [main.backward:225]: Epoch 3/300 - Iteration 2/199 - Time 0.920 batch, 0.708 data, 0.879 forward
[INFO] - 03-16 18:14:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:14:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0218 (0.0217)
[INFO] - 03-16 18:14:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5910 (0.5986)
[INFO] - 03-16 18:14:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -136.4493 (-133.2363)
[INFO] - 03-16 18:14:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.1308 (31.0884)
[INFO] - 03-16 18:14:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.7616 (305.8056)
[INFO] - 03-16 18:14:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:14:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4766 (0.5044)
[INFO] - 03-16 18:14:40 - [main.backward:225]: Epoch 3/300 - Iteration 52/199 - Time 0.274 batch, 0.061 data, 0.238 forward
[INFO] - 03-16 18:14:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0215)
[INFO] - 03-16 18:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5971 (0.5980)
[INFO] - 03-16 18:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -138.6733 (-137.6260)
[INFO] - 03-16 18:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.9885 (31.0442)
[INFO] - 03-16 18:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 304.7621 (306.0931)
[INFO] - 03-16 18:14:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5391 (0.5467)
[INFO] - 03-16 18:14:52 - [main.backward:225]: Epoch 3/300 - Iteration 102/199 - Time 0.263 batch, 0.049 data, 0.227 forward
[INFO] - 03-16 18:14:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:14:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0214)
[INFO] - 03-16 18:14:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5866 (0.5980)
[INFO] - 03-16 18:14:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -137.1296 (-137.6584)
[INFO] - 03-16 18:14:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.8815 (30.8215)
[INFO] - 03-16 18:14:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.1518 (306.6090)
[INFO] - 03-16 18:14:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:14:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.5534)
[INFO] - 03-16 18:15:04 - [main.backward:225]: Epoch 3/300 - Iteration 152/199 - Time 0.256 batch, 0.042 data, 0.223 forward
[INFO] - 03-16 18:15:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:15:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0223 (0.0215)
[INFO] - 03-16 18:15:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5945 (0.5972)
[INFO] - 03-16 18:15:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -137.1411 (-137.5654)
[INFO] - 03-16 18:15:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.7389 (30.6527)
[INFO] - 03-16 18:15:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 308.8957 (308.1387)
[INFO] - 03-16 18:15:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:15:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4219 (0.5470)
[INFO] - 03-16 18:15:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:15:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:15:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:15:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:15:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:15:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:15:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:15:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.407
[INFO] - 03-16 18:15:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.407
[INFO] - 03-16 18:15:20 - [main.summary_metrics:168]: Epoch 3/300 - Test Results:
{'auc': 0.5048551493710691,
 'f1': 0.07169811320754718,
 'loss': 0.6930038698584279,
 'ndcg': 0.270324969010653,
 'precision': 0.10754716981132074,
 'recall': 0.05377358490566037}
[INFO] - 03-16 18:15:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[3] Complete. Time taken: 00:00:54.518
[INFO] - 03-16 18:15:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:15:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:15:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:15:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:15:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:15:20 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7194, 5008, 5140]
[INFO] - 03-16 18:15:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:15:22 - [main.backward:225]: Epoch 4/300 - Iteration 3/199 - Time 0.656 batch, 0.451 data, 0.632 forward
[INFO] - 03-16 18:15:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:15:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0217)
[INFO] - 03-16 18:15:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5959 (0.5982)
[INFO] - 03-16 18:15:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -138.8464 (-137.8559)
[INFO] - 03-16 18:15:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.9908 (30.9354)
[INFO] - 03-16 18:15:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 308.9606 (308.7817)
[INFO] - 03-16 18:15:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:15:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5078 (0.4993)
[INFO] - 03-16 18:15:33 - [main.backward:225]: Epoch 4/300 - Iteration 53/199 - Time 0.255 batch, 0.052 data, 0.226 forward
[INFO] - 03-16 18:15:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:15:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0215)
[INFO] - 03-16 18:15:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5966 (0.5975)
[INFO] - 03-16 18:15:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.1750 (-138.9503)
[INFO] - 03-16 18:15:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.9863 (30.9646)
[INFO] - 03-16 18:15:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.9455 (307.9482)
[INFO] - 03-16 18:15:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:15:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4922 (0.5572)
[INFO] - 03-16 18:15:45 - [main.backward:225]: Epoch 4/300 - Iteration 103/199 - Time 0.248 batch, 0.041 data, 0.219 forward
[INFO] - 03-16 18:15:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:15:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0201 (0.0214)
[INFO] - 03-16 18:15:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5849 (0.5976)
[INFO] - 03-16 18:15:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -138.8047 (-138.9010)
[INFO] - 03-16 18:15:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.7668 (30.8197)
[INFO] - 03-16 18:15:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.6861 (308.0912)
[INFO] - 03-16 18:15:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:15:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7891 (0.5623)
[INFO] - 03-16 18:15:58 - [main.backward:225]: Epoch 4/300 - Iteration 153/199 - Time 0.246 batch, 0.037 data, 0.217 forward
[INFO] - 03-16 18:15:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0218 (0.0216)
[INFO] - 03-16 18:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6003 (0.5979)
[INFO] - 03-16 18:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -138.8588 (-138.8968)
[INFO] - 03-16 18:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.7705 (30.6512)
[INFO] - 03-16 18:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 309.5326 (308.9172)
[INFO] - 03-16 18:15:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4531 (0.5356)
[INFO] - 03-16 18:16:09 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:16:09 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:16:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:16:09 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:16:09 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:16:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:16:09 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:16:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.323
[INFO] - 03-16 18:16:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.324
[INFO] - 03-16 18:16:13 - [main.summary_metrics:168]: Epoch 4/300 - Test Results:
{'auc': 0.5078946213312369,
 'f1': 0.06415094339622643,
 'loss': 0.6929211785738321,
 'ndcg': 0.2739696751465527,
 'precision': 0.09622641509433962,
 'recall': 0.04811320754716981}
[INFO] - 03-16 18:16:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[4] Complete. Time taken: 00:00:53.257
[INFO] - 03-16 18:16:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:16:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:16:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:16:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:16:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:16:13 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7253, 4978, 5118]
[INFO] - 03-16 18:16:14 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:16:15 - [main.backward:225]: Epoch 5/300 - Iteration 4/199 - Time 0.574 batch, 0.360 data, 0.542 forward
[INFO] - 03-16 18:16:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:16:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0219 (0.0217)
[INFO] - 03-16 18:16:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5955 (0.5987)
[INFO] - 03-16 18:16:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.6850 (-139.0084)
[INFO] - 03-16 18:16:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.8470 (30.8415)
[INFO] - 03-16 18:16:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 309.3612 (309.3493)
[INFO] - 03-16 18:16:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:16:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4531 (0.5075)
[INFO] - 03-16 18:16:28 - [main.backward:225]: Epoch 5/300 - Iteration 54/199 - Time 0.266 batch, 0.053 data, 0.237 forward
[INFO] - 03-16 18:16:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:16:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0215)
[INFO] - 03-16 18:16:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5919 (0.5963)
[INFO] - 03-16 18:16:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.5910 (-139.4439)
[INFO] - 03-16 18:16:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.8084 (30.8163)
[INFO] - 03-16 18:16:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.7939 (308.3422)
[INFO] - 03-16 18:16:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:16:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.5602)
[INFO] - 03-16 18:16:40 - [main.backward:225]: Epoch 5/300 - Iteration 104/199 - Time 0.254 batch, 0.041 data, 0.226 forward
[INFO] - 03-16 18:16:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:16:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0196 (0.0213)
[INFO] - 03-16 18:16:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5867 (0.5974)
[INFO] - 03-16 18:16:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.6571 (-139.4234)
[INFO] - 03-16 18:16:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.7260 (30.7216)
[INFO] - 03-16 18:16:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.4946 (306.8909)
[INFO] - 03-16 18:16:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:16:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.5683)
[INFO] - 03-16 18:16:52 - [main.backward:225]: Epoch 5/300 - Iteration 154/199 - Time 0.250 batch, 0.037 data, 0.221 forward
[INFO] - 03-16 18:16:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0220 (0.0216)
[INFO] - 03-16 18:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5962 (0.5979)
[INFO] - 03-16 18:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.5178 (-139.3870)
[INFO] - 03-16 18:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.7980 (30.5831)
[INFO] - 03-16 18:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 308.8195 (307.7152)
[INFO] - 03-16 18:16:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4453 (0.5286)
[INFO] - 03-16 18:17:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:17:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:17:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:17:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:17:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:17:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:17:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:17:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.927
[INFO] - 03-16 18:17:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.928
[INFO] - 03-16 18:17:06 - [main.summary_metrics:168]: Epoch 5/300 - Test Results:
{'auc': 0.5101711215932914,
 'f1': 0.06666666666666668,
 'loss': 0.6928045997859547,
 'ndcg': 0.2722601562480519,
 'precision': 0.09999999999999998,
 'recall': 0.04999999999999999}
[INFO] - 03-16 18:17:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[5] Complete. Time taken: 00:00:53.259
[INFO] - 03-16 18:17:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:17:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:17:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:17:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:17:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:17:06 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7190, 4977, 5148]
[INFO] - 03-16 18:17:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:17:09 - [main.backward:225]: Epoch 6/300 - Iteration 5/199 - Time 0.486 batch, 0.274 data, 0.456 forward
[INFO] - 03-16 18:17:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:17:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0212 (0.0216)
[INFO] - 03-16 18:17:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5954 (0.5986)
[INFO] - 03-16 18:17:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.8730 (-139.5002)
[INFO] - 03-16 18:17:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.8527 (30.8185)
[INFO] - 03-16 18:17:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.5667 (308.3756)
[INFO] - 03-16 18:17:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:17:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6250 (0.5255)
[INFO] - 03-16 18:17:21 - [main.backward:225]: Epoch 6/300 - Iteration 55/199 - Time 0.262 batch, 0.050 data, 0.234 forward
[INFO] - 03-16 18:17:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0208 (0.0214)
[INFO] - 03-16 18:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5940 (0.5971)
[INFO] - 03-16 18:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.9337 (-139.6608)
[INFO] - 03-16 18:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.7037 (30.7557)
[INFO] - 03-16 18:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 305.9320 (307.2228)
[INFO] - 03-16 18:17:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.5625)
[INFO] - 03-16 18:17:33 - [main.backward:225]: Epoch 6/300 - Iteration 105/199 - Time 0.254 batch, 0.041 data, 0.225 forward
[INFO] - 03-16 18:17:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:17:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0196 (0.0212)
[INFO] - 03-16 18:17:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5854 (0.5976)
[INFO] - 03-16 18:17:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.7854 (-139.6615)
[INFO] - 03-16 18:17:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.6244 (30.6095)
[INFO] - 03-16 18:17:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.4930 (306.9490)
[INFO] - 03-16 18:17:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:17:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7656 (0.5778)
[INFO] - 03-16 18:17:46 - [main.backward:225]: Epoch 6/300 - Iteration 155/199 - Time 0.253 batch, 0.038 data, 0.223 forward
[INFO] - 03-16 18:17:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:17:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0216)
[INFO] - 03-16 18:17:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5945 (0.5984)
[INFO] - 03-16 18:17:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.9408 (-139.6849)
[INFO] - 03-16 18:17:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.6014 (30.4521)
[INFO] - 03-16 18:17:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 309.1989 (307.3524)
[INFO] - 03-16 18:17:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:17:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5703 (0.5322)
[INFO] - 03-16 18:17:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:17:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:17:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:17:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:17:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:17:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:17:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:18:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.472
[INFO] - 03-16 18:18:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.472
[INFO] - 03-16 18:18:01 - [main.summary_metrics:168]: Epoch 6/300 - Test Results:
{'auc': 0.5079300314465409,
 'f1': 0.06308659893565555,
 'loss': 0.6929195456234917,
 'ndcg': 0.2694015241451953,
 'precision': 0.09433962264150941,
 'recall': 0.04740566037735848}
[INFO] - 03-16 18:18:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[6] Complete. Time taken: 00:00:54.525
[INFO] - 03-16 18:18:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:18:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:18:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:18:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:18:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:18:01 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7253, 4979, 5148]
[INFO] - 03-16 18:18:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:18:04 - [main.backward:225]: Epoch 7/300 - Iteration 6/199 - Time 0.489 batch, 0.274 data, 0.456 forward
[INFO] - 03-16 18:18:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:18:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0216)
[INFO] - 03-16 18:18:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5964 (0.5983)
[INFO] - 03-16 18:18:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.8419 (-139.7076)
[INFO] - 03-16 18:18:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.5806 (30.5643)
[INFO] - 03-16 18:18:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 308.4174 (308.4678)
[INFO] - 03-16 18:18:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:18:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5703 (0.5343)
[INFO] - 03-16 18:18:16 - [main.backward:225]: Epoch 7/300 - Iteration 56/199 - Time 0.269 batch, 0.057 data, 0.237 forward
[INFO] - 03-16 18:18:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0212 (0.0214)
[INFO] - 03-16 18:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5907 (0.5965)
[INFO] - 03-16 18:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.9411 (-139.8286)
[INFO] - 03-16 18:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.4788 (30.4757)
[INFO] - 03-16 18:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 308.3101 (307.6866)
[INFO] - 03-16 18:18:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.5648)
[INFO] - 03-16 18:18:28 - [main.backward:225]: Epoch 7/300 - Iteration 106/199 - Time 0.254 batch, 0.043 data, 0.224 forward
[INFO] - 03-16 18:18:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:18:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0212)
[INFO] - 03-16 18:18:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5969 (0.5978)
[INFO] - 03-16 18:18:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.7360 (-139.7900)
[INFO] - 03-16 18:18:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.3373 (30.3503)
[INFO] - 03-16 18:18:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.5246 (306.9236)
[INFO] - 03-16 18:18:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:18:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.5828)
[INFO] - 03-16 18:18:40 - [main.backward:225]: Epoch 7/300 - Iteration 156/199 - Time 0.249 batch, 0.038 data, 0.220 forward
[INFO] - 03-16 18:18:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0212 (0.0216)
[INFO] - 03-16 18:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5945 (0.5988)
[INFO] - 03-16 18:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0431 (-139.7998)
[INFO] - 03-16 18:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.5364 (30.2570)
[INFO] - 03-16 18:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 308.3013 (307.8954)
[INFO] - 03-16 18:18:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.5370)
[INFO] - 03-16 18:18:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:18:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:18:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:18:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:18:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:18:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:18:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:18:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.313
[INFO] - 03-16 18:18:54 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.315
[INFO] - 03-16 18:18:54 - [main.summary_metrics:168]: Epoch 7/300 - Test Results:
{'auc': 0.5120094339622641,
 'f1': 0.055345911949685536,
 'loss': 0.6927958973738633,
 'ndcg': 0.2719068268571716,
 'precision': 0.0830188679245283,
 'recall': 0.04150943396226415}
[INFO] - 03-16 18:18:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[7] Complete. Time taken: 00:00:53.025
[INFO] - 03-16 18:18:54 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:18:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:18:54 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:18:54 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:18:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:18:54 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7247, 4985, 5130]
[INFO] - 03-16 18:18:55 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:18:57 - [main.backward:225]: Epoch 8/300 - Iteration 7/199 - Time 0.395 batch, 0.188 data, 0.366 forward
[INFO] - 03-16 18:18:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0209 (0.0216)
[INFO] - 03-16 18:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5950 (0.5989)
[INFO] - 03-16 18:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0409 (-139.8292)
[INFO] - 03-16 18:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.6332 (30.5403)
[INFO] - 03-16 18:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 308.2976 (308.7954)
[INFO] - 03-16 18:18:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.5251)
[INFO] - 03-16 18:19:09 - [main.backward:225]: Epoch 8/300 - Iteration 57/199 - Time 0.257 batch, 0.046 data, 0.230 forward
[INFO] - 03-16 18:19:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0208 (0.0214)
[INFO] - 03-16 18:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5969 (0.5956)
[INFO] - 03-16 18:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.7911 (-139.9575)
[INFO] - 03-16 18:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.4699 (30.5553)
[INFO] - 03-16 18:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.4674 (307.3285)
[INFO] - 03-16 18:19:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.5633)
[INFO] - 03-16 18:19:20 - [main.backward:225]: Epoch 8/300 - Iteration 107/199 - Time 0.248 batch, 0.037 data, 0.221 forward
[INFO] - 03-16 18:19:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:19:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0215 (0.0212)
[INFO] - 03-16 18:19:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5988 (0.5973)
[INFO] - 03-16 18:19:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.6370 (-139.8866)
[INFO] - 03-16 18:19:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.2654 (30.3442)
[INFO] - 03-16 18:19:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.3242 (306.9442)
[INFO] - 03-16 18:19:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:19:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5000 (0.5792)
[INFO] - 03-16 18:19:33 - [main.backward:225]: Epoch 8/300 - Iteration 157/199 - Time 0.247 batch, 0.035 data, 0.219 forward
[INFO] - 03-16 18:19:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0216)
[INFO] - 03-16 18:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5929 (0.5984)
[INFO] - 03-16 18:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1256 (-139.8931)
[INFO] - 03-16 18:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.3133 (30.1511)
[INFO] - 03-16 18:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 309.6967 (307.8368)
[INFO] - 03-16 18:19:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.5361)
[INFO] - 03-16 18:19:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:19:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:19:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:19:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:19:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:19:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:19:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:19:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.432
[INFO] - 03-16 18:19:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.432
[INFO] - 03-16 18:19:47 - [main.summary_metrics:168]: Epoch 8/300 - Test Results:
{'auc': 0.5079707154088051,
 'f1': 0.0628930817610063,
 'loss': 0.6928914418490428,
 'ndcg': 0.2708751459853895,
 'precision': 0.09433962264150944,
 'recall': 0.04716981132075472}
[INFO] - 03-16 18:19:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[8] Complete. Time taken: 00:00:53.467
[INFO] - 03-16 18:19:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:19:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:19:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:19:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:19:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:19:47 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7230, 4989, 5114]
[INFO] - 03-16 18:19:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:19:51 - [main.backward:225]: Epoch 9/300 - Iteration 8/199 - Time 0.389 batch, 0.182 data, 0.359 forward
[INFO] - 03-16 18:19:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0216)
[INFO] - 03-16 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5927 (0.5982)
[INFO] - 03-16 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1107 (-139.9236)
[INFO] - 03-16 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.2727 (30.2382)
[INFO] - 03-16 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 308.8050 (309.3517)
[INFO] - 03-16 18:19:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.5258)
[INFO] - 03-16 18:20:03 - [main.backward:225]: Epoch 9/300 - Iteration 58/199 - Time 0.265 batch, 0.051 data, 0.235 forward
[INFO] - 03-16 18:20:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:20:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0207 (0.0214)
[INFO] - 03-16 18:20:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5979 (0.5970)
[INFO] - 03-16 18:20:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.9300 (-140.0154)
[INFO] - 03-16 18:20:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.1252 (30.2338)
[INFO] - 03-16 18:20:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 304.8411 (307.7221)
[INFO] - 03-16 18:20:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:20:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.5647)
[INFO] - 03-16 18:20:15 - [main.backward:225]: Epoch 9/300 - Iteration 108/199 - Time 0.255 batch, 0.041 data, 0.225 forward
[INFO] - 03-16 18:20:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:20:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0208 (0.0212)
[INFO] - 03-16 18:20:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6001 (0.5975)
[INFO] - 03-16 18:20:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.6722 (-139.9513)
[INFO] - 03-16 18:20:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.0839 (30.1018)
[INFO] - 03-16 18:20:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.6212 (307.0872)
[INFO] - 03-16 18:20:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:20:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.5772)
[INFO] - 03-16 18:20:27 - [main.backward:225]: Epoch 9/300 - Iteration 158/199 - Time 0.248 batch, 0.037 data, 0.219 forward
[INFO] - 03-16 18:20:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0215)
[INFO] - 03-16 18:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5939 (0.5983)
[INFO] - 03-16 18:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1019 (-139.9839)
[INFO] - 03-16 18:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.0276 (29.9088)
[INFO] - 03-16 18:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 309.6487 (308.0090)
[INFO] - 03-16 18:20:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.5441)
[INFO] - 03-16 18:20:36 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:20:36 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:20:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:20:36 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:20:36 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:20:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:20:36 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:20:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.357
[INFO] - 03-16 18:20:41 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.357
[INFO] - 03-16 18:20:41 - [main.summary_metrics:168]: Epoch 9/300 - Test Results:
{'auc': 0.5109376637840671,
 'f1': 0.05157232704402517,
 'loss': 0.6927469650524468,
 'ndcg': 0.273465275577131,
 'precision': 0.07735849056603773,
 'recall': 0.038679245283018866}
[INFO] - 03-16 18:20:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[9] Complete. Time taken: 00:00:53.406
[INFO] - 03-16 18:20:41 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:20:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:20:41 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:20:41 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:20:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:20:41 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7252, 4971, 5123]
[INFO] - 03-16 18:20:42 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:20:44 - [main.backward:225]: Epoch 10/300 - Iteration 9/199 - Time 0.381 batch, 0.173 data, 0.353 forward
[INFO] - 03-16 18:20:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:20:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0209 (0.0216)
[INFO] - 03-16 18:20:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5827 (0.5980)
[INFO] - 03-16 18:20:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2812 (-139.9884)
[INFO] - 03-16 18:20:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.0165 (29.9902)
[INFO] - 03-16 18:20:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 308.8658 (309.1045)
[INFO] - 03-16 18:20:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:20:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.5327)
[INFO] - 03-16 18:20:56 - [main.backward:225]: Epoch 10/300 - Iteration 59/199 - Time 0.261 batch, 0.050 data, 0.233 forward
[INFO] - 03-16 18:20:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:20:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0215)
[INFO] - 03-16 18:20:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5988 (0.5958)
[INFO] - 03-16 18:20:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.9966 (-140.0530)
[INFO] - 03-16 18:20:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 30.0241 (30.0237)
[INFO] - 03-16 18:20:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.7282 (308.5197)
[INFO] - 03-16 18:20:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:20:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5391 (0.5564)
[INFO] - 03-16 18:21:08 - [main.backward:225]: Epoch 10/300 - Iteration 109/199 - Time 0.252 batch, 0.041 data, 0.223 forward
[INFO] - 03-16 18:21:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0203 (0.0212)
[INFO] - 03-16 18:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5984 (0.5970)
[INFO] - 03-16 18:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -139.8884 (-140.0346)
[INFO] - 03-16 18:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.9987 (29.9047)
[INFO] - 03-16 18:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.8215 (307.1303)
[INFO] - 03-16 18:21:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.5847)
[INFO] - 03-16 18:21:20 - [main.backward:225]: Epoch 10/300 - Iteration 159/199 - Time 0.249 batch, 0.037 data, 0.220 forward
[INFO] - 03-16 18:21:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:21:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0212 (0.0215)
[INFO] - 03-16 18:21:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5946 (0.5977)
[INFO] - 03-16 18:21:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1529 (-140.0527)
[INFO] - 03-16 18:21:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.9944 (29.8120)
[INFO] - 03-16 18:21:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 309.7404 (307.1805)
[INFO] - 03-16 18:21:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:21:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.5386)
[INFO] - 03-16 18:21:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:21:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:21:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:21:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:21:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:21:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:21:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:21:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.443
[INFO] - 03-16 18:21:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.444
[INFO] - 03-16 18:21:35 - [main.summary_metrics:168]: Epoch 10/300 - Test Results:
{'auc': 0.5136454402515723,
 'f1': 0.06182873730043543,
 'loss': 0.69254472618183,
 'ndcg': 0.27751286438793904,
 'precision': 0.09245283018867922,
 'recall': 0.046462264150943386}
[INFO] - 03-16 18:21:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[10] Complete. Time taken: 00:00:53.956
[INFO] - 03-16 18:21:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:21:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:21:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:21:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:21:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:21:35 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7256, 4979, 5130]
[INFO] - 03-16 18:21:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:21:38 - [main.backward:225]: Epoch 11/300 - Iteration 10/199 - Time 0.370 batch, 0.157 data, 0.339 forward
[INFO] - 03-16 18:21:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:21:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0204 (0.0215)
[INFO] - 03-16 18:21:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5857 (0.5987)
[INFO] - 03-16 18:21:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2713 (-140.0351)
[INFO] - 03-16 18:21:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.7654 (29.7945)
[INFO] - 03-16 18:21:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 309.5264 (309.4701)
[INFO] - 03-16 18:21:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:21:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7422 (0.5490)
[INFO] - 03-16 18:21:51 - [main.backward:225]: Epoch 11/300 - Iteration 60/199 - Time 0.265 batch, 0.050 data, 0.236 forward
[INFO] - 03-16 18:21:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:21:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0214)
[INFO] - 03-16 18:21:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5992 (0.5963)
[INFO] - 03-16 18:21:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0350 (-140.0977)
[INFO] - 03-16 18:21:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.7127 (29.7580)
[INFO] - 03-16 18:21:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.4992 (308.1951)
[INFO] - 03-16 18:21:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:21:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6016 (0.5598)
[INFO] - 03-16 18:22:03 - [main.backward:225]: Epoch 11/300 - Iteration 110/199 - Time 0.255 batch, 0.042 data, 0.225 forward
[INFO] - 03-16 18:22:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0211)
[INFO] - 03-16 18:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5908 (0.5972)
[INFO] - 03-16 18:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0655 (-140.0726)
[INFO] - 03-16 18:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.5234 (29.6293)
[INFO] - 03-16 18:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 305.3692 (307.1243)
[INFO] - 03-16 18:22:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.5803)
[INFO] - 03-16 18:22:15 - [main.backward:225]: Epoch 11/300 - Iteration 160/199 - Time 0.250 batch, 0.037 data, 0.221 forward
[INFO] - 03-16 18:22:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0215 (0.0216)
[INFO] - 03-16 18:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5937 (0.5983)
[INFO] - 03-16 18:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1575 (-140.1039)
[INFO] - 03-16 18:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.6726 (29.5077)
[INFO] - 03-16 18:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 310.1096 (307.7276)
[INFO] - 03-16 18:22:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5312 (0.5298)
[INFO] - 03-16 18:22:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:22:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:22:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:22:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:22:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:22:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:22:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:22:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.310
[INFO] - 03-16 18:22:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.311
[INFO] - 03-16 18:22:29 - [main.summary_metrics:168]: Epoch 11/300 - Test Results:
{'auc': 0.52355080581761,
 'f1': 0.07295597484276731,
 'loss': 0.6919974036506639,
 'ndcg': 0.2896701864371979,
 'precision': 0.10943396226415092,
 'recall': 0.05471698113207546}
[INFO] - 03-16 18:22:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[11] Complete. Time taken: 00:00:53.940
[INFO] - 03-16 18:22:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:22:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:22:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:22:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:22:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:22:29 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7239, 4996, 5144]
[INFO] - 03-16 18:22:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:22:33 - [main.backward:225]: Epoch 12/300 - Iteration 11/199 - Time 0.349 batch, 0.141 data, 0.321 forward
[INFO] - 03-16 18:22:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:22:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0215)
[INFO] - 03-16 18:22:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5795 (0.5976)
[INFO] - 03-16 18:22:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2996 (-140.0592)
[INFO] - 03-16 18:22:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.5881 (29.5949)
[INFO] - 03-16 18:22:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 309.2073 (309.6836)
[INFO] - 03-16 18:22:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:22:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.5433)
[INFO] - 03-16 18:22:44 - [main.backward:225]: Epoch 12/300 - Iteration 61/199 - Time 0.258 batch, 0.048 data, 0.231 forward
[INFO] - 03-16 18:22:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0214)
[INFO] - 03-16 18:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5986 (0.5965)
[INFO] - 03-16 18:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0768 (-140.1434)
[INFO] - 03-16 18:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.5886 (29.6202)
[INFO] - 03-16 18:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.8163 (308.0172)
[INFO] - 03-16 18:22:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7734 (0.5544)
[INFO] - 03-16 18:22:56 - [main.backward:225]: Epoch 12/300 - Iteration 111/199 - Time 0.250 batch, 0.040 data, 0.221 forward
[INFO] - 03-16 18:22:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:22:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0210)
[INFO] - 03-16 18:22:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5948 (0.5970)
[INFO] - 03-16 18:22:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0949 (-140.1131)
[INFO] - 03-16 18:22:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.4286 (29.3986)
[INFO] - 03-16 18:22:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 307.5050 (307.6860)
[INFO] - 03-16 18:22:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:22:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.6002)
[INFO] - 03-16 18:23:08 - [main.backward:225]: Epoch 12/300 - Iteration 161/199 - Time 0.245 batch, 0.036 data, 0.217 forward
[INFO] - 03-16 18:23:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:23:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0215)
[INFO] - 03-16 18:23:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5980 (0.5980)
[INFO] - 03-16 18:23:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1837 (-140.1518)
[INFO] - 03-16 18:23:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.5480 (29.3340)
[INFO] - 03-16 18:23:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 309.8516 (307.8409)
[INFO] - 03-16 18:23:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:23:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5781 (0.5411)
[INFO] - 03-16 18:23:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:23:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:23:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:23:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.320
[INFO] - 03-16 18:23:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.322
[INFO] - 03-16 18:23:22 - [main.summary_metrics:168]: Epoch 12/300 - Test Results:
{'auc': 0.5202427607442348,
 'f1': 0.0719496855345912,
 'loss': 0.6922590681271984,
 'ndcg': 0.2838255298500675,
 'precision': 0.10754716981132074,
 'recall': 0.05408805031446541}
[INFO] - 03-16 18:23:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[12] Complete. Time taken: 00:00:53.004
[INFO] - 03-16 18:23:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:23:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:23:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:23:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:23:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:23:22 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7259, 4986, 5167]
[INFO] - 03-16 18:23:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:23:26 - [main.backward:225]: Epoch 13/300 - Iteration 12/199 - Time 0.341 batch, 0.133 data, 0.312 forward
[INFO] - 03-16 18:23:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:23:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0215)
[INFO] - 03-16 18:23:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5915 (0.5974)
[INFO] - 03-16 18:23:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1692 (-140.1003)
[INFO] - 03-16 18:23:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.4777 (29.5425)
[INFO] - 03-16 18:23:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.9529 (308.2735)
[INFO] - 03-16 18:23:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:23:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5469 (0.5372)
[INFO] - 03-16 18:23:37 - [main.backward:225]: Epoch 13/300 - Iteration 62/199 - Time 0.252 batch, 0.048 data, 0.224 forward
[INFO] - 03-16 18:23:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:23:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0201 (0.0213)
[INFO] - 03-16 18:23:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6000 (0.5971)
[INFO] - 03-16 18:23:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1976 (-140.1877)
[INFO] - 03-16 18:23:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.5308 (29.4692)
[INFO] - 03-16 18:23:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.9408 (307.5018)
[INFO] - 03-16 18:23:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:23:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6797 (0.5673)
[INFO] - 03-16 18:23:49 - [main.backward:225]: Epoch 13/300 - Iteration 112/199 - Time 0.245 batch, 0.039 data, 0.217 forward
[INFO] - 03-16 18:23:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:23:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0201 (0.0211)
[INFO] - 03-16 18:23:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5946 (0.5963)
[INFO] - 03-16 18:23:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1307 (-140.1482)
[INFO] - 03-16 18:23:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.3939 (29.3955)
[INFO] - 03-16 18:23:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 305.1223 (305.8352)
[INFO] - 03-16 18:23:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:23:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5938 (0.5763)
[INFO] - 03-16 18:24:01 - [main.backward:225]: Epoch 13/300 - Iteration 162/199 - Time 0.242 batch, 0.036 data, 0.214 forward
[INFO] - 03-16 18:24:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:24:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0215 (0.0216)
[INFO] - 03-16 18:24:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5988 (0.5979)
[INFO] - 03-16 18:24:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0534 (-140.1733)
[INFO] - 03-16 18:24:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.4757 (29.3339)
[INFO] - 03-16 18:24:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 306.3423 (305.8457)
[INFO] - 03-16 18:24:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:24:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6016 (0.5344)
[INFO] - 03-16 18:24:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:24:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:24:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:24:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:24:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:24:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:24:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:24:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.329
[INFO] - 03-16 18:24:14 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.330
[INFO] - 03-16 18:24:14 - [main.summary_metrics:168]: Epoch 13/300 - Test Results:
{'auc': 0.5234781184486373,
 'f1': 0.08553459119496856,
 'loss': 0.6919145677754466,
 'ndcg': 0.29706348782179415,
 'precision': 0.12830188679245283,
 'recall': 0.06415094339622641}
[INFO] - 03-16 18:24:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[13] Complete. Time taken: 00:00:52.270
[INFO] - 03-16 18:24:14 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:24:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:24:14 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:24:14 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:24:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:24:14 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7252, 5004, 5171]
[INFO] - 03-16 18:24:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:24:18 - [main.backward:225]: Epoch 14/300 - Iteration 13/199 - Time 0.329 batch, 0.117 data, 0.302 forward
[INFO] - 03-16 18:24:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:24:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0214)
[INFO] - 03-16 18:24:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5990 (0.5974)
[INFO] - 03-16 18:24:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1470 (-140.1495)
[INFO] - 03-16 18:24:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.4928 (29.4947)
[INFO] - 03-16 18:24:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 304.9547 (305.9419)
[INFO] - 03-16 18:24:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:24:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.5464)
[INFO] - 03-16 18:24:30 - [main.backward:225]: Epoch 14/300 - Iteration 63/199 - Time 0.255 batch, 0.047 data, 0.226 forward
[INFO] - 03-16 18:24:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:24:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0197 (0.0213)
[INFO] - 03-16 18:24:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5969 (0.5963)
[INFO] - 03-16 18:24:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2308 (-140.2186)
[INFO] - 03-16 18:24:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.4795 (29.4247)
[INFO] - 03-16 18:24:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 303.2277 (304.5157)
[INFO] - 03-16 18:24:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:24:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7422 (0.5709)
[INFO] - 03-16 18:24:42 - [main.backward:225]: Epoch 14/300 - Iteration 113/199 - Time 0.245 batch, 0.038 data, 0.218 forward
[INFO] - 03-16 18:24:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:24:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0194 (0.0208)
[INFO] - 03-16 18:24:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5895 (0.5972)
[INFO] - 03-16 18:24:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2901 (-140.1951)
[INFO] - 03-16 18:24:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1228 (29.2478)
[INFO] - 03-16 18:24:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 304.0372 (303.6659)
[INFO] - 03-16 18:24:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:24:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.5977)
[INFO] - 03-16 18:24:53 - [main.backward:225]: Epoch 14/300 - Iteration 163/199 - Time 0.242 batch, 0.035 data, 0.215 forward
[INFO] - 03-16 18:24:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:24:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0215 (0.0216)
[INFO] - 03-16 18:24:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5999 (0.5985)
[INFO] - 03-16 18:24:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0847 (-140.2070)
[INFO] - 03-16 18:24:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.4376 (29.1499)
[INFO] - 03-16 18:24:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 305.7598 (305.1200)
[INFO] - 03-16 18:24:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:24:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5547 (0.5384)
[INFO] - 03-16 18:25:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:25:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:25:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:25:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:25:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:25:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:25:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:25:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.090
[INFO] - 03-16 18:25:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.091
[INFO] - 03-16 18:25:06 - [main.summary_metrics:168]: Epoch 14/300 - Test Results:
{'auc': 0.520923447327044,
 'f1': 0.0817610062893082,
 'loss': 0.6918905555637128,
 'ndcg': 0.2938625713515009,
 'precision': 0.12264150943396226,
 'recall': 0.06132075471698113}
[INFO] - 03-16 18:25:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[14] Complete. Time taken: 00:00:52.539
[INFO] - 03-16 18:25:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:25:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:25:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:25:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:25:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:25:07 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7255, 5022, 5138]
[INFO] - 03-16 18:25:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:25:11 - [main.backward:225]: Epoch 15/300 - Iteration 14/199 - Time 0.326 batch, 0.115 data, 0.297 forward
[INFO] - 03-16 18:25:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:25:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0219 (0.0214)
[INFO] - 03-16 18:25:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5926 (0.5972)
[INFO] - 03-16 18:25:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2225 (-140.1941)
[INFO] - 03-16 18:25:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.2687 (29.3487)
[INFO] - 03-16 18:25:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 305.2501 (306.2005)
[INFO] - 03-16 18:25:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:25:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4609 (0.5628)
[INFO] - 03-16 18:25:23 - [main.backward:225]: Epoch 15/300 - Iteration 64/199 - Time 0.257 batch, 0.046 data, 0.230 forward
[INFO] - 03-16 18:25:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0214)
[INFO] - 03-16 18:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6001 (0.5971)
[INFO] - 03-16 18:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2572 (-140.2537)
[INFO] - 03-16 18:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1288 (29.2195)
[INFO] - 03-16 18:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 305.2671 (305.5649)
[INFO] - 03-16 18:25:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.5587)
[INFO] - 03-16 18:25:35 - [main.backward:225]: Epoch 15/300 - Iteration 114/199 - Time 0.251 batch, 0.038 data, 0.223 forward
[INFO] - 03-16 18:25:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:25:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0195 (0.0208)
[INFO] - 03-16 18:25:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5946 (0.5975)
[INFO] - 03-16 18:25:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3714 (-140.2434)
[INFO] - 03-16 18:25:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1363 (29.1604)
[INFO] - 03-16 18:25:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 304.1702 (304.1095)
[INFO] - 03-16 18:25:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:25:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.6030)
[INFO] - 03-16 18:25:47 - [main.backward:225]: Epoch 15/300 - Iteration 164/199 - Time 0.248 batch, 0.036 data, 0.219 forward
[INFO] - 03-16 18:25:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:25:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0218 (0.0215)
[INFO] - 03-16 18:25:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6022 (0.5992)
[INFO] - 03-16 18:25:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1581 (-140.2315)
[INFO] - 03-16 18:25:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.5711 (29.1483)
[INFO] - 03-16 18:25:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 301.4734 (303.6518)
[INFO] - 03-16 18:25:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:25:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5312 (0.5355)
[INFO] - 03-16 18:25:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:25:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:25:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:25:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:25:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:25:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:25:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:26:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.327
[INFO] - 03-16 18:26:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.328
[INFO] - 03-16 18:26:00 - [main.summary_metrics:168]: Epoch 15/300 - Test Results:
{'auc': 0.5254597418763103,
 'f1': 0.09308176100628933,
 'loss': 0.6915470818773504,
 'ndcg': 0.302460715509799,
 'precision': 0.13962264150943396,
 'recall': 0.06981132075471698}
[INFO] - 03-16 18:26:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[15] Complete. Time taken: 00:00:53.771
[INFO] - 03-16 18:26:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:26:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:26:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:26:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:26:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:26:00 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7232, 4999, 5149]
[INFO] - 03-16 18:26:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:26:05 - [main.backward:225]: Epoch 16/300 - Iteration 15/199 - Time 0.320 batch, 0.110 data, 0.288 forward
[INFO] - 03-16 18:26:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0215 (0.0214)
[INFO] - 03-16 18:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6024 (0.5974)
[INFO] - 03-16 18:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2373 (-140.2486)
[INFO] - 03-16 18:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.4362 (29.5181)
[INFO] - 03-16 18:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 303.0673 (302.9747)
[INFO] - 03-16 18:26:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5234 (0.5526)
[INFO] - 03-16 18:26:17 - [main.backward:225]: Epoch 16/300 - Iteration 65/199 - Time 0.258 batch, 0.047 data, 0.229 forward
[INFO] - 03-16 18:26:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0214)
[INFO] - 03-16 18:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6041 (0.5968)
[INFO] - 03-16 18:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3480 (-140.2760)
[INFO] - 03-16 18:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1844 (29.2517)
[INFO] - 03-16 18:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 305.6460 (303.8785)
[INFO] - 03-16 18:26:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5234 (0.5586)
[INFO] - 03-16 18:26:29 - [main.backward:225]: Epoch 16/300 - Iteration 115/199 - Time 0.250 batch, 0.039 data, 0.222 forward
[INFO] - 03-16 18:26:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:26:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0195 (0.0208)
[INFO] - 03-16 18:26:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5925 (0.5967)
[INFO] - 03-16 18:26:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3742 (-140.2791)
[INFO] - 03-16 18:26:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.9742 (29.0552)
[INFO] - 03-16 18:26:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 303.0065 (304.1749)
[INFO] - 03-16 18:26:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:26:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.5952)
[INFO] - 03-16 18:26:41 - [main.backward:225]: Epoch 16/300 - Iteration 165/199 - Time 0.248 batch, 0.036 data, 0.218 forward
[INFO] - 03-16 18:26:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0218 (0.0216)
[INFO] - 03-16 18:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6005 (0.5984)
[INFO] - 03-16 18:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1969 (-140.2553)
[INFO] - 03-16 18:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.3612 (29.0830)
[INFO] - 03-16 18:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 302.8368 (302.5728)
[INFO] - 03-16 18:26:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4844 (0.5386)
[INFO] - 03-16 18:26:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:26:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:26:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:26:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:26:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:26:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:26:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:26:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.274
[INFO] - 03-16 18:26:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.274
[INFO] - 03-16 18:26:53 - [main.summary_metrics:168]: Epoch 16/300 - Test Results:
{'auc': 0.5278382140985325,
 'f1': 0.09459119496855348,
 'loss': 0.6910938070845055,
 'ndcg': 0.30439488531552883,
 'precision': 0.14150943396226418,
 'recall': 0.07106918238993712}
[INFO] - 03-16 18:26:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[16] Complete. Time taken: 00:00:53.166
[INFO] - 03-16 18:26:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:26:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:26:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:26:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:26:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:26:54 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7235, 4973, 5123]
[INFO] - 03-16 18:26:55 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:26:59 - [main.backward:225]: Epoch 17/300 - Iteration 16/199 - Time 0.317 batch, 0.107 data, 0.286 forward
[INFO] - 03-16 18:26:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:26:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0213)
[INFO] - 03-16 18:26:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5982 (0.5969)
[INFO] - 03-16 18:26:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2487 (-140.2878)
[INFO] - 03-16 18:26:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0822 (29.2994)
[INFO] - 03-16 18:26:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 302.6361 (303.0779)
[INFO] - 03-16 18:26:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:26:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.5756)
[INFO] - 03-16 18:27:10 - [main.backward:225]: Epoch 17/300 - Iteration 66/199 - Time 0.257 batch, 0.047 data, 0.228 forward
[INFO] - 03-16 18:27:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0215 (0.0212)
[INFO] - 03-16 18:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6114 (0.5979)
[INFO] - 03-16 18:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4008 (-140.3193)
[INFO] - 03-16 18:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8748 (29.0483)
[INFO] - 03-16 18:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 302.8304 (303.3236)
[INFO] - 03-16 18:27:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5781 (0.5769)
[INFO] - 03-16 18:27:22 - [main.backward:225]: Epoch 17/300 - Iteration 116/199 - Time 0.250 batch, 0.039 data, 0.222 forward
[INFO] - 03-16 18:27:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:27:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0183 (0.0208)
[INFO] - 03-16 18:27:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5955)
[INFO] - 03-16 18:27:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4029 (-140.3067)
[INFO] - 03-16 18:27:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8897 (28.9265)
[INFO] - 03-16 18:27:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 300.8617 (301.6848)
[INFO] - 03-16 18:27:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:27:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7500 (0.6061)
[INFO] - 03-16 18:27:35 - [main.backward:225]: Epoch 17/300 - Iteration 166/199 - Time 0.248 batch, 0.036 data, 0.220 forward
[INFO] - 03-16 18:27:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:27:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0217 (0.0215)
[INFO] - 03-16 18:27:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5995 (0.5993)
[INFO] - 03-16 18:27:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2124 (-140.2891)
[INFO] - 03-16 18:27:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.4016 (29.1188)
[INFO] - 03-16 18:27:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 301.0213 (300.8669)
[INFO] - 03-16 18:27:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:27:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5234 (0.5413)
[INFO] - 03-16 18:27:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:27:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:27:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:27:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:27:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:27:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:27:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:27:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.407
[INFO] - 03-16 18:27:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.408
[INFO] - 03-16 18:27:47 - [main.summary_metrics:168]: Epoch 17/300 - Test Results:
{'auc': 0.5319231525157233,
 'f1': 0.0955974842767296,
 'loss': 0.6905235721260248,
 'ndcg': 0.3143108412193509,
 'precision': 0.14339622641509436,
 'recall': 0.07169811320754718}
[INFO] - 03-16 18:27:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[17] Complete. Time taken: 00:00:53.545
[INFO] - 03-16 18:27:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:27:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:27:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:27:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:27:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:27:47 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7240, 4992, 5159]
[INFO] - 03-16 18:27:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:27:52 - [main.backward:225]: Epoch 18/300 - Iteration 17/199 - Time 0.317 batch, 0.106 data, 0.288 forward
[INFO] - 03-16 18:27:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:27:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0221 (0.0212)
[INFO] - 03-16 18:27:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6009 (0.5977)
[INFO] - 03-16 18:27:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2807 (-140.3288)
[INFO] - 03-16 18:27:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1592 (29.3728)
[INFO] - 03-16 18:27:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 301.0852 (300.6468)
[INFO] - 03-16 18:27:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:27:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5078 (0.5589)
[INFO] - 03-16 18:28:05 - [main.backward:225]: Epoch 18/300 - Iteration 67/199 - Time 0.261 batch, 0.049 data, 0.232 forward
[INFO] - 03-16 18:28:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0211)
[INFO] - 03-16 18:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6134 (0.5985)
[INFO] - 03-16 18:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4105 (-140.3507)
[INFO] - 03-16 18:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8315 (29.0662)
[INFO] - 03-16 18:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 302.3487 (301.6506)
[INFO] - 03-16 18:28:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5938 (0.5833)
[INFO] - 03-16 18:28:17 - [main.backward:225]: Epoch 18/300 - Iteration 117/199 - Time 0.252 batch, 0.040 data, 0.223 forward
[INFO] - 03-16 18:28:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:28:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0206)
[INFO] - 03-16 18:28:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5960 (0.5956)
[INFO] - 03-16 18:28:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2637 (-140.3258)
[INFO] - 03-16 18:28:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8752 (28.8834)
[INFO] - 03-16 18:28:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 300.4341 (300.8779)
[INFO] - 03-16 18:28:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:28:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6016 (0.6014)
[INFO] - 03-16 18:28:28 - [main.backward:225]: Epoch 18/300 - Iteration 167/199 - Time 0.248 batch, 0.037 data, 0.219 forward
[INFO] - 03-16 18:28:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0216)
[INFO] - 03-16 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5973 (0.5995)
[INFO] - 03-16 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2938 (-140.3306)
[INFO] - 03-16 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.3589 (29.0611)
[INFO] - 03-16 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 300.5841 (300.3512)
[INFO] - 03-16 18:28:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5312 (0.5364)
[INFO] - 03-16 18:28:36 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:28:36 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:28:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:28:36 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:28:36 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:28:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:28:36 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:28:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.377
[INFO] - 03-16 18:28:41 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.377
[INFO] - 03-16 18:28:41 - [main.summary_metrics:168]: Epoch 18/300 - Test Results:
{'auc': 0.5275425838574423,
 'f1': 0.08930817610062895,
 'loss': 0.6906045858515133,
 'ndcg': 0.3125024267182523,
 'precision': 0.1339622641509434,
 'recall': 0.0669811320754717}
[INFO] - 03-16 18:28:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[18] Complete. Time taken: 00:00:53.630
[INFO] - 03-16 18:28:41 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:28:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:28:41 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:28:41 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:28:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:28:41 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7209, 5001, 5125]
[INFO] - 03-16 18:28:42 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:28:46 - [main.backward:225]: Epoch 19/300 - Iteration 18/199 - Time 0.303 batch, 0.091 data, 0.275 forward
[INFO] - 03-16 18:28:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0220 (0.0211)
[INFO] - 03-16 18:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5980 (0.5990)
[INFO] - 03-16 18:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3178 (-140.3615)
[INFO] - 03-16 18:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0324 (29.2487)
[INFO] - 03-16 18:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 302.0761 (301.1198)
[INFO] - 03-16 18:28:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5000 (0.5730)
[INFO] - 03-16 18:28:58 - [main.backward:225]: Epoch 19/300 - Iteration 68/199 - Time 0.257 batch, 0.045 data, 0.228 forward
[INFO] - 03-16 18:28:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:28:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0201 (0.0209)
[INFO] - 03-16 18:28:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5997 (0.6004)
[INFO] - 03-16 18:28:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4477 (-140.3829)
[INFO] - 03-16 18:28:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.9472 (28.9162)
[INFO] - 03-16 18:28:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 299.5220 (301.6358)
[INFO] - 03-16 18:28:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:28:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.5931)
[INFO] - 03-16 18:29:10 - [main.backward:225]: Epoch 19/300 - Iteration 118/199 - Time 0.252 batch, 0.039 data, 0.223 forward
[INFO] - 03-16 18:29:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:29:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0208)
[INFO] - 03-16 18:29:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6055 (0.5935)
[INFO] - 03-16 18:29:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2589 (-140.3453)
[INFO] - 03-16 18:29:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0862 (28.9164)
[INFO] - 03-16 18:29:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 298.6051 (299.5890)
[INFO] - 03-16 18:29:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:29:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.5889)
[INFO] - 03-16 18:29:22 - [main.backward:225]: Epoch 19/300 - Iteration 168/199 - Time 0.249 batch, 0.036 data, 0.219 forward
[INFO] - 03-16 18:29:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0221 (0.0217)
[INFO] - 03-16 18:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6016 (0.5980)
[INFO] - 03-16 18:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3656 (-140.3643)
[INFO] - 03-16 18:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.2799 (29.0522)
[INFO] - 03-16 18:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 299.0582 (299.0166)
[INFO] - 03-16 18:29:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.3984 (0.5281)
[INFO] - 03-16 18:29:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:29:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:29:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:29:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:29:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:29:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:29:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:29:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.284
[INFO] - 03-16 18:29:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.284
[INFO] - 03-16 18:29:34 - [main.summary_metrics:168]: Epoch 19/300 - Test Results:
{'auc': 0.5309521095387841,
 'f1': 0.08930817610062895,
 'loss': 0.6902337690429367,
 'ndcg': 0.3163824593692657,
 'precision': 0.1339622641509434,
 'recall': 0.0669811320754717}
[INFO] - 03-16 18:29:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[19] Complete. Time taken: 00:00:53.490
[INFO] - 03-16 18:29:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:29:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:29:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:29:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:29:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:29:34 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7230, 4990, 5141]
[INFO] - 03-16 18:29:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:29:40 - [main.backward:225]: Epoch 20/300 - Iteration 19/199 - Time 0.301 batch, 0.091 data, 0.273 forward
[INFO] - 03-16 18:29:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:29:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0211)
[INFO] - 03-16 18:29:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5982 (0.5962)
[INFO] - 03-16 18:29:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4026 (-140.3870)
[INFO] - 03-16 18:29:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8820 (29.1548)
[INFO] - 03-16 18:29:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 299.7365 (298.9987)
[INFO] - 03-16 18:29:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:29:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5469 (0.5760)
[INFO] - 03-16 18:29:52 - [main.backward:225]: Epoch 20/300 - Iteration 69/199 - Time 0.256 batch, 0.046 data, 0.228 forward
[INFO] - 03-16 18:29:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:29:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0188 (0.0209)
[INFO] - 03-16 18:29:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5897 (0.5997)
[INFO] - 03-16 18:29:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4853 (-140.4076)
[INFO] - 03-16 18:29:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7885 (28.8146)
[INFO] - 03-16 18:29:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 299.2229 (299.4812)
[INFO] - 03-16 18:29:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:29:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.5923)
[INFO] - 03-16 18:30:04 - [main.backward:225]: Epoch 20/300 - Iteration 119/199 - Time 0.248 batch, 0.038 data, 0.220 forward
[INFO] - 03-16 18:30:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:30:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0208)
[INFO] - 03-16 18:30:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6061 (0.5958)
[INFO] - 03-16 18:30:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3242 (-140.3708)
[INFO] - 03-16 18:30:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.9846 (28.7688)
[INFO] - 03-16 18:30:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 296.4072 (298.9439)
[INFO] - 03-16 18:30:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:30:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.5955)
[INFO] - 03-16 18:30:16 - [main.backward:225]: Epoch 20/300 - Iteration 169/199 - Time 0.246 batch, 0.035 data, 0.218 forward
[INFO] - 03-16 18:30:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0216)
[INFO] - 03-16 18:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5952 (0.5983)
[INFO] - 03-16 18:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4317 (-140.3962)
[INFO] - 03-16 18:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0358 (28.8974)
[INFO] - 03-16 18:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 299.0866 (298.5610)
[INFO] - 03-16 18:30:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5312 (0.5408)
[INFO] - 03-16 18:30:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:30:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:30:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:30:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:30:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:30:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:30:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:30:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.371
[INFO] - 03-16 18:30:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.372
[INFO] - 03-16 18:30:27 - [main.summary_metrics:168]: Epoch 20/300 - Test Results:
{'auc': 0.5370941430817611,
 'f1': 0.08679245283018869,
 'loss': 0.6888635877933141,
 'ndcg': 0.3237800542382498,
 'precision': 0.13018867924528302,
 'recall': 0.06509433962264151}
[INFO] - 03-16 18:30:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[20] Complete. Time taken: 00:00:53.216
[INFO] - 03-16 18:30:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:30:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:30:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:30:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:30:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:30:27 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7236, 4990, 5137]
[INFO] - 03-16 18:30:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:30:34 - [main.backward:225]: Epoch 21/300 - Iteration 20/199 - Time 0.326 batch, 0.108 data, 0.295 forward
[INFO] - 03-16 18:30:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:30:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0221 (0.0210)
[INFO] - 03-16 18:30:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5974 (0.5981)
[INFO] - 03-16 18:30:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5327 (-140.4122)
[INFO] - 03-16 18:30:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6948 (29.0294)
[INFO] - 03-16 18:30:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 298.6814 (298.5177)
[INFO] - 03-16 18:30:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:30:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4688 (0.5808)
[INFO] - 03-16 18:30:46 - [main.backward:225]: Epoch 21/300 - Iteration 70/199 - Time 0.265 batch, 0.052 data, 0.235 forward
[INFO] - 03-16 18:30:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:30:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0173 (0.0209)
[INFO] - 03-16 18:30:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5982)
[INFO] - 03-16 18:30:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5105 (-140.4297)
[INFO] - 03-16 18:30:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6587 (28.6740)
[INFO] - 03-16 18:30:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 298.1746 (299.6557)
[INFO] - 03-16 18:30:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:30:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.5930)
[INFO] - 03-16 18:30:58 - [main.backward:225]: Epoch 21/300 - Iteration 120/199 - Time 0.256 batch, 0.043 data, 0.226 forward
[INFO] - 03-16 18:30:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0198 (0.0207)
[INFO] - 03-16 18:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6074 (0.5950)
[INFO] - 03-16 18:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3179 (-140.3945)
[INFO] - 03-16 18:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7668 (28.6446)
[INFO] - 03-16 18:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 297.7564 (299.1967)
[INFO] - 03-16 18:30:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.5986)
[INFO] - 03-16 18:31:10 - [main.backward:225]: Epoch 21/300 - Iteration 170/199 - Time 0.252 batch, 0.039 data, 0.222 forward
[INFO] - 03-16 18:31:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:31:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0215)
[INFO] - 03-16 18:31:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5808 (0.5986)
[INFO] - 03-16 18:31:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5195 (-140.4217)
[INFO] - 03-16 18:31:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8435 (28.7218)
[INFO] - 03-16 18:31:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 298.8286 (298.6734)
[INFO] - 03-16 18:31:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:31:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.5431)
[INFO] - 03-16 18:31:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:31:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:31:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:31:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:31:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:31:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:31:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:31:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.359
[INFO] - 03-16 18:31:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.359
[INFO] - 03-16 18:31:22 - [main.summary_metrics:168]: Epoch 21/300 - Test Results:
{'auc': 0.5385628275681341,
 'f1': 0.09308176100628932,
 'loss': 0.6882783388821584,
 'ndcg': 0.32485600073275306,
 'precision': 0.13962264150943396,
 'recall': 0.06981132075471698}
[INFO] - 03-16 18:31:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[21] Complete. Time taken: 00:00:54.348
[INFO] - 03-16 18:31:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:31:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:31:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:31:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:31:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:31:22 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7244, 4997, 5140]
[INFO] - 03-16 18:31:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:31:28 - [main.backward:225]: Epoch 22/300 - Iteration 21/199 - Time 0.300 batch, 0.089 data, 0.271 forward
[INFO] - 03-16 18:31:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:31:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0217 (0.0209)
[INFO] - 03-16 18:31:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5923 (0.5988)
[INFO] - 03-16 18:31:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5473 (-140.4388)
[INFO] - 03-16 18:31:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2911 (28.7418)
[INFO] - 03-16 18:31:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 298.3748 (298.2674)
[INFO] - 03-16 18:31:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:31:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5000 (0.5871)
[INFO] - 03-16 18:31:40 - [main.backward:225]: Epoch 22/300 - Iteration 71/199 - Time 0.254 batch, 0.046 data, 0.226 forward
[INFO] - 03-16 18:31:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:31:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0174 (0.0207)
[INFO] - 03-16 18:31:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5951 (0.5988)
[INFO] - 03-16 18:31:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5306 (-140.4459)
[INFO] - 03-16 18:31:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4359 (28.4984)
[INFO] - 03-16 18:31:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 297.1775 (299.2132)
[INFO] - 03-16 18:31:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:31:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.6016)
[INFO] - 03-16 18:31:52 - [main.backward:225]: Epoch 22/300 - Iteration 121/199 - Time 0.248 batch, 0.039 data, 0.219 forward
[INFO] - 03-16 18:31:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:31:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0191 (0.0206)
[INFO] - 03-16 18:31:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5984 (0.5982)
[INFO] - 03-16 18:31:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3567 (-140.4142)
[INFO] - 03-16 18:31:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.9642 (28.6353)
[INFO] - 03-16 18:31:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 293.2975 (297.3123)
[INFO] - 03-16 18:31:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:31:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.6070)
[INFO] - 03-16 18:32:04 - [main.backward:225]: Epoch 22/300 - Iteration 171/199 - Time 0.245 batch, 0.036 data, 0.217 forward
[INFO] - 03-16 18:32:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0215)
[INFO] - 03-16 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5987)
[INFO] - 03-16 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5407 (-140.4505)
[INFO] - 03-16 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1552 (28.9164)
[INFO] - 03-16 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 295.8220 (296.3010)
[INFO] - 03-16 18:32:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5156 (0.5411)
[INFO] - 03-16 18:32:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:32:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:32:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:32:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:32:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:32:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:32:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:32:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.339
[INFO] - 03-16 18:32:15 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.340
[INFO] - 03-16 18:32:15 - [main.summary_metrics:168]: Epoch 22/300 - Test Results:
{'auc': 0.5578934093291404,
 'f1': 0.09811320754716982,
 'loss': 0.6851532823894508,
 'ndcg': 0.33879272856222054,
 'precision': 0.1471698113207547,
 'recall': 0.07358490566037736}
[INFO] - 03-16 18:32:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[22] Complete. Time taken: 00:00:53.031
[INFO] - 03-16 18:32:15 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:32:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:32:15 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:32:15 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:32:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:32:15 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7241, 4976, 5121]
[INFO] - 03-16 18:32:16 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:32:21 - [main.backward:225]: Epoch 23/300 - Iteration 22/199 - Time 0.298 batch, 0.087 data, 0.267 forward
[INFO] - 03-16 18:32:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0229 (0.0208)
[INFO] - 03-16 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5850 (0.5998)
[INFO] - 03-16 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5646 (-140.4607)
[INFO] - 03-16 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4189 (28.8647)
[INFO] - 03-16 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 295.2546 (295.4991)
[INFO] - 03-16 18:32:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4688 (0.5975)
[INFO] - 03-16 18:32:33 - [main.backward:225]: Epoch 23/300 - Iteration 72/199 - Time 0.258 batch, 0.046 data, 0.229 forward
[INFO] - 03-16 18:32:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:32:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0195 (0.0208)
[INFO] - 03-16 18:32:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6059 (0.5965)
[INFO] - 03-16 18:32:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3155 (-140.4587)
[INFO] - 03-16 18:32:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5540 (28.6223)
[INFO] - 03-16 18:32:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 297.0891 (295.9568)
[INFO] - 03-16 18:32:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:32:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.5973)
[INFO] - 03-16 18:32:46 - [main.backward:225]: Epoch 23/300 - Iteration 122/199 - Time 0.253 batch, 0.040 data, 0.223 forward
[INFO] - 03-16 18:32:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0207)
[INFO] - 03-16 18:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5996 (0.5958)
[INFO] - 03-16 18:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3849 (-140.4353)
[INFO] - 03-16 18:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8059 (28.5941)
[INFO] - 03-16 18:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 293.9128 (296.0563)
[INFO] - 03-16 18:32:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6016 (0.6020)
[INFO] - 03-16 18:32:58 - [main.backward:225]: Epoch 23/300 - Iteration 172/199 - Time 0.249 batch, 0.037 data, 0.220 forward
[INFO] - 03-16 18:32:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0214)
[INFO] - 03-16 18:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5994)
[INFO] - 03-16 18:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5534 (-140.4728)
[INFO] - 03-16 18:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1535 (28.9089)
[INFO] - 03-16 18:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 292.7222 (295.1069)
[INFO] - 03-16 18:32:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5547 (0.5492)
[INFO] - 03-16 18:33:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:33:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:33:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:33:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:33:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:33:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:33:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:33:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.452
[INFO] - 03-16 18:33:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.452
[INFO] - 03-16 18:33:09 - [main.summary_metrics:168]: Epoch 23/300 - Test Results:
{'auc': 0.5477603183962263,
 'f1': 0.10062893081761007,
 'loss': 0.6863234275601945,
 'ndcg': 0.33668420393899146,
 'precision': 0.1509433962264151,
 'recall': 0.07547169811320754}
[INFO] - 03-16 18:33:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[23] Complete. Time taken: 00:00:54.158
[INFO] - 03-16 18:33:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:33:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:33:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:33:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:33:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:33:09 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7234, 4955, 5080]
[INFO] - 03-16 18:33:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:33:16 - [main.backward:225]: Epoch 24/300 - Iteration 23/199 - Time 0.298 batch, 0.082 data, 0.270 forward
[INFO] - 03-16 18:33:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:33:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0221 (0.0207)
[INFO] - 03-16 18:33:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6025 (0.6007)
[INFO] - 03-16 18:33:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5481 (-140.4808)
[INFO] - 03-16 18:33:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6188 (28.9929)
[INFO] - 03-16 18:33:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 295.4216 (293.6094)
[INFO] - 03-16 18:33:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:33:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4844 (0.6015)
[INFO] - 03-16 18:33:28 - [main.backward:225]: Epoch 24/300 - Iteration 73/199 - Time 0.258 batch, 0.046 data, 0.229 forward
[INFO] - 03-16 18:33:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:33:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0220 (0.0206)
[INFO] - 03-16 18:33:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6093 (0.5970)
[INFO] - 03-16 18:33:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2662 (-140.4687)
[INFO] - 03-16 18:33:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7007 (28.7141)
[INFO] - 03-16 18:33:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 295.5950 (293.9612)
[INFO] - 03-16 18:33:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:33:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5234 (0.6125)
[INFO] - 03-16 18:33:40 - [main.backward:225]: Epoch 24/300 - Iteration 123/199 - Time 0.250 batch, 0.038 data, 0.221 forward
[INFO] - 03-16 18:33:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0198 (0.0205)
[INFO] - 03-16 18:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6010 (0.5962)
[INFO] - 03-16 18:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4141 (-140.4592)
[INFO] - 03-16 18:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0521 (28.8284)
[INFO] - 03-16 18:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 292.8362 (293.6521)
[INFO] - 03-16 18:33:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.6153)
[INFO] - 03-16 18:33:52 - [main.backward:225]: Epoch 24/300 - Iteration 173/199 - Time 0.247 batch, 0.036 data, 0.218 forward
[INFO] - 03-16 18:33:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0212 (0.0216)
[INFO] - 03-16 18:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5969 (0.5988)
[INFO] - 03-16 18:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5649 (-140.4922)
[INFO] - 03-16 18:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0900 (28.9816)
[INFO] - 03-16 18:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 294.3251 (293.5434)
[INFO] - 03-16 18:33:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5391 (0.5341)
[INFO] - 03-16 18:33:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:33:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:33:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:33:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:33:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:33:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:33:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:34:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.424
[INFO] - 03-16 18:34:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.425
[INFO] - 03-16 18:34:02 - [main.summary_metrics:168]: Epoch 24/300 - Test Results:
{'auc': 0.5639878144654089,
 'f1': 0.10691823899371068,
 'loss': 0.6834899655787949,
 'ndcg': 0.34353394588534225,
 'precision': 0.160377358490566,
 'recall': 0.080188679245283}
[INFO] - 03-16 18:34:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[24] Complete. Time taken: 00:00:53.278
[INFO] - 03-16 18:34:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:34:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:34:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:34:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:34:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:34:02 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7255, 5003, 5146]
[INFO] - 03-16 18:34:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:34:09 - [main.backward:225]: Epoch 25/300 - Iteration 24/199 - Time 0.289 batch, 0.077 data, 0.260 forward
[INFO] - 03-16 18:34:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0190 (0.0205)
[INFO] - 03-16 18:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6220 (0.6021)
[INFO] - 03-16 18:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5341 (-140.4933)
[INFO] - 03-16 18:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5330 (28.7896)
[INFO] - 03-16 18:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 294.7244 (294.7342)
[INFO] - 03-16 18:34:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.6150)
[INFO] - 03-16 18:34:21 - [main.backward:225]: Epoch 25/300 - Iteration 74/199 - Time 0.256 batch, 0.044 data, 0.227 forward
[INFO] - 03-16 18:34:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:34:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0204)
[INFO] - 03-16 18:34:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6278 (0.5986)
[INFO] - 03-16 18:34:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3145 (-140.4776)
[INFO] - 03-16 18:34:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5206 (28.5760)
[INFO] - 03-16 18:34:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 295.1433 (295.3095)
[INFO] - 03-16 18:34:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:34:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.6225)
[INFO] - 03-16 18:34:33 - [main.backward:225]: Epoch 25/300 - Iteration 124/199 - Time 0.250 batch, 0.038 data, 0.221 forward
[INFO] - 03-16 18:34:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0197 (0.0202)
[INFO] - 03-16 18:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6027 (0.5967)
[INFO] - 03-16 18:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4677 (-140.4799)
[INFO] - 03-16 18:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7257 (28.6226)
[INFO] - 03-16 18:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 292.8815 (293.7800)
[INFO] - 03-16 18:34:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.6317)
[INFO] - 03-16 18:34:45 - [main.backward:225]: Epoch 25/300 - Iteration 174/199 - Time 0.247 batch, 0.035 data, 0.218 forward
[INFO] - 03-16 18:34:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0227 (0.0214)
[INFO] - 03-16 18:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5950 (0.5995)
[INFO] - 03-16 18:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5809 (-140.5094)
[INFO] - 03-16 18:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.9244 (28.8217)
[INFO] - 03-16 18:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 292.4708 (292.6402)
[INFO] - 03-16 18:34:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4531 (0.5466)
[INFO] - 03-16 18:34:51 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:34:51 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:34:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:34:51 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:34:51 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:34:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:34:51 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:34:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.325
[INFO] - 03-16 18:34:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.326
[INFO] - 03-16 18:34:55 - [main.summary_metrics:168]: Epoch 25/300 - Test Results:
{'auc': 0.5663839098532494,
 'f1': 0.09937106918238996,
 'loss': 0.6811034171906156,
 'ndcg': 0.3401750416686908,
 'precision': 0.1490566037735849,
 'recall': 0.07452830188679245}
[INFO] - 03-16 18:34:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[25] Complete. Time taken: 00:00:53.027
[INFO] - 03-16 18:34:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:34:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:34:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:34:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:34:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:34:55 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7256, 4976, 5146]
[INFO] - 03-16 18:34:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:35:02 - [main.backward:225]: Epoch 26/300 - Iteration 25/199 - Time 0.290 batch, 0.079 data, 0.261 forward
[INFO] - 03-16 18:35:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:35:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0218 (0.0202)
[INFO] - 03-16 18:35:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6061 (0.6056)
[INFO] - 03-16 18:35:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5437 (-140.5018)
[INFO] - 03-16 18:35:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4500 (28.7755)
[INFO] - 03-16 18:35:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 291.6981 (292.3253)
[INFO] - 03-16 18:35:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:35:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5234 (0.6221)
[INFO] - 03-16 18:35:14 - [main.backward:225]: Epoch 26/300 - Iteration 75/199 - Time 0.256 batch, 0.045 data, 0.228 forward
[INFO] - 03-16 18:35:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0205)
[INFO] - 03-16 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6244 (0.5973)
[INFO] - 03-16 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3490 (-140.4860)
[INFO] - 03-16 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5071 (28.7160)
[INFO] - 03-16 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 292.9664 (292.2633)
[INFO] - 03-16 18:35:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5781 (0.6158)
[INFO] - 03-16 18:35:26 - [main.backward:225]: Epoch 26/300 - Iteration 125/199 - Time 0.249 batch, 0.038 data, 0.221 forward
[INFO] - 03-16 18:35:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:35:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0219 (0.0205)
[INFO] - 03-16 18:35:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6081 (0.5946)
[INFO] - 03-16 18:35:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5667 (-140.4967)
[INFO] - 03-16 18:35:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1983 (28.9616)
[INFO] - 03-16 18:35:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 286.1854 (289.9336)
[INFO] - 03-16 18:35:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:35:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.6070)
[INFO] - 03-16 18:35:38 - [main.backward:225]: Epoch 26/300 - Iteration 175/199 - Time 0.246 batch, 0.035 data, 0.218 forward
[INFO] - 03-16 18:35:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:35:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0217)
[INFO] - 03-16 18:35:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6069 (0.5977)
[INFO] - 03-16 18:35:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5856 (-140.5213)
[INFO] - 03-16 18:35:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.5104 (29.3861)
[INFO] - 03-16 18:35:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 287.5301 (287.5205)
[INFO] - 03-16 18:35:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:35:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5469 (0.5248)
[INFO] - 03-16 18:35:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:35:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:35:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:35:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:35:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:35:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:35:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:35:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.331
[INFO] - 03-16 18:35:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.332
[INFO] - 03-16 18:35:48 - [main.summary_metrics:168]: Epoch 26/300 - Test Results:
{'auc': 0.5670558503668763,
 'f1': 0.10440251572327044,
 'loss': 0.6845112921476864,
 'ndcg': 0.34798913811918886,
 'precision': 0.15660377358490565,
 'recall': 0.07830188679245283}
[INFO] - 03-16 18:35:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[26] Complete. Time taken: 00:00:53.277
[INFO] - 03-16 18:35:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:35:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:35:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:35:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:35:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:35:49 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7253, 4983, 5116]
[INFO] - 03-16 18:35:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:35:56 - [main.backward:225]: Epoch 27/300 - Iteration 26/199 - Time 0.294 batch, 0.080 data, 0.265 forward
[INFO] - 03-16 18:35:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:35:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0207)
[INFO] - 03-16 18:35:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6078 (0.6008)
[INFO] - 03-16 18:35:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5408 (-140.5107)
[INFO] - 03-16 18:35:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7645 (29.1948)
[INFO] - 03-16 18:35:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 292.0320 (289.2864)
[INFO] - 03-16 18:35:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:35:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5469 (0.5997)
[INFO] - 03-16 18:36:08 - [main.backward:225]: Epoch 27/300 - Iteration 76/199 - Time 0.258 batch, 0.046 data, 0.229 forward
[INFO] - 03-16 18:36:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0180 (0.0200)
[INFO] - 03-16 18:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5835 (0.5977)
[INFO] - 03-16 18:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3980 (-140.4932)
[INFO] - 03-16 18:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5590 (28.7246)
[INFO] - 03-16 18:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 290.7222 (291.2263)
[INFO] - 03-16 18:36:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7422 (0.6480)
[INFO] - 03-16 18:36:20 - [main.backward:225]: Epoch 27/300 - Iteration 126/199 - Time 0.251 batch, 0.039 data, 0.222 forward
[INFO] - 03-16 18:36:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:36:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0204)
[INFO] - 03-16 18:36:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6061 (0.5992)
[INFO] - 03-16 18:36:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5795 (-140.5121)
[INFO] - 03-16 18:36:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.2209 (28.9517)
[INFO] - 03-16 18:36:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 288.8165 (289.8324)
[INFO] - 03-16 18:36:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:36:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6016 (0.6144)
[INFO] - 03-16 18:36:32 - [main.backward:225]: Epoch 27/300 - Iteration 176/199 - Time 0.247 batch, 0.036 data, 0.218 forward
[INFO] - 03-16 18:36:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0212 (0.0214)
[INFO] - 03-16 18:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6102 (0.5986)
[INFO] - 03-16 18:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5943 (-140.5334)
[INFO] - 03-16 18:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1751 (29.2187)
[INFO] - 03-16 18:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 289.8864 (289.4383)
[INFO] - 03-16 18:36:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.5514)
[INFO] - 03-16 18:36:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:36:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:36:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:36:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:36:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:36:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:36:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:36:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.247
[INFO] - 03-16 18:36:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.248
[INFO] - 03-16 18:36:42 - [main.summary_metrics:168]: Epoch 27/300 - Test Results:
{'auc': 0.5764683241614255,
 'f1': 0.10817610062893082,
 'loss': 0.6802453151878822,
 'ndcg': 0.34518790468010696,
 'precision': 0.1622641509433962,
 'recall': 0.0811320754716981}
[INFO] - 03-16 18:36:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[27] Complete. Time taken: 00:00:53.221
[INFO] - 03-16 18:36:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:36:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:36:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:36:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:36:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:36:42 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7212, 4970, 5133]
[INFO] - 03-16 18:36:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:36:49 - [main.backward:225]: Epoch 28/300 - Iteration 27/199 - Time 0.286 batch, 0.075 data, 0.257 forward
[INFO] - 03-16 18:36:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:36:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0204)
[INFO] - 03-16 18:36:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6015 (0.6028)
[INFO] - 03-16 18:36:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5103 (-140.5186)
[INFO] - 03-16 18:36:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6268 (28.9062)
[INFO] - 03-16 18:36:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 292.0371 (290.8237)
[INFO] - 03-16 18:36:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:36:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.6253)
[INFO] - 03-16 18:37:02 - [main.backward:225]: Epoch 28/300 - Iteration 77/199 - Time 0.258 batch, 0.045 data, 0.229 forward
[INFO] - 03-16 18:37:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0178 (0.0196)
[INFO] - 03-16 18:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5800 (0.5986)
[INFO] - 03-16 18:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4240 (-140.4997)
[INFO] - 03-16 18:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5303 (28.5799)
[INFO] - 03-16 18:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 291.2540 (291.3324)
[INFO] - 03-16 18:37:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.6580)
[INFO] - 03-16 18:37:14 - [main.backward:225]: Epoch 28/300 - Iteration 127/199 - Time 0.251 batch, 0.039 data, 0.222 forward
[INFO] - 03-16 18:37:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:37:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0204)
[INFO] - 03-16 18:37:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6118 (0.5983)
[INFO] - 03-16 18:37:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5983 (-140.5267)
[INFO] - 03-16 18:37:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.3889 (29.1392)
[INFO] - 03-16 18:37:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 285.1003 (287.7833)
[INFO] - 03-16 18:37:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:37:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5938 (0.6156)
[INFO] - 03-16 18:37:26 - [main.backward:225]: Epoch 28/300 - Iteration 177/199 - Time 0.248 batch, 0.036 data, 0.219 forward
[INFO] - 03-16 18:37:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:37:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0216)
[INFO] - 03-16 18:37:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6082 (0.5976)
[INFO] - 03-16 18:37:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5103 (-140.5426)
[INFO] - 03-16 18:37:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.6620 (29.6013)
[INFO] - 03-16 18:37:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 284.5003 (284.4889)
[INFO] - 03-16 18:37:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:37:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.5427)
[INFO] - 03-16 18:37:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:37:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:37:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:37:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:37:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:37:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:37:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:37:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.289
[INFO] - 03-16 18:37:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.290
[INFO] - 03-16 18:37:35 - [main.summary_metrics:168]: Epoch 28/300 - Test Results:
{'auc': 0.5737261857966457,
 'f1': 0.10610546686018384,
 'loss': 0.6818031950296846,
 'ndcg': 0.3471964016478611,
 'precision': 0.1584905660377358,
 'recall': 0.07979559748427671}
[INFO] - 03-16 18:37:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[28] Complete. Time taken: 00:00:53.511
[INFO] - 03-16 18:37:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:37:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:37:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:37:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:37:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:37:35 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7234, 5001, 5134]
[INFO] - 03-16 18:37:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:37:43 - [main.backward:225]: Epoch 29/300 - Iteration 28/199 - Time 0.282 batch, 0.070 data, 0.252 forward
[INFO] - 03-16 18:37:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:37:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0212 (0.0204)
[INFO] - 03-16 18:37:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5943 (0.6027)
[INFO] - 03-16 18:37:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5128 (-140.5262)
[INFO] - 03-16 18:37:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6021 (29.2081)
[INFO] - 03-16 18:37:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 291.6009 (288.2532)
[INFO] - 03-16 18:37:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:37:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5703 (0.6249)
[INFO] - 03-16 18:37:55 - [main.backward:225]: Epoch 29/300 - Iteration 78/199 - Time 0.258 batch, 0.044 data, 0.228 forward
[INFO] - 03-16 18:37:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:37:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0163 (0.0197)
[INFO] - 03-16 18:37:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5701 (0.5966)
[INFO] - 03-16 18:37:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4209 (-140.5089)
[INFO] - 03-16 18:37:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7129 (28.7738)
[INFO] - 03-16 18:37:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 288.0121 (290.3807)
[INFO] - 03-16 18:37:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:37:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7422 (0.6527)
[INFO] - 03-16 18:38:08 - [main.backward:225]: Epoch 29/300 - Iteration 128/199 - Time 0.254 batch, 0.039 data, 0.223 forward
[INFO] - 03-16 18:38:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:38:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0196 (0.0205)
[INFO] - 03-16 18:38:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6177 (0.5980)
[INFO] - 03-16 18:38:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5965 (-140.5353)
[INFO] - 03-16 18:38:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.6868 (29.3442)
[INFO] - 03-16 18:38:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 282.7242 (285.3701)
[INFO] - 03-16 18:38:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:38:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.6159)
[INFO] - 03-16 18:38:20 - [main.backward:225]: Epoch 29/300 - Iteration 178/199 - Time 0.253 batch, 0.037 data, 0.222 forward
[INFO] - 03-16 18:38:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:38:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0209 (0.0214)
[INFO] - 03-16 18:38:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6038 (0.5991)
[INFO] - 03-16 18:38:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4976 (-140.5486)
[INFO] - 03-16 18:38:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.4701 (29.5550)
[INFO] - 03-16 18:38:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 286.6774 (284.6106)
[INFO] - 03-16 18:38:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:38:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.5541)
[INFO] - 03-16 18:38:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:38:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:38:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:38:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:38:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:38:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:38:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:38:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.353
[INFO] - 03-16 18:38:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.354
[INFO] - 03-16 18:38:30 - [main.summary_metrics:168]: Epoch 29/300 - Test Results:
{'auc': 0.5755076650943396,
 'f1': 0.1056603773584906,
 'loss': 0.6780108564684727,
 'ndcg': 0.35165863265831304,
 'precision': 0.1584905660377358,
 'recall': 0.0792452830188679}
[INFO] - 03-16 18:38:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[29] Complete. Time taken: 00:00:54.581
[INFO] - 03-16 18:38:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:38:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:38:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:38:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:38:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:38:30 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7228, 4970, 5136]
[INFO] - 03-16 18:38:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:38:38 - [main.backward:225]: Epoch 30/300 - Iteration 29/199 - Time 0.296 batch, 0.083 data, 0.265 forward
[INFO] - 03-16 18:38:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:38:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0223 (0.0202)
[INFO] - 03-16 18:38:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5952 (0.6038)
[INFO] - 03-16 18:38:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5210 (-140.5347)
[INFO] - 03-16 18:38:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6269 (29.0681)
[INFO] - 03-16 18:38:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 289.8088 (287.3107)
[INFO] - 03-16 18:38:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:38:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5156 (0.6322)
[INFO] - 03-16 18:38:50 - [main.backward:225]: Epoch 30/300 - Iteration 79/199 - Time 0.261 batch, 0.049 data, 0.231 forward
[INFO] - 03-16 18:38:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:38:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0175 (0.0195)
[INFO] - 03-16 18:38:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5916 (0.5969)
[INFO] - 03-16 18:38:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4708 (-140.5190)
[INFO] - 03-16 18:38:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6070 (28.6926)
[INFO] - 03-16 18:38:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 288.7964 (288.8908)
[INFO] - 03-16 18:38:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:38:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7734 (0.6620)
[INFO] - 03-16 18:39:02 - [main.backward:225]: Epoch 30/300 - Iteration 129/199 - Time 0.253 batch, 0.042 data, 0.223 forward
[INFO] - 03-16 18:39:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0191 (0.0203)
[INFO] - 03-16 18:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6161 (0.5985)
[INFO] - 03-16 18:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5841 (-140.5445)
[INFO] - 03-16 18:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0433 (28.9441)
[INFO] - 03-16 18:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 285.3501 (286.9324)
[INFO] - 03-16 18:39:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.6259)
[INFO] - 03-16 18:39:14 - [main.backward:225]: Epoch 30/300 - Iteration 179/199 - Time 0.250 batch, 0.038 data, 0.220 forward
[INFO] - 03-16 18:39:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0211)
[INFO] - 03-16 18:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6116 (0.6007)
[INFO] - 03-16 18:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5264 (-140.5570)
[INFO] - 03-16 18:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8719 (29.0147)
[INFO] - 03-16 18:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 288.1247 (286.6131)
[INFO] - 03-16 18:39:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.5758)
[INFO] - 03-16 18:39:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:39:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:39:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:39:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:39:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:39:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:39:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:39:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.379
[INFO] - 03-16 18:39:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.380
[INFO] - 03-16 18:39:24 - [main.summary_metrics:168]: Epoch 30/300 - Test Results:
{'auc': 0.5917457416142557,
 'f1': 0.10968553459119498,
 'loss': 0.6745465180099135,
 'ndcg': 0.3582452437597145,
 'precision': 0.1641509433962264,
 'recall': 0.08238993710691823}
[INFO] - 03-16 18:39:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[30] Complete. Time taken: 00:00:54.048
[INFO] - 03-16 18:39:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:39:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:39:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:39:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:39:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:39:24 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7212, 4977, 5117]
[INFO] - 03-16 18:39:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:39:32 - [main.backward:225]: Epoch 31/300 - Iteration 30/199 - Time 0.285 batch, 0.071 data, 0.255 forward
[INFO] - 03-16 18:39:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0221 (0.0202)
[INFO] - 03-16 18:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5912 (0.6020)
[INFO] - 03-16 18:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5105 (-140.5395)
[INFO] - 03-16 18:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3789 (28.6418)
[INFO] - 03-16 18:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 289.6853 (289.1224)
[INFO] - 03-16 18:39:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5234 (0.6229)
[INFO] - 03-16 18:39:45 - [main.backward:225]: Epoch 31/300 - Iteration 80/199 - Time 0.260 batch, 0.047 data, 0.228 forward
[INFO] - 03-16 18:39:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0197)
[INFO] - 03-16 18:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6079 (0.5957)
[INFO] - 03-16 18:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5627 (-140.5253)
[INFO] - 03-16 18:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3397 (28.5599)
[INFO] - 03-16 18:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 288.4643 (289.5126)
[INFO] - 03-16 18:39:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5703 (0.6525)
[INFO] - 03-16 18:39:57 - [main.backward:225]: Epoch 31/300 - Iteration 130/199 - Time 0.255 batch, 0.041 data, 0.224 forward
[INFO] - 03-16 18:39:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:39:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0203 (0.0204)
[INFO] - 03-16 18:39:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6182 (0.5970)
[INFO] - 03-16 18:39:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5874 (-140.5534)
[INFO] - 03-16 18:39:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1113 (28.9357)
[INFO] - 03-16 18:39:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 285.1466 (286.0418)
[INFO] - 03-16 18:39:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:39:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.6155)
[INFO] - 03-16 18:40:09 - [main.backward:225]: Epoch 31/300 - Iteration 180/199 - Time 0.252 batch, 0.038 data, 0.221 forward
[INFO] - 03-16 18:40:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:40:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0212)
[INFO] - 03-16 18:40:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6157 (0.6011)
[INFO] - 03-16 18:40:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5314 (-140.5637)
[INFO] - 03-16 18:40:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7538 (29.0802)
[INFO] - 03-16 18:40:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 287.4042 (285.3059)
[INFO] - 03-16 18:40:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:40:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.5802)
[INFO] - 03-16 18:40:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:40:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:40:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:40:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:40:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:40:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:40:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:40:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.434
[INFO] - 03-16 18:40:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.434
[INFO] - 03-16 18:40:18 - [main.summary_metrics:168]: Epoch 31/300 - Test Results:
{'auc': 0.5940111045597484,
 'f1': 0.1109433962264151,
 'loss': 0.6725541529145631,
 'ndcg': 0.36060585689946306,
 'precision': 0.1660377358490566,
 'recall': 0.08333333333333333}
[INFO] - 03-16 18:40:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[31] Complete. Time taken: 00:00:54.486
[INFO] - 03-16 18:40:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:40:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:40:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:40:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:40:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:40:18 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7236, 4988, 5149]
[INFO] - 03-16 18:40:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:40:27 - [main.backward:225]: Epoch 32/300 - Iteration 31/199 - Time 0.289 batch, 0.078 data, 0.259 forward
[INFO] - 03-16 18:40:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:40:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0215 (0.0198)
[INFO] - 03-16 18:40:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5535 (0.6039)
[INFO] - 03-16 18:40:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5288 (-140.5415)
[INFO] - 03-16 18:40:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3878 (28.5528)
[INFO] - 03-16 18:40:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 289.3286 (288.4276)
[INFO] - 03-16 18:40:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:40:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5781 (0.6424)
[INFO] - 03-16 18:40:39 - [main.backward:225]: Epoch 32/300 - Iteration 81/199 - Time 0.261 batch, 0.049 data, 0.231 forward
[INFO] - 03-16 18:40:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0220 (0.0194)
[INFO] - 03-16 18:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6013 (0.5960)
[INFO] - 03-16 18:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5613 (-140.5305)
[INFO] - 03-16 18:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.1948 (28.5184)
[INFO] - 03-16 18:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 287.8601 (288.5379)
[INFO] - 03-16 18:40:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.6630)
[INFO] - 03-16 18:40:52 - [main.backward:225]: Epoch 32/300 - Iteration 131/199 - Time 0.257 batch, 0.042 data, 0.226 forward
[INFO] - 03-16 18:40:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:40:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0184 (0.0201)
[INFO] - 03-16 18:40:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6149 (0.5982)
[INFO] - 03-16 18:40:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5998 (-140.5588)
[INFO] - 03-16 18:40:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.9752 (28.9072)
[INFO] - 03-16 18:40:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 286.0733 (286.3208)
[INFO] - 03-16 18:40:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:40:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.6347)
[INFO] - 03-16 18:41:04 - [main.backward:225]: Epoch 32/300 - Iteration 181/199 - Time 0.252 batch, 0.039 data, 0.222 forward
[INFO] - 03-16 18:41:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:41:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0198 (0.0209)
[INFO] - 03-16 18:41:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6042 (0.6033)
[INFO] - 03-16 18:41:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5150 (-140.5679)
[INFO] - 03-16 18:41:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.9877 (28.9545)
[INFO] - 03-16 18:41:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 287.7984 (286.6737)
[INFO] - 03-16 18:41:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:41:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.5913)
[INFO] - 03-16 18:41:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:41:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:41:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:41:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:41:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:41:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:41:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:41:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.369
[INFO] - 03-16 18:41:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.372
[INFO] - 03-16 18:41:13 - [main.summary_metrics:168]: Epoch 32/300 - Test Results:
{'auc': 0.6010396685010483,
 'f1': 0.10440251572327044,
 'loss': 0.6701569889076604,
 'ndcg': 0.3605946980498511,
 'precision': 0.15660377358490565,
 'recall': 0.07830188679245283}
[INFO] - 03-16 18:41:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[32] Complete. Time taken: 00:00:54.474
[INFO] - 03-16 18:41:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:41:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:41:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:41:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:41:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:41:13 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7227, 4974, 5132]
[INFO] - 03-16 18:41:14 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:41:22 - [main.backward:225]: Epoch 33/300 - Iteration 32/199 - Time 0.283 batch, 0.073 data, 0.252 forward
[INFO] - 03-16 18:41:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:41:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0191 (0.0197)
[INFO] - 03-16 18:41:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5733 (0.6017)
[INFO] - 03-16 18:41:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5377 (-140.5433)
[INFO] - 03-16 18:41:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5626 (28.7044)
[INFO] - 03-16 18:41:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 286.5063 (287.4065)
[INFO] - 03-16 18:41:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:41:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.6471)
[INFO] - 03-16 18:41:34 - [main.backward:225]: Epoch 33/300 - Iteration 82/199 - Time 0.257 batch, 0.046 data, 0.228 forward
[INFO] - 03-16 18:41:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:41:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0222 (0.0194)
[INFO] - 03-16 18:41:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6099 (0.5994)
[INFO] - 03-16 18:41:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5547 (-140.5371)
[INFO] - 03-16 18:41:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5721 (28.7628)
[INFO] - 03-16 18:41:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 285.5121 (286.5292)
[INFO] - 03-16 18:41:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:41:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5078 (0.6600)
[INFO] - 03-16 18:41:46 - [main.backward:225]: Epoch 33/300 - Iteration 132/199 - Time 0.251 batch, 0.040 data, 0.222 forward
[INFO] - 03-16 18:41:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:41:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0220 (0.0203)
[INFO] - 03-16 18:41:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6048 (0.5973)
[INFO] - 03-16 18:41:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5456 (-140.5617)
[INFO] - 03-16 18:41:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0847 (29.0283)
[INFO] - 03-16 18:41:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 283.9989 (283.6460)
[INFO] - 03-16 18:41:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:41:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5234 (0.6139)
[INFO] - 03-16 18:41:58 - [main.backward:225]: Epoch 33/300 - Iteration 182/199 - Time 0.249 batch, 0.037 data, 0.219 forward
[INFO] - 03-16 18:41:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:41:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0200 (0.0208)
[INFO] - 03-16 18:41:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5925 (0.6028)
[INFO] - 03-16 18:41:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5172 (-140.5717)
[INFO] - 03-16 18:41:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8285 (28.9909)
[INFO] - 03-16 18:41:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 285.2874 (285.3055)
[INFO] - 03-16 18:41:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:41:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.5914)
[INFO] - 03-16 18:42:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:42:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:42:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:42:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:42:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:42:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:42:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:42:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.394
[INFO] - 03-16 18:42:07 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.395
[INFO] - 03-16 18:42:07 - [main.summary_metrics:168]: Epoch 33/300 - Test Results:
{'auc': 0.5967389937106918,
 'f1': 0.11220125786163522,
 'loss': 0.6707346573555746,
 'ndcg': 0.3612834939379617,
 'precision': 0.16792452830188676,
 'recall': 0.08427672955974841}
[INFO] - 03-16 18:42:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[33] Complete. Time taken: 00:00:53.988
[INFO] - 03-16 18:42:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:42:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:42:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:42:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:42:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:42:07 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7221, 4978, 5127]
[INFO] - 03-16 18:42:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:42:16 - [main.backward:225]: Epoch 34/300 - Iteration 33/199 - Time 0.279 batch, 0.065 data, 0.250 forward
[INFO] - 03-16 18:42:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0197)
[INFO] - 03-16 18:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5682 (0.6014)
[INFO] - 03-16 18:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5432 (-140.5460)
[INFO] - 03-16 18:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7130 (28.7355)
[INFO] - 03-16 18:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 285.0523 (285.0697)
[INFO] - 03-16 18:42:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.6415)
[INFO] - 03-16 18:42:28 - [main.backward:225]: Epoch 34/300 - Iteration 83/199 - Time 0.258 batch, 0.044 data, 0.228 forward
[INFO] - 03-16 18:42:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:42:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0229 (0.0193)
[INFO] - 03-16 18:42:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5980 (0.5995)
[INFO] - 03-16 18:42:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5368 (-140.5401)
[INFO] - 03-16 18:42:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7725 (28.7917)
[INFO] - 03-16 18:42:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 285.8919 (285.2267)
[INFO] - 03-16 18:42:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:42:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5156 (0.6631)
[INFO] - 03-16 18:42:40 - [main.backward:225]: Epoch 34/300 - Iteration 133/199 - Time 0.252 batch, 0.038 data, 0.222 forward
[INFO] - 03-16 18:42:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:42:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0227 (0.0202)
[INFO] - 03-16 18:42:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5996 (0.5968)
[INFO] - 03-16 18:42:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5359 (-140.5659)
[INFO] - 03-16 18:42:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.3298 (29.3181)
[INFO] - 03-16 18:42:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 280.4630 (281.1782)
[INFO] - 03-16 18:42:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:42:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4844 (0.6233)
[INFO] - 03-16 18:42:52 - [main.backward:225]: Epoch 34/300 - Iteration 183/199 - Time 0.249 batch, 0.036 data, 0.220 forward
[INFO] - 03-16 18:42:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:42:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0187 (0.0210)
[INFO] - 03-16 18:42:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6164 (0.6021)
[INFO] - 03-16 18:42:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5080 (-140.5737)
[INFO] - 03-16 18:42:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8888 (29.2603)
[INFO] - 03-16 18:42:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 283.0349 (282.2329)
[INFO] - 03-16 18:42:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:42:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.5781)
[INFO] - 03-16 18:42:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:42:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:42:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:42:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:42:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:42:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:42:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:43:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.586
[INFO] - 03-16 18:43:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.587
[INFO] - 03-16 18:43:01 - [main.summary_metrics:168]: Epoch 34/300 - Test Results:
{'auc': 0.6055305293501049,
 'f1': 0.11320754716981132,
 'loss': 0.669576342016896,
 'ndcg': 0.3717258805432061,
 'precision': 0.16981132075471697,
 'recall': 0.08490566037735849}
[INFO] - 03-16 18:43:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[34] Complete. Time taken: 00:00:54.012
[INFO] - 03-16 18:43:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:43:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:43:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:43:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:43:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:43:01 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7223, 4999, 5144]
[INFO] - 03-16 18:43:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:43:10 - [main.backward:225]: Epoch 35/300 - Iteration 34/199 - Time 0.285 batch, 0.072 data, 0.254 forward
[INFO] - 03-16 18:43:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:43:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0204 (0.0197)
[INFO] - 03-16 18:43:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5710 (0.6013)
[INFO] - 03-16 18:43:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5580 (-140.5496)
[INFO] - 03-16 18:43:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4312 (28.7567)
[INFO] - 03-16 18:43:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 286.1826 (284.3113)
[INFO] - 03-16 18:43:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:43:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.6510)
[INFO] - 03-16 18:43:23 - [main.backward:225]: Epoch 35/300 - Iteration 84/199 - Time 0.262 batch, 0.048 data, 0.231 forward
[INFO] - 03-16 18:43:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:43:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0200 (0.0189)
[INFO] - 03-16 18:43:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6098 (0.6005)
[INFO] - 03-16 18:43:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5113 (-140.5425)
[INFO] - 03-16 18:43:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7031 (28.6726)
[INFO] - 03-16 18:43:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 282.9290 (283.9284)
[INFO] - 03-16 18:43:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:43:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.6747)
[INFO] - 03-16 18:43:35 - [main.backward:225]: Epoch 35/300 - Iteration 134/199 - Time 0.256 batch, 0.042 data, 0.225 forward
[INFO] - 03-16 18:43:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:43:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0215 (0.0203)
[INFO] - 03-16 18:43:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6062 (0.5959)
[INFO] - 03-16 18:43:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5503 (-140.5672)
[INFO] - 03-16 18:43:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.2627 (29.2513)
[INFO] - 03-16 18:43:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 280.0086 (280.1822)
[INFO] - 03-16 18:43:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:43:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5078 (0.6233)
[INFO] - 03-16 18:43:47 - [main.backward:225]: Epoch 35/300 - Iteration 184/199 - Time 0.252 batch, 0.039 data, 0.221 forward
[INFO] - 03-16 18:43:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0208)
[INFO] - 03-16 18:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6158 (0.6004)
[INFO] - 03-16 18:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5184 (-140.5748)
[INFO] - 03-16 18:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.9537 (29.2152)
[INFO] - 03-16 18:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 283.5939 (280.8839)
[INFO] - 03-16 18:43:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.5905)
[INFO] - 03-16 18:43:51 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:43:51 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:43:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:43:51 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:43:51 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:43:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:43:51 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:43:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.459
[INFO] - 03-16 18:43:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.460
[INFO] - 03-16 18:43:55 - [main.summary_metrics:168]: Epoch 35/300 - Test Results:
{'auc': 0.6114571868448638,
 'f1': 0.12100628930817613,
 'loss': 0.6677503256207992,
 'ndcg': 0.3705214935109839,
 'precision': 0.18113207547169807,
 'recall': 0.09088050314465407}
[INFO] - 03-16 18:43:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[35] Complete. Time taken: 00:00:54.675
[INFO] - 03-16 18:43:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:43:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:43:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:43:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:43:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:43:56 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7245, 4991, 5127]
[INFO] - 03-16 18:43:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:44:06 - [main.backward:225]: Epoch 36/300 - Iteration 35/199 - Time 0.288 batch, 0.079 data, 0.256 forward
[INFO] - 03-16 18:44:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0190 (0.0195)
[INFO] - 03-16 18:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6095 (0.6012)
[INFO] - 03-16 18:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5529 (-140.5482)
[INFO] - 03-16 18:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5429 (28.8444)
[INFO] - 03-16 18:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 283.3116 (282.7336)
[INFO] - 03-16 18:44:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.6492)
[INFO] - 03-16 18:44:18 - [main.backward:225]: Epoch 36/300 - Iteration 85/199 - Time 0.260 batch, 0.050 data, 0.229 forward
[INFO] - 03-16 18:44:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:44:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0190 (0.0190)
[INFO] - 03-16 18:44:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6085 (0.5994)
[INFO] - 03-16 18:44:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5259 (-140.5427)
[INFO] - 03-16 18:44:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4182 (28.6336)
[INFO] - 03-16 18:44:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 282.9877 (282.7554)
[INFO] - 03-16 18:44:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:44:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.6791)
[INFO] - 03-16 18:44:30 - [main.backward:225]: Epoch 36/300 - Iteration 135/199 - Time 0.253 batch, 0.042 data, 0.223 forward
[INFO] - 03-16 18:44:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:44:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0226 (0.0201)
[INFO] - 03-16 18:44:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5978 (0.5971)
[INFO] - 03-16 18:44:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5586 (-140.5693)
[INFO] - 03-16 18:44:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.9953 (28.9972)
[INFO] - 03-16 18:44:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 281.4958 (280.4744)
[INFO] - 03-16 18:44:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:44:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5391 (0.6286)
[INFO] - 03-16 18:44:41 - [main.backward:225]: Epoch 36/300 - Iteration 185/199 - Time 0.248 batch, 0.039 data, 0.218 forward
[INFO] - 03-16 18:44:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:44:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0205)
[INFO] - 03-16 18:44:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6135 (0.6029)
[INFO] - 03-16 18:44:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5643 (-140.5768)
[INFO] - 03-16 18:44:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5360 (28.8754)
[INFO] - 03-16 18:44:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 283.4297 (282.1600)
[INFO] - 03-16 18:44:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:44:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6034)
[INFO] - 03-16 18:44:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:44:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:44:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:44:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:44:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:44:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:44:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:44:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.337
[INFO] - 03-16 18:44:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.338
[INFO] - 03-16 18:44:49 - [main.summary_metrics:168]: Epoch 36/300 - Test Results:
{'auc': 0.6018405070754719,
 'f1': 0.11345911949685537,
 'loss': 0.6682354077713043,
 'ndcg': 0.3664636316413913,
 'precision': 0.16981132075471694,
 'recall': 0.0852201257861635}
[INFO] - 03-16 18:44:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[36] Complete. Time taken: 00:00:53.640
[INFO] - 03-16 18:44:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:44:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:44:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:44:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:44:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:44:49 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 4969, 5109]
[INFO] - 03-16 18:44:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:44:59 - [main.backward:225]: Epoch 37/300 - Iteration 36/199 - Time 0.272 batch, 0.061 data, 0.244 forward
[INFO] - 03-16 18:44:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:44:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0195)
[INFO] - 03-16 18:44:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5990 (0.6010)
[INFO] - 03-16 18:44:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5496 (-140.5506)
[INFO] - 03-16 18:44:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6866 (28.6997)
[INFO] - 03-16 18:44:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 283.3297 (282.7006)
[INFO] - 03-16 18:44:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:44:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.6562)
[INFO] - 03-16 18:45:11 - [main.backward:225]: Epoch 37/300 - Iteration 86/199 - Time 0.253 batch, 0.043 data, 0.224 forward
[INFO] - 03-16 18:45:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0190)
[INFO] - 03-16 18:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6043 (0.5977)
[INFO] - 03-16 18:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5377 (-140.5417)
[INFO] - 03-16 18:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5906 (28.5665)
[INFO] - 03-16 18:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 282.8223 (282.3119)
[INFO] - 03-16 18:45:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.6744)
[INFO] - 03-16 18:45:23 - [main.backward:225]: Epoch 37/300 - Iteration 136/199 - Time 0.249 batch, 0.037 data, 0.220 forward
[INFO] - 03-16 18:45:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0232 (0.0204)
[INFO] - 03-16 18:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5976 (0.5949)
[INFO] - 03-16 18:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5239 (-140.5685)
[INFO] - 03-16 18:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.5140 (29.4985)
[INFO] - 03-16 18:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 278.0693 (277.0924)
[INFO] - 03-16 18:45:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4688 (0.6216)
[INFO] - 03-16 18:45:35 - [main.backward:225]: Epoch 37/300 - Iteration 186/199 - Time 0.246 batch, 0.035 data, 0.217 forward
[INFO] - 03-16 18:45:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0209 (0.0206)
[INFO] - 03-16 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6172 (0.6020)
[INFO] - 03-16 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5716 (-140.5791)
[INFO] - 03-16 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6354 (29.0577)
[INFO] - 03-16 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 281.8457 (280.0791)
[INFO] - 03-16 18:45:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5391 (0.6080)
[INFO] - 03-16 18:45:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:45:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:45:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:45:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:45:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:45:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:45:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:45:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.529
[INFO] - 03-16 18:45:43 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.530
[INFO] - 03-16 18:45:43 - [main.summary_metrics:168]: Epoch 37/300 - Test Results:
{'auc': 0.6179211871069182,
 'f1': 0.11345911949685537,
 'loss': 0.6648801847493873,
 'ndcg': 0.37502216773480773,
 'precision': 0.16981132075471694,
 'recall': 0.0852201257861635}
[INFO] - 03-16 18:45:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[37] Complete. Time taken: 00:00:53.556
[INFO] - 03-16 18:45:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:45:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:45:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:45:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:45:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:45:43 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7243, 4991, 5146]
[INFO] - 03-16 18:45:44 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:45:53 - [main.backward:225]: Epoch 38/300 - Iteration 37/199 - Time 0.285 batch, 0.071 data, 0.252 forward
[INFO] - 03-16 18:45:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:45:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0187 (0.0194)
[INFO] - 03-16 18:45:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6079 (0.6007)
[INFO] - 03-16 18:45:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5473 (-140.5515)
[INFO] - 03-16 18:45:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5967 (28.6648)
[INFO] - 03-16 18:45:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 281.5501 (281.2127)
[INFO] - 03-16 18:45:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:45:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.6587)
[INFO] - 03-16 18:46:05 - [main.backward:225]: Epoch 38/300 - Iteration 87/199 - Time 0.260 batch, 0.047 data, 0.229 forward
[INFO] - 03-16 18:46:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:46:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0184)
[INFO] - 03-16 18:46:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5984 (0.5969)
[INFO] - 03-16 18:46:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5459 (-140.5438)
[INFO] - 03-16 18:46:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6540 (28.6458)
[INFO] - 03-16 18:46:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 281.1012 (280.2111)
[INFO] - 03-16 18:46:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:46:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.6920)
[INFO] - 03-16 18:46:17 - [main.backward:225]: Epoch 38/300 - Iteration 137/199 - Time 0.249 batch, 0.040 data, 0.219 forward
[INFO] - 03-16 18:46:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0222 (0.0203)
[INFO] - 03-16 18:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5978 (0.5941)
[INFO] - 03-16 18:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5208 (-140.5726)
[INFO] - 03-16 18:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0255 (29.1331)
[INFO] - 03-16 18:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 280.5240 (279.4643)
[INFO] - 03-16 18:46:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5078 (0.6211)
[INFO] - 03-16 18:46:29 - [main.backward:225]: Epoch 38/300 - Iteration 187/199 - Time 0.246 batch, 0.037 data, 0.216 forward
[INFO] - 03-16 18:46:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:46:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0204)
[INFO] - 03-16 18:46:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6097 (0.6041)
[INFO] - 03-16 18:46:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5568 (-140.5793)
[INFO] - 03-16 18:46:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4336 (28.8183)
[INFO] - 03-16 18:46:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 282.4605 (282.1366)
[INFO] - 03-16 18:46:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:46:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.6158)
[INFO] - 03-16 18:46:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:46:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:46:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:46:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:46:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:46:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:46:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:46:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.272
[INFO] - 03-16 18:46:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.274
[INFO] - 03-16 18:46:36 - [main.summary_metrics:168]: Epoch 38/300 - Test Results:
{'auc': 0.6037605476939203,
 'f1': 0.11094339622641511,
 'loss': 0.6665422403987349,
 'ndcg': 0.3618486408632406,
 'precision': 0.16603773584905654,
 'recall': 0.08333333333333333}
[INFO] - 03-16 18:46:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[38] Complete. Time taken: 00:00:53.171
[INFO] - 03-16 18:46:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:46:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:46:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:46:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:46:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:46:36 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7215, 4983, 5146]
[INFO] - 03-16 18:46:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:46:46 - [main.backward:225]: Epoch 39/300 - Iteration 38/199 - Time 0.275 batch, 0.066 data, 0.245 forward
[INFO] - 03-16 18:46:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0203 (0.0192)
[INFO] - 03-16 18:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6051 (0.6021)
[INFO] - 03-16 18:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5611 (-140.5499)
[INFO] - 03-16 18:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7214 (28.6991)
[INFO] - 03-16 18:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 282.5408 (281.1696)
[INFO] - 03-16 18:46:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6671)
[INFO] - 03-16 18:46:58 - [main.backward:225]: Epoch 39/300 - Iteration 88/199 - Time 0.254 batch, 0.045 data, 0.224 forward
[INFO] - 03-16 18:46:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:46:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0202 (0.0188)
[INFO] - 03-16 18:46:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6018 (0.5983)
[INFO] - 03-16 18:46:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5607 (-140.5437)
[INFO] - 03-16 18:46:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7667 (28.6870)
[INFO] - 03-16 18:46:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 277.6476 (280.5793)
[INFO] - 03-16 18:46:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:46:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6016 (0.6789)
[INFO] - 03-16 18:47:10 - [main.backward:225]: Epoch 39/300 - Iteration 138/199 - Time 0.247 batch, 0.039 data, 0.218 forward
[INFO] - 03-16 18:47:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:47:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0201)
[INFO] - 03-16 18:47:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6163 (0.5967)
[INFO] - 03-16 18:47:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5176 (-140.5728)
[INFO] - 03-16 18:47:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.9920 (29.0658)
[INFO] - 03-16 18:47:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 279.0881 (278.5974)
[INFO] - 03-16 18:47:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:47:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.6288)
[INFO] - 03-16 18:47:22 - [main.backward:225]: Epoch 39/300 - Iteration 188/199 - Time 0.244 batch, 0.036 data, 0.215 forward
[INFO] - 03-16 18:47:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0198 (0.0204)
[INFO] - 03-16 18:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6071 (0.6026)
[INFO] - 03-16 18:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5532 (-140.5800)
[INFO] - 03-16 18:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5629 (28.8860)
[INFO] - 03-16 18:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 279.6183 (279.7177)
[INFO] - 03-16 18:47:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.6216)
[INFO] - 03-16 18:47:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:47:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:47:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:47:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:47:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:47:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:47:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:47:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.313
[INFO] - 03-16 18:47:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.314
[INFO] - 03-16 18:47:29 - [main.summary_metrics:168]: Epoch 39/300 - Test Results:
{'auc': 0.619000556865828,
 'f1': 0.11597484276729562,
 'loss': 0.6638684025290627,
 'ndcg': 0.37675065558655574,
 'precision': 0.17358490566037735,
 'recall': 0.08710691823899369}
[INFO] - 03-16 18:47:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[39] Complete. Time taken: 00:00:52.867
[INFO] - 03-16 18:47:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:47:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:47:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:47:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:47:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:47:29 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7235, 5006, 5124]
[INFO] - 03-16 18:47:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:47:39 - [main.backward:225]: Epoch 40/300 - Iteration 39/199 - Time 0.267 batch, 0.060 data, 0.238 forward
[INFO] - 03-16 18:47:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0203 (0.0193)
[INFO] - 03-16 18:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6100 (0.6012)
[INFO] - 03-16 18:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5792 (-140.5513)
[INFO] - 03-16 18:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5562 (28.5675)
[INFO] - 03-16 18:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 281.8377 (281.2542)
[INFO] - 03-16 18:47:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.6644)
[INFO] - 03-16 18:47:51 - [main.backward:225]: Epoch 40/300 - Iteration 89/199 - Time 0.246 batch, 0.042 data, 0.218 forward
[INFO] - 03-16 18:47:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:47:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0212 (0.0189)
[INFO] - 03-16 18:47:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5913 (0.5954)
[INFO] - 03-16 18:47:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5619 (-140.5446)
[INFO] - 03-16 18:47:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6866 (28.7156)
[INFO] - 03-16 18:47:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 279.7894 (279.4158)
[INFO] - 03-16 18:47:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:47:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6763)
[INFO] - 03-16 18:48:03 - [main.backward:225]: Epoch 40/300 - Iteration 139/199 - Time 0.243 batch, 0.037 data, 0.215 forward
[INFO] - 03-16 18:48:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:48:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0196 (0.0201)
[INFO] - 03-16 18:48:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6129 (0.5958)
[INFO] - 03-16 18:48:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5269 (-140.5720)
[INFO] - 03-16 18:48:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7733 (29.0441)
[INFO] - 03-16 18:48:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 276.2487 (277.0632)
[INFO] - 03-16 18:48:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:48:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.6236)
[INFO] - 03-16 18:48:14 - [main.backward:225]: Epoch 40/300 - Iteration 189/199 - Time 0.241 batch, 0.035 data, 0.212 forward
[INFO] - 03-16 18:48:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:48:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0197 (0.0202)
[INFO] - 03-16 18:48:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6034 (0.6037)
[INFO] - 03-16 18:48:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5656 (-140.5840)
[INFO] - 03-16 18:48:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2909 (28.7719)
[INFO] - 03-16 18:48:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 281.4586 (278.9854)
[INFO] - 03-16 18:48:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:48:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.6259)
[INFO] - 03-16 18:48:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:48:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:48:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:48:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:48:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:48:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:48:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:48:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.294
[INFO] - 03-16 18:48:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.295
[INFO] - 03-16 18:48:21 - [main.summary_metrics:168]: Epoch 40/300 - Test Results:
{'auc': 0.6117031577568134,
 'f1': 0.11471698113207549,
 'loss': 0.6650400106402065,
 'ndcg': 0.3675711383000177,
 'precision': 0.17169811320754713,
 'recall': 0.08616352201257861}
[INFO] - 03-16 18:48:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[40] Complete. Time taken: 00:00:52.231
[INFO] - 03-16 18:48:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:48:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:48:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:48:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:48:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:48:21 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7225, 4987, 5152]
[INFO] - 03-16 18:48:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:48:32 - [main.backward:225]: Epoch 41/300 - Iteration 40/199 - Time 0.266 batch, 0.058 data, 0.237 forward
[INFO] - 03-16 18:48:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:48:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0212 (0.0195)
[INFO] - 03-16 18:48:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6066 (0.6001)
[INFO] - 03-16 18:48:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5883 (-140.5534)
[INFO] - 03-16 18:48:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4807 (28.4578)
[INFO] - 03-16 18:48:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 279.2006 (280.0833)
[INFO] - 03-16 18:48:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:48:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4922 (0.6552)
[INFO] - 03-16 18:48:43 - [main.backward:225]: Epoch 41/300 - Iteration 90/199 - Time 0.250 batch, 0.041 data, 0.222 forward
[INFO] - 03-16 18:48:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:48:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0187)
[INFO] - 03-16 18:48:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5914 (0.5970)
[INFO] - 03-16 18:48:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5582 (-140.5467)
[INFO] - 03-16 18:48:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6523 (28.4113)
[INFO] - 03-16 18:48:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 277.5566 (278.7850)
[INFO] - 03-16 18:48:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:48:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5391 (0.6837)
[INFO] - 03-16 18:48:55 - [main.backward:225]: Epoch 41/300 - Iteration 140/199 - Time 0.245 batch, 0.036 data, 0.216 forward
[INFO] - 03-16 18:48:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:48:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0200 (0.0201)
[INFO] - 03-16 18:48:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6075 (0.5963)
[INFO] - 03-16 18:48:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5352 (-140.5739)
[INFO] - 03-16 18:48:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7526 (28.9759)
[INFO] - 03-16 18:48:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 276.1744 (275.6856)
[INFO] - 03-16 18:48:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:48:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5781 (0.6252)
[INFO] - 03-16 18:49:07 - [main.backward:225]: Epoch 41/300 - Iteration 190/199 - Time 0.242 batch, 0.034 data, 0.214 forward
[INFO] - 03-16 18:49:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0190 (0.0202)
[INFO] - 03-16 18:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6165 (0.6037)
[INFO] - 03-16 18:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5743 (-140.5869)
[INFO] - 03-16 18:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3756 (28.7912)
[INFO] - 03-16 18:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 278.7908 (278.0366)
[INFO] - 03-16 18:49:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6797 (0.6261)
[INFO] - 03-16 18:49:09 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:49:09 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:49:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:49:09 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:49:09 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:49:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:49:09 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:49:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.271
[INFO] - 03-16 18:49:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.271
[INFO] - 03-16 18:49:13 - [main.summary_metrics:168]: Epoch 41/300 - Test Results:
{'auc': 0.6232874082809224,
 'f1': 0.11220125786163523,
 'loss': 0.6626532203946225,
 'ndcg': 0.37414411666982744,
 'precision': 0.16792452830188673,
 'recall': 0.0842767295597484}
[INFO] - 03-16 18:49:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[41] Complete. Time taken: 00:00:52.486
[INFO] - 03-16 18:49:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:49:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:49:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:49:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:49:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:49:13 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7245, 4977, 5126]
[INFO] - 03-16 18:49:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:49:24 - [main.backward:225]: Epoch 42/300 - Iteration 41/199 - Time 0.262 batch, 0.062 data, 0.234 forward
[INFO] - 03-16 18:49:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:49:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0208 (0.0195)
[INFO] - 03-16 18:49:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6056 (0.6002)
[INFO] - 03-16 18:49:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5875 (-140.5550)
[INFO] - 03-16 18:49:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5079 (28.4686)
[INFO] - 03-16 18:49:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 279.3406 (278.7613)
[INFO] - 03-16 18:49:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:49:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.6517)
[INFO] - 03-16 18:49:36 - [main.backward:225]: Epoch 42/300 - Iteration 91/199 - Time 0.248 batch, 0.044 data, 0.220 forward
[INFO] - 03-16 18:49:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0215 (0.0181)
[INFO] - 03-16 18:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5960)
[INFO] - 03-16 18:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5278 (-140.5470)
[INFO] - 03-16 18:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3884 (28.4542)
[INFO] - 03-16 18:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 276.3175 (277.1002)
[INFO] - 03-16 18:49:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5938 (0.7028)
[INFO] - 03-16 18:49:48 - [main.backward:225]: Epoch 42/300 - Iteration 141/199 - Time 0.244 batch, 0.038 data, 0.215 forward
[INFO] - 03-16 18:49:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:49:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0201)
[INFO] - 03-16 18:49:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6146 (0.5974)
[INFO] - 03-16 18:49:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5409 (-140.5742)
[INFO] - 03-16 18:49:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6818 (28.8397)
[INFO] - 03-16 18:49:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 275.6191 (274.9817)
[INFO] - 03-16 18:49:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:49:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6250 (0.6255)
[INFO] - 03-16 18:50:00 - [main.backward:225]: Epoch 42/300 - Iteration 191/199 - Time 0.242 batch, 0.036 data, 0.213 forward
[INFO] - 03-16 18:50:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0183 (0.0198)
[INFO] - 03-16 18:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6088 (0.6032)
[INFO] - 03-16 18:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5632 (-140.5883)
[INFO] - 03-16 18:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2861 (28.5836)
[INFO] - 03-16 18:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 280.0988 (278.8442)
[INFO] - 03-16 18:50:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.6492)
[INFO] - 03-16 18:50:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:50:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:50:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:50:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:50:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:50:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:50:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:50:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.172
[INFO] - 03-16 18:50:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.174
[INFO] - 03-16 18:50:06 - [main.summary_metrics:168]: Epoch 42/300 - Test Results:
{'auc': 0.6173900353773585,
 'f1': 0.11471698113207549,
 'loss': 0.6621559130670638,
 'ndcg': 0.36922052527575994,
 'precision': 0.17169811320754716,
 'recall': 0.08616352201257861}
[INFO] - 03-16 18:50:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[42] Complete. Time taken: 00:00:52.492
[INFO] - 03-16 18:50:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:50:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:50:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:50:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:50:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:50:06 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7251, 4992, 5155]
[INFO] - 03-16 18:50:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:50:17 - [main.backward:225]: Epoch 43/300 - Iteration 42/199 - Time 0.266 batch, 0.055 data, 0.238 forward
[INFO] - 03-16 18:50:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:50:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0194)
[INFO] - 03-16 18:50:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5990 (0.5978)
[INFO] - 03-16 18:50:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5570 (-140.5529)
[INFO] - 03-16 18:50:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4977 (28.4289)
[INFO] - 03-16 18:50:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 278.0403 (278.3043)
[INFO] - 03-16 18:50:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:50:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.6526)
[INFO] - 03-16 18:50:29 - [main.backward:225]: Epoch 43/300 - Iteration 92/199 - Time 0.250 batch, 0.041 data, 0.221 forward
[INFO] - 03-16 18:50:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0190 (0.0183)
[INFO] - 03-16 18:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5927 (0.5964)
[INFO] - 03-16 18:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5276 (-140.5479)
[INFO] - 03-16 18:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6111 (28.4392)
[INFO] - 03-16 18:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 276.1552 (276.9206)
[INFO] - 03-16 18:50:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.6955)
[INFO] - 03-16 18:50:41 - [main.backward:225]: Epoch 43/300 - Iteration 142/199 - Time 0.245 batch, 0.036 data, 0.217 forward
[INFO] - 03-16 18:50:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0208 (0.0205)
[INFO] - 03-16 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6114 (0.5939)
[INFO] - 03-16 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5537 (-140.5745)
[INFO] - 03-16 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0999 (29.1361)
[INFO] - 03-16 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 271.3623 (271.5110)
[INFO] - 03-16 18:50:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6016 (0.6123)
[INFO] - 03-16 18:50:53 - [main.backward:225]: Epoch 43/300 - Iteration 192/199 - Time 0.243 batch, 0.035 data, 0.214 forward
[INFO] - 03-16 18:50:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:50:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0188 (0.0199)
[INFO] - 03-16 18:50:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6044 (0.6018)
[INFO] - 03-16 18:50:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5533 (-140.5879)
[INFO] - 03-16 18:50:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3812 (28.7859)
[INFO] - 03-16 18:50:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 277.6284 (274.2929)
[INFO] - 03-16 18:50:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:50:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.6406)
[INFO] - 03-16 18:50:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:50:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:50:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:50:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:50:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:50:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:50:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:50:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.015
[INFO] - 03-16 18:50:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.016
[INFO] - 03-16 18:50:58 - [main.summary_metrics:168]: Epoch 43/300 - Test Results:
{'auc': 0.617725432389937,
 'f1': 0.11220125786163523,
 'loss': 0.6620066290881399,
 'ndcg': 0.37018360954676305,
 'precision': 0.16792452830188676,
 'recall': 0.0842767295597484}
[INFO] - 03-16 18:50:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[43] Complete. Time taken: 00:00:52.265
[INFO] - 03-16 18:50:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:50:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:50:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:50:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:50:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:50:58 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7249, 4997, 5122]
[INFO] - 03-16 18:50:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:51:10 - [main.backward:225]: Epoch 44/300 - Iteration 43/199 - Time 0.267 batch, 0.057 data, 0.239 forward
[INFO] - 03-16 18:51:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:51:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0188 (0.0194)
[INFO] - 03-16 18:51:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6058 (0.5971)
[INFO] - 03-16 18:51:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5453 (-140.5485)
[INFO] - 03-16 18:51:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4003 (28.3831)
[INFO] - 03-16 18:51:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 278.4711 (278.2040)
[INFO] - 03-16 18:51:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:51:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.6490)
[INFO] - 03-16 18:51:21 - [main.backward:225]: Epoch 44/300 - Iteration 93/199 - Time 0.250 batch, 0.041 data, 0.223 forward
[INFO] - 03-16 18:51:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:51:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0182 (0.0183)
[INFO] - 03-16 18:51:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6059 (0.5962)
[INFO] - 03-16 18:51:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5366 (-140.5471)
[INFO] - 03-16 18:51:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5304 (28.3733)
[INFO] - 03-16 18:51:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 276.1803 (277.0842)
[INFO] - 03-16 18:51:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:51:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.7022)
[INFO] - 03-16 18:51:33 - [main.backward:225]: Epoch 44/300 - Iteration 143/199 - Time 0.246 batch, 0.037 data, 0.218 forward
[INFO] - 03-16 18:51:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0208 (0.0203)
[INFO] - 03-16 18:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5996 (0.5957)
[INFO] - 03-16 18:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5926 (-140.5739)
[INFO] - 03-16 18:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6400 (28.8236)
[INFO] - 03-16 18:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 272.8353 (272.4327)
[INFO] - 03-16 18:51:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5703 (0.6136)
[INFO] - 03-16 18:51:45 - [main.backward:225]: Epoch 44/300 - Iteration 193/199 - Time 0.243 batch, 0.035 data, 0.215 forward
[INFO] - 03-16 18:51:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:51:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0156 (0.0197)
[INFO] - 03-16 18:51:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6089 (0.6025)
[INFO] - 03-16 18:51:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5492 (-140.5808)
[INFO] - 03-16 18:51:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2068 (28.3414)
[INFO] - 03-16 18:51:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 278.0540 (276.3721)
[INFO] - 03-16 18:51:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:51:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7891 (0.6498)
[INFO] - 03-16 18:51:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:51:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:51:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:51:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:51:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:51:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:51:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:51:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.268
[INFO] - 03-16 18:51:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.269
[INFO] - 03-16 18:51:51 - [main.summary_metrics:168]: Epoch 44/300 - Test Results:
{'auc': 0.608226218553459,
 'f1': 0.10817610062893082,
 'loss': 0.6628747732574334,
 'ndcg': 0.3625050494146972,
 'precision': 0.16226415094339625,
 'recall': 0.08113207547169812}
[INFO] - 03-16 18:51:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[44] Complete. Time taken: 00:00:52.551
[INFO] - 03-16 18:51:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:51:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:51:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:51:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:51:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:51:51 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7220, 4998, 5132]
[INFO] - 03-16 18:51:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:52:02 - [main.backward:225]: Epoch 45/300 - Iteration 44/199 - Time 0.264 batch, 0.058 data, 0.235 forward
[INFO] - 03-16 18:52:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0192)
[INFO] - 03-16 18:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5929 (0.5984)
[INFO] - 03-16 18:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5470 (-140.5479)
[INFO] - 03-16 18:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.0647 (28.0520)
[INFO] - 03-16 18:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 278.5691 (278.2314)
[INFO] - 03-16 18:52:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.6557)
[INFO] - 03-16 18:52:14 - [main.backward:225]: Epoch 45/300 - Iteration 94/199 - Time 0.251 batch, 0.043 data, 0.222 forward
[INFO] - 03-16 18:52:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0202 (0.0186)
[INFO] - 03-16 18:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5883 (0.5981)
[INFO] - 03-16 18:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5428 (-140.5474)
[INFO] - 03-16 18:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6556 (28.2944)
[INFO] - 03-16 18:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 276.3337 (277.8307)
[INFO] - 03-16 18:52:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6917)
[INFO] - 03-16 18:52:26 - [main.backward:225]: Epoch 45/300 - Iteration 144/199 - Time 0.246 batch, 0.038 data, 0.216 forward
[INFO] - 03-16 18:52:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0200)
[INFO] - 03-16 18:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6177 (0.5961)
[INFO] - 03-16 18:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5949 (-140.5764)
[INFO] - 03-16 18:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6345 (28.7562)
[INFO] - 03-16 18:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 273.5846 (273.6079)
[INFO] - 03-16 18:52:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6277)
[INFO] - 03-16 18:52:38 - [main.backward:225]: Epoch 45/300 - Iteration 194/199 - Time 0.242 batch, 0.036 data, 0.213 forward
[INFO] - 03-16 18:52:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:52:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0183 (0.0196)
[INFO] - 03-16 18:52:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6017 (0.6026)
[INFO] - 03-16 18:52:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5413 (-140.5742)
[INFO] - 03-16 18:52:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.1048 (28.3152)
[INFO] - 03-16 18:52:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 278.1183 (276.5246)
[INFO] - 03-16 18:52:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:52:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6797 (0.6539)
[INFO] - 03-16 18:52:39 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:52:39 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:52:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:52:39 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:52:39 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:52:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:52:39 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:52:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.265
[INFO] - 03-16 18:52:43 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.266
[INFO] - 03-16 18:52:43 - [main.summary_metrics:168]: Epoch 45/300 - Test Results:
{'auc': 0.6255994824423481,
 'f1': 0.11365263667150462,
 'loss': 0.6588320758427714,
 'ndcg': 0.3759076649941254,
 'precision': 0.16981132075471694,
 'recall': 0.08545597484276728}
[INFO] - 03-16 18:52:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[45] Complete. Time taken: 00:00:52.543
[INFO] - 03-16 18:52:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:52:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:52:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:52:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:52:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:52:43 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7254, 4945, 5124]
[INFO] - 03-16 18:52:44 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:52:55 - [main.backward:225]: Epoch 46/300 - Iteration 45/199 - Time 0.260 batch, 0.054 data, 0.232 forward
[INFO] - 03-16 18:52:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:52:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0188 (0.0192)
[INFO] - 03-16 18:52:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6096 (0.5988)
[INFO] - 03-16 18:52:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5565 (-140.5456)
[INFO] - 03-16 18:52:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.0459 (28.0970)
[INFO] - 03-16 18:52:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 277.4974 (277.5564)
[INFO] - 03-16 18:52:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:52:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.6654)
[INFO] - 03-16 18:53:07 - [main.backward:225]: Epoch 46/300 - Iteration 95/199 - Time 0.249 batch, 0.041 data, 0.220 forward
[INFO] - 03-16 18:53:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0186)
[INFO] - 03-16 18:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5919 (0.5977)
[INFO] - 03-16 18:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5306 (-140.5485)
[INFO] - 03-16 18:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4393 (28.0500)
[INFO] - 03-16 18:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 276.3222 (276.9652)
[INFO] - 03-16 18:53:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6250 (0.6855)
[INFO] - 03-16 18:53:19 - [main.backward:225]: Epoch 46/300 - Iteration 145/199 - Time 0.244 batch, 0.036 data, 0.216 forward
[INFO] - 03-16 18:53:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:53:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0209 (0.0202)
[INFO] - 03-16 18:53:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6078 (0.5961)
[INFO] - 03-16 18:53:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5866 (-140.5776)
[INFO] - 03-16 18:53:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.0735 (28.9262)
[INFO] - 03-16 18:53:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 273.3998 (273.2635)
[INFO] - 03-16 18:53:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:53:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6177)
[INFO] - 03-16 18:53:31 - [main.backward:225]: Epoch 46/300 - Iteration 195/199 - Time 0.242 batch, 0.034 data, 0.214 forward
[INFO] - 03-16 18:53:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0156 (0.0199)
[INFO] - 03-16 18:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6061 (0.6007)
[INFO] - 03-16 18:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5518 (-140.5724)
[INFO] - 03-16 18:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4927 (28.7447)
[INFO] - 03-16 18:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 276.6021 (275.2516)
[INFO] - 03-16 18:53:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.6408)
[INFO] - 03-16 18:53:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:53:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:53:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:53:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:53:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:53:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:53:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:53:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.212
[INFO] - 03-16 18:53:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.213
[INFO] - 03-16 18:53:36 - [main.summary_metrics:168]: Epoch 46/300 - Test Results:
{'auc': 0.6182651336477987,
 'f1': 0.1119496855345912,
 'loss': 0.6625946133291697,
 'ndcg': 0.37668672594081076,
 'precision': 0.1679245283018868,
 'recall': 0.0839622641509434}
[INFO] - 03-16 18:53:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[46] Complete. Time taken: 00:00:52.432
[INFO] - 03-16 18:53:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:53:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:53:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:53:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:53:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:53:36 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7238, 5019, 5163]
[INFO] - 03-16 18:53:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:53:48 - [main.backward:225]: Epoch 47/300 - Iteration 46/199 - Time 0.264 batch, 0.056 data, 0.236 forward
[INFO] - 03-16 18:53:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:53:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0170 (0.0191)
[INFO] - 03-16 18:53:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5798 (0.5984)
[INFO] - 03-16 18:53:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5406 (-140.5420)
[INFO] - 03-16 18:53:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.0116 (28.2503)
[INFO] - 03-16 18:53:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 275.4342 (276.6551)
[INFO] - 03-16 18:53:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:53:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.6679)
[INFO] - 03-16 18:54:00 - [main.backward:225]: Epoch 47/300 - Iteration 96/199 - Time 0.250 batch, 0.043 data, 0.220 forward
[INFO] - 03-16 18:54:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0193 (0.0182)
[INFO] - 03-16 18:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6031 (0.5973)
[INFO] - 03-16 18:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5339 (-140.5478)
[INFO] - 03-16 18:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7441 (28.1764)
[INFO] - 03-16 18:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 273.9418 (276.4269)
[INFO] - 03-16 18:54:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6797 (0.6958)
[INFO] - 03-16 18:54:11 - [main.backward:225]: Epoch 47/300 - Iteration 146/199 - Time 0.243 batch, 0.038 data, 0.214 forward
[INFO] - 03-16 18:54:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:54:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0209 (0.0201)
[INFO] - 03-16 18:54:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6082 (0.5970)
[INFO] - 03-16 18:54:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5923 (-140.5792)
[INFO] - 03-16 18:54:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 29.1210 (29.1382)
[INFO] - 03-16 18:54:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.6261 (270.4047)
[INFO] - 03-16 18:54:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:54:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5781 (0.6208)
[INFO] - 03-16 18:54:23 - [main.backward:225]: Epoch 47/300 - Iteration 196/199 - Time 0.241 batch, 0.035 data, 0.212 forward
[INFO] - 03-16 18:54:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0198 (0.0197)
[INFO] - 03-16 18:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6121 (0.6023)
[INFO] - 03-16 18:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5022 (-140.5686)
[INFO] - 03-16 18:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2826 (28.8000)
[INFO] - 03-16 18:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 275.8502 (272.0760)
[INFO] - 03-16 18:54:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6483)
[INFO] - 03-16 18:54:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:54:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:54:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:54:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:54:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:54:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:54:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:54:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.267
[INFO] - 03-16 18:54:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.268
[INFO] - 03-16 18:54:28 - [main.summary_metrics:168]: Epoch 47/300 - Test Results:
{'auc': 0.6180492662473793,
 'f1': 0.11974842767295599,
 'loss': 0.660216966457087,
 'ndcg': 0.3701645493406821,
 'precision': 0.17924528301886788,
 'recall': 0.08993710691823897}
[INFO] - 03-16 18:54:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[47] Complete. Time taken: 00:00:52.281
[INFO] - 03-16 18:54:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:54:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:54:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:54:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:54:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:54:28 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7240, 5003, 5127]
[INFO] - 03-16 18:54:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:54:40 - [main.backward:225]: Epoch 48/300 - Iteration 47/199 - Time 0.259 batch, 0.053 data, 0.232 forward
[INFO] - 03-16 18:54:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:54:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0182 (0.0191)
[INFO] - 03-16 18:54:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5533 (0.5968)
[INFO] - 03-16 18:54:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5540 (-140.5387)
[INFO] - 03-16 18:54:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.7457 (28.0670)
[INFO] - 03-16 18:54:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 276.6086 (276.7053)
[INFO] - 03-16 18:54:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:54:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.6590)
[INFO] - 03-16 18:54:52 - [main.backward:225]: Epoch 48/300 - Iteration 97/199 - Time 0.248 batch, 0.041 data, 0.220 forward
[INFO] - 03-16 18:54:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:54:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0178 (0.0180)
[INFO] - 03-16 18:54:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5963 (0.5963)
[INFO] - 03-16 18:54:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5325 (-140.5442)
[INFO] - 03-16 18:54:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5742 (27.9945)
[INFO] - 03-16 18:54:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 275.5149 (275.7459)
[INFO] - 03-16 18:54:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:54:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.7041)
[INFO] - 03-16 18:55:04 - [main.backward:225]: Epoch 48/300 - Iteration 147/199 - Time 0.246 batch, 0.037 data, 0.217 forward
[INFO] - 03-16 18:55:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0200)
[INFO] - 03-16 18:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6020 (0.5959)
[INFO] - 03-16 18:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5782 (-140.5777)
[INFO] - 03-16 18:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7071 (28.5791)
[INFO] - 03-16 18:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 271.9951 (271.5630)
[INFO] - 03-16 18:55:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5703 (0.6245)
[INFO] - 03-16 18:55:16 - [main.backward:225]: Epoch 48/300 - Iteration 197/199 - Time 0.243 batch, 0.035 data, 0.215 forward
[INFO] - 03-16 18:55:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0175 (0.0195)
[INFO] - 03-16 18:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6098 (0.6018)
[INFO] - 03-16 18:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5057 (-140.5669)
[INFO] - 03-16 18:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2321 (28.3768)
[INFO] - 03-16 18:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 275.1245 (273.3200)
[INFO] - 03-16 18:55:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.6592)
[INFO] - 03-16 18:55:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:55:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:55:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:55:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:55:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:55:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:55:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:55:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.247
[INFO] - 03-16 18:55:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.249
[INFO] - 03-16 18:55:21 - [main.summary_metrics:168]: Epoch 48/300 - Test Results:
{'auc': 0.615274338312369,
 'f1': 0.11069182389937107,
 'loss': 0.6607298525804244,
 'ndcg': 0.36973553925591185,
 'precision': 0.1660377358490566,
 'recall': 0.0830188679245283}
[INFO] - 03-16 18:55:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[48] Complete. Time taken: 00:00:52.670
[INFO] - 03-16 18:55:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:55:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:55:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:55:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:55:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:55:21 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7246, 5005, 5167]
[INFO] - 03-16 18:55:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:55:33 - [main.backward:225]: Epoch 49/300 - Iteration 48/199 - Time 0.264 batch, 0.056 data, 0.236 forward
[INFO] - 03-16 18:55:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0186 (0.0190)
[INFO] - 03-16 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5568 (0.5968)
[INFO] - 03-16 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5562 (-140.5381)
[INFO] - 03-16 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.7560 (28.0391)
[INFO] - 03-16 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 275.1427 (275.2330)
[INFO] - 03-16 18:55:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.6647)
[INFO] - 03-16 18:55:45 - [main.backward:225]: Epoch 49/300 - Iteration 98/199 - Time 0.247 batch, 0.041 data, 0.219 forward
[INFO] - 03-16 18:55:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0203 (0.0185)
[INFO] - 03-16 18:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5956 (0.5976)
[INFO] - 03-16 18:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5381 (-140.5403)
[INFO] - 03-16 18:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3192 (27.9424)
[INFO] - 03-16 18:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 272.6885 (275.5555)
[INFO] - 03-16 18:55:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.6953)
[INFO] - 03-16 18:55:57 - [main.backward:225]: Epoch 49/300 - Iteration 148/199 - Time 0.243 batch, 0.037 data, 0.215 forward
[INFO] - 03-16 18:55:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0198)
[INFO] - 03-16 18:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5963 (0.5974)
[INFO] - 03-16 18:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5929 (-140.5761)
[INFO] - 03-16 18:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.7461 (28.4973)
[INFO] - 03-16 18:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.4572 (270.9874)
[INFO] - 03-16 18:55:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5781 (0.6405)
[INFO] - 03-16 18:56:09 - [main.backward:225]: Epoch 49/300 - Iteration 198/199 - Time 0.242 batch, 0.035 data, 0.213 forward
[INFO] - 03-16 18:56:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0202 (0.0194)
[INFO] - 03-16 18:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6024 (0.6028)
[INFO] - 03-16 18:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4929 (-140.5613)
[INFO] - 03-16 18:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.1092 (28.3967)
[INFO] - 03-16 18:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 273.8106 (272.0849)
[INFO] - 03-16 18:56:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.6625)
[INFO] - 03-16 18:56:09 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:56:09 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:56:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:56:09 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:56:09 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:56:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:56:09 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:56:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.250
[INFO] - 03-16 18:56:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.251
[INFO] - 03-16 18:56:13 - [main.summary_metrics:168]: Epoch 49/300 - Test Results:
{'auc': 0.6237311975890986,
 'f1': 0.11446540880503146,
 'loss': 0.6586447184380745,
 'ndcg': 0.3724946030684166,
 'precision': 0.17169811320754713,
 'recall': 0.08584905660377357}
[INFO] - 03-16 18:56:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[49] Complete. Time taken: 00:00:52.408
[INFO] - 03-16 18:56:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:56:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:56:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:56:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:56:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:56:13 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7246, 4971, 5125]
[INFO] - 03-16 18:56:14 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:56:26 - [main.backward:225]: Epoch 50/300 - Iteration 49/199 - Time 0.260 batch, 0.052 data, 0.231 forward
[INFO] - 03-16 18:56:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0202 (0.0190)
[INFO] - 03-16 18:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5946)
[INFO] - 03-16 18:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5453 (-140.5362)
[INFO] - 03-16 18:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.8844 (28.0494)
[INFO] - 03-16 18:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 273.5763 (274.6752)
[INFO] - 03-16 18:56:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.6598)
[INFO] - 03-16 18:56:38 - [main.backward:225]: Epoch 50/300 - Iteration 99/199 - Time 0.248 batch, 0.041 data, 0.219 forward
[INFO] - 03-16 18:56:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0200 (0.0181)
[INFO] - 03-16 18:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5989 (0.5978)
[INFO] - 03-16 18:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5607 (-140.5411)
[INFO] - 03-16 18:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4635 (27.8840)
[INFO] - 03-16 18:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 273.3424 (275.5219)
[INFO] - 03-16 18:56:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.7003)
[INFO] - 03-16 18:56:50 - [main.backward:225]: Epoch 50/300 - Iteration 149/199 - Time 0.245 batch, 0.037 data, 0.215 forward
[INFO] - 03-16 18:56:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0207 (0.0199)
[INFO] - 03-16 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5986 (0.5961)
[INFO] - 03-16 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6033 (-140.5725)
[INFO] - 03-16 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.6606 (28.6353)
[INFO] - 03-16 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.4820 (270.9338)
[INFO] - 03-16 18:56:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6272)
[INFO] - 03-16 18:57:01 - [main.backward:225]: Epoch 50/300 - Iteration 0/199 - Time 0.242 batch, 0.035 data, 0.213 forward
[INFO] - 03-16 18:57:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:57:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0200 (0.0197)
[INFO] - 03-16 18:57:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6134 (0.6009)
[INFO] - 03-16 18:57:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4982 (-140.5537)
[INFO] - 03-16 18:57:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.1649 (28.2839)
[INFO] - 03-16 18:57:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 272.6214 (271.9442)
[INFO] - 03-16 18:57:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:57:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6042 (0.6468)
[INFO] - 03-16 18:57:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:57:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:57:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:57:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:57:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:57:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:57:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:57:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.212
[INFO] - 03-16 18:57:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.213
[INFO] - 03-16 18:57:06 - [main.summary_metrics:168]: Epoch 50/300 - Test Results:
{'auc': 0.6179282625786163,
 'f1': 0.11214320270924047,
 'loss': 0.6612957597568601,
 'ndcg': 0.3726079466741471,
 'precision': 0.1679245283018868,
 'recall': 0.08419811320754718}
[INFO] - 03-16 18:57:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[50] Complete. Time taken: 00:00:52.429
[INFO] - 03-16 18:57:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:57:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:57:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:57:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:57:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:57:06 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7230, 4996, 5166]
[INFO] - 03-16 18:57:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:57:18 - [main.backward:225]: Epoch 51/300 - Iteration 50/199 - Time 0.258 batch, 0.055 data, 0.229 forward
[INFO] - 03-16 18:57:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:57:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0198 (0.0189)
[INFO] - 03-16 18:57:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5976 (0.5942)
[INFO] - 03-16 18:57:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5045 (-140.5344)
[INFO] - 03-16 18:57:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.9589 (27.9310)
[INFO] - 03-16 18:57:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 275.0901 (273.8327)
[INFO] - 03-16 18:57:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:57:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.6722)
[INFO] - 03-16 18:57:30 - [main.backward:225]: Epoch 51/300 - Iteration 100/199 - Time 0.248 batch, 0.042 data, 0.219 forward
[INFO] - 03-16 18:57:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0208 (0.0184)
[INFO] - 03-16 18:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6022 (0.5971)
[INFO] - 03-16 18:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5694 (-140.5414)
[INFO] - 03-16 18:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5050 (27.9678)
[INFO] - 03-16 18:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 273.7376 (274.4784)
[INFO] - 03-16 18:57:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.6983)
[INFO] - 03-16 18:57:42 - [main.backward:225]: Epoch 51/300 - Iteration 150/199 - Time 0.244 batch, 0.037 data, 0.215 forward
[INFO] - 03-16 18:57:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0203)
[INFO] - 03-16 18:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6091 (0.5944)
[INFO] - 03-16 18:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5928 (-140.5717)
[INFO] - 03-16 18:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.8786 (28.6911)
[INFO] - 03-16 18:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.3189 (270.3937)
[INFO] - 03-16 18:57:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.6103)
[INFO] - 03-16 18:57:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:57:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:57:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:57:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:57:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:57:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:57:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:57:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.236
[INFO] - 03-16 18:57:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.237
[INFO] - 03-16 18:57:58 - [main.summary_metrics:168]: Epoch 51/300 - Test Results:
{'auc': 0.6095194575471697,
 'f1': 0.10691823899371068,
 'loss': 0.662980053811703,
 'ndcg': 0.3652443358130951,
 'precision': 0.160377358490566,
 'recall': 0.080188679245283}
[INFO] - 03-16 18:57:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[51] Complete. Time taken: 00:00:52.307
[INFO] - 03-16 18:57:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:57:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:57:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:57:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:57:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:57:58 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7263, 4982, 5113]
[INFO] - 03-16 18:57:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:57:59 - [main.backward:225]: Epoch 52/300 - Iteration 1/199 - Time 1.397 batch, 1.193 data, 1.375 forward
[INFO] - 03-16 18:57:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0172 (0.0195)
[INFO] - 03-16 18:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5757 (0.6004)
[INFO] - 03-16 18:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5628 (-140.5522)
[INFO] - 03-16 18:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4226 (28.3464)
[INFO] - 03-16 18:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 271.3966 (271.0685)
[INFO] - 03-16 18:57:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7734 (0.6564)
[INFO] - 03-16 18:58:11 - [main.backward:225]: Epoch 52/300 - Iteration 51/199 - Time 0.262 batch, 0.052 data, 0.233 forward
[INFO] - 03-16 18:58:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:58:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0195 (0.0191)
[INFO] - 03-16 18:58:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5963 (0.5937)
[INFO] - 03-16 18:58:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4933 (-140.5363)
[INFO] - 03-16 18:58:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.9542 (28.0387)
[INFO] - 03-16 18:58:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 274.9684 (273.7622)
[INFO] - 03-16 18:58:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:58:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.6597)
[INFO] - 03-16 18:58:23 - [main.backward:225]: Epoch 52/300 - Iteration 101/199 - Time 0.250 batch, 0.041 data, 0.221 forward
[INFO] - 03-16 18:58:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:58:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0185)
[INFO] - 03-16 18:58:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5994 (0.5970)
[INFO] - 03-16 18:58:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5689 (-140.5392)
[INFO] - 03-16 18:58:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3956 (28.0467)
[INFO] - 03-16 18:58:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 271.4433 (273.5438)
[INFO] - 03-16 18:58:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:58:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6966)
[INFO] - 03-16 18:58:35 - [main.backward:225]: Epoch 52/300 - Iteration 151/199 - Time 0.245 batch, 0.036 data, 0.216 forward
[INFO] - 03-16 18:58:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0199)
[INFO] - 03-16 18:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5946 (0.5960)
[INFO] - 03-16 18:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5604 (-140.5725)
[INFO] - 03-16 18:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4594 (28.4566)
[INFO] - 03-16 18:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 270.2120 (270.6886)
[INFO] - 03-16 18:58:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.6322)
[INFO] - 03-16 18:58:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:58:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:58:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:58:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:58:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:58:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:58:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:58:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.937
[INFO] - 03-16 18:58:50 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.937
[INFO] - 03-16 18:58:50 - [main.summary_metrics:168]: Epoch 52/300 - Test Results:
{'auc': 0.6251788849580714,
 'f1': 0.11214320270924046,
 'loss': 0.6578651118688363,
 'ndcg': 0.3811623464806728,
 'precision': 0.16792452830188676,
 'recall': 0.08419811320754716}
[INFO] - 03-16 18:58:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[52] Complete. Time taken: 00:00:52.321
[INFO] - 03-16 18:58:50 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:58:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:58:50 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:58:50 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:58:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:58:50 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7232, 5007, 5161]
[INFO] - 03-16 18:58:51 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:58:52 - [main.backward:225]: Epoch 53/300 - Iteration 2/199 - Time 0.748 batch, 0.538 data, 0.713 forward
[INFO] - 03-16 18:58:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:58:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0163 (0.0193)
[INFO] - 03-16 18:58:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5824 (0.5991)
[INFO] - 03-16 18:58:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5602 (-140.5457)
[INFO] - 03-16 18:58:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2854 (28.1226)
[INFO] - 03-16 18:58:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 272.2154 (272.7992)
[INFO] - 03-16 18:58:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:58:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8125 (0.6592)
[INFO] - 03-16 18:59:03 - [main.backward:225]: Epoch 53/300 - Iteration 52/199 - Time 0.256 batch, 0.048 data, 0.228 forward
[INFO] - 03-16 18:59:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:59:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0180 (0.0190)
[INFO] - 03-16 18:59:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5953 (0.5936)
[INFO] - 03-16 18:59:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4884 (-140.5334)
[INFO] - 03-16 18:59:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.7573 (27.9276)
[INFO] - 03-16 18:59:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 273.1547 (272.8378)
[INFO] - 03-16 18:59:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:59:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.6678)
[INFO] - 03-16 18:59:15 - [main.backward:225]: Epoch 53/300 - Iteration 102/199 - Time 0.247 batch, 0.038 data, 0.219 forward
[INFO] - 03-16 18:59:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:59:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0173 (0.0184)
[INFO] - 03-16 18:59:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5533 (0.5954)
[INFO] - 03-16 18:59:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6170 (-140.5359)
[INFO] - 03-16 18:59:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.1833 (27.8087)
[INFO] - 03-16 18:59:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 271.7245 (273.2585)
[INFO] - 03-16 18:59:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:59:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.6975)
[INFO] - 03-16 18:59:27 - [main.backward:225]: Epoch 53/300 - Iteration 152/199 - Time 0.244 batch, 0.035 data, 0.215 forward
[INFO] - 03-16 18:59:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0189 (0.0196)
[INFO] - 03-16 18:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6095 (0.5986)
[INFO] - 03-16 18:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5731 (-140.5740)
[INFO] - 03-16 18:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3746 (28.2812)
[INFO] - 03-16 18:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 270.0970 (270.5009)
[INFO] - 03-16 18:59:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.6458)
[INFO] - 03-16 18:59:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 18:59:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:59:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:59:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 18:59:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:59:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 18:59:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 18:59:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.249
[INFO] - 03-16 18:59:43 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.255
[INFO] - 03-16 18:59:43 - [main.summary_metrics:168]: Epoch 53/300 - Test Results:
{'auc': 0.6253448964884697,
 'f1': 0.11591678761490083,
 'loss': 0.6577781309371725,
 'ndcg': 0.3791331908946575,
 'precision': 0.17358490566037738,
 'recall': 0.08702830188679246}
[INFO] - 03-16 18:59:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[53] Complete. Time taken: 00:00:52.502
[INFO] - 03-16 18:59:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 18:59:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 18:59:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 18:59:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 18:59:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 18:59:43 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7240, 4977, 5128]
[INFO] - 03-16 18:59:44 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 18:59:45 - [main.backward:225]: Epoch 54/300 - Iteration 3/199 - Time 0.672 batch, 0.466 data, 0.645 forward
[INFO] - 03-16 18:59:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0155 (0.0192)
[INFO] - 03-16 18:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5827 (0.6006)
[INFO] - 03-16 18:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5556 (-140.5422)
[INFO] - 03-16 18:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3319 (28.1133)
[INFO] - 03-16 18:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 273.1050 (273.4329)
[INFO] - 03-16 18:59:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8047 (0.6624)
[INFO] - 03-16 18:59:56 - [main.backward:225]: Epoch 54/300 - Iteration 53/199 - Time 0.260 batch, 0.053 data, 0.231 forward
[INFO] - 03-16 18:59:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 18:59:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0179 (0.0188)
[INFO] - 03-16 18:59:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5741 (0.5952)
[INFO] - 03-16 18:59:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5379 (-140.5304)
[INFO] - 03-16 18:59:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.6000 (27.8237)
[INFO] - 03-16 18:59:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 273.7957 (273.5668)
[INFO] - 03-16 18:59:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 18:59:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.6805)
[INFO] - 03-16 19:00:08 - [main.backward:225]: Epoch 54/300 - Iteration 103/199 - Time 0.248 batch, 0.041 data, 0.220 forward
[INFO] - 03-16 19:00:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:00:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0197 (0.0176)
[INFO] - 03-16 19:00:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5332 (0.5961)
[INFO] - 03-16 19:00:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6401 (-140.5365)
[INFO] - 03-16 19:00:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.5724 (27.9160)
[INFO] - 03-16 19:00:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.0831 (272.3850)
[INFO] - 03-16 19:00:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:00:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.7141)
[INFO] - 03-16 19:00:20 - [main.backward:225]: Epoch 54/300 - Iteration 153/199 - Time 0.244 batch, 0.037 data, 0.216 forward
[INFO] - 03-16 19:00:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0194 (0.0197)
[INFO] - 03-16 19:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5992 (0.6007)
[INFO] - 03-16 19:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5688 (-140.5754)
[INFO] - 03-16 19:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.4962 (28.5265)
[INFO] - 03-16 19:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 268.0536 (268.3664)
[INFO] - 03-16 19:00:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6797 (0.6395)
[INFO] - 03-16 19:00:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:00:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:00:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:00:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:00:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:00:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:00:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:00:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.210
[INFO] - 03-16 19:00:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.210
[INFO] - 03-16 19:00:35 - [main.summary_metrics:168]: Epoch 54/300 - Test Results:
{'auc': 0.6244272798742138,
 'f1': 0.1157232704402516,
 'loss': 0.655861869644069,
 'ndcg': 0.37697775981722315,
 'precision': 0.17358490566037735,
 'recall': 0.08679245283018867}
[INFO] - 03-16 19:00:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[54] Complete. Time taken: 00:00:52.372
[INFO] - 03-16 19:00:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:00:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:00:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:00:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:00:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:00:35 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7240, 4996, 5163]
[INFO] - 03-16 19:00:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:00:37 - [main.backward:225]: Epoch 55/300 - Iteration 4/199 - Time 0.530 batch, 0.322 data, 0.502 forward
[INFO] - 03-16 19:00:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0154 (0.0188)
[INFO] - 03-16 19:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5830 (0.5988)
[INFO] - 03-16 19:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5735 (-140.5402)
[INFO] - 03-16 19:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2198 (28.1150)
[INFO] - 03-16 19:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.8626 (271.1434)
[INFO] - 03-16 19:00:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.6813)
[INFO] - 03-16 19:00:49 - [main.backward:225]: Epoch 55/300 - Iteration 54/199 - Time 0.258 batch, 0.049 data, 0.230 forward
[INFO] - 03-16 19:00:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:00:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0185 (0.0187)
[INFO] - 03-16 19:00:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5623 (0.5952)
[INFO] - 03-16 19:00:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6010 (-140.5312)
[INFO] - 03-16 19:00:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.6900 (27.7744)
[INFO] - 03-16 19:00:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 271.2344 (271.4636)
[INFO] - 03-16 19:00:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:00:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.6809)
[INFO] - 03-16 19:01:01 - [main.backward:225]: Epoch 55/300 - Iteration 104/199 - Time 0.248 batch, 0.040 data, 0.220 forward
[INFO] - 03-16 19:01:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0202 (0.0183)
[INFO] - 03-16 19:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5176 (0.5946)
[INFO] - 03-16 19:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6330 (-140.5365)
[INFO] - 03-16 19:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3803 (27.8750)
[INFO] - 03-16 19:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 271.1749 (272.6751)
[INFO] - 03-16 19:01:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.6869)
[INFO] - 03-16 19:01:13 - [main.backward:225]: Epoch 55/300 - Iteration 154/199 - Time 0.245 batch, 0.037 data, 0.216 forward
[INFO] - 03-16 19:01:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:01:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0202 (0.0199)
[INFO] - 03-16 19:01:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5972 (0.5979)
[INFO] - 03-16 19:01:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5695 (-140.5732)
[INFO] - 03-16 19:01:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2927 (28.3351)
[INFO] - 03-16 19:01:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 268.1869 (270.0690)
[INFO] - 03-16 19:01:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:01:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6389)
[INFO] - 03-16 19:01:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:01:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:01:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:01:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:01:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:01:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:01:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:01:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.263
[INFO] - 03-16 19:01:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.263
[INFO] - 03-16 19:01:28 - [main.summary_metrics:168]: Epoch 55/300 - Test Results:
{'auc': 0.6265902450209644,
 'f1': 0.1119496855345912,
 'loss': 0.6582108669640883,
 'ndcg': 0.3801157672474625,
 'precision': 0.16792452830188676,
 'recall': 0.08396226415094338}
[INFO] - 03-16 19:01:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[55] Complete. Time taken: 00:00:52.596
[INFO] - 03-16 19:01:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:01:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:01:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:01:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:01:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:01:28 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7241, 4999, 5132]
[INFO] - 03-16 19:01:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:01:30 - [main.backward:225]: Epoch 56/300 - Iteration 5/199 - Time 0.465 batch, 0.257 data, 0.438 forward
[INFO] - 03-16 19:01:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:01:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0153 (0.0190)
[INFO] - 03-16 19:01:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5738 (0.5979)
[INFO] - 03-16 19:01:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6040 (-140.5396)
[INFO] - 03-16 19:01:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3543 (28.1451)
[INFO] - 03-16 19:01:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.8884 (271.5592)
[INFO] - 03-16 19:01:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:01:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7734 (0.6653)
[INFO] - 03-16 19:01:42 - [main.backward:225]: Epoch 56/300 - Iteration 55/199 - Time 0.255 batch, 0.049 data, 0.227 forward
[INFO] - 03-16 19:01:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:01:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0188 (0.0191)
[INFO] - 03-16 19:01:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5231 (0.5909)
[INFO] - 03-16 19:01:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6010 (-140.5269)
[INFO] - 03-16 19:01:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.5455 (27.8102)
[INFO] - 03-16 19:01:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.5963 (270.6357)
[INFO] - 03-16 19:01:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:01:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.6650)
[INFO] - 03-16 19:01:53 - [main.backward:225]: Epoch 56/300 - Iteration 105/199 - Time 0.246 batch, 0.039 data, 0.218 forward
[INFO] - 03-16 19:01:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0174 (0.0180)
[INFO] - 03-16 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5206 (0.5926)
[INFO] - 03-16 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6340 (-140.5333)
[INFO] - 03-16 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.1120 (27.8034)
[INFO] - 03-16 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 268.5744 (270.0870)
[INFO] - 03-16 19:01:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.7041)
[INFO] - 03-16 19:02:05 - [main.backward:225]: Epoch 56/300 - Iteration 155/199 - Time 0.241 batch, 0.035 data, 0.213 forward
[INFO] - 03-16 19:02:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:02:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0204 (0.0199)
[INFO] - 03-16 19:02:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6006 (0.6004)
[INFO] - 03-16 19:02:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6014 (-140.5717)
[INFO] - 03-16 19:02:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.0070 (28.1018)
[INFO] - 03-16 19:02:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 268.8146 (267.1924)
[INFO] - 03-16 19:02:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:02:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6255)
[INFO] - 03-16 19:02:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:02:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:02:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:02:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:02:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:02:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:02:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:02:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.264
[INFO] - 03-16 19:02:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.264
[INFO] - 03-16 19:02:20 - [main.summary_metrics:168]: Epoch 56/300 - Test Results:
{'auc': 0.6367960560796645,
 'f1': 0.11843251088534108,
 'loss': 0.6546577705167376,
 'ndcg': 0.38839527844442506,
 'precision': 0.17735849056603775,
 'recall': 0.08891509433962264}
[INFO] - 03-16 19:02:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[56] Complete. Time taken: 00:00:51.973
[INFO] - 03-16 19:02:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:02:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:02:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:02:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:02:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:02:20 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7246, 4992, 5147]
[INFO] - 03-16 19:02:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:02:22 - [main.backward:225]: Epoch 57/300 - Iteration 6/199 - Time 0.454 batch, 0.244 data, 0.425 forward
[INFO] - 03-16 19:02:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0146 (0.0190)
[INFO] - 03-16 19:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5573 (0.5965)
[INFO] - 03-16 19:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6116 (-140.5372)
[INFO] - 03-16 19:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2352 (27.9071)
[INFO] - 03-16 19:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 267.5361 (270.1200)
[INFO] - 03-16 19:02:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7734 (0.6778)
[INFO] - 03-16 19:02:34 - [main.backward:225]: Epoch 57/300 - Iteration 56/199 - Time 0.261 batch, 0.052 data, 0.232 forward
[INFO] - 03-16 19:02:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:02:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0167 (0.0189)
[INFO] - 03-16 19:02:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5400 (0.5916)
[INFO] - 03-16 19:02:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5883 (-140.5243)
[INFO] - 03-16 19:02:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.6621 (27.7446)
[INFO] - 03-16 19:02:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.1931 (268.9122)
[INFO] - 03-16 19:02:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:02:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.6752)
[INFO] - 03-16 19:02:46 - [main.backward:225]: Epoch 57/300 - Iteration 106/199 - Time 0.249 batch, 0.041 data, 0.220 forward
[INFO] - 03-16 19:02:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0179 (0.0179)
[INFO] - 03-16 19:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5814 (0.5942)
[INFO] - 03-16 19:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5863 (-140.5329)
[INFO] - 03-16 19:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3621 (27.8382)
[INFO] - 03-16 19:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.2205 (269.9846)
[INFO] - 03-16 19:02:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7500 (0.7025)
[INFO] - 03-16 19:02:58 - [main.backward:225]: Epoch 57/300 - Iteration 156/199 - Time 0.245 batch, 0.037 data, 0.216 forward
[INFO] - 03-16 19:02:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:02:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0197 (0.0195)
[INFO] - 03-16 19:02:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5973 (0.6023)
[INFO] - 03-16 19:02:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6052 (-140.5713)
[INFO] - 03-16 19:02:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2491 (28.1389)
[INFO] - 03-16 19:02:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 268.8864 (268.2762)
[INFO] - 03-16 19:02:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:02:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.6511)
[INFO] - 03-16 19:03:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:03:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:03:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:03:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:03:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:03:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:03:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:03:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.239
[INFO] - 03-16 19:03:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.239
[INFO] - 03-16 19:03:12 - [main.summary_metrics:168]: Epoch 57/300 - Test Results:
{'auc': 0.6345565055031447,
 'f1': 0.11320754716981134,
 'loss': 0.6534606354991345,
 'ndcg': 0.3813414564491492,
 'precision': 0.16981132075471694,
 'recall': 0.08490566037735847}
[INFO] - 03-16 19:03:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[57] Complete. Time taken: 00:00:52.653
[INFO] - 03-16 19:03:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:03:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:03:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:03:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:03:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:03:12 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7213, 4980, 5114]
[INFO] - 03-16 19:03:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:03:15 - [main.backward:225]: Epoch 58/300 - Iteration 7/199 - Time 0.406 batch, 0.201 data, 0.377 forward
[INFO] - 03-16 19:03:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:03:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0168 (0.0186)
[INFO] - 03-16 19:03:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5724 (0.5984)
[INFO] - 03-16 19:03:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5907 (-140.5356)
[INFO] - 03-16 19:03:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.2138 (28.0524)
[INFO] - 03-16 19:03:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 268.9991 (269.7815)
[INFO] - 03-16 19:03:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:03:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.6886)
[INFO] - 03-16 19:03:27 - [main.backward:225]: Epoch 58/300 - Iteration 57/199 - Time 0.258 batch, 0.052 data, 0.228 forward
[INFO] - 03-16 19:03:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0169 (0.0188)
[INFO] - 03-16 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5897 (0.5918)
[INFO] - 03-16 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5626 (-140.5228)
[INFO] - 03-16 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.6839 (27.7538)
[INFO] - 03-16 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 270.1310 (269.8585)
[INFO] - 03-16 19:03:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7656 (0.6802)
[INFO] - 03-16 19:03:39 - [main.backward:225]: Epoch 58/300 - Iteration 107/199 - Time 0.246 batch, 0.041 data, 0.216 forward
[INFO] - 03-16 19:03:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0185 (0.0180)
[INFO] - 03-16 19:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5891 (0.5947)
[INFO] - 03-16 19:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5886 (-140.5336)
[INFO] - 03-16 19:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.3590 (27.7879)
[INFO] - 03-16 19:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 267.1701 (269.3291)
[INFO] - 03-16 19:03:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.6967)
[INFO] - 03-16 19:03:50 - [main.backward:225]: Epoch 58/300 - Iteration 157/199 - Time 0.242 batch, 0.037 data, 0.213 forward
[INFO] - 03-16 19:03:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:03:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0200)
[INFO] - 03-16 19:03:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5876 (0.5996)
[INFO] - 03-16 19:03:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5918 (-140.5704)
[INFO] - 03-16 19:03:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.0936 (28.2408)
[INFO] - 03-16 19:03:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 268.0009 (266.5790)
[INFO] - 03-16 19:03:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:03:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.6303)
[INFO] - 03-16 19:04:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:04:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:04:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:04:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:04:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:04:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:04:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:04:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.245
[INFO] - 03-16 19:04:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.246
[INFO] - 03-16 19:04:05 - [main.summary_metrics:168]: Epoch 58/300 - Test Results:
{'auc': 0.6200526401991615,
 'f1': 0.1159748427672956,
 'loss': 0.6589337716132592,
 'ndcg': 0.3749903537425344,
 'precision': 0.17358490566037735,
 'recall': 0.08710691823899372}
[INFO] - 03-16 19:04:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[58] Complete. Time taken: 00:00:52.392
[INFO] - 03-16 19:04:05 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:04:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:04:05 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:04:05 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:04:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:04:05 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7252, 5014, 5138]
[INFO] - 03-16 19:04:06 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:04:08 - [main.backward:225]: Epoch 59/300 - Iteration 8/199 - Time 0.389 batch, 0.183 data, 0.358 forward
[INFO] - 03-16 19:04:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:04:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0169 (0.0186)
[INFO] - 03-16 19:04:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5742 (0.5975)
[INFO] - 03-16 19:04:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5508 (-140.5308)
[INFO] - 03-16 19:04:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.1730 (27.8862)
[INFO] - 03-16 19:04:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 266.4254 (268.4512)
[INFO] - 03-16 19:04:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:04:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.6861)
[INFO] - 03-16 19:04:20 - [main.backward:225]: Epoch 59/300 - Iteration 58/199 - Time 0.256 batch, 0.049 data, 0.228 forward
[INFO] - 03-16 19:04:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:04:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0180 (0.0191)
[INFO] - 03-16 19:04:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5924 (0.5918)
[INFO] - 03-16 19:04:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5666 (-140.5267)
[INFO] - 03-16 19:04:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.4874 (27.7571)
[INFO] - 03-16 19:04:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 268.8116 (268.4168)
[INFO] - 03-16 19:04:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:04:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7500 (0.6692)
[INFO] - 03-16 19:04:31 - [main.backward:225]: Epoch 59/300 - Iteration 108/199 - Time 0.246 batch, 0.040 data, 0.218 forward
[INFO] - 03-16 19:04:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0172 (0.0179)
[INFO] - 03-16 19:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6059 (0.5951)
[INFO] - 03-16 19:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5806 (-140.5334)
[INFO] - 03-16 19:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 28.1614 (27.5803)
[INFO] - 03-16 19:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 267.6992 (269.3125)
[INFO] - 03-16 19:04:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.6991)
[INFO] - 03-16 19:04:43 - [main.backward:225]: Epoch 59/300 - Iteration 158/199 - Time 0.243 batch, 0.036 data, 0.215 forward
[INFO] - 03-16 19:04:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:04:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0199)
[INFO] - 03-16 19:04:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5967 (0.6013)
[INFO] - 03-16 19:04:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5869 (-140.5678)
[INFO] - 03-16 19:04:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.9783 (28.0089)
[INFO] - 03-16 19:04:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 268.2025 (266.9611)
[INFO] - 03-16 19:04:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:04:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5781 (0.6348)
[INFO] - 03-16 19:04:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:04:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:04:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:04:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:04:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:04:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:04:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:04:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.292
[INFO] - 03-16 19:04:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.293
[INFO] - 03-16 19:04:57 - [main.summary_metrics:168]: Epoch 59/300 - Test Results:
{'auc': 0.6378228839098533,
 'f1': 0.11471698113207549,
 'loss': 0.6525811874261692,
 'ndcg': 0.3860440921027698,
 'precision': 0.17169811320754716,
 'recall': 0.0861635220125786}
[INFO] - 03-16 19:04:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[59] Complete. Time taken: 00:00:52.621
[INFO] - 03-16 19:04:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:04:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:04:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:04:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:04:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:04:57 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7240, 4993, 5120]
[INFO] - 03-16 19:04:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:05:01 - [main.backward:225]: Epoch 60/300 - Iteration 9/199 - Time 0.365 batch, 0.162 data, 0.337 forward
[INFO] - 03-16 19:05:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:05:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0185)
[INFO] - 03-16 19:05:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5577 (0.5955)
[INFO] - 03-16 19:05:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5135 (-140.5274)
[INFO] - 03-16 19:05:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.8887 (27.8344)
[INFO] - 03-16 19:05:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 268.7131 (269.3567)
[INFO] - 03-16 19:05:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:05:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6250 (0.6914)
[INFO] - 03-16 19:05:12 - [main.backward:225]: Epoch 60/300 - Iteration 59/199 - Time 0.251 batch, 0.048 data, 0.223 forward
[INFO] - 03-16 19:05:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0172 (0.0187)
[INFO] - 03-16 19:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5802 (0.5935)
[INFO] - 03-16 19:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5693 (-140.5280)
[INFO] - 03-16 19:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.6108 (27.7014)
[INFO] - 03-16 19:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 266.9730 (268.0073)
[INFO] - 03-16 19:05:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7500 (0.6769)
[INFO] - 03-16 19:05:24 - [main.backward:225]: Epoch 60/300 - Iteration 109/199 - Time 0.245 batch, 0.040 data, 0.216 forward
[INFO] - 03-16 19:05:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:05:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0171 (0.0178)
[INFO] - 03-16 19:05:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5993 (0.5957)
[INFO] - 03-16 19:05:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5810 (-140.5311)
[INFO] - 03-16 19:05:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.9527 (27.6344)
[INFO] - 03-16 19:05:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 267.6649 (267.5705)
[INFO] - 03-16 19:05:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:05:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.7058)
[INFO] - 03-16 19:05:36 - [main.backward:225]: Epoch 60/300 - Iteration 159/199 - Time 0.242 batch, 0.036 data, 0.214 forward
[INFO] - 03-16 19:05:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0218 (0.0198)
[INFO] - 03-16 19:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5975 (0.6013)
[INFO] - 03-16 19:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5602 (-140.5661)
[INFO] - 03-16 19:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.8566 (27.8550)
[INFO] - 03-16 19:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 266.4801 (266.5913)
[INFO] - 03-16 19:05:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5469 (0.6416)
[INFO] - 03-16 19:05:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:05:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:05:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:05:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:05:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:05:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:05:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:05:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.263
[INFO] - 03-16 19:05:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.264
[INFO] - 03-16 19:05:49 - [main.summary_metrics:168]: Epoch 60/300 - Test Results:
{'auc': 0.6401498296645701,
 'f1': 0.12245766811804547,
 'loss': 0.6524420078685449,
 'ndcg': 0.3898098890916763,
 'precision': 0.18301886792452826,
 'recall': 0.09205974842767294}
[INFO] - 03-16 19:05:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[60] Complete. Time taken: 00:00:52.210
[INFO] - 03-16 19:05:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:05:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:05:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:05:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:05:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:05:50 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7250, 4991, 5135]
[INFO] - 03-16 19:05:51 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:05:53 - [main.backward:225]: Epoch 61/300 - Iteration 10/199 - Time 0.361 batch, 0.151 data, 0.334 forward
[INFO] - 03-16 19:05:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0187)
[INFO] - 03-16 19:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5553 (0.5944)
[INFO] - 03-16 19:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5078 (-140.5205)
[INFO] - 03-16 19:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.8313 (27.6564)
[INFO] - 03-16 19:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 267.2733 (267.7083)
[INFO] - 03-16 19:05:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.6848)
[INFO] - 03-16 19:06:05 - [main.backward:225]: Epoch 61/300 - Iteration 60/199 - Time 0.257 batch, 0.049 data, 0.229 forward
[INFO] - 03-16 19:06:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0133 (0.0183)
[INFO] - 03-16 19:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6009 (0.5944)
[INFO] - 03-16 19:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5700 (-140.5277)
[INFO] - 03-16 19:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.5684 (27.5174)
[INFO] - 03-16 19:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 269.1332 (268.1917)
[INFO] - 03-16 19:06:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.6927)
[INFO] - 03-16 19:06:17 - [main.backward:225]: Epoch 61/300 - Iteration 110/199 - Time 0.247 batch, 0.039 data, 0.219 forward
[INFO] - 03-16 19:06:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:06:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0193 (0.0181)
[INFO] - 03-16 19:06:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6067 (0.5927)
[INFO] - 03-16 19:06:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5729 (-140.5284)
[INFO] - 03-16 19:06:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.8557 (27.6069)
[INFO] - 03-16 19:06:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 264.6506 (266.8383)
[INFO] - 03-16 19:06:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:06:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.6937)
[INFO] - 03-16 19:06:29 - [main.backward:225]: Epoch 61/300 - Iteration 160/199 - Time 0.244 batch, 0.036 data, 0.216 forward
[INFO] - 03-16 19:06:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:06:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0201)
[INFO] - 03-16 19:06:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5998 (0.5993)
[INFO] - 03-16 19:06:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5638 (-140.5632)
[INFO] - 03-16 19:06:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.8667 (27.8680)
[INFO] - 03-16 19:06:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 266.3679 (264.8660)
[INFO] - 03-16 19:06:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:06:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.6192)
[INFO] - 03-16 19:06:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:06:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:06:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:06:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:06:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:06:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:06:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:06:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.231
[INFO] - 03-16 19:06:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.232
[INFO] - 03-16 19:06:42 - [main.summary_metrics:168]: Epoch 61/300 - Test Results:
{'auc': 0.643215539832285,
 'f1': 0.11843251088534107,
 'loss': 0.6521471646866709,
 'ndcg': 0.39267408363887996,
 'precision': 0.17735849056603775,
 'recall': 0.08891509433962264}
[INFO] - 03-16 19:06:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[61] Complete. Time taken: 00:00:52.557
[INFO] - 03-16 19:06:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:06:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:06:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:06:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:06:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:06:42 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7232, 4965, 5162]
[INFO] - 03-16 19:06:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:06:46 - [main.backward:225]: Epoch 62/300 - Iteration 11/199 - Time 0.329 batch, 0.138 data, 0.302 forward
[INFO] - 03-16 19:06:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0180 (0.0185)
[INFO] - 03-16 19:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5689 (0.5935)
[INFO] - 03-16 19:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5070 (-140.5171)
[INFO] - 03-16 19:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.6700 (27.5842)
[INFO] - 03-16 19:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 266.7389 (267.3407)
[INFO] - 03-16 19:06:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.6921)
[INFO] - 03-16 19:06:57 - [main.backward:225]: Epoch 62/300 - Iteration 61/199 - Time 0.252 batch, 0.048 data, 0.224 forward
[INFO] - 03-16 19:06:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:06:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0171 (0.0184)
[INFO] - 03-16 19:06:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6043 (0.5930)
[INFO] - 03-16 19:06:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5610 (-140.5256)
[INFO] - 03-16 19:06:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.3717 (27.4768)
[INFO] - 03-16 19:06:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 267.7188 (267.4389)
[INFO] - 03-16 19:06:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:06:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.6878)
[INFO] - 03-16 19:07:09 - [main.backward:225]: Epoch 62/300 - Iteration 111/199 - Time 0.244 batch, 0.039 data, 0.216 forward
[INFO] - 03-16 19:07:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:07:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0194 (0.0181)
[INFO] - 03-16 19:07:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6100 (0.5930)
[INFO] - 03-16 19:07:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5552 (-140.5268)
[INFO] - 03-16 19:07:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.8153 (27.4332)
[INFO] - 03-16 19:07:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 264.9737 (267.3217)
[INFO] - 03-16 19:07:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:07:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.6947)
[INFO] - 03-16 19:07:21 - [main.backward:225]: Epoch 62/300 - Iteration 161/199 - Time 0.242 batch, 0.036 data, 0.214 forward
[INFO] - 03-16 19:07:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:07:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0191 (0.0198)
[INFO] - 03-16 19:07:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6062 (0.6005)
[INFO] - 03-16 19:07:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5695 (-140.5612)
[INFO] - 03-16 19:07:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.8689 (27.7920)
[INFO] - 03-16 19:07:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 266.4991 (265.1759)
[INFO] - 03-16 19:07:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:07:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.6392)
[INFO] - 03-16 19:07:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:07:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:07:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:07:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:07:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:07:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:07:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:07:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.275
[INFO] - 03-16 19:07:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.276
[INFO] - 03-16 19:07:34 - [main.summary_metrics:168]: Epoch 62/300 - Test Results:
{'auc': 0.6431947720125785,
 'f1': 0.12371552975326561,
 'loss': 0.6488580465976547,
 'ndcg': 0.3919749533130456,
 'precision': 0.18490566037735848,
 'recall': 0.09300314465408804}
[INFO] - 03-16 19:07:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[62] Complete. Time taken: 00:00:52.376
[INFO] - 03-16 19:07:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:07:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:07:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:07:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:07:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:07:34 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7259, 4955, 5106]
[INFO] - 03-16 19:07:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:07:38 - [main.backward:225]: Epoch 63/300 - Iteration 12/199 - Time 0.335 batch, 0.128 data, 0.306 forward
[INFO] - 03-16 19:07:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0170 (0.0183)
[INFO] - 03-16 19:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6079 (0.5937)
[INFO] - 03-16 19:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5022 (-140.5139)
[INFO] - 03-16 19:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.9144 (27.6794)
[INFO] - 03-16 19:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 266.4695 (267.2310)
[INFO] - 03-16 19:07:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7500 (0.6951)
[INFO] - 03-16 19:07:50 - [main.backward:225]: Epoch 63/300 - Iteration 62/199 - Time 0.254 batch, 0.047 data, 0.226 forward
[INFO] - 03-16 19:07:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:07:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0175 (0.0183)
[INFO] - 03-16 19:07:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5995 (0.5919)
[INFO] - 03-16 19:07:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5579 (-140.5235)
[INFO] - 03-16 19:07:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.3303 (27.4733)
[INFO] - 03-16 19:07:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 266.9850 (266.4706)
[INFO] - 03-16 19:07:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:07:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.6930)
[INFO] - 03-16 19:08:02 - [main.backward:225]: Epoch 63/300 - Iteration 112/199 - Time 0.245 batch, 0.039 data, 0.217 forward
[INFO] - 03-16 19:08:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0175 (0.0181)
[INFO] - 03-16 19:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5981 (0.5921)
[INFO] - 03-16 19:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5520 (-140.5227)
[INFO] - 03-16 19:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.6021 (27.3795)
[INFO] - 03-16 19:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 265.3923 (266.7701)
[INFO] - 03-16 19:08:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.6920)
[INFO] - 03-16 19:08:14 - [main.backward:225]: Epoch 63/300 - Iteration 162/199 - Time 0.242 batch, 0.035 data, 0.214 forward
[INFO] - 03-16 19:08:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0190 (0.0198)
[INFO] - 03-16 19:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6099 (0.5998)
[INFO] - 03-16 19:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5523 (-140.5582)
[INFO] - 03-16 19:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.8763 (27.7920)
[INFO] - 03-16 19:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 263.3800 (263.6881)
[INFO] - 03-16 19:08:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.6388)
[INFO] - 03-16 19:08:22 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:08:22 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:08:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:08:22 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:08:22 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:08:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:08:22 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:08:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.267
[INFO] - 03-16 19:08:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.268
[INFO] - 03-16 19:08:27 - [main.summary_metrics:168]: Epoch 63/300 - Test Results:
{'auc': 0.6394032036163522,
 'f1': 0.11742622157716498,
 'loss': 0.652846889131974,
 'ndcg': 0.3883086804784965,
 'precision': 0.17547169811320754,
 'recall': 0.08828616352201257}
[INFO] - 03-16 19:08:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[63] Complete. Time taken: 00:00:52.189
[INFO] - 03-16 19:08:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:08:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:08:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:08:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:08:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:08:27 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7255, 4983, 5119]
[INFO] - 03-16 19:08:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:08:31 - [main.backward:225]: Epoch 64/300 - Iteration 13/199 - Time 0.319 batch, 0.115 data, 0.291 forward
[INFO] - 03-16 19:08:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:08:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0176 (0.0183)
[INFO] - 03-16 19:08:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6094 (0.5936)
[INFO] - 03-16 19:08:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4948 (-140.5089)
[INFO] - 03-16 19:08:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.7706 (27.7417)
[INFO] - 03-16 19:08:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 265.1818 (265.2950)
[INFO] - 03-16 19:08:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:08:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.6936)
[INFO] - 03-16 19:08:43 - [main.backward:225]: Epoch 64/300 - Iteration 63/199 - Time 0.253 batch, 0.046 data, 0.225 forward
[INFO] - 03-16 19:08:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:08:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0178 (0.0182)
[INFO] - 03-16 19:08:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6082 (0.5923)
[INFO] - 03-16 19:08:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5462 (-140.5196)
[INFO] - 03-16 19:08:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.1963 (27.4526)
[INFO] - 03-16 19:08:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 265.7921 (266.1488)
[INFO] - 03-16 19:08:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:08:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7422 (0.7002)
[INFO] - 03-16 19:08:54 - [main.backward:225]: Epoch 64/300 - Iteration 113/199 - Time 0.245 batch, 0.039 data, 0.217 forward
[INFO] - 03-16 19:08:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:08:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0169 (0.0182)
[INFO] - 03-16 19:08:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5917)
[INFO] - 03-16 19:08:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5466 (-140.5185)
[INFO] - 03-16 19:08:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.5734 (27.2844)
[INFO] - 03-16 19:08:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 264.5286 (265.8517)
[INFO] - 03-16 19:08:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:08:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.6867)
[INFO] - 03-16 19:09:06 - [main.backward:225]: Epoch 64/300 - Iteration 163/199 - Time 0.242 batch, 0.035 data, 0.214 forward
[INFO] - 03-16 19:09:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0195)
[INFO] - 03-16 19:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5966 (0.6026)
[INFO] - 03-16 19:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5602 (-140.5553)
[INFO] - 03-16 19:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.6223 (27.6447)
[INFO] - 03-16 19:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 264.4418 (263.8719)
[INFO] - 03-16 19:09:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.6516)
[INFO] - 03-16 19:09:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:09:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:09:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:09:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:09:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:09:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:09:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:09:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.298
[INFO] - 03-16 19:09:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.298
[INFO] - 03-16 19:09:19 - [main.summary_metrics:168]: Epoch 64/300 - Test Results:
{'auc': 0.6340955188679245,
 'f1': 0.12019351717464924,
 'loss': 0.6531174794962821,
 'ndcg': 0.3819891607019143,
 'precision': 0.17924528301886788,
 'recall': 0.09048742138364778}
[INFO] - 03-16 19:09:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[64] Complete. Time taken: 00:00:52.182
[INFO] - 03-16 19:09:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:09:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:09:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:09:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:09:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:09:19 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7248, 4955, 5119]
[INFO] - 03-16 19:09:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:09:23 - [main.backward:225]: Epoch 65/300 - Iteration 14/199 - Time 0.329 batch, 0.121 data, 0.301 forward
[INFO] - 03-16 19:09:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0165 (0.0179)
[INFO] - 03-16 19:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6165 (0.5958)
[INFO] - 03-16 19:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4926 (-140.5041)
[INFO] - 03-16 19:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.5768 (27.4885)
[INFO] - 03-16 19:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 264.8577 (265.4245)
[INFO] - 03-16 19:09:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7422 (0.7035)
[INFO] - 03-16 19:09:35 - [main.backward:225]: Epoch 65/300 - Iteration 64/199 - Time 0.258 batch, 0.050 data, 0.228 forward
[INFO] - 03-16 19:09:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:09:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0159 (0.0181)
[INFO] - 03-16 19:09:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6123 (0.5936)
[INFO] - 03-16 19:09:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5312 (-140.5209)
[INFO] - 03-16 19:09:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.1537 (27.3516)
[INFO] - 03-16 19:09:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 264.2877 (264.8002)
[INFO] - 03-16 19:09:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:09:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.6970)
[INFO] - 03-16 19:09:47 - [main.backward:225]: Epoch 65/300 - Iteration 114/199 - Time 0.248 batch, 0.040 data, 0.219 forward
[INFO] - 03-16 19:09:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0186 (0.0180)
[INFO] - 03-16 19:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5834 (0.5907)
[INFO] - 03-16 19:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5640 (-140.5170)
[INFO] - 03-16 19:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.3577 (27.2325)
[INFO] - 03-16 19:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 264.1647 (264.6699)
[INFO] - 03-16 19:09:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.6923)
[INFO] - 03-16 19:09:59 - [main.backward:225]: Epoch 65/300 - Iteration 164/199 - Time 0.242 batch, 0.037 data, 0.214 forward
[INFO] - 03-16 19:09:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0199)
[INFO] - 03-16 19:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6033 (0.6004)
[INFO] - 03-16 19:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5596 (-140.5547)
[INFO] - 03-16 19:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.7472 (27.6100)
[INFO] - 03-16 19:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 260.6776 (261.7733)
[INFO] - 03-16 19:09:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.6350)
[INFO] - 03-16 19:17:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:17:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:17:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:17:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:17:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:17:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:17:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:17:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.509
[INFO] - 03-16 19:17:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.510
[INFO] - 03-16 19:17:36 - [main.summary_metrics:168]: Epoch 65/300 - Test Results:
{'auc': 0.6361002686058699,
 'f1': 0.11471698113207546,
 'loss': 0.6514785673593325,
 'ndcg': 0.3847056697533585,
 'precision': 0.17169811320754716,
 'recall': 0.08616352201257861}
[INFO] - 03-16 19:17:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[65] Complete. Time taken: 00:08:17.573
[INFO] - 03-16 19:17:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:17:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:17:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:17:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:17:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:17:36 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7216, 4988, 5158]
[INFO] - 03-16 19:17:38 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:17:41 - [main.backward:225]: Epoch 66/300 - Iteration 15/199 - Time 0.328 batch, 0.115 data, 0.299 forward
[INFO] - 03-16 19:17:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0161 (0.0181)
[INFO] - 03-16 19:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6238 (0.5933)
[INFO] - 03-16 19:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4721 (-140.4969)
[INFO] - 03-16 19:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.5476 (27.4085)
[INFO] - 03-16 19:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 265.7945 (263.8606)
[INFO] - 03-16 19:17:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.6953)
[INFO] - 03-16 19:17:54 - [main.backward:225]: Epoch 66/300 - Iteration 65/199 - Time 0.274 batch, 0.055 data, 0.239 forward
[INFO] - 03-16 19:17:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:17:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0182 (0.0182)
[INFO] - 03-16 19:17:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6175 (0.5935)
[INFO] - 03-16 19:17:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4730 (-140.5161)
[INFO] - 03-16 19:17:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.0411 (27.1288)
[INFO] - 03-16 19:17:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 263.7518 (264.5690)
[INFO] - 03-16 19:17:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:17:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.6937)
[INFO] - 03-16 19:18:07 - [main.backward:225]: Epoch 66/300 - Iteration 115/199 - Time 0.263 batch, 0.045 data, 0.229 forward
[INFO] - 03-16 19:18:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0176 (0.0176)
[INFO] - 03-16 19:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5846 (0.5930)
[INFO] - 03-16 19:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5631 (-140.5159)
[INFO] - 03-16 19:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.0873 (27.0595)
[INFO] - 03-16 19:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 265.2522 (265.5880)
[INFO] - 03-16 19:18:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.7064)
[INFO] - 03-16 19:18:19 - [main.backward:225]: Epoch 66/300 - Iteration 165/199 - Time 0.257 batch, 0.041 data, 0.224 forward
[INFO] - 03-16 19:18:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:18:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0192 (0.0195)
[INFO] - 03-16 19:18:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5950 (0.6017)
[INFO] - 03-16 19:18:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5636 (-140.5544)
[INFO] - 03-16 19:18:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.1705 (27.2499)
[INFO] - 03-16 19:18:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 264.0999 (264.7015)
[INFO] - 03-16 19:18:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:18:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.6472)
[INFO] - 03-16 19:18:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:18:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:18:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:18:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:18:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:18:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:18:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:18:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.452
[INFO] - 03-16 19:18:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.453
[INFO] - 03-16 19:18:32 - [main.summary_metrics:168]: Epoch 66/300 - Test Results:
{'auc': 0.6471535639412999,
 'f1': 0.11969037252056121,
 'loss': 0.6453990968428318,
 'ndcg': 0.39456135181079305,
 'precision': 0.1792452830188679,
 'recall': 0.08985849056603774}
[INFO] - 03-16 19:18:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[66] Complete. Time taken: 00:00:55.563
[INFO] - 03-16 19:18:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:18:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:18:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:18:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:18:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:18:32 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7207, 5018, 5163]
[INFO] - 03-16 19:18:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:18:37 - [main.backward:225]: Epoch 67/300 - Iteration 16/199 - Time 0.339 batch, 0.113 data, 0.301 forward
[INFO] - 03-16 19:18:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0184 (0.0177)
[INFO] - 03-16 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5941 (0.5945)
[INFO] - 03-16 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5236 (-140.4917)
[INFO] - 03-16 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.1224 (27.2067)
[INFO] - 03-16 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 264.6710 (264.7326)
[INFO] - 03-16 19:18:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.7094)
[INFO] - 03-16 19:18:50 - [main.backward:225]: Epoch 67/300 - Iteration 66/199 - Time 0.266 batch, 0.050 data, 0.234 forward
[INFO] - 03-16 19:18:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0203 (0.0182)
[INFO] - 03-16 19:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6268 (0.5934)
[INFO] - 03-16 19:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4816 (-140.5030)
[INFO] - 03-16 19:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.1725 (27.2004)
[INFO] - 03-16 19:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 262.8417 (263.3592)
[INFO] - 03-16 19:18:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.6913)
[INFO] - 03-16 19:19:01 - [main.backward:225]: Epoch 67/300 - Iteration 116/199 - Time 0.254 batch, 0.041 data, 0.223 forward
[INFO] - 03-16 19:19:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:19:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0146 (0.0177)
[INFO] - 03-16 19:19:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6008 (0.5928)
[INFO] - 03-16 19:19:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5681 (-140.5133)
[INFO] - 03-16 19:19:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.1976 (27.0393)
[INFO] - 03-16 19:19:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 262.9282 (263.8610)
[INFO] - 03-16 19:19:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:19:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.7069)
[INFO] - 03-16 19:19:14 - [main.backward:225]: Epoch 67/300 - Iteration 166/199 - Time 0.252 batch, 0.038 data, 0.221 forward
[INFO] - 03-16 19:19:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:19:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0204 (0.0199)
[INFO] - 03-16 19:19:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6003 (0.6022)
[INFO] - 03-16 19:19:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4961 (-140.5519)
[INFO] - 03-16 19:19:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.1255 (27.1942)
[INFO] - 03-16 19:19:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 263.7362 (263.6424)
[INFO] - 03-16 19:19:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:19:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5938 (0.6380)
[INFO] - 03-16 19:19:22 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:19:22 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:19:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:19:22 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:19:22 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:19:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:19:22 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:19:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.403
[INFO] - 03-16 19:19:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.403
[INFO] - 03-16 19:19:26 - [main.summary_metrics:168]: Epoch 67/300 - Test Results:
{'auc': 0.6389667518343815,
 'f1': 0.11340106434446057,
 'loss': 0.6483315375306071,
 'ndcg': 0.3877263058761788,
 'precision': 0.16981132075471697,
 'recall': 0.08514150943396225}
[INFO] - 03-16 19:19:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[67] Complete. Time taken: 00:00:54.224
[INFO] - 03-16 19:19:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:19:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:19:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:19:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:19:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:19:26 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7231, 5001, 5167]
[INFO] - 03-16 19:19:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:19:32 - [main.backward:225]: Epoch 68/300 - Iteration 17/199 - Time 0.316 batch, 0.100 data, 0.288 forward
[INFO] - 03-16 19:19:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0185 (0.0175)
[INFO] - 03-16 19:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6060 (0.5950)
[INFO] - 03-16 19:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5032 (-140.4890)
[INFO] - 03-16 19:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.0350 (27.0780)
[INFO] - 03-16 19:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 263.0809 (263.8955)
[INFO] - 03-16 19:19:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.7169)
[INFO] - 03-16 19:19:44 - [main.backward:225]: Epoch 68/300 - Iteration 67/199 - Time 0.262 batch, 0.047 data, 0.233 forward
[INFO] - 03-16 19:19:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0166 (0.0181)
[INFO] - 03-16 19:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6331 (0.5937)
[INFO] - 03-16 19:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4958 (-140.5028)
[INFO] - 03-16 19:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.9150 (26.9812)
[INFO] - 03-16 19:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 261.6853 (263.3095)
[INFO] - 03-16 19:19:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.7002)
[INFO] - 03-16 19:19:56 - [main.backward:225]: Epoch 68/300 - Iteration 117/199 - Time 0.259 batch, 0.042 data, 0.227 forward
[INFO] - 03-16 19:19:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:19:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0172)
[INFO] - 03-16 19:19:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6002 (0.5906)
[INFO] - 03-16 19:19:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5599 (-140.5128)
[INFO] - 03-16 19:19:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.0868 (26.8774)
[INFO] - 03-16 19:19:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 263.3075 (263.0898)
[INFO] - 03-16 19:19:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:19:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.7241)
[INFO] - 03-16 19:20:09 - [main.backward:225]: Epoch 68/300 - Iteration 167/199 - Time 0.257 batch, 0.040 data, 0.225 forward
[INFO] - 03-16 19:20:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0193 (0.0201)
[INFO] - 03-16 19:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6075 (0.6013)
[INFO] - 03-16 19:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5006 (-140.5499)
[INFO] - 03-16 19:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.2531 (27.1312)
[INFO] - 03-16 19:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 262.8489 (261.6668)
[INFO] - 03-16 19:20:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.6283)
[INFO] - 03-16 19:20:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:20:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:20:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:20:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:20:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:20:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:20:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:20:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.488
[INFO] - 03-16 19:20:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.489
[INFO] - 03-16 19:20:21 - [main.summary_metrics:168]: Epoch 68/300 - Test Results:
{'auc': 0.6408559355345912,
 'f1': 0.11994194484760523,
 'loss': 0.6494095270168855,
 'ndcg': 0.3930396748056708,
 'precision': 0.1792452830188679,
 'recall': 0.09017295597484278}
[INFO] - 03-16 19:20:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[68] Complete. Time taken: 00:00:55.390
[INFO] - 03-16 19:20:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:20:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:20:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:20:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:20:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:20:22 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7242, 5010, 5142]
[INFO] - 03-16 19:20:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:20:27 - [main.backward:225]: Epoch 69/300 - Iteration 18/199 - Time 0.321 batch, 0.101 data, 0.291 forward
[INFO] - 03-16 19:20:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0179 (0.0180)
[INFO] - 03-16 19:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6096 (0.5933)
[INFO] - 03-16 19:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4956 (-140.4860)
[INFO] - 03-16 19:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.8441 (27.0085)
[INFO] - 03-16 19:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 262.3723 (263.5714)
[INFO] - 03-16 19:20:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:20:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.7020)
[INFO] - 03-16 19:20:39 - [main.backward:225]: Epoch 69/300 - Iteration 68/199 - Time 0.258 batch, 0.049 data, 0.229 forward
[INFO] - 03-16 19:20:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:20:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0165 (0.0179)
[INFO] - 03-16 19:20:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5930 (0.5936)
[INFO] - 03-16 19:20:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5179 (-140.5015)
[INFO] - 03-16 19:20:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.6830 (26.7707)
[INFO] - 03-16 19:20:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 262.6100 (262.1977)
[INFO] - 03-16 19:20:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:20:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.6987)
[INFO] - 03-16 19:20:51 - [main.backward:225]: Epoch 69/300 - Iteration 118/199 - Time 0.253 batch, 0.041 data, 0.222 forward
[INFO] - 03-16 19:20:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0175 (0.0174)
[INFO] - 03-16 19:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6058 (0.5909)
[INFO] - 03-16 19:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5710 (-140.5099)
[INFO] - 03-16 19:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.8896 (26.8825)
[INFO] - 03-16 19:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 261.0926 (263.1870)
[INFO] - 03-16 19:20:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.7178)
[INFO] - 03-16 19:21:04 - [main.backward:225]: Epoch 69/300 - Iteration 168/199 - Time 0.251 batch, 0.038 data, 0.221 forward
[INFO] - 03-16 19:21:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:21:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0207 (0.0199)
[INFO] - 03-16 19:21:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6017 (0.6009)
[INFO] - 03-16 19:21:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5049 (-140.5491)
[INFO] - 03-16 19:21:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.0934 (27.0674)
[INFO] - 03-16 19:21:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 260.3893 (261.3326)
[INFO] - 03-16 19:21:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:21:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.6320)
[INFO] - 03-16 19:21:11 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:21:11 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:21:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:21:11 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:21:11 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:21:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:21:11 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:21:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.859
[INFO] - 03-16 19:21:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.860
[INFO] - 03-16 19:21:16 - [main.summary_metrics:168]: Epoch 69/300 - Test Results:
{'auc': 0.648208235062893,
 'f1': 0.1337784228350266,
 'loss': 0.6437817311796753,
 'ndcg': 0.402336086527838,
 'precision': 0.19999999999999996,
 'recall': 0.10055031446540878}
[INFO] - 03-16 19:21:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[69] Complete. Time taken: 00:00:54.647
[INFO] - 03-16 19:21:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:21:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:21:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:21:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:21:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:21:16 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7249, 5009, 5153]
[INFO] - 03-16 19:21:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:21:22 - [main.backward:225]: Epoch 70/300 - Iteration 19/199 - Time 0.302 batch, 0.091 data, 0.274 forward
[INFO] - 03-16 19:21:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:21:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0198 (0.0175)
[INFO] - 03-16 19:21:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5938)
[INFO] - 03-16 19:21:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4994 (-140.4842)
[INFO] - 03-16 19:21:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.7277 (26.9248)
[INFO] - 03-16 19:21:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 260.6353 (261.7783)
[INFO] - 03-16 19:21:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:21:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.7220)
[INFO] - 03-16 19:21:34 - [main.backward:225]: Epoch 70/300 - Iteration 69/199 - Time 0.256 batch, 0.046 data, 0.227 forward
[INFO] - 03-16 19:21:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0121 (0.0180)
[INFO] - 03-16 19:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5507 (0.5903)
[INFO] - 03-16 19:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5850 (-140.5004)
[INFO] - 03-16 19:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.2890 (26.6958)
[INFO] - 03-16 19:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 259.3284 (260.1342)
[INFO] - 03-16 19:21:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.6981)
[INFO] - 03-16 19:21:46 - [main.backward:225]: Epoch 70/300 - Iteration 119/199 - Time 0.248 batch, 0.038 data, 0.220 forward
[INFO] - 03-16 19:21:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0189 (0.0176)
[INFO] - 03-16 19:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6003 (0.5928)
[INFO] - 03-16 19:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5521 (-140.5024)
[INFO] - 03-16 19:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.9977 (26.7909)
[INFO] - 03-16 19:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 259.7839 (260.7498)
[INFO] - 03-16 19:21:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.7031)
[INFO] - 03-16 19:21:58 - [main.backward:225]: Epoch 70/300 - Iteration 169/199 - Time 0.248 batch, 0.036 data, 0.219 forward
[INFO] - 03-16 19:21:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:21:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0197 (0.0198)
[INFO] - 03-16 19:21:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6008 (0.6019)
[INFO] - 03-16 19:21:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4838 (-140.5442)
[INFO] - 03-16 19:21:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 27.1355 (27.1040)
[INFO] - 03-16 19:21:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 259.6403 (259.5729)
[INFO] - 03-16 19:21:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:21:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.6406)
[INFO] - 03-16 19:22:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:22:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:22:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:22:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:22:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:22:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:22:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:22:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.286
[INFO] - 03-16 19:22:10 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.287
[INFO] - 03-16 19:22:10 - [main.summary_metrics:168]: Epoch 70/300 - Test Results:
{'auc': 0.6515490041928722,
 'f1': 0.12472181906144171,
 'loss': 0.643199351040822,
 'ndcg': 0.4037197722918632,
 'precision': 0.1867924528301887,
 'recall': 0.09363207547169812}
[INFO] - 03-16 19:22:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[70] Complete. Time taken: 00:00:53.607
[INFO] - 03-16 19:22:10 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:22:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:22:10 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:22:10 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:22:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:22:10 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7228, 5028, 5163]
[INFO] - 03-16 19:22:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:22:16 - [main.backward:225]: Epoch 71/300 - Iteration 20/199 - Time 0.307 batch, 0.094 data, 0.274 forward
[INFO] - 03-16 19:22:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:22:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0182 (0.0171)
[INFO] - 03-16 19:22:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5928)
[INFO] - 03-16 19:22:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5343 (-140.4868)
[INFO] - 03-16 19:22:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.8752 (26.9712)
[INFO] - 03-16 19:22:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 260.2700 (260.8466)
[INFO] - 03-16 19:22:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:22:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.7345)
[INFO] - 03-16 19:22:28 - [main.backward:225]: Epoch 71/300 - Iteration 70/199 - Time 0.266 batch, 0.049 data, 0.234 forward
[INFO] - 03-16 19:22:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:22:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0138 (0.0176)
[INFO] - 03-16 19:22:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5380 (0.5895)
[INFO] - 03-16 19:22:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5658 (-140.4983)
[INFO] - 03-16 19:22:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.3354 (26.6978)
[INFO] - 03-16 19:22:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 261.2758 (260.0443)
[INFO] - 03-16 19:22:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:22:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.7067)
[INFO] - 03-16 19:22:41 - [main.backward:225]: Epoch 71/300 - Iteration 120/199 - Time 0.256 batch, 0.041 data, 0.225 forward
[INFO] - 03-16 19:22:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:22:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0188 (0.0180)
[INFO] - 03-16 19:22:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6191 (0.5913)
[INFO] - 03-16 19:22:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5508 (-140.4985)
[INFO] - 03-16 19:22:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.9114 (26.6739)
[INFO] - 03-16 19:22:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 260.4946 (261.3482)
[INFO] - 03-16 19:22:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:22:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.6905)
[INFO] - 03-16 19:22:53 - [main.backward:225]: Epoch 71/300 - Iteration 170/199 - Time 0.257 batch, 0.039 data, 0.224 forward
[INFO] - 03-16 19:22:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:22:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0144 (0.0193)
[INFO] - 03-16 19:22:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5728 (0.5998)
[INFO] - 03-16 19:22:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4639 (-140.5381)
[INFO] - 03-16 19:22:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.6729 (26.7965)
[INFO] - 03-16 19:22:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 261.7572 (260.4819)
[INFO] - 03-16 19:22:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:22:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.6595)
[INFO] - 03-16 19:23:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:23:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:23:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:23:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:23:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:23:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:23:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:23:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.542
[INFO] - 03-16 19:23:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.543
[INFO] - 03-16 19:23:05 - [main.summary_metrics:168]: Epoch 71/300 - Test Results:
{'auc': 0.6443840081236897,
 'f1': 0.1236574746008708,
 'loss': 0.6445886198119797,
 'ndcg': 0.393815111121135,
 'precision': 0.18490566037735848,
 'recall': 0.09292452830188679}
[INFO] - 03-16 19:23:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[71] Complete. Time taken: 00:00:55.603
[INFO] - 03-16 19:23:05 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:23:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:23:05 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:23:05 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:23:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:23:05 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7206, 5007, 5146]
[INFO] - 03-16 19:23:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:23:12 - [main.backward:225]: Epoch 72/300 - Iteration 21/199 - Time 0.295 batch, 0.084 data, 0.265 forward
[INFO] - 03-16 19:23:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:23:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0171 (0.0171)
[INFO] - 03-16 19:23:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5945 (0.5940)
[INFO] - 03-16 19:23:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5416 (-140.4860)
[INFO] - 03-16 19:23:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.6683 (26.7307)
[INFO] - 03-16 19:23:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 260.2774 (260.8673)
[INFO] - 03-16 19:23:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:23:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.7304)
[INFO] - 03-16 19:23:23 - [main.backward:225]: Epoch 72/300 - Iteration 71/199 - Time 0.254 batch, 0.045 data, 0.225 forward
[INFO] - 03-16 19:23:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:23:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0140 (0.0176)
[INFO] - 03-16 19:23:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5249 (0.5892)
[INFO] - 03-16 19:23:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5714 (-140.4940)
[INFO] - 03-16 19:23:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.2653 (26.6045)
[INFO] - 03-16 19:23:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 261.0829 (260.4429)
[INFO] - 03-16 19:23:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:23:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.7117)
[INFO] - 03-16 19:23:36 - [main.backward:225]: Epoch 72/300 - Iteration 121/199 - Time 0.249 batch, 0.039 data, 0.219 forward
[INFO] - 03-16 19:23:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:23:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0174 (0.0175)
[INFO] - 03-16 19:23:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5674 (0.5935)
[INFO] - 03-16 19:23:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6067 (-140.4944)
[INFO] - 03-16 19:23:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.5904 (26.5595)
[INFO] - 03-16 19:23:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.7837 (259.9740)
[INFO] - 03-16 19:23:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:23:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.7042)
[INFO] - 03-16 19:23:47 - [main.backward:225]: Epoch 72/300 - Iteration 171/199 - Time 0.245 batch, 0.036 data, 0.216 forward
[INFO] - 03-16 19:23:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:23:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0164 (0.0196)
[INFO] - 03-16 19:23:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5778 (0.6004)
[INFO] - 03-16 19:23:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4786 (-140.5294)
[INFO] - 03-16 19:23:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.5081 (26.5892)
[INFO] - 03-16 19:23:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 261.0914 (259.4027)
[INFO] - 03-16 19:23:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:23:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.6503)
[INFO] - 03-16 19:23:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:23:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:23:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:23:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:23:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:23:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:23:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:23:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.069
[INFO] - 03-16 19:23:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.069
[INFO] - 03-16 19:23:58 - [main.summary_metrics:168]: Epoch 72/300 - Test Results:
{'auc': 0.6469932193396225,
 'f1': 0.12371552975326561,
 'loss': 0.6433344428424317,
 'ndcg': 0.3984491980362751,
 'precision': 0.18490566037735848,
 'recall': 0.09300314465408804}
[INFO] - 03-16 19:23:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[72] Complete. Time taken: 00:00:52.317
[INFO] - 03-16 19:23:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:23:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:23:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:23:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:23:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:23:58 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7205, 5005, 5133]
[INFO] - 03-16 19:23:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:24:04 - [main.backward:225]: Epoch 73/300 - Iteration 22/199 - Time 0.290 batch, 0.081 data, 0.263 forward
[INFO] - 03-16 19:24:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:24:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0174 (0.0173)
[INFO] - 03-16 19:24:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6126 (0.5939)
[INFO] - 03-16 19:24:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5480 (-140.4866)
[INFO] - 03-16 19:24:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.5456 (26.5213)
[INFO] - 03-16 19:24:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 258.8243 (259.8133)
[INFO] - 03-16 19:24:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:24:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.7199)
[INFO] - 03-16 19:24:16 - [main.backward:225]: Epoch 73/300 - Iteration 72/199 - Time 0.252 batch, 0.044 data, 0.224 forward
[INFO] - 03-16 19:24:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0115 (0.0171)
[INFO] - 03-16 19:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6207 (0.5907)
[INFO] - 03-16 19:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4495 (-140.4868)
[INFO] - 03-16 19:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.4327 (26.6156)
[INFO] - 03-16 19:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 259.4711 (259.2999)
[INFO] - 03-16 19:24:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.7266)
[INFO] - 03-16 19:24:28 - [main.backward:225]: Epoch 73/300 - Iteration 122/199 - Time 0.247 batch, 0.038 data, 0.218 forward
[INFO] - 03-16 19:24:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:24:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0181 (0.0178)
[INFO] - 03-16 19:24:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5701 (0.5935)
[INFO] - 03-16 19:24:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.6026 (-140.4914)
[INFO] - 03-16 19:24:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.9447 (26.7665)
[INFO] - 03-16 19:24:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.7873 (258.8781)
[INFO] - 03-16 19:24:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:24:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.6981)
[INFO] - 03-16 19:24:41 - [main.backward:225]: Epoch 73/300 - Iteration 172/199 - Time 0.250 batch, 0.037 data, 0.220 forward
[INFO] - 03-16 19:24:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:24:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0134 (0.0191)
[INFO] - 03-16 19:24:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5834 (0.6000)
[INFO] - 03-16 19:24:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4783 (-140.5214)
[INFO] - 03-16 19:24:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.6096 (26.7830)
[INFO] - 03-16 19:24:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 260.0721 (258.3235)
[INFO] - 03-16 19:24:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:24:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.6714)
[INFO] - 03-16 19:24:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:24:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:24:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:24:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:24:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:24:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:24:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:24:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.792
[INFO] - 03-16 19:24:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.792
[INFO] - 03-16 19:24:52 - [main.summary_metrics:168]: Epoch 73/300 - Test Results:
{'auc': 0.6459934158805032,
 'f1': 0.13372036768263182,
 'loss': 0.643797022005797,
 'ndcg': 0.39931823405251543,
 'precision': 0.20000000000000004,
 'recall': 0.10047169811320755}
[INFO] - 03-16 19:24:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[73] Complete. Time taken: 00:00:54.745
[INFO] - 03-16 19:24:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:24:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:24:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:24:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:24:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:24:53 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7227, 4982, 5138]
[INFO] - 03-16 19:24:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:25:00 - [main.backward:225]: Epoch 74/300 - Iteration 23/199 - Time 0.328 batch, 0.099 data, 0.292 forward
[INFO] - 03-16 19:25:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:25:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0186 (0.0173)
[INFO] - 03-16 19:25:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5970 (0.5945)
[INFO] - 03-16 19:25:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4784 (-140.4837)
[INFO] - 03-16 19:25:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.6217 (26.6276)
[INFO] - 03-16 19:25:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.5407 (259.9171)
[INFO] - 03-16 19:25:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:25:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.7209)
[INFO] - 03-16 19:25:13 - [main.backward:225]: Epoch 74/300 - Iteration 73/199 - Time 0.277 batch, 0.056 data, 0.241 forward
[INFO] - 03-16 19:25:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:25:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0150 (0.0173)
[INFO] - 03-16 19:25:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6193 (0.5894)
[INFO] - 03-16 19:25:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4165 (-140.4801)
[INFO] - 03-16 19:25:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.3478 (26.5635)
[INFO] - 03-16 19:25:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.5393 (258.0600)
[INFO] - 03-16 19:25:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:25:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.7139)
[INFO] - 03-16 19:25:26 - [main.backward:225]: Epoch 74/300 - Iteration 123/199 - Time 0.272 batch, 0.047 data, 0.237 forward
[INFO] - 03-16 19:25:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0177 (0.0176)
[INFO] - 03-16 19:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5644 (0.5943)
[INFO] - 03-16 19:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5815 (-140.4881)
[INFO] - 03-16 19:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.6052 (26.5603)
[INFO] - 03-16 19:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.5919 (257.3777)
[INFO] - 03-16 19:25:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.7017)
[INFO] - 03-16 19:25:39 - [main.backward:225]: Epoch 74/300 - Iteration 173/199 - Time 0.267 batch, 0.044 data, 0.231 forward
[INFO] - 03-16 19:25:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0165 (0.0193)
[INFO] - 03-16 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5850 (0.6011)
[INFO] - 03-16 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5175 (-140.5148)
[INFO] - 03-16 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.5212 (26.5840)
[INFO] - 03-16 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 259.7288 (259.0630)
[INFO] - 03-16 19:25:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7891 (0.6594)
[INFO] - 03-16 19:25:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:25:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:25:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:25:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:25:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:25:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:25:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:25:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.545
[INFO] - 03-16 19:25:50 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.546
[INFO] - 03-16 19:25:50 - [main.summary_metrics:168]: Epoch 74/300 - Test Results:
{'auc': 0.6515326585429769,
 'f1': 0.12748911465892598,
 'loss': 0.6385496600249029,
 'ndcg': 0.40473573244731914,
 'precision': 0.19056603773584907,
 'recall': 0.09583333333333335}
[INFO] - 03-16 19:25:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[74] Complete. Time taken: 00:00:57.135
[INFO] - 03-16 19:25:50 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:25:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:25:50 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:25:50 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:25:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:25:50 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7260, 5012, 5153]
[INFO] - 03-16 19:25:51 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:25:57 - [main.backward:225]: Epoch 75/300 - Iteration 24/199 - Time 0.301 batch, 0.083 data, 0.270 forward
[INFO] - 03-16 19:25:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0163 (0.0170)
[INFO] - 03-16 19:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6187 (0.5960)
[INFO] - 03-16 19:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4141 (-140.4757)
[INFO] - 03-16 19:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.4973 (26.5532)
[INFO] - 03-16 19:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.1725 (259.1935)
[INFO] - 03-16 19:25:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.7254)
[INFO] - 03-16 19:26:09 - [main.backward:225]: Epoch 75/300 - Iteration 74/199 - Time 0.264 batch, 0.048 data, 0.233 forward
[INFO] - 03-16 19:26:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:26:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0137 (0.0173)
[INFO] - 03-16 19:26:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6326 (0.5909)
[INFO] - 03-16 19:26:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4224 (-140.4804)
[INFO] - 03-16 19:26:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.2864 (26.4582)
[INFO] - 03-16 19:26:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 258.7809 (257.8558)
[INFO] - 03-16 19:26:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:26:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.7195)
[INFO] - 03-16 19:26:22 - [main.backward:225]: Epoch 75/300 - Iteration 124/199 - Time 0.259 batch, 0.041 data, 0.228 forward
[INFO] - 03-16 19:26:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:26:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0202 (0.0178)
[INFO] - 03-16 19:26:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5870 (0.5914)
[INFO] - 03-16 19:26:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5569 (-140.4920)
[INFO] - 03-16 19:26:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.4252 (26.4116)
[INFO] - 03-16 19:26:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 255.8983 (257.1112)
[INFO] - 03-16 19:26:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:26:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.7020)
[INFO] - 03-16 19:26:34 - [main.backward:225]: Epoch 75/300 - Iteration 174/199 - Time 0.256 batch, 0.039 data, 0.225 forward
[INFO] - 03-16 19:26:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0201 (0.0190)
[INFO] - 03-16 19:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5752 (0.6003)
[INFO] - 03-16 19:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5493 (-140.5127)
[INFO] - 03-16 19:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.5758 (26.5368)
[INFO] - 03-16 19:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 260.6479 (258.7060)
[INFO] - 03-16 19:26:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.6752)
[INFO] - 03-16 19:26:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:26:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:26:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:26:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:26:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:26:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:26:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:26:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.788
[INFO] - 03-16 19:26:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.790
[INFO] - 03-16 19:26:45 - [main.summary_metrics:168]: Epoch 75/300 - Test Results:
{'auc': 0.6574319313417192,
 'f1': 0.1261731978713111,
 'loss': 0.6386797075011696,
 'ndcg': 0.41231703402086844,
 'precision': 0.18867924528301883,
 'recall': 0.09481132075471697}
[INFO] - 03-16 19:26:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[75] Complete. Time taken: 00:00:55.564
[INFO] - 03-16 19:26:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:26:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:26:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:26:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:26:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:26:45 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7213, 4989, 5109]
[INFO] - 03-16 19:26:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:26:53 - [main.backward:225]: Epoch 76/300 - Iteration 25/199 - Time 0.317 batch, 0.096 data, 0.284 forward
[INFO] - 03-16 19:26:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0176 (0.0169)
[INFO] - 03-16 19:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6178 (0.5965)
[INFO] - 03-16 19:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4219 (-140.4741)
[INFO] - 03-16 19:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.5098 (26.4296)
[INFO] - 03-16 19:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.5974 (259.7133)
[INFO] - 03-16 19:26:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.7323)
[INFO] - 03-16 19:27:05 - [main.backward:225]: Epoch 76/300 - Iteration 75/199 - Time 0.267 batch, 0.052 data, 0.236 forward
[INFO] - 03-16 19:27:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:27:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0172 (0.0171)
[INFO] - 03-16 19:27:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6284 (0.5892)
[INFO] - 03-16 19:27:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4342 (-140.4793)
[INFO] - 03-16 19:27:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.2075 (26.3195)
[INFO] - 03-16 19:27:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 258.0795 (257.6958)
[INFO] - 03-16 19:27:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:27:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.7163)
[INFO] - 03-16 19:27:17 - [main.backward:225]: Epoch 76/300 - Iteration 125/199 - Time 0.258 batch, 0.044 data, 0.227 forward
[INFO] - 03-16 19:27:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:27:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0180)
[INFO] - 03-16 19:27:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6004 (0.5912)
[INFO] - 03-16 19:27:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4973 (-140.4930)
[INFO] - 03-16 19:27:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.4788 (26.2802)
[INFO] - 03-16 19:27:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 255.2689 (257.5777)
[INFO] - 03-16 19:27:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:27:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5938 (0.6919)
[INFO] - 03-16 19:27:30 - [main.backward:225]: Epoch 76/300 - Iteration 175/199 - Time 0.257 batch, 0.041 data, 0.225 forward
[INFO] - 03-16 19:27:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:27:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0198 (0.0193)
[INFO] - 03-16 19:27:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5816 (0.5996)
[INFO] - 03-16 19:27:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5325 (-140.5118)
[INFO] - 03-16 19:27:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.4461 (26.4457)
[INFO] - 03-16 19:27:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 260.6167 (257.7448)
[INFO] - 03-16 19:27:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:27:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6250 (0.6631)
[INFO] - 03-16 19:27:36 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:27:36 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:27:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:27:36 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:27:36 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:27:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:27:36 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:27:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.002
[INFO] - 03-16 19:27:41 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.003
[INFO] - 03-16 19:27:41 - [main.summary_metrics:168]: Epoch 76/300 - Test Results:
{'auc': 0.6461506158280923,
 'f1': 0.13749395258829222,
 'loss': 0.6427649547608895,
 'ndcg': 0.40220759155493985,
 'precision': 0.20566037735849055,
 'recall': 0.10330188679245282}
[INFO] - 03-16 19:27:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[76] Complete. Time taken: 00:00:56.316
[INFO] - 03-16 19:27:41 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:27:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:27:41 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:27:41 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:27:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:27:42 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7231, 5008, 5140]
[INFO] - 03-16 19:27:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:27:49 - [main.backward:225]: Epoch 77/300 - Iteration 26/199 - Time 0.308 batch, 0.083 data, 0.276 forward
[INFO] - 03-16 19:27:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0200 (0.0172)
[INFO] - 03-16 19:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6160 (0.5952)
[INFO] - 03-16 19:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4144 (-140.4695)
[INFO] - 03-16 19:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.5205 (26.4041)
[INFO] - 03-16 19:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 256.7624 (258.4923)
[INFO] - 03-16 19:27:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.7094)
[INFO] - 03-16 19:28:02 - [main.backward:225]: Epoch 77/300 - Iteration 76/199 - Time 0.274 batch, 0.050 data, 0.242 forward
[INFO] - 03-16 19:28:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0181 (0.0167)
[INFO] - 03-16 19:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5729 (0.5901)
[INFO] - 03-16 19:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4520 (-140.4738)
[INFO] - 03-16 19:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.9805 (26.3301)
[INFO] - 03-16 19:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.1063 (256.6562)
[INFO] - 03-16 19:28:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.7328)
[INFO] - 03-16 19:28:15 - [main.backward:225]: Epoch 77/300 - Iteration 126/199 - Time 0.267 batch, 0.043 data, 0.235 forward
[INFO] - 03-16 19:28:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:28:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0174)
[INFO] - 03-16 19:28:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6031 (0.5903)
[INFO] - 03-16 19:28:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5025 (-140.4916)
[INFO] - 03-16 19:28:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.2368 (26.1865)
[INFO] - 03-16 19:28:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 256.9714 (257.2088)
[INFO] - 03-16 19:28:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:28:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6250 (0.7048)
[INFO] - 03-16 19:28:28 - [main.backward:225]: Epoch 77/300 - Iteration 176/199 - Time 0.264 batch, 0.040 data, 0.232 forward
[INFO] - 03-16 19:28:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0184 (0.0193)
[INFO] - 03-16 19:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5822 (0.5975)
[INFO] - 03-16 19:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5266 (-140.5126)
[INFO] - 03-16 19:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.3292 (26.3162)
[INFO] - 03-16 19:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 258.1615 (257.1932)
[INFO] - 03-16 19:28:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.6566)
[INFO] - 03-16 19:28:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:28:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:28:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:28:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:28:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:28:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:28:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:28:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.681
[INFO] - 03-16 19:28:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.681
[INFO] - 03-16 19:28:39 - [main.summary_metrics:168]: Epoch 77/300 - Test Results:
{'auc': 0.6436228380503144,
 'f1': 0.1324625060474117,
 'loss': 0.6422445534200287,
 'ndcg': 0.39825901557684795,
 'precision': 0.19811320754716977,
 'recall': 0.09952830188679244}
[INFO] - 03-16 19:28:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[77] Complete. Time taken: 00:00:57.072
[INFO] - 03-16 19:28:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:28:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:28:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:28:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:28:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:28:39 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7251, 4966, 5125]
[INFO] - 03-16 19:28:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:28:47 - [main.backward:225]: Epoch 78/300 - Iteration 27/199 - Time 0.313 batch, 0.089 data, 0.281 forward
[INFO] - 03-16 19:28:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0170)
[INFO] - 03-16 19:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6165 (0.5955)
[INFO] - 03-16 19:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4217 (-140.4653)
[INFO] - 03-16 19:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.3874 (26.4909)
[INFO] - 03-16 19:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 258.4552 (258.1759)
[INFO] - 03-16 19:28:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.7257)
[INFO] - 03-16 19:28:59 - [main.backward:225]: Epoch 78/300 - Iteration 77/199 - Time 0.271 batch, 0.051 data, 0.240 forward
[INFO] - 03-16 19:28:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0176 (0.0165)
[INFO] - 03-16 19:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5875 (0.5896)
[INFO] - 03-16 19:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4510 (-140.4684)
[INFO] - 03-16 19:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.2149 (26.3676)
[INFO] - 03-16 19:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 258.2121 (257.6945)
[INFO] - 03-16 19:28:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.7375)
[INFO] - 03-16 19:29:12 - [main.backward:225]: Epoch 78/300 - Iteration 127/199 - Time 0.265 batch, 0.044 data, 0.234 forward
[INFO] - 03-16 19:29:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:29:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0175)
[INFO] - 03-16 19:29:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6054 (0.5925)
[INFO] - 03-16 19:29:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5130 (-140.4936)
[INFO] - 03-16 19:29:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.2534 (26.2131)
[INFO] - 03-16 19:29:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 255.7780 (256.6043)
[INFO] - 03-16 19:29:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:29:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5938 (0.7072)
[INFO] - 03-16 19:29:25 - [main.backward:225]: Epoch 78/300 - Iteration 177/199 - Time 0.262 batch, 0.040 data, 0.230 forward
[INFO] - 03-16 19:29:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:29:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0200 (0.0191)
[INFO] - 03-16 19:29:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6060 (0.6004)
[INFO] - 03-16 19:29:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4978 (-140.5135)
[INFO] - 03-16 19:29:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.2816 (26.2591)
[INFO] - 03-16 19:29:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 258.6107 (257.5975)
[INFO] - 03-16 19:29:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:29:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.6702)
[INFO] - 03-16 19:29:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:29:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:29:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:29:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:29:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:29:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:29:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:29:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.491
[INFO] - 03-16 19:29:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.493
[INFO] - 03-16 19:29:35 - [main.summary_metrics:168]: Epoch 78/300 - Test Results:
{'auc': 0.6444577109538785,
 'f1': 0.12617319787131107,
 'loss': 0.6422252922857832,
 'ndcg': 0.39913305556920314,
 'precision': 0.18867924528301888,
 'recall': 0.09481132075471697}
[INFO] - 03-16 19:29:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[78] Complete. Time taken: 00:00:56.560
[INFO] - 03-16 19:29:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:29:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:29:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:29:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:29:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:29:35 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7260, 5000, 5170]
[INFO] - 03-16 19:29:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:29:43 - [main.backward:225]: Epoch 79/300 - Iteration 28/199 - Time 0.269 batch, 0.064 data, 0.242 forward
[INFO] - 03-16 19:29:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0208 (0.0169)
[INFO] - 03-16 19:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6086 (0.5988)
[INFO] - 03-16 19:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4186 (-140.4637)
[INFO] - 03-16 19:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.3361 (26.3730)
[INFO] - 03-16 19:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 255.0727 (256.2946)
[INFO] - 03-16 19:29:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.7223)
[INFO] - 03-16 19:29:55 - [main.backward:225]: Epoch 79/300 - Iteration 78/199 - Time 0.253 batch, 0.043 data, 0.224 forward
[INFO] - 03-16 19:29:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:29:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0187 (0.0167)
[INFO] - 03-16 19:29:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5870)
[INFO] - 03-16 19:29:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4529 (-140.4709)
[INFO] - 03-16 19:29:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.0215 (26.1804)
[INFO] - 03-16 19:29:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 255.4215 (254.1385)
[INFO] - 03-16 19:29:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:29:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.7338)
[INFO] - 03-16 19:30:08 - [main.backward:225]: Epoch 79/300 - Iteration 128/199 - Time 0.254 batch, 0.039 data, 0.223 forward
[INFO] - 03-16 19:30:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0185 (0.0179)
[INFO] - 03-16 19:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6108 (0.5927)
[INFO] - 03-16 19:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4997 (-140.4911)
[INFO] - 03-16 19:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.2083 (26.2070)
[INFO] - 03-16 19:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 253.2561 (254.6546)
[INFO] - 03-16 19:30:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.6937)
[INFO] - 03-16 19:30:20 - [main.backward:225]: Epoch 79/300 - Iteration 178/199 - Time 0.251 batch, 0.037 data, 0.220 forward
[INFO] - 03-16 19:30:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:30:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0180 (0.0188)
[INFO] - 03-16 19:30:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6264 (0.5997)
[INFO] - 03-16 19:30:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4920 (-140.5100)
[INFO] - 03-16 19:30:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.1934 (26.1877)
[INFO] - 03-16 19:30:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.3963 (255.4758)
[INFO] - 03-16 19:30:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:30:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.6773)
[INFO] - 03-16 19:30:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:30:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:30:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:30:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:30:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:30:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:30:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:30:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.370
[INFO] - 03-16 19:30:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.371
[INFO] - 03-16 19:30:29 - [main.summary_metrics:168]: Epoch 79/300 - Test Results:
{'auc': 0.6509796580188678,
 'f1': 0.1274310595065312,
 'loss': 0.6397008808783763,
 'ndcg': 0.404111159407219,
 'precision': 0.19056603773584904,
 'recall': 0.09575471698113208}
[INFO] - 03-16 19:30:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[79] Complete. Time taken: 00:00:54.226
[INFO] - 03-16 19:30:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:30:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:30:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:30:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:30:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:30:29 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7257, 5010, 5126]
[INFO] - 03-16 19:30:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:30:38 - [main.backward:225]: Epoch 80/300 - Iteration 29/199 - Time 0.285 batch, 0.070 data, 0.252 forward
[INFO] - 03-16 19:30:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:30:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0180 (0.0173)
[INFO] - 03-16 19:30:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6126 (0.5957)
[INFO] - 03-16 19:30:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4341 (-140.4612)
[INFO] - 03-16 19:30:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.0668 (26.2992)
[INFO] - 03-16 19:30:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 254.7731 (256.1225)
[INFO] - 03-16 19:30:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:30:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.7160)
[INFO] - 03-16 19:30:49 - [main.backward:225]: Epoch 80/300 - Iteration 79/199 - Time 0.254 batch, 0.044 data, 0.224 forward
[INFO] - 03-16 19:30:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0152 (0.0164)
[INFO] - 03-16 19:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6059 (0.5886)
[INFO] - 03-16 19:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4353 (-140.4751)
[INFO] - 03-16 19:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.8990 (26.0808)
[INFO] - 03-16 19:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 255.5992 (254.5854)
[INFO] - 03-16 19:30:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8047 (0.7438)
[INFO] - 03-16 19:31:01 - [main.backward:225]: Epoch 80/300 - Iteration 129/199 - Time 0.247 batch, 0.038 data, 0.218 forward
[INFO] - 03-16 19:31:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:31:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0170 (0.0177)
[INFO] - 03-16 19:31:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6203 (0.5946)
[INFO] - 03-16 19:31:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4918 (-140.4895)
[INFO] - 03-16 19:31:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.0200 (26.0299)
[INFO] - 03-16 19:31:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 253.1650 (254.2924)
[INFO] - 03-16 19:31:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:31:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7891 (0.7052)
[INFO] - 03-16 19:31:13 - [main.backward:225]: Epoch 80/300 - Iteration 179/199 - Time 0.247 batch, 0.036 data, 0.217 forward
[INFO] - 03-16 19:31:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0153 (0.0188)
[INFO] - 03-16 19:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6222 (0.6013)
[INFO] - 03-16 19:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4915 (-140.5087)
[INFO] - 03-16 19:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.1522 (25.9476)
[INFO] - 03-16 19:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.9927 (256.5350)
[INFO] - 03-16 19:31:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.6777)
[INFO] - 03-16 19:31:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:31:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:31:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:31:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:31:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:31:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:31:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:31:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.483
[INFO] - 03-16 19:31:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.486
[INFO] - 03-16 19:31:23 - [main.summary_metrics:168]: Epoch 80/300 - Test Results:
{'auc': 0.6416932979559747,
 'f1': 0.13497822931785197,
 'loss': 0.6419178959748529,
 'ndcg': 0.4012817390968514,
 'precision': 0.20188679245283017,
 'recall': 0.10141509433962262}
[INFO] - 03-16 19:31:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[80] Complete. Time taken: 00:00:53.621
[INFO] - 03-16 19:31:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:31:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:31:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:31:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:31:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:31:23 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7234, 4985, 5140]
[INFO] - 03-16 19:31:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:31:32 - [main.backward:225]: Epoch 81/300 - Iteration 30/199 - Time 0.293 batch, 0.077 data, 0.263 forward
[INFO] - 03-16 19:31:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0166 (0.0167)
[INFO] - 03-16 19:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6254 (0.5983)
[INFO] - 03-16 19:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4174 (-140.4548)
[INFO] - 03-16 19:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.8865 (26.1972)
[INFO] - 03-16 19:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 252.8031 (255.1053)
[INFO] - 03-16 19:31:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.7300)
[INFO] - 03-16 19:31:44 - [main.backward:225]: Epoch 81/300 - Iteration 80/199 - Time 0.266 batch, 0.049 data, 0.235 forward
[INFO] - 03-16 19:31:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:31:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0160)
[INFO] - 03-16 19:31:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6027 (0.5881)
[INFO] - 03-16 19:31:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3643 (-140.4741)
[INFO] - 03-16 19:31:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.8853 (25.9544)
[INFO] - 03-16 19:31:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 255.8520 (254.1134)
[INFO] - 03-16 19:31:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:31:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.7562)
[INFO] - 03-16 19:31:57 - [main.backward:225]: Epoch 81/300 - Iteration 130/199 - Time 0.259 batch, 0.043 data, 0.227 forward
[INFO] - 03-16 19:31:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:31:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0164 (0.0176)
[INFO] - 03-16 19:31:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6061 (0.5937)
[INFO] - 03-16 19:31:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4933 (-140.4913)
[INFO] - 03-16 19:31:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.2494 (26.1549)
[INFO] - 03-16 19:31:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 253.3836 (253.7886)
[INFO] - 03-16 19:31:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:31:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7656 (0.7081)
[INFO] - 03-16 19:32:09 - [main.backward:225]: Epoch 81/300 - Iteration 180/199 - Time 0.256 batch, 0.039 data, 0.224 forward
[INFO] - 03-16 19:32:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0183 (0.0192)
[INFO] - 03-16 19:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6189 (0.5987)
[INFO] - 03-16 19:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4636 (-140.5047)
[INFO] - 03-16 19:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.0526 (26.1085)
[INFO] - 03-16 19:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 257.8561 (256.3601)
[INFO] - 03-16 19:32:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.6572)
[INFO] - 03-16 19:32:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:32:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:32:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:32:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:32:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:32:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:32:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:32:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.616
[INFO] - 03-16 19:32:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.617
[INFO] - 03-16 19:32:18 - [main.summary_metrics:168]: Epoch 81/300 - Test Results:
{'auc': 0.6513121724318659,
 'f1': 0.12868892114175132,
 'loss': 0.6378636563778924,
 'ndcg': 0.4069433435406163,
 'precision': 0.19245283018867923,
 'recall': 0.09669811320754718}
[INFO] - 03-16 19:32:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[81] Complete. Time taken: 00:00:55.420
[INFO] - 03-16 19:32:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:32:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:32:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:32:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:32:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:32:18 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7238, 5002, 5128]
[INFO] - 03-16 19:32:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:32:28 - [main.backward:225]: Epoch 82/300 - Iteration 31/199 - Time 0.324 batch, 0.077 data, 0.288 forward
[INFO] - 03-16 19:32:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:32:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0208 (0.0165)
[INFO] - 03-16 19:32:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5524 (0.5966)
[INFO] - 03-16 19:32:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4401 (-140.4522)
[INFO] - 03-16 19:32:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.9538 (26.2087)
[INFO] - 03-16 19:32:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 254.0938 (255.6058)
[INFO] - 03-16 19:32:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:32:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.7336)
[INFO] - 03-16 19:32:42 - [main.backward:225]: Epoch 82/300 - Iteration 81/199 - Time 0.292 batch, 0.051 data, 0.257 forward
[INFO] - 03-16 19:32:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0138 (0.0163)
[INFO] - 03-16 19:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6225 (0.5896)
[INFO] - 03-16 19:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3477 (-140.4734)
[INFO] - 03-16 19:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.8023 (26.0402)
[INFO] - 03-16 19:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 254.8076 (253.1047)
[INFO] - 03-16 19:32:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7969 (0.7478)
[INFO] - 03-16 19:32:56 - [main.backward:225]: Epoch 82/300 - Iteration 131/199 - Time 0.287 batch, 0.044 data, 0.253 forward
[INFO] - 03-16 19:32:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:32:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0156 (0.0173)
[INFO] - 03-16 19:32:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6182 (0.5941)
[INFO] - 03-16 19:32:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4605 (-140.4906)
[INFO] - 03-16 19:32:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.0007 (25.8842)
[INFO] - 03-16 19:32:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 250.8665 (252.4743)
[INFO] - 03-16 19:32:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:32:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.7141)
[INFO] - 03-16 19:33:11 - [main.backward:225]: Epoch 82/300 - Iteration 181/199 - Time 0.288 batch, 0.042 data, 0.254 forward
[INFO] - 03-16 19:33:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:33:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0154 (0.0185)
[INFO] - 03-16 19:33:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6065 (0.5997)
[INFO] - 03-16 19:33:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4551 (-140.4999)
[INFO] - 03-16 19:33:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 26.0665 (25.9704)
[INFO] - 03-16 19:33:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 254.5589 (254.0676)
[INFO] - 03-16 19:33:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:33:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8125 (0.6800)
[INFO] - 03-16 19:33:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:33:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:33:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:33:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:33:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:33:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:33:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:33:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.989
[INFO] - 03-16 19:33:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.989
[INFO] - 03-16 19:33:21 - [main.summary_metrics:168]: Epoch 82/300 - Test Results:
{'auc': 0.6417526205450735,
 'f1': 0.13774552491533623,
 'loss': 0.6420867674325746,
 'ndcg': 0.39985970691383443,
 'precision': 0.20566037735849058,
 'recall': 0.10361635220125787}
[INFO] - 03-16 19:33:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[82] Complete. Time taken: 00:01:02.593
[INFO] - 03-16 19:33:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:33:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:33:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:33:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:33:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:33:21 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7264, 4977, 5120]
[INFO] - 03-16 19:33:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:33:31 - [main.backward:225]: Epoch 83/300 - Iteration 32/199 - Time 0.327 batch, 0.080 data, 0.293 forward
[INFO] - 03-16 19:33:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:33:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0189 (0.0165)
[INFO] - 03-16 19:33:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5720 (0.5955)
[INFO] - 03-16 19:33:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4282 (-140.4532)
[INFO] - 03-16 19:33:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.8200 (25.9993)
[INFO] - 03-16 19:33:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 252.5646 (253.3999)
[INFO] - 03-16 19:33:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:33:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.7337)
[INFO] - 03-16 19:33:46 - [main.backward:225]: Epoch 83/300 - Iteration 82/199 - Time 0.302 batch, 0.051 data, 0.269 forward
[INFO] - 03-16 19:33:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:33:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0173 (0.0160)
[INFO] - 03-16 19:33:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6216 (0.5887)
[INFO] - 03-16 19:33:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3596 (-140.4685)
[INFO] - 03-16 19:33:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.7902 (25.8289)
[INFO] - 03-16 19:33:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 253.2288 (253.1053)
[INFO] - 03-16 19:33:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:33:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.7497)
[INFO] - 03-16 19:33:59 - [main.backward:225]: Epoch 83/300 - Iteration 132/199 - Time 0.292 batch, 0.045 data, 0.257 forward
[INFO] - 03-16 19:33:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0199 (0.0176)
[INFO] - 03-16 19:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6105 (0.5926)
[INFO] - 03-16 19:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4850 (-140.4939)
[INFO] - 03-16 19:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4518 (25.7210)
[INFO] - 03-16 19:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 250.4218 (250.3696)
[INFO] - 03-16 19:33:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6250 (0.7042)
[INFO] - 03-16 19:34:13 - [main.backward:225]: Epoch 83/300 - Iteration 182/199 - Time 0.285 batch, 0.042 data, 0.251 forward
[INFO] - 03-16 19:34:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:34:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0181 (0.0189)
[INFO] - 03-16 19:34:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6106 (0.6005)
[INFO] - 03-16 19:34:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4499 (-140.4918)
[INFO] - 03-16 19:34:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.5782 (25.5112)
[INFO] - 03-16 19:34:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 255.2396 (254.0487)
[INFO] - 03-16 19:34:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:34:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.6714)
[INFO] - 03-16 19:34:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:34:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:34:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:34:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:34:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:34:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:34:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:34:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.860
[INFO] - 03-16 19:34:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.860
[INFO] - 03-16 19:34:22 - [main.summary_metrics:168]: Epoch 83/300 - Test Results:
{'auc': 0.652103020178197,
 'f1': 0.12849540396710207,
 'loss': 0.6380930812283881,
 'ndcg': 0.4095191113098823,
 'precision': 0.19245283018867926,
 'recall': 0.09646226415094339}
[INFO] - 03-16 19:34:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[83] Complete. Time taken: 00:01:01.297
[INFO] - 03-16 19:34:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:34:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:34:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:34:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:34:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:34:22 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7241, 4960, 5118]
[INFO] - 03-16 19:34:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:34:33 - [main.backward:225]: Epoch 84/300 - Iteration 33/199 - Time 0.322 batch, 0.079 data, 0.289 forward
[INFO] - 03-16 19:34:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0164 (0.0169)
[INFO] - 03-16 19:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5868 (0.5939)
[INFO] - 03-16 19:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4288 (-140.4519)
[INFO] - 03-16 19:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.7044 (25.6916)
[INFO] - 03-16 19:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 253.1925 (254.1308)
[INFO] - 03-16 19:34:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:34:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7422 (0.7184)
[INFO] - 03-16 19:34:47 - [main.backward:225]: Epoch 84/300 - Iteration 83/199 - Time 0.292 batch, 0.051 data, 0.260 forward
[INFO] - 03-16 19:34:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:34:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0179 (0.0161)
[INFO] - 03-16 19:34:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6133 (0.5909)
[INFO] - 03-16 19:34:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3678 (-140.4638)
[INFO] - 03-16 19:34:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.6477 (25.6236)
[INFO] - 03-16 19:34:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 252.6228 (252.2103)
[INFO] - 03-16 19:34:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:34:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.7480)
[INFO] - 03-16 19:35:00 - [main.backward:225]: Epoch 84/300 - Iteration 133/199 - Time 0.286 batch, 0.044 data, 0.254 forward
[INFO] - 03-16 19:35:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0173)
[INFO] - 03-16 19:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5948 (0.5917)
[INFO] - 03-16 19:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4710 (-140.4948)
[INFO] - 03-16 19:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.7727 (25.7168)
[INFO] - 03-16 19:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 249.7235 (250.9745)
[INFO] - 03-16 19:35:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.7150)
[INFO] - 03-16 19:35:14 - [main.backward:225]: Epoch 84/300 - Iteration 183/199 - Time 0.281 batch, 0.041 data, 0.248 forward
[INFO] - 03-16 19:35:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0143 (0.0184)
[INFO] - 03-16 19:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6087 (0.5978)
[INFO] - 03-16 19:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4601 (-140.4905)
[INFO] - 03-16 19:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.7096 (25.6595)
[INFO] - 03-16 19:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 253.1133 (252.5587)
[INFO] - 03-16 19:35:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8047 (0.6958)
[INFO] - 03-16 19:35:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:35:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:35:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:35:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:35:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:35:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:35:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:35:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.941
[INFO] - 03-16 19:35:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.942
[INFO] - 03-16 19:35:23 - [main.summary_metrics:168]: Epoch 84/300 - Test Results:
{'auc': 0.6517781381027253,
 'f1': 0.14378326076439282,
 'loss': 0.6381264756320657,
 'ndcg': 0.4112029088353856,
 'precision': 0.2150943396226415,
 'recall': 0.10801886792452829}
[INFO] - 03-16 19:35:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[84] Complete. Time taken: 00:01:01.103
[INFO] - 03-16 19:35:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:35:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:35:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:35:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:35:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:35:23 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 4965, 5110]
[INFO] - 03-16 19:35:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:35:34 - [main.backward:225]: Epoch 85/300 - Iteration 34/199 - Time 0.318 batch, 0.074 data, 0.286 forward
[INFO] - 03-16 19:35:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0184 (0.0166)
[INFO] - 03-16 19:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5935)
[INFO] - 03-16 19:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4357 (-140.4502)
[INFO] - 03-16 19:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.7695 (25.7970)
[INFO] - 03-16 19:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 252.6343 (253.0987)
[INFO] - 03-16 19:35:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7031 (0.7304)
[INFO] - 03-16 19:35:48 - [main.backward:225]: Epoch 85/300 - Iteration 84/199 - Time 0.292 batch, 0.049 data, 0.259 forward
[INFO] - 03-16 19:35:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:35:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0164 (0.0159)
[INFO] - 03-16 19:35:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6214 (0.5903)
[INFO] - 03-16 19:35:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3683 (-140.4590)
[INFO] - 03-16 19:35:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.7561 (25.8323)
[INFO] - 03-16 19:35:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 253.1452 (251.9763)
[INFO] - 03-16 19:35:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:35:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.7522)
[INFO] - 03-16 19:36:01 - [main.backward:225]: Epoch 85/300 - Iteration 134/199 - Time 0.284 batch, 0.043 data, 0.251 forward
[INFO] - 03-16 19:36:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:36:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0239 (0.0172)
[INFO] - 03-16 19:36:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6036 (0.5929)
[INFO] - 03-16 19:36:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4743 (-140.4988)
[INFO] - 03-16 19:36:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.6422 (25.7975)
[INFO] - 03-16 19:36:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 248.3727 (250.3270)
[INFO] - 03-16 19:36:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:36:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5312 (0.7198)
[INFO] - 03-16 19:36:15 - [main.backward:225]: Epoch 85/300 - Iteration 184/199 - Time 0.280 batch, 0.040 data, 0.248 forward
[INFO] - 03-16 19:36:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:36:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0167 (0.0182)
[INFO] - 03-16 19:36:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6024 (0.5995)
[INFO] - 03-16 19:36:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4671 (-140.4936)
[INFO] - 03-16 19:36:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4615 (25.5133)
[INFO] - 03-16 19:36:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 248.6810 (250.2842)
[INFO] - 03-16 19:36:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:36:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.6917)
[INFO] - 03-16 19:36:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:36:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:36:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:36:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:36:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:36:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:36:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:36:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.612
[INFO] - 03-16 19:36:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.614
[INFO] - 03-16 19:36:24 - [main.summary_metrics:168]: Epoch 85/300 - Test Results:
{'auc': 0.6660221763626835,
 'f1': 0.14000967585873247,
 'loss': 0.6320728262135569,
 'ndcg': 0.4198907328132945,
 'precision': 0.20943396226415098,
 'recall': 0.10518867924528302}
[INFO] - 03-16 19:36:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[85] Complete. Time taken: 00:01:00.281
[INFO] - 03-16 19:36:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:36:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:36:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:36:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:36:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:36:24 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7260, 4994, 5150]
[INFO] - 03-16 19:36:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:36:35 - [main.backward:225]: Epoch 86/300 - Iteration 35/199 - Time 0.312 batch, 0.076 data, 0.280 forward
[INFO] - 03-16 19:36:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:36:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0197 (0.0166)
[INFO] - 03-16 19:36:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6045 (0.5924)
[INFO] - 03-16 19:36:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4356 (-140.4455)
[INFO] - 03-16 19:36:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.5394 (25.5774)
[INFO] - 03-16 19:36:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 250.4686 (250.6192)
[INFO] - 03-16 19:36:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:36:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6250 (0.7276)
[INFO] - 03-16 19:36:48 - [main.backward:225]: Epoch 86/300 - Iteration 85/199 - Time 0.290 batch, 0.050 data, 0.258 forward
[INFO] - 03-16 19:36:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0173 (0.0162)
[INFO] - 03-16 19:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6071 (0.5899)
[INFO] - 03-16 19:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3746 (-140.4523)
[INFO] - 03-16 19:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4969 (25.4888)
[INFO] - 03-16 19:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 251.0554 (249.9038)
[INFO] - 03-16 19:36:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.7480)
[INFO] - 03-16 19:37:02 - [main.backward:225]: Epoch 86/300 - Iteration 135/199 - Time 0.284 batch, 0.043 data, 0.252 forward
[INFO] - 03-16 19:37:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0172)
[INFO] - 03-16 19:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5998 (0.5898)
[INFO] - 03-16 19:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4738 (-140.5017)
[INFO] - 03-16 19:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4911 (25.5398)
[INFO] - 03-16 19:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 248.8839 (249.1084)
[INFO] - 03-16 19:37:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:37:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5703 (0.7119)
[INFO] - 03-16 19:37:16 - [main.backward:225]: Epoch 86/300 - Iteration 185/199 - Time 0.282 batch, 0.040 data, 0.250 forward
[INFO] - 03-16 19:37:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0190 (0.0182)
[INFO] - 03-16 19:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6032 (0.6010)
[INFO] - 03-16 19:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4354 (-140.4883)
[INFO] - 03-16 19:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4338 (25.4812)
[INFO] - 03-16 19:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 249.6457 (250.8492)
[INFO] - 03-16 19:37:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6484 (0.6916)
[INFO] - 03-16 19:37:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:37:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:37:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:37:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:37:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:37:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:37:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:37:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.077
[INFO] - 03-16 19:37:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.078
[INFO] - 03-16 19:37:25 - [main.summary_metrics:168]: Epoch 86/300 - Test Results:
{'auc': 0.657795302672956,
 'f1': 0.14000967585873247,
 'loss': 0.6370614525017249,
 'ndcg': 0.4218881679521719,
 'precision': 0.20943396226415092,
 'recall': 0.10518867924528302}
[INFO] - 03-16 19:37:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[86] Complete. Time taken: 00:01:01.027
[INFO] - 03-16 19:37:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:37:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:37:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:37:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:37:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:37:25 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7242, 4970, 5116]
[INFO] - 03-16 19:37:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:37:36 - [main.backward:225]: Epoch 87/300 - Iteration 36/199 - Time 0.310 batch, 0.068 data, 0.279 forward
[INFO] - 03-16 19:37:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:37:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0154 (0.0170)
[INFO] - 03-16 19:37:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6123 (0.5917)
[INFO] - 03-16 19:37:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4182 (-140.4444)
[INFO] - 03-16 19:37:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.7171 (25.6330)
[INFO] - 03-16 19:37:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 250.7472 (250.6570)
[INFO] - 03-16 19:37:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:37:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.7197)
[INFO] - 03-16 19:37:49 - [main.backward:225]: Epoch 87/300 - Iteration 86/199 - Time 0.282 batch, 0.048 data, 0.250 forward
[INFO] - 03-16 19:37:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:37:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0166 (0.0165)
[INFO] - 03-16 19:37:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6070 (0.5919)
[INFO] - 03-16 19:37:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3658 (-140.4527)
[INFO] - 03-16 19:37:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.5794 (25.6641)
[INFO] - 03-16 19:37:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 252.2390 (250.8115)
[INFO] - 03-16 19:37:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:37:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.7447)
[INFO] - 03-16 19:38:02 - [main.backward:225]: Epoch 87/300 - Iteration 136/199 - Time 0.276 batch, 0.042 data, 0.244 forward
[INFO] - 03-16 19:38:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0223 (0.0178)
[INFO] - 03-16 19:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6250 (0.5905)
[INFO] - 03-16 19:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3386 (-140.4970)
[INFO] - 03-16 19:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4283 (25.6456)
[INFO] - 03-16 19:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 249.3024 (249.6605)
[INFO] - 03-16 19:38:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5234 (0.6970)
[INFO] - 03-16 19:38:16 - [main.backward:225]: Epoch 87/300 - Iteration 186/199 - Time 0.276 batch, 0.039 data, 0.244 forward
[INFO] - 03-16 19:38:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:38:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0168 (0.0182)
[INFO] - 03-16 19:38:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6197 (0.5986)
[INFO] - 03-16 19:38:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4192 (-140.4908)
[INFO] - 03-16 19:38:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4746 (25.3719)
[INFO] - 03-16 19:38:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 251.8871 (251.1808)
[INFO] - 03-16 19:38:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:38:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7500 (0.6914)
[INFO] - 03-16 19:38:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:38:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:38:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:38:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:38:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:38:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:38:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:38:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.939
[INFO] - 03-16 19:38:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.939
[INFO] - 03-16 19:38:25 - [main.summary_metrics:168]: Epoch 87/300 - Test Results:
{'auc': 0.6651057717505241,
 'f1': 0.14378326076439285,
 'loss': 0.6328724125236334,
 'ndcg': 0.4194947995854057,
 'precision': 0.21509433962264152,
 'recall': 0.10801886792452829}
[INFO] - 03-16 19:38:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[87] Complete. Time taken: 00:00:59.952
[INFO] - 03-16 19:38:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:38:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:38:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:38:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:38:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:38:25 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7234, 4998, 5150]
[INFO] - 03-16 19:38:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:38:36 - [main.backward:225]: Epoch 88/300 - Iteration 37/199 - Time 0.320 batch, 0.072 data, 0.288 forward
[INFO] - 03-16 19:38:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0180 (0.0165)
[INFO] - 03-16 19:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6059 (0.5941)
[INFO] - 03-16 19:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4030 (-140.4390)
[INFO] - 03-16 19:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4692 (25.4801)
[INFO] - 03-16 19:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 249.8161 (250.0357)
[INFO] - 03-16 19:38:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.7357)
[INFO] - 03-16 19:38:51 - [main.backward:225]: Epoch 88/300 - Iteration 87/199 - Time 0.301 batch, 0.051 data, 0.267 forward
[INFO] - 03-16 19:38:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:38:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0189 (0.0163)
[INFO] - 03-16 19:38:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5777 (0.5889)
[INFO] - 03-16 19:38:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4831 (-140.4584)
[INFO] - 03-16 19:38:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4675 (25.3706)
[INFO] - 03-16 19:38:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 248.6116 (248.9854)
[INFO] - 03-16 19:38:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:38:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.7461)
[INFO] - 03-16 19:39:05 - [main.backward:225]: Epoch 88/300 - Iteration 137/199 - Time 0.291 batch, 0.045 data, 0.257 forward
[INFO] - 03-16 19:39:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:39:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0220 (0.0178)
[INFO] - 03-16 19:39:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6141 (0.5908)
[INFO] - 03-16 19:39:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3384 (-140.4918)
[INFO] - 03-16 19:39:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.2675 (25.3981)
[INFO] - 03-16 19:39:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 245.7235 (246.5023)
[INFO] - 03-16 19:39:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:39:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5391 (0.6981)
[INFO] - 03-16 19:39:18 - [main.backward:225]: Epoch 88/300 - Iteration 187/199 - Time 0.287 batch, 0.041 data, 0.254 forward
[INFO] - 03-16 19:39:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:39:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0197 (0.0183)
[INFO] - 03-16 19:39:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6023 (0.5990)
[INFO] - 03-16 19:39:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4286 (-140.4908)
[INFO] - 03-16 19:39:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4495 (25.3854)
[INFO] - 03-16 19:39:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 251.2990 (249.5421)
[INFO] - 03-16 19:39:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:39:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.6894)
[INFO] - 03-16 19:39:22 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:39:22 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:39:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:39:22 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:39:22 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:39:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:39:22 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:39:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.993
[INFO] - 03-16 19:39:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.994
[INFO] - 03-16 19:39:27 - [main.summary_metrics:168]: Epoch 88/300 - Test Results:
{'auc': 0.6577117727987422,
 'f1': 0.13372036768263185,
 'loss': 0.6393204768198842,
 'ndcg': 0.41555121795601024,
 'precision': 0.20000000000000004,
 'recall': 0.10047169811320755}
[INFO] - 03-16 19:39:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[88] Complete. Time taken: 00:01:01.995
[INFO] - 03-16 19:39:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:39:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:39:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:39:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:39:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:39:27 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7250, 4982, 5114]
[INFO] - 03-16 19:39:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:39:40 - [main.backward:225]: Epoch 89/300 - Iteration 38/199 - Time 0.339 batch, 0.083 data, 0.302 forward
[INFO] - 03-16 19:39:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:39:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0187 (0.0166)
[INFO] - 03-16 19:39:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6118 (0.5937)
[INFO] - 03-16 19:39:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4428 (-140.4417)
[INFO] - 03-16 19:39:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.5175 (25.4552)
[INFO] - 03-16 19:39:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 248.2826 (249.8998)
[INFO] - 03-16 19:39:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:39:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6797 (0.7341)
[INFO] - 03-16 19:39:53 - [main.backward:225]: Epoch 89/300 - Iteration 88/199 - Time 0.301 batch, 0.057 data, 0.264 forward
[INFO] - 03-16 19:39:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:39:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0191 (0.0160)
[INFO] - 03-16 19:39:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5717 (0.5912)
[INFO] - 03-16 19:39:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5294 (-140.4620)
[INFO] - 03-16 19:39:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.2803 (25.4070)
[INFO] - 03-16 19:39:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 249.5328 (248.1861)
[INFO] - 03-16 19:39:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:39:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.7570)
[INFO] - 03-16 19:40:07 - [main.backward:225]: Epoch 89/300 - Iteration 138/199 - Time 0.294 batch, 0.048 data, 0.258 forward
[INFO] - 03-16 19:40:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:40:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0220 (0.0173)
[INFO] - 03-16 19:40:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6178 (0.5914)
[INFO] - 03-16 19:40:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3382 (-140.4914)
[INFO] - 03-16 19:40:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1746 (25.3269)
[INFO] - 03-16 19:40:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.3707 (245.4960)
[INFO] - 03-16 19:40:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:40:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5000 (0.7119)
[INFO] - 03-16 19:40:21 - [main.backward:225]: Epoch 89/300 - Iteration 188/199 - Time 0.287 batch, 0.045 data, 0.252 forward
[INFO] - 03-16 19:40:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0177 (0.0179)
[INFO] - 03-16 19:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6088 (0.5997)
[INFO] - 03-16 19:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4175 (-140.4923)
[INFO] - 03-16 19:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.2378 (25.1851)
[INFO] - 03-16 19:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 247.4328 (248.1751)
[INFO] - 03-16 19:40:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.7063)
[INFO] - 03-16 19:40:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:40:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:40:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:40:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:40:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:40:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:40:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:40:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.921
[INFO] - 03-16 19:40:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.922
[INFO] - 03-16 19:40:29 - [main.summary_metrics:168]: Epoch 89/300 - Test Results:
{'auc': 0.658201487159329,
 'f1': 0.1425253991291727,
 'loss': 0.6341011401962185,
 'ndcg': 0.41186298211469635,
 'precision': 0.2132075471698113,
 'recall': 0.1070754716981132}
[INFO] - 03-16 19:40:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[89] Complete. Time taken: 00:01:02.146
[INFO] - 03-16 19:40:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:40:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:40:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:40:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:40:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:40:29 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7243, 4992, 5125]
[INFO] - 03-16 19:40:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:40:41 - [main.backward:225]: Epoch 90/300 - Iteration 39/199 - Time 0.319 batch, 0.071 data, 0.285 forward
[INFO] - 03-16 19:40:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0211 (0.0166)
[INFO] - 03-16 19:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6036 (0.5925)
[INFO] - 03-16 19:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4774 (-140.4431)
[INFO] - 03-16 19:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.3775 (25.2570)
[INFO] - 03-16 19:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 246.0110 (247.2445)
[INFO] - 03-16 19:40:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.7288)
[INFO] - 03-16 19:40:55 - [main.backward:225]: Epoch 90/300 - Iteration 89/199 - Time 0.298 batch, 0.051 data, 0.263 forward
[INFO] - 03-16 19:40:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:40:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0150 (0.0164)
[INFO] - 03-16 19:40:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5809 (0.5884)
[INFO] - 03-16 19:40:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5225 (-140.4592)
[INFO] - 03-16 19:40:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.5666 (25.4012)
[INFO] - 03-16 19:40:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 249.8944 (248.0694)
[INFO] - 03-16 19:40:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:40:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7656 (0.7448)
[INFO] - 03-16 19:41:09 - [main.backward:225]: Epoch 90/300 - Iteration 139/199 - Time 0.290 batch, 0.044 data, 0.257 forward
[INFO] - 03-16 19:41:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:41:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0182)
[INFO] - 03-16 19:41:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6043 (0.5907)
[INFO] - 03-16 19:41:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4075 (-140.4931)
[INFO] - 03-16 19:41:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1888 (25.3912)
[INFO] - 03-16 19:41:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.9298 (247.1081)
[INFO] - 03-16 19:41:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:41:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5781 (0.6866)
[INFO] - 03-16 19:41:23 - [main.backward:225]: Epoch 90/300 - Iteration 189/199 - Time 0.287 batch, 0.041 data, 0.254 forward
[INFO] - 03-16 19:41:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:41:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0155 (0.0178)
[INFO] - 03-16 19:41:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6086 (0.5985)
[INFO] - 03-16 19:41:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3981 (-140.4923)
[INFO] - 03-16 19:41:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.3468 (25.3432)
[INFO] - 03-16 19:41:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 248.1136 (247.5318)
[INFO] - 03-16 19:41:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:41:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.7039)
[INFO] - 03-16 19:41:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:41:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:41:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:41:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:41:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:41:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:41:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:41:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.862
[INFO] - 03-16 19:41:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.862
[INFO] - 03-16 19:41:31 - [main.summary_metrics:168]: Epoch 90/300 - Test Results:
{'auc': 0.6642760416666667,
 'f1': 0.15007256894049345,
 'loss': 0.6327674804383604,
 'ndcg': 0.42333578274505923,
 'precision': 0.22452830188679246,
 'recall': 0.11273584905660379}
[INFO] - 03-16 19:41:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[90] Complete. Time taken: 00:01:02.024
[INFO] - 03-16 19:41:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:41:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:41:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:41:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:41:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:41:31 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 4979, 5102]
[INFO] - 03-16 19:41:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:41:43 - [main.backward:225]: Epoch 91/300 - Iteration 40/199 - Time 0.303 batch, 0.073 data, 0.271 forward
[INFO] - 03-16 19:41:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:41:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0192 (0.0164)
[INFO] - 03-16 19:41:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5974 (0.5933)
[INFO] - 03-16 19:41:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4816 (-140.4416)
[INFO] - 03-16 19:41:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4340 (25.3949)
[INFO] - 03-16 19:41:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 245.3612 (247.3697)
[INFO] - 03-16 19:41:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:41:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.7342)
[INFO] - 03-16 19:41:57 - [main.backward:225]: Epoch 91/300 - Iteration 90/199 - Time 0.288 batch, 0.050 data, 0.256 forward
[INFO] - 03-16 19:41:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0156 (0.0157)
[INFO] - 03-16 19:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5712 (0.5906)
[INFO] - 03-16 19:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5083 (-140.4600)
[INFO] - 03-16 19:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.3040 (25.3320)
[INFO] - 03-16 19:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 245.0208 (246.0867)
[INFO] - 03-16 19:41:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.7625)
[INFO] - 03-16 19:42:11 - [main.backward:225]: Epoch 91/300 - Iteration 140/199 - Time 0.285 batch, 0.044 data, 0.253 forward
[INFO] - 03-16 19:42:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:42:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0173)
[INFO] - 03-16 19:42:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6019 (0.5914)
[INFO] - 03-16 19:42:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5405 (-140.4938)
[INFO] - 03-16 19:42:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.2939 (25.3085)
[INFO] - 03-16 19:42:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 245.4500 (245.5877)
[INFO] - 03-16 19:42:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:42:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5469 (0.7072)
[INFO] - 03-16 19:42:25 - [main.backward:225]: Epoch 91/300 - Iteration 190/199 - Time 0.284 batch, 0.041 data, 0.251 forward
[INFO] - 03-16 19:42:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:42:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0175 (0.0179)
[INFO] - 03-16 19:42:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6194 (0.5981)
[INFO] - 03-16 19:42:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3840 (-140.4896)
[INFO] - 03-16 19:42:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.2739 (25.2002)
[INFO] - 03-16 19:42:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 248.8011 (247.9446)
[INFO] - 03-16 19:42:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:42:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.7084)
[INFO] - 03-16 19:42:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:42:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:42:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:42:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:42:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:42:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:42:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:42:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.841
[INFO] - 03-16 19:42:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.842
[INFO] - 03-16 19:42:32 - [main.summary_metrics:168]: Epoch 91/300 - Test Results:
{'auc': 0.6604238076519917,
 'f1': 0.1465505563618771,
 'loss': 0.636060970858208,
 'ndcg': 0.42428363226993043,
 'precision': 0.21886792452830184,
 'recall': 0.11022012578616353}
[INFO] - 03-16 19:42:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[91] Complete. Time taken: 00:01:01.332
[INFO] - 03-16 19:42:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:42:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:42:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:42:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:42:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:42:32 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7262, 4988, 5111]
[INFO] - 03-16 19:42:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:42:45 - [main.backward:225]: Epoch 92/300 - Iteration 41/199 - Time 0.314 batch, 0.071 data, 0.282 forward
[INFO] - 03-16 19:42:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0176 (0.0167)
[INFO] - 03-16 19:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6021 (0.5925)
[INFO] - 03-16 19:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4802 (-140.4428)
[INFO] - 03-16 19:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.3386 (25.2266)
[INFO] - 03-16 19:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 246.1644 (248.2439)
[INFO] - 03-16 19:42:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.7242)
[INFO] - 03-16 19:42:58 - [main.backward:225]: Epoch 92/300 - Iteration 91/199 - Time 0.288 batch, 0.050 data, 0.255 forward
[INFO] - 03-16 19:42:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:42:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0187 (0.0159)
[INFO] - 03-16 19:42:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5829 (0.5899)
[INFO] - 03-16 19:42:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4684 (-140.4530)
[INFO] - 03-16 19:42:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.5187 (25.2683)
[INFO] - 03-16 19:42:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 247.4133 (245.7771)
[INFO] - 03-16 19:42:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:42:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.7578)
[INFO] - 03-16 19:43:13 - [main.backward:225]: Epoch 92/300 - Iteration 141/199 - Time 0.288 batch, 0.044 data, 0.255 forward
[INFO] - 03-16 19:43:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:43:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0201 (0.0176)
[INFO] - 03-16 19:43:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6001 (0.5908)
[INFO] - 03-16 19:43:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5296 (-140.4922)
[INFO] - 03-16 19:43:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.0872 (25.4415)
[INFO] - 03-16 19:43:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 245.1477 (245.9265)
[INFO] - 03-16 19:43:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:43:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.7020)
[INFO] - 03-16 19:43:27 - [main.backward:225]: Epoch 92/300 - Iteration 191/199 - Time 0.289 batch, 0.042 data, 0.255 forward
[INFO] - 03-16 19:43:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0161 (0.0178)
[INFO] - 03-16 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6128 (0.5949)
[INFO] - 03-16 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3484 (-140.4845)
[INFO] - 03-16 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.8860 (24.9646)
[INFO] - 03-16 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 247.8062 (247.2315)
[INFO] - 03-16 19:43:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.7033)
[INFO] - 03-16 19:43:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:43:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:43:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:43:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:43:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:43:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:43:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:43:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.038
[INFO] - 03-16 19:43:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.039
[INFO] - 03-16 19:43:35 - [main.summary_metrics:168]: Epoch 92/300 - Test Results:
{'auc': 0.680261923480084,
 'f1': 0.14649250120948235,
 'loss': 0.6267716153782619,
 'ndcg': 0.43830696782448286,
 'precision': 0.21886792452830192,
 'recall': 0.11014150943396227}
[INFO] - 03-16 19:43:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[92] Complete. Time taken: 00:01:02.536
[INFO] - 03-16 19:43:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:43:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:43:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:43:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:43:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:43:35 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7239, 4991, 5142]
[INFO] - 03-16 19:43:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:43:48 - [main.backward:225]: Epoch 93/300 - Iteration 42/199 - Time 0.324 batch, 0.063 data, 0.290 forward
[INFO] - 03-16 19:43:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:43:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0182 (0.0161)
[INFO] - 03-16 19:43:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5963 (0.5925)
[INFO] - 03-16 19:43:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4727 (-140.4443)
[INFO] - 03-16 19:43:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.9591 (25.0032)
[INFO] - 03-16 19:43:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 246.1697 (247.4850)
[INFO] - 03-16 19:43:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:43:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6719 (0.7554)
[INFO] - 03-16 19:44:03 - [main.backward:225]: Epoch 93/300 - Iteration 92/199 - Time 0.308 batch, 0.048 data, 0.274 forward
[INFO] - 03-16 19:44:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0179 (0.0157)
[INFO] - 03-16 19:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5832 (0.5874)
[INFO] - 03-16 19:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4666 (-140.4493)
[INFO] - 03-16 19:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.3604 (25.0909)
[INFO] - 03-16 19:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.8038 (245.7710)
[INFO] - 03-16 19:44:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.7697)
[INFO] - 03-16 19:44:17 - [main.backward:225]: Epoch 93/300 - Iteration 142/199 - Time 0.299 batch, 0.043 data, 0.264 forward
[INFO] - 03-16 19:44:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:44:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0176 (0.0167)
[INFO] - 03-16 19:44:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5994 (0.5903)
[INFO] - 03-16 19:44:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5250 (-140.4909)
[INFO] - 03-16 19:44:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.8688 (25.2775)
[INFO] - 03-16 19:44:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 243.8476 (243.4762)
[INFO] - 03-16 19:44:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:44:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.7350)
[INFO] - 03-16 19:44:32 - [main.backward:225]: Epoch 93/300 - Iteration 192/199 - Time 0.298 batch, 0.041 data, 0.263 forward
[INFO] - 03-16 19:44:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:44:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0136 (0.0170)
[INFO] - 03-16 19:44:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5832 (0.5959)
[INFO] - 03-16 19:44:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4593 (-140.4801)
[INFO] - 03-16 19:44:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.8501 (24.8385)
[INFO] - 03-16 19:44:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 248.8606 (246.4403)
[INFO] - 03-16 19:44:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:44:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.7367)
[INFO] - 03-16 19:44:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:44:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:44:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:44:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:44:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:44:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:44:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:44:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.295
[INFO] - 03-16 19:44:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.295
[INFO] - 03-16 19:44:39 - [main.summary_metrics:168]: Epoch 93/300 - Test Results:
{'auc': 0.6798715605345913,
 'f1': 0.15278180938558297,
 'loss': 0.6238802190216832,
 'ndcg': 0.4348866201901253,
 'precision': 0.22830188679245278,
 'recall': 0.11485849056603772}
[INFO] - 03-16 19:44:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[93] Complete. Time taken: 00:01:04.569
[INFO] - 03-16 19:44:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:44:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:44:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:44:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:44:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:44:39 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7244, 5023, 5138]
[INFO] - 03-16 19:44:41 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:44:53 - [main.backward:225]: Epoch 94/300 - Iteration 43/199 - Time 0.325 batch, 0.070 data, 0.292 forward
[INFO] - 03-16 19:44:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0166 (0.0155)
[INFO] - 03-16 19:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6007 (0.5932)
[INFO] - 03-16 19:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4751 (-140.4431)
[INFO] - 03-16 19:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.9845 (24.9135)
[INFO] - 03-16 19:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 249.0677 (248.6565)
[INFO] - 03-16 19:44:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7656 (0.7621)
[INFO] - 03-16 19:45:08 - [main.backward:225]: Epoch 94/300 - Iteration 93/199 - Time 0.307 batch, 0.051 data, 0.273 forward
[INFO] - 03-16 19:45:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:45:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0192 (0.0152)
[INFO] - 03-16 19:45:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5925 (0.5887)
[INFO] - 03-16 19:45:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4689 (-140.4489)
[INFO] - 03-16 19:45:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.0873 (25.0652)
[INFO] - 03-16 19:45:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 246.5350 (247.1961)
[INFO] - 03-16 19:45:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:45:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.7759)
[INFO] - 03-16 19:45:22 - [main.backward:225]: Epoch 94/300 - Iteration 143/199 - Time 0.302 batch, 0.045 data, 0.268 forward
[INFO] - 03-16 19:45:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:45:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0184 (0.0171)
[INFO] - 03-16 19:45:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6095 (0.5905)
[INFO] - 03-16 19:45:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4559 (-140.4877)
[INFO] - 03-16 19:45:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1011 (25.0744)
[INFO] - 03-16 19:45:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 246.9671 (245.6813)
[INFO] - 03-16 19:45:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:45:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.7228)
[INFO] - 03-16 19:45:36 - [main.backward:225]: Epoch 94/300 - Iteration 193/199 - Time 0.294 batch, 0.043 data, 0.259 forward
[INFO] - 03-16 19:45:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:45:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0136 (0.0165)
[INFO] - 03-16 19:45:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5799 (0.5948)
[INFO] - 03-16 19:45:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4931 (-140.4795)
[INFO] - 03-16 19:45:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1668 (25.0612)
[INFO] - 03-16 19:45:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 249.5949 (247.9749)
[INFO] - 03-16 19:45:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:45:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.7598)
[INFO] - 03-16 19:45:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:45:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:45:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:45:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:45:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:45:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:45:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:45:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:06.261
[INFO] - 03-16 19:45:44 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:06.262
[INFO] - 03-16 19:45:44 - [main.summary_metrics:168]: Epoch 94/300 - Test Results:
{'auc': 0.7146421318134172,
 'f1': 0.18064828253507498,
 'loss': 0.6121641640093343,
 'ndcg': 0.48084569479151906,
 'precision': 0.269811320754717,
 'recall': 0.13584905660377358}
[INFO] - 03-16 19:45:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[94] Complete. Time taken: 00:01:04.826
[INFO] - 03-16 19:45:44 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:45:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:45:44 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:45:44 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:45:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:45:44 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 4975, 5129]
[INFO] - 03-16 19:45:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:45:59 - [main.backward:225]: Epoch 95/300 - Iteration 44/199 - Time 0.332 batch, 0.075 data, 0.298 forward
[INFO] - 03-16 19:45:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0157 (0.0150)
[INFO] - 03-16 19:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5834 (0.5910)
[INFO] - 03-16 19:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4691 (-140.4424)
[INFO] - 03-16 19:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1917 (25.1036)
[INFO] - 03-16 19:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 248.1977 (249.0403)
[INFO] - 03-16 19:45:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.7806)
[INFO] - 03-16 19:46:13 - [main.backward:225]: Epoch 95/300 - Iteration 94/199 - Time 0.310 batch, 0.053 data, 0.276 forward
[INFO] - 03-16 19:46:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0147 (0.0145)
[INFO] - 03-16 19:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5990 (0.5864)
[INFO] - 03-16 19:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4537 (-140.4481)
[INFO] - 03-16 19:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.3036 (25.1996)
[INFO] - 03-16 19:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.7983 (246.2964)
[INFO] - 03-16 19:46:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7969 (0.8020)
[INFO] - 03-16 19:46:28 - [main.backward:225]: Epoch 95/300 - Iteration 144/199 - Time 0.305 batch, 0.047 data, 0.270 forward
[INFO] - 03-16 19:46:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0174 (0.0156)
[INFO] - 03-16 19:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6077 (0.5907)
[INFO] - 03-16 19:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4365 (-140.4849)
[INFO] - 03-16 19:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.3367 (25.2531)
[INFO] - 03-16 19:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 243.7087 (244.8601)
[INFO] - 03-16 19:46:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.7667)
[INFO] - 03-16 19:46:42 - [main.backward:225]: Epoch 95/300 - Iteration 194/199 - Time 0.299 batch, 0.044 data, 0.264 forward
[INFO] - 03-16 19:46:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0122 (0.0152)
[INFO] - 03-16 19:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5947)
[INFO] - 03-16 19:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4918 (-140.4805)
[INFO] - 03-16 19:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1557 (25.2330)
[INFO] - 03-16 19:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 247.0731 (245.9812)
[INFO] - 03-16 19:46:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.7941)
[INFO] - 03-16 19:46:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:46:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:46:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:46:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:46:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:46:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:46:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:46:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.035
[INFO] - 03-16 19:46:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.036
[INFO] - 03-16 19:46:48 - [main.summary_metrics:168]: Epoch 95/300 - Test Results:
{'auc': 0.7394406446540879,
 'f1': 0.2183841315916788,
 'loss': 0.5997253192365795,
 'ndcg': 0.5269940098018607,
 'precision': 0.32641509433962257,
 'recall': 0.1641509433962264}
[INFO] - 03-16 19:46:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[95] Complete. Time taken: 00:01:04.461
[INFO] - 03-16 19:46:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:46:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:46:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:46:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:46:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:46:49 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7246, 4996, 5161]
[INFO] - 03-16 19:46:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:47:02 - [main.backward:225]: Epoch 96/300 - Iteration 45/199 - Time 0.310 batch, 0.068 data, 0.276 forward
[INFO] - 03-16 19:47:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0116 (0.0136)
[INFO] - 03-16 19:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5980 (0.5927)
[INFO] - 03-16 19:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4753 (-140.4437)
[INFO] - 03-16 19:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1278 (25.0802)
[INFO] - 03-16 19:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 246.2388 (247.7508)
[INFO] - 03-16 19:47:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8155)
[INFO] - 03-16 19:47:17 - [main.backward:225]: Epoch 96/300 - Iteration 95/199 - Time 0.296 batch, 0.050 data, 0.262 forward
[INFO] - 03-16 19:47:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:47:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0121 (0.0128)
[INFO] - 03-16 19:47:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5869)
[INFO] - 03-16 19:47:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4243 (-140.4484)
[INFO] - 03-16 19:47:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4053 (25.2184)
[INFO] - 03-16 19:47:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 245.7557 (245.8599)
[INFO] - 03-16 19:47:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:47:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8337)
[INFO] - 03-16 19:47:31 - [main.backward:225]: Epoch 96/300 - Iteration 145/199 - Time 0.295 batch, 0.047 data, 0.259 forward
[INFO] - 03-16 19:47:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:47:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0156 (0.0148)
[INFO] - 03-16 19:47:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6157 (0.5922)
[INFO] - 03-16 19:47:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4476 (-140.4854)
[INFO] - 03-16 19:47:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.3742 (25.3956)
[INFO] - 03-16 19:47:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 242.0414 (243.9940)
[INFO] - 03-16 19:47:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:47:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.7847)
[INFO] - 03-16 19:47:45 - [main.backward:225]: Epoch 96/300 - Iteration 195/199 - Time 0.291 batch, 0.043 data, 0.256 forward
[INFO] - 03-16 19:47:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0098 (0.0148)
[INFO] - 03-16 19:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5844 (0.5935)
[INFO] - 03-16 19:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4880 (-140.4825)
[INFO] - 03-16 19:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.0211 (25.0731)
[INFO] - 03-16 19:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 249.1769 (246.0902)
[INFO] - 03-16 19:47:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.8020)
[INFO] - 03-16 19:47:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:47:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:47:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:47:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:47:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:47:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:47:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:47:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.123
[INFO] - 03-16 19:47:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.125
[INFO] - 03-16 19:47:52 - [main.summary_metrics:168]: Epoch 96/300 - Test Results:
{'auc': 0.740815546383648,
 'f1': 0.2435413642960813,
 'loss': 0.5967851297830385,
 'ndcg': 0.5432518661751139,
 'precision': 0.3641509433962265,
 'recall': 0.18301886792452834}
[INFO] - 03-16 19:47:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[96] Complete. Time taken: 00:01:03.088
[INFO] - 03-16 19:47:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:47:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:47:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:47:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:47:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:47:52 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7228, 5038, 5175]
[INFO] - 03-16 19:47:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:48:06 - [main.backward:225]: Epoch 97/300 - Iteration 46/199 - Time 0.308 batch, 0.065 data, 0.275 forward
[INFO] - 03-16 19:48:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0122 (0.0138)
[INFO] - 03-16 19:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5211 (0.5919)
[INFO] - 03-16 19:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5310 (-140.4462)
[INFO] - 03-16 19:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1634 (25.0648)
[INFO] - 03-16 19:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 246.0478 (247.6115)
[INFO] - 03-16 19:48:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8119)
[INFO] - 03-16 19:48:19 - [main.backward:225]: Epoch 97/300 - Iteration 96/199 - Time 0.289 batch, 0.049 data, 0.254 forward
[INFO] - 03-16 19:48:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:48:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0127 (0.0133)
[INFO] - 03-16 19:48:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5991 (0.5886)
[INFO] - 03-16 19:48:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4224 (-140.4471)
[INFO] - 03-16 19:48:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.2307 (25.1285)
[INFO] - 03-16 19:48:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 245.1592 (245.5463)
[INFO] - 03-16 19:48:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:48:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8175)
[INFO] - 03-16 19:48:33 - [main.backward:225]: Epoch 97/300 - Iteration 146/199 - Time 0.285 batch, 0.043 data, 0.251 forward
[INFO] - 03-16 19:48:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:48:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0179 (0.0148)
[INFO] - 03-16 19:48:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6069 (0.5929)
[INFO] - 03-16 19:48:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4424 (-140.4844)
[INFO] - 03-16 19:48:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1153 (25.1439)
[INFO] - 03-16 19:48:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.6420 (244.9328)
[INFO] - 03-16 19:48:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:48:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.7822)
[INFO] - 03-16 19:48:47 - [main.backward:225]: Epoch 97/300 - Iteration 196/199 - Time 0.284 batch, 0.041 data, 0.250 forward
[INFO] - 03-16 19:48:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:48:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0171 (0.0145)
[INFO] - 03-16 19:48:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6029 (0.5942)
[INFO] - 03-16 19:48:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3997 (-140.4831)
[INFO] - 03-16 19:48:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.8615 (24.9950)
[INFO] - 03-16 19:48:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 246.3918 (246.2139)
[INFO] - 03-16 19:48:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:48:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.8036)
[INFO] - 03-16 19:48:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:48:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:48:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:48:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.312
[INFO] - 03-16 19:48:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.312
[INFO] - 03-16 19:48:53 - [main.summary_metrics:168]: Epoch 97/300 - Test Results:
{'auc': 0.7521596239517819,
 'f1': 0.26637639090469284,
 'loss': 0.5922984934792829,
 'ndcg': 0.5703861762555219,
 'precision': 0.39811320754716983,
 'recall': 0.2002358490566038}
[INFO] - 03-16 19:48:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[97] Complete. Time taken: 00:01:01.883
[INFO] - 03-16 19:48:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:48:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:48:54 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:48:54 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:48:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:48:54 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7216, 4974, 5119]
[INFO] - 03-16 19:48:55 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:49:09 - [main.backward:225]: Epoch 98/300 - Iteration 47/199 - Time 0.326 batch, 0.071 data, 0.290 forward
[INFO] - 03-16 19:49:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:49:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0127 (0.0134)
[INFO] - 03-16 19:49:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5070 (0.5886)
[INFO] - 03-16 19:49:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5420 (-140.4528)
[INFO] - 03-16 19:49:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1144 (25.0858)
[INFO] - 03-16 19:49:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 245.1074 (246.4507)
[INFO] - 03-16 19:49:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:49:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.8174)
[INFO] - 03-16 19:49:23 - [main.backward:225]: Epoch 98/300 - Iteration 97/199 - Time 0.306 batch, 0.054 data, 0.268 forward
[INFO] - 03-16 19:49:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0148 (0.0131)
[INFO] - 03-16 19:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5870 (0.5904)
[INFO] - 03-16 19:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4424 (-140.4531)
[INFO] - 03-16 19:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.4049 (25.2184)
[INFO] - 03-16 19:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 243.1620 (244.7157)
[INFO] - 03-16 19:49:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.8225)
[INFO] - 03-16 19:49:36 - [main.backward:225]: Epoch 98/300 - Iteration 147/199 - Time 0.291 batch, 0.047 data, 0.255 forward
[INFO] - 03-16 19:49:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0162 (0.0148)
[INFO] - 03-16 19:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5957 (0.5933)
[INFO] - 03-16 19:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5034 (-140.4868)
[INFO] - 03-16 19:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.3027 (25.2095)
[INFO] - 03-16 19:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 243.7509 (243.2669)
[INFO] - 03-16 19:49:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:49:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7500 (0.7761)
[INFO] - 03-16 19:49:50 - [main.backward:225]: Epoch 98/300 - Iteration 197/199 - Time 0.288 batch, 0.043 data, 0.253 forward
[INFO] - 03-16 19:49:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:49:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0154 (0.0147)
[INFO] - 03-16 19:49:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6225 (0.5932)
[INFO] - 03-16 19:49:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3860 (-140.4801)
[INFO] - 03-16 19:49:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.0178 (25.1395)
[INFO] - 03-16 19:49:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 246.3936 (245.7450)
[INFO] - 03-16 19:49:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:49:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.7858)
[INFO] - 03-16 19:49:51 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:49:51 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:49:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:49:51 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:49:51 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:49:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:49:51 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:49:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.896
[INFO] - 03-16 19:49:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.897
[INFO] - 03-16 19:49:56 - [main.summary_metrics:168]: Epoch 98/300 - Test Results:
{'auc': 0.7438155463836478,
 'f1': 0.2565650701499758,
 'loss': 0.5938826002444861,
 'ndcg': 0.5483475485478319,
 'precision': 0.38301886792452833,
 'recall': 0.19300314465408805}
[INFO] - 03-16 19:49:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[98] Complete. Time taken: 00:01:02.280
[INFO] - 03-16 19:49:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:49:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:49:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:49:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:49:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:49:56 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 4982, 5128]
[INFO] - 03-16 19:49:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:50:11 - [main.backward:225]: Epoch 99/300 - Iteration 48/199 - Time 0.310 batch, 0.063 data, 0.278 forward
[INFO] - 03-16 19:50:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:50:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0133)
[INFO] - 03-16 19:50:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5322 (0.5888)
[INFO] - 03-16 19:50:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5493 (-140.4591)
[INFO] - 03-16 19:50:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1203 (25.1286)
[INFO] - 03-16 19:50:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.5750 (245.4204)
[INFO] - 03-16 19:50:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:50:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.8171)
[INFO] - 03-16 19:50:24 - [main.backward:225]: Epoch 99/300 - Iteration 98/199 - Time 0.293 batch, 0.047 data, 0.261 forward
[INFO] - 03-16 19:50:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:50:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0178 (0.0126)
[INFO] - 03-16 19:50:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5919)
[INFO] - 03-16 19:50:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4568 (-140.4554)
[INFO] - 03-16 19:50:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1972 (25.0595)
[INFO] - 03-16 19:50:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 242.0931 (244.0914)
[INFO] - 03-16 19:50:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:50:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.8300)
[INFO] - 03-16 19:50:38 - [main.backward:225]: Epoch 99/300 - Iteration 148/199 - Time 0.287 batch, 0.041 data, 0.256 forward
[INFO] - 03-16 19:50:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:50:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0152 (0.0151)
[INFO] - 03-16 19:50:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5933)
[INFO] - 03-16 19:50:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5052 (-140.4894)
[INFO] - 03-16 19:50:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1792 (25.0928)
[INFO] - 03-16 19:50:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 240.8531 (241.6701)
[INFO] - 03-16 19:50:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:50:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8125 (0.7708)
[INFO] - 03-16 19:50:52 - [main.backward:225]: Epoch 99/300 - Iteration 198/199 - Time 0.283 batch, 0.040 data, 0.250 forward
[INFO] - 03-16 19:50:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0147 (0.0142)
[INFO] - 03-16 19:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6090 (0.5952)
[INFO] - 03-16 19:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3883 (-140.4802)
[INFO] - 03-16 19:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.8246 (24.9906)
[INFO] - 03-16 19:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 246.2399 (244.0116)
[INFO] - 03-16 19:50:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.7967)
[INFO] - 03-16 19:50:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:50:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:50:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:50:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:50:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:50:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:50:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:50:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.928
[INFO] - 03-16 19:50:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.930
[INFO] - 03-16 19:50:57 - [main.summary_metrics:168]: Epoch 99/300 - Test Results:
{'auc': 0.7486723663522012,
 'f1': 0.26386066763425253,
 'loss': 0.5859744314197725,
 'ndcg': 0.5696197860692922,
 'precision': 0.3943396226415094,
 'recall': 0.19834905660377358}
[INFO] - 03-16 19:50:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[99] Complete. Time taken: 00:01:01.676
[INFO] - 03-16 19:50:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:50:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:50:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:50:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:50:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:50:57 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7233, 4980, 5141]
[INFO] - 03-16 19:50:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:51:12 - [main.backward:225]: Epoch 100/300 - Iteration 49/199 - Time 0.301 batch, 0.058 data, 0.270 forward
[INFO] - 03-16 19:51:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0118 (0.0127)
[INFO] - 03-16 19:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5577 (0.5882)
[INFO] - 03-16 19:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5325 (-140.4651)
[INFO] - 03-16 19:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.9463 (24.9092)
[INFO] - 03-16 19:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.7487 (244.8968)
[INFO] - 03-16 19:51:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8233)
[INFO] - 03-16 19:51:26 - [main.backward:225]: Epoch 100/300 - Iteration 99/199 - Time 0.285 batch, 0.045 data, 0.254 forward
[INFO] - 03-16 19:51:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:51:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0167 (0.0125)
[INFO] - 03-16 19:51:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6044 (0.5943)
[INFO] - 03-16 19:51:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4362 (-140.4565)
[INFO] - 03-16 19:51:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1439 (24.9234)
[INFO] - 03-16 19:51:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.0395 (244.3803)
[INFO] - 03-16 19:51:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:51:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.8287)
[INFO] - 03-16 19:51:40 - [main.backward:225]: Epoch 100/300 - Iteration 149/199 - Time 0.283 batch, 0.041 data, 0.251 forward
[INFO] - 03-16 19:51:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0181 (0.0150)
[INFO] - 03-16 19:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5784 (0.5921)
[INFO] - 03-16 19:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5147 (-140.4913)
[INFO] - 03-16 19:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.1416 (25.0395)
[INFO] - 03-16 19:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 241.3422 (241.6048)
[INFO] - 03-16 19:51:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6797 (0.7723)
[INFO] - 03-16 19:51:54 - [main.backward:225]: Epoch 100/300 - Iteration 0/199 - Time 0.283 batch, 0.040 data, 0.250 forward
[INFO] - 03-16 19:51:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:51:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0192 (0.0147)
[INFO] - 03-16 19:51:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6095 (0.5941)
[INFO] - 03-16 19:51:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3958 (-140.4796)
[INFO] - 03-16 19:51:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.7656 (24.8846)
[INFO] - 03-16 19:51:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 243.9049 (242.9320)
[INFO] - 03-16 19:51:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:51:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6146 (0.7801)
[INFO] - 03-16 19:51:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:51:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:51:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:51:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:51:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:51:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:51:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:51:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.091
[INFO] - 03-16 19:51:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.091
[INFO] - 03-16 19:51:59 - [main.summary_metrics:168]: Epoch 100/300 - Test Results:
{'auc': 0.7583642885220124,
 'f1': 0.27663280116110306,
 'loss': 0.5829306559732627,
 'ndcg': 0.5841823484575341,
 'precision': 0.41320754716981134,
 'recall': 0.2080188679245283}
[INFO] - 03-16 19:51:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[100] Complete. Time taken: 00:01:01.473
[INFO] - 03-16 19:51:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:51:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:51:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:51:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:51:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:51:59 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7269, 5003, 5119]
[INFO] - 03-16 19:52:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:52:14 - [main.backward:225]: Epoch 101/300 - Iteration 50/199 - Time 0.308 batch, 0.067 data, 0.276 forward
[INFO] - 03-16 19:52:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0121 (0.0126)
[INFO] - 03-16 19:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6073 (0.5885)
[INFO] - 03-16 19:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4641 (-140.4707)
[INFO] - 03-16 19:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.9976 (24.9284)
[INFO] - 03-16 19:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.1758 (243.7444)
[INFO] - 03-16 19:52:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:52:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8334)
[INFO] - 03-16 19:52:29 - [main.backward:225]: Epoch 101/300 - Iteration 100/199 - Time 0.300 batch, 0.051 data, 0.267 forward
[INFO] - 03-16 19:52:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:52:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0153 (0.0123)
[INFO] - 03-16 19:52:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6069 (0.5931)
[INFO] - 03-16 19:52:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4482 (-140.4592)
[INFO] - 03-16 19:52:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 25.0013 (24.8822)
[INFO] - 03-16 19:52:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 241.5944 (242.4518)
[INFO] - 03-16 19:52:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:52:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7656 (0.8352)
[INFO] - 03-16 19:52:43 - [main.backward:225]: Epoch 101/300 - Iteration 150/199 - Time 0.297 batch, 0.046 data, 0.262 forward
[INFO] - 03-16 19:52:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:52:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0158 (0.0145)
[INFO] - 03-16 19:52:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5791 (0.5927)
[INFO] - 03-16 19:52:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5129 (-140.4950)
[INFO] - 03-16 19:52:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.9078 (24.8393)
[INFO] - 03-16 19:52:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 240.5794 (239.9433)
[INFO] - 03-16 19:52:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:52:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7891 (0.7830)
[INFO] - 03-16 19:52:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:52:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:52:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:52:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:52:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:52:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:52:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:53:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.281
[INFO] - 03-16 19:53:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.282
[INFO] - 03-16 19:53:03 - [main.summary_metrics:168]: Epoch 101/300 - Test Results:
{'auc': 0.7582102659853248,
 'f1': 0.2943009192065796,
 'loss': 0.5817367350180443,
 'ndcg': 0.6041814716845988,
 'precision': 0.439622641509434,
 'recall': 0.2213050314465409}
[INFO] - 03-16 19:53:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[101] Complete. Time taken: 00:01:03.848
[INFO] - 03-16 19:53:03 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:53:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:53:03 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:53:03 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:53:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:53:03 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7254, 5018, 5154]
[INFO] - 03-16 19:53:04 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:53:05 - [main.backward:225]: Epoch 102/300 - Iteration 1/199 - Time 1.791 batch, 1.548 data, 1.751 forward
[INFO] - 03-16 19:53:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:53:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0113 (0.0141)
[INFO] - 03-16 19:53:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6102 (0.5946)
[INFO] - 03-16 19:53:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5056 (-140.4801)
[INFO] - 03-16 19:53:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.6234 (24.7047)
[INFO] - 03-16 19:53:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 242.1893 (241.6433)
[INFO] - 03-16 19:53:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:53:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.7971)
[INFO] - 03-16 19:53:18 - [main.backward:225]: Epoch 102/300 - Iteration 51/199 - Time 0.298 batch, 0.064 data, 0.264 forward
[INFO] - 03-16 19:53:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0096 (0.0124)
[INFO] - 03-16 19:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6076 (0.5888)
[INFO] - 03-16 19:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4843 (-140.4744)
[INFO] - 03-16 19:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.6181 (24.6333)
[INFO] - 03-16 19:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 242.8038 (243.0476)
[INFO] - 03-16 19:53:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.8352)
[INFO] - 03-16 19:53:32 - [main.backward:225]: Epoch 102/300 - Iteration 101/199 - Time 0.293 batch, 0.051 data, 0.257 forward
[INFO] - 03-16 19:53:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0161 (0.0123)
[INFO] - 03-16 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6143 (0.5940)
[INFO] - 03-16 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4577 (-140.4633)
[INFO] - 03-16 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.7237 (24.5901)
[INFO] - 03-16 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 241.7626 (241.9102)
[INFO] - 03-16 19:53:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.8302)
[INFO] - 03-16 19:53:47 - [main.backward:225]: Epoch 102/300 - Iteration 151/199 - Time 0.291 batch, 0.046 data, 0.255 forward
[INFO] - 03-16 19:53:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:53:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0153 (0.0147)
[INFO] - 03-16 19:53:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5966 (0.5916)
[INFO] - 03-16 19:53:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5188 (-140.4987)
[INFO] - 03-16 19:53:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.6699 (24.6529)
[INFO] - 03-16 19:53:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 240.9696 (240.1083)
[INFO] - 03-16 19:53:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:53:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7969 (0.7762)
[INFO] - 03-16 19:54:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:54:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:54:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:54:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:54:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:54:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:54:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:54:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.170
[INFO] - 03-16 19:54:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.171
[INFO] - 03-16 19:54:05 - [main.summary_metrics:168]: Epoch 102/300 - Test Results:
{'auc': 0.754265166404612,
 'f1': 0.28040638606676344,
 'loss': 0.5791166651024009,
 'ndcg': 0.5838000325247997,
 'precision': 0.41886792452830196,
 'recall': 0.21084905660377362}
[INFO] - 03-16 19:54:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[102] Complete. Time taken: 00:01:02.746
[INFO] - 03-16 19:54:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:54:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:54:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:54:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:54:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:54:06 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7265, 4972, 5110]
[INFO] - 03-16 19:54:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:54:07 - [main.backward:225]: Epoch 103/300 - Iteration 2/199 - Time 0.944 batch, 0.708 data, 0.911 forward
[INFO] - 03-16 19:54:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:54:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0103 (0.0136)
[INFO] - 03-16 19:54:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5639 (0.5967)
[INFO] - 03-16 19:54:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4940 (-140.4829)
[INFO] - 03-16 19:54:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.6593 (24.5875)
[INFO] - 03-16 19:54:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.1528 (243.1125)
[INFO] - 03-16 19:54:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:54:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.7987)
[INFO] - 03-16 19:54:21 - [main.backward:225]: Epoch 103/300 - Iteration 52/199 - Time 0.304 batch, 0.058 data, 0.272 forward
[INFO] - 03-16 19:54:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:54:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0123 (0.0128)
[INFO] - 03-16 19:54:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6128 (0.5897)
[INFO] - 03-16 19:54:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5022 (-140.4810)
[INFO] - 03-16 19:54:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.8052 (24.6566)
[INFO] - 03-16 19:54:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 244.0581 (243.5089)
[INFO] - 03-16 19:54:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:54:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8170)
[INFO] - 03-16 19:54:36 - [main.backward:225]: Epoch 103/300 - Iteration 102/199 - Time 0.294 batch, 0.046 data, 0.261 forward
[INFO] - 03-16 19:54:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:54:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0076 (0.0129)
[INFO] - 03-16 19:54:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5463 (0.5919)
[INFO] - 03-16 19:54:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5495 (-140.4671)
[INFO] - 03-16 19:54:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.6558 (24.7198)
[INFO] - 03-16 19:54:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 240.3145 (241.0199)
[INFO] - 03-16 19:54:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:54:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.8116)
[INFO] - 03-16 19:54:49 - [main.backward:225]: Epoch 103/300 - Iteration 152/199 - Time 0.286 batch, 0.042 data, 0.252 forward
[INFO] - 03-16 19:54:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0137 (0.0142)
[INFO] - 03-16 19:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5891 (0.5950)
[INFO] - 03-16 19:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5206 (-140.5037)
[INFO] - 03-16 19:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.5201 (24.5735)
[INFO] - 03-16 19:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 239.5697 (240.2968)
[INFO] - 03-16 19:54:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.7898)
[INFO] - 03-16 19:55:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:55:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:55:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:55:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:55:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:55:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:55:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:55:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.669
[INFO] - 03-16 19:55:07 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.670
[INFO] - 03-16 19:55:07 - [main.summary_metrics:168]: Epoch 103/300 - Test Results:
{'auc': 0.7543672366352203,
 'f1': 0.28588292210933725,
 'loss': 0.5781350923454236,
 'ndcg': 0.5795658531518951,
 'precision': 0.4264150943396227,
 'recall': 0.21517295597484282}
[INFO] - 03-16 19:55:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[103] Complete. Time taken: 00:01:01.085
[INFO] - 03-16 19:55:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:55:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:55:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:55:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:55:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:55:07 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7231, 4955, 5122]
[INFO] - 03-16 19:55:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:55:09 - [main.backward:225]: Epoch 104/300 - Iteration 3/199 - Time 0.711 batch, 0.508 data, 0.681 forward
[INFO] - 03-16 19:55:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:55:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0104 (0.0134)
[INFO] - 03-16 19:55:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5655 (0.5944)
[INFO] - 03-16 19:55:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5003 (-140.4855)
[INFO] - 03-16 19:55:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.5916 (24.4839)
[INFO] - 03-16 19:55:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 240.8674 (241.3201)
[INFO] - 03-16 19:55:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:55:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8109)
[INFO] - 03-16 19:55:23 - [main.backward:225]: Epoch 104/300 - Iteration 53/199 - Time 0.301 batch, 0.061 data, 0.268 forward
[INFO] - 03-16 19:55:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:55:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0121)
[INFO] - 03-16 19:55:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5762 (0.5905)
[INFO] - 03-16 19:55:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5177 (-140.4862)
[INFO] - 03-16 19:55:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.4615 (24.4977)
[INFO] - 03-16 19:55:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 240.5283 (241.7647)
[INFO] - 03-16 19:55:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:55:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.8375)
[INFO] - 03-16 19:55:36 - [main.backward:225]: Epoch 104/300 - Iteration 103/199 - Time 0.289 batch, 0.047 data, 0.256 forward
[INFO] - 03-16 19:55:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:55:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0100 (0.0122)
[INFO] - 03-16 19:55:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5591 (0.5916)
[INFO] - 03-16 19:55:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5811 (-140.4688)
[INFO] - 03-16 19:55:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.5799 (24.4393)
[INFO] - 03-16 19:55:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 241.0607 (241.3676)
[INFO] - 03-16 19:55:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:55:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8308)
[INFO] - 03-16 19:55:50 - [main.backward:225]: Epoch 104/300 - Iteration 153/199 - Time 0.286 batch, 0.042 data, 0.253 forward
[INFO] - 03-16 19:55:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0142 (0.0140)
[INFO] - 03-16 19:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5969 (0.5939)
[INFO] - 03-16 19:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5159 (-140.5028)
[INFO] - 03-16 19:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.4767 (24.5485)
[INFO] - 03-16 19:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 241.8614 (239.8273)
[INFO] - 03-16 19:55:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7969 (0.7941)
[INFO] - 03-16 19:56:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:56:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:56:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:56:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:56:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:56:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:56:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:56:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.985
[INFO] - 03-16 19:56:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.986
[INFO] - 03-16 19:56:08 - [main.summary_metrics:168]: Epoch 104/300 - Test Results:
{'auc': 0.7552774502096435,
 'f1': 0.29153362360909535,
 'loss': 0.5741609908129933,
 'ndcg': 0.5857286119174423,
 'precision': 0.43584905660377365,
 'recall': 0.2191037735849057}
[INFO] - 03-16 19:56:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[104] Complete. Time taken: 00:01:01.055
[INFO] - 03-16 19:56:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:56:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:56:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:56:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:56:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:56:08 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7241, 5024, 5161]
[INFO] - 03-16 19:56:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:56:10 - [main.backward:225]: Epoch 105/300 - Iteration 4/199 - Time 0.637 batch, 0.390 data, 0.604 forward
[INFO] - 03-16 19:56:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:56:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0097 (0.0131)
[INFO] - 03-16 19:56:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5679 (0.5932)
[INFO] - 03-16 19:56:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5048 (-140.4885)
[INFO] - 03-16 19:56:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.6864 (24.5420)
[INFO] - 03-16 19:56:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 243.0340 (242.1475)
[INFO] - 03-16 19:56:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:56:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8121)
[INFO] - 03-16 19:56:24 - [main.backward:225]: Epoch 105/300 - Iteration 54/199 - Time 0.297 batch, 0.055 data, 0.269 forward
[INFO] - 03-16 19:56:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:56:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0080 (0.0118)
[INFO] - 03-16 19:56:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5583 (0.5900)
[INFO] - 03-16 19:56:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5351 (-140.4882)
[INFO] - 03-16 19:56:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.6438 (24.6113)
[INFO] - 03-16 19:56:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 241.0103 (241.4775)
[INFO] - 03-16 19:56:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:56:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.8448)
[INFO] - 03-16 19:56:38 - [main.backward:225]: Epoch 105/300 - Iteration 104/199 - Time 0.289 batch, 0.045 data, 0.258 forward
[INFO] - 03-16 19:56:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0122)
[INFO] - 03-16 19:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5283 (0.5902)
[INFO] - 03-16 19:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5945 (-140.4749)
[INFO] - 03-16 19:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.5108 (24.5672)
[INFO] - 03-16 19:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 238.9686 (240.0869)
[INFO] - 03-16 19:56:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:56:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.8350)
[INFO] - 03-16 19:56:52 - [main.backward:225]: Epoch 105/300 - Iteration 154/199 - Time 0.287 batch, 0.041 data, 0.256 forward
[INFO] - 03-16 19:56:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:56:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0172 (0.0137)
[INFO] - 03-16 19:56:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5970)
[INFO] - 03-16 19:56:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5147 (-140.5023)
[INFO] - 03-16 19:56:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.4264 (24.4021)
[INFO] - 03-16 19:56:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 238.6149 (238.1165)
[INFO] - 03-16 19:56:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:56:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.7972)
[INFO] - 03-16 19:57:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:57:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:57:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:57:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:57:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:57:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:57:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:57:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.091
[INFO] - 03-16 19:57:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.093
[INFO] - 03-16 19:57:09 - [main.summary_metrics:168]: Epoch 105/300 - Test Results:
{'auc': 0.7597821016771488,
 'f1': 0.27305273343009195,
 'loss': 0.5734729857814637,
 'ndcg': 0.5888225036797748,
 'precision': 0.40754716981132066,
 'recall': 0.20542452830188673}
[INFO] - 03-16 19:57:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[105] Complete. Time taken: 00:01:01.386
[INFO] - 03-16 19:57:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:57:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:57:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:57:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:57:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:57:09 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7239, 4994, 5105]
[INFO] - 03-16 19:57:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:57:12 - [main.backward:225]: Epoch 106/300 - Iteration 5/199 - Time 0.601 batch, 0.360 data, 0.561 forward
[INFO] - 03-16 19:57:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:57:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0102 (0.0129)
[INFO] - 03-16 19:57:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5408 (0.5926)
[INFO] - 03-16 19:57:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5164 (-140.4885)
[INFO] - 03-16 19:57:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.2898 (24.2404)
[INFO] - 03-16 19:57:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 240.0456 (240.3449)
[INFO] - 03-16 19:57:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:57:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.8167)
[INFO] - 03-16 19:57:26 - [main.backward:225]: Epoch 106/300 - Iteration 55/199 - Time 0.310 batch, 0.064 data, 0.275 forward
[INFO] - 03-16 19:57:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:57:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0119)
[INFO] - 03-16 19:57:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5470 (0.5880)
[INFO] - 03-16 19:57:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5324 (-140.4910)
[INFO] - 03-16 19:57:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.3424 (24.4090)
[INFO] - 03-16 19:57:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 240.0363 (240.2984)
[INFO] - 03-16 19:57:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:57:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.8416)
[INFO] - 03-16 19:57:40 - [main.backward:225]: Epoch 106/300 - Iteration 105/199 - Time 0.297 batch, 0.050 data, 0.262 forward
[INFO] - 03-16 19:57:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0121)
[INFO] - 03-16 19:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5284 (0.5913)
[INFO] - 03-16 19:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5998 (-140.4784)
[INFO] - 03-16 19:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.3729 (24.4043)
[INFO] - 03-16 19:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 239.2291 (239.3473)
[INFO] - 03-16 19:57:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.8317)
[INFO] - 03-16 19:57:54 - [main.backward:225]: Epoch 106/300 - Iteration 155/199 - Time 0.293 batch, 0.046 data, 0.258 forward
[INFO] - 03-16 19:57:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0121 (0.0142)
[INFO] - 03-16 19:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5968 (0.5959)
[INFO] - 03-16 19:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5568 (-140.4983)
[INFO] - 03-16 19:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.3101 (24.3688)
[INFO] - 03-16 19:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 237.7285 (238.4799)
[INFO] - 03-16 19:57:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.7925)
[INFO] - 03-16 19:58:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:58:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:58:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:58:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:58:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:58:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:58:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:58:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.301
[INFO] - 03-16 19:58:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.302
[INFO] - 03-16 19:58:12 - [main.summary_metrics:168]: Epoch 106/300 - Test Results:
{'auc': 0.7657160311844865,
 'f1': 0.2908563134978229,
 'loss': 0.5685459976316248,
 'ndcg': 0.5978038255045538,
 'precision': 0.43396226415094347,
 'recall': 0.21886792452830192}
[INFO] - 03-16 19:58:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[106] Complete. Time taken: 00:01:03.543
[INFO] - 03-16 19:58:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:58:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:58:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:58:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:58:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:58:13 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7228, 5004, 5158]
[INFO] - 03-16 19:58:14 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:58:16 - [main.backward:225]: Epoch 107/300 - Iteration 6/199 - Time 0.550 batch, 0.300 data, 0.517 forward
[INFO] - 03-16 19:58:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0098 (0.0126)
[INFO] - 03-16 19:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5593 (0.5922)
[INFO] - 03-16 19:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5396 (-140.4824)
[INFO] - 03-16 19:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.4215 (24.3286)
[INFO] - 03-16 19:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 239.5237 (239.5353)
[INFO] - 03-16 19:58:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8204)
[INFO] - 03-16 19:58:30 - [main.backward:225]: Epoch 107/300 - Iteration 56/199 - Time 0.310 batch, 0.063 data, 0.275 forward
[INFO] - 03-16 19:58:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:58:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0121)
[INFO] - 03-16 19:58:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5471 (0.5890)
[INFO] - 03-16 19:58:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5356 (-140.4933)
[INFO] - 03-16 19:58:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.3996 (24.4667)
[INFO] - 03-16 19:58:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 237.1693 (238.7764)
[INFO] - 03-16 19:58:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:58:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.8383)
[INFO] - 03-16 19:58:44 - [main.backward:225]: Epoch 107/300 - Iteration 106/199 - Time 0.293 batch, 0.049 data, 0.260 forward
[INFO] - 03-16 19:58:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0140 (0.0123)
[INFO] - 03-16 19:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5812 (0.5896)
[INFO] - 03-16 19:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5202 (-140.4762)
[INFO] - 03-16 19:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.3193 (24.3634)
[INFO] - 03-16 19:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 239.2548 (238.9658)
[INFO] - 03-16 19:58:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8125 (0.8295)
[INFO] - 03-16 19:58:57 - [main.backward:225]: Epoch 107/300 - Iteration 156/199 - Time 0.287 batch, 0.044 data, 0.253 forward
[INFO] - 03-16 19:58:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0118 (0.0143)
[INFO] - 03-16 19:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5997 (0.5955)
[INFO] - 03-16 19:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5614 (-140.5007)
[INFO] - 03-16 19:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.1726 (24.1778)
[INFO] - 03-16 19:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 239.5083 (238.8802)
[INFO] - 03-16 19:58:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.7886)
[INFO] - 03-16 19:59:09 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 19:59:09 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:59:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:59:09 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 19:59:09 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:59:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 19:59:09 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 19:59:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.848
[INFO] - 03-16 19:59:14 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.849
[INFO] - 03-16 19:59:14 - [main.summary_metrics:168]: Epoch 107/300 - Test Results:
{'auc': 0.7733672693920335,
 'f1': 0.2996613449443638,
 'loss': 0.5631434076097277,
 'ndcg': 0.6106930808488967,
 'precision': 0.4471698113207548,
 'recall': 0.22547169811320758}
[INFO] - 03-16 19:59:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[107] Complete. Time taken: 00:01:01.576
[INFO] - 03-16 19:59:14 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 19:59:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 19:59:14 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 19:59:14 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 19:59:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 19:59:14 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7275, 5000, 5158]
[INFO] - 03-16 19:59:16 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 19:59:18 - [main.backward:225]: Epoch 108/300 - Iteration 7/199 - Time 0.511 batch, 0.254 data, 0.476 forward
[INFO] - 03-16 19:59:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:59:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0103 (0.0127)
[INFO] - 03-16 19:59:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5593 (0.5910)
[INFO] - 03-16 19:59:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5361 (-140.4836)
[INFO] - 03-16 19:59:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.1288 (24.0740)
[INFO] - 03-16 19:59:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 240.8114 (240.4998)
[INFO] - 03-16 19:59:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:59:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8176)
[INFO] - 03-16 19:59:32 - [main.backward:225]: Epoch 108/300 - Iteration 57/199 - Time 0.308 batch, 0.060 data, 0.275 forward
[INFO] - 03-16 19:59:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:59:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0103 (0.0119)
[INFO] - 03-16 19:59:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5743 (0.5883)
[INFO] - 03-16 19:59:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5330 (-140.4933)
[INFO] - 03-16 19:59:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.3244 (24.2415)
[INFO] - 03-16 19:59:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 237.1868 (239.6792)
[INFO] - 03-16 19:59:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:59:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8395)
[INFO] - 03-16 19:59:45 - [main.backward:225]: Epoch 108/300 - Iteration 107/199 - Time 0.292 batch, 0.047 data, 0.259 forward
[INFO] - 03-16 19:59:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0111 (0.0114)
[INFO] - 03-16 19:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5921 (0.5923)
[INFO] - 03-16 19:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5116 (-140.4753)
[INFO] - 03-16 19:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.2484 (24.2612)
[INFO] - 03-16 19:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 237.2769 (237.9868)
[INFO] - 03-16 19:59:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:59:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.8492)
[INFO] - 03-16 19:59:59 - [main.backward:225]: Epoch 108/300 - Iteration 157/199 - Time 0.287 batch, 0.044 data, 0.254 forward
[INFO] - 03-16 19:59:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 19:59:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0152 (0.0140)
[INFO] - 03-16 19:59:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5796 (0.5961)
[INFO] - 03-16 19:59:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5554 (-140.5020)
[INFO] - 03-16 19:59:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.0568 (24.2127)
[INFO] - 03-16 19:59:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 238.5395 (237.6942)
[INFO] - 03-16 19:59:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 19:59:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7891 (0.7928)
[INFO] - 03-16 20:00:11 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:00:11 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:00:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:00:11 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:00:11 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:00:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:00:11 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:00:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.152
[INFO] - 03-16 20:00:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.153
[INFO] - 03-16 20:00:16 - [main.summary_metrics:168]: Epoch 108/300 - Test Results:
{'auc': 0.764443691037736,
 'f1': 0.2906627963231737,
 'loss': 0.5657335257500221,
 'ndcg': 0.5868422761067333,
 'precision': 0.43396226415094336,
 'recall': 0.2186320754716981}
[INFO] - 03-16 20:00:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[108] Complete. Time taken: 00:01:02.136
[INFO] - 03-16 20:00:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:00:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:00:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:00:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:00:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:00:16 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7243, 4988, 5145]
[INFO] - 03-16 20:00:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:00:20 - [main.backward:225]: Epoch 109/300 - Iteration 8/199 - Time 0.460 batch, 0.209 data, 0.428 forward
[INFO] - 03-16 20:00:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0096 (0.0128)
[INFO] - 03-16 20:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5484 (0.5923)
[INFO] - 03-16 20:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5266 (-140.4862)
[INFO] - 03-16 20:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.2943 (24.2470)
[INFO] - 03-16 20:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 238.1480 (238.3968)
[INFO] - 03-16 20:00:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.8106)
[INFO] - 03-16 20:00:34 - [main.backward:225]: Epoch 109/300 - Iteration 58/199 - Time 0.305 batch, 0.057 data, 0.272 forward
[INFO] - 03-16 20:00:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0097 (0.0116)
[INFO] - 03-16 20:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5839 (0.5903)
[INFO] - 03-16 20:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5385 (-140.4949)
[INFO] - 03-16 20:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.3073 (24.3214)
[INFO] - 03-16 20:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 236.2706 (237.8611)
[INFO] - 03-16 20:00:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8470)
[INFO] - 03-16 20:00:47 - [main.backward:225]: Epoch 109/300 - Iteration 108/199 - Time 0.289 batch, 0.046 data, 0.256 forward
[INFO] - 03-16 20:00:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0133 (0.0118)
[INFO] - 03-16 20:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5927 (0.5912)
[INFO] - 03-16 20:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4942 (-140.4779)
[INFO] - 03-16 20:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.2128 (24.2152)
[INFO] - 03-16 20:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 238.0278 (237.0022)
[INFO] - 03-16 20:00:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.8397)
[INFO] - 03-16 20:01:01 - [main.backward:225]: Epoch 109/300 - Iteration 158/199 - Time 0.285 batch, 0.042 data, 0.252 forward
[INFO] - 03-16 20:01:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0146 (0.0138)
[INFO] - 03-16 20:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5868 (0.5954)
[INFO] - 03-16 20:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5563 (-140.5032)
[INFO] - 03-16 20:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.2020 (24.1517)
[INFO] - 03-16 20:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 234.6034 (235.5590)
[INFO] - 03-16 20:01:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:01:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8125 (0.7986)
[INFO] - 03-16 20:01:12 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:01:12 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:01:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:01:12 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:01:12 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:01:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:01:12 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:01:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.060
[INFO] - 03-16 20:01:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.061
[INFO] - 03-16 20:01:17 - [main.summary_metrics:168]: Epoch 109/300 - Test Results:
{'auc': 0.7855998100104822,
 'f1': 0.31978713110788576,
 'loss': 0.5603358442758364,
 'ndcg': 0.6344553502993406,
 'precision': 0.4773584905660377,
 'recall': 0.24056603773584906}
[INFO] - 03-16 20:01:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[109] Complete. Time taken: 00:01:01.041
[INFO] - 03-16 20:01:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:01:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:01:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:01:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:01:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:01:17 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 5002, 5123]
[INFO] - 03-16 20:01:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:01:22 - [main.backward:225]: Epoch 110/300 - Iteration 9/199 - Time 0.465 batch, 0.209 data, 0.432 forward
[INFO] - 03-16 20:01:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:01:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0120)
[INFO] - 03-16 20:01:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5556 (0.5889)
[INFO] - 03-16 20:01:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5343 (-140.4882)
[INFO] - 03-16 20:01:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.0053 (24.0427)
[INFO] - 03-16 20:01:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 239.0938 (237.2998)
[INFO] - 03-16 20:01:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:01:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.8297)
[INFO] - 03-16 20:01:36 - [main.backward:225]: Epoch 110/300 - Iteration 59/199 - Time 0.317 batch, 0.061 data, 0.283 forward
[INFO] - 03-16 20:01:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0111 (0.0114)
[INFO] - 03-16 20:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5929 (0.5881)
[INFO] - 03-16 20:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5405 (-140.4953)
[INFO] - 03-16 20:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.1490 (24.1067)
[INFO] - 03-16 20:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 235.9417 (237.7573)
[INFO] - 03-16 20:01:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8461)
[INFO] - 03-16 20:01:50 - [main.backward:225]: Epoch 110/300 - Iteration 109/199 - Time 0.301 batch, 0.048 data, 0.268 forward
[INFO] - 03-16 20:01:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:01:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0109 (0.0115)
[INFO] - 03-16 20:01:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5984 (0.5891)
[INFO] - 03-16 20:01:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4939 (-140.4763)
[INFO] - 03-16 20:01:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.0916 (24.0678)
[INFO] - 03-16 20:01:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 235.5901 (236.1618)
[INFO] - 03-16 20:01:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:01:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8411)
[INFO] - 03-16 20:02:04 - [main.backward:225]: Epoch 110/300 - Iteration 159/199 - Time 0.296 batch, 0.044 data, 0.263 forward
[INFO] - 03-16 20:02:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:02:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0147 (0.0129)
[INFO] - 03-16 20:02:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5788 (0.5961)
[INFO] - 03-16 20:02:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5507 (-140.4995)
[INFO] - 03-16 20:02:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.6644 (23.9251)
[INFO] - 03-16 20:02:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 234.6515 (236.3378)
[INFO] - 03-16 20:02:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:02:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7500 (0.8155)
[INFO] - 03-16 20:02:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:02:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:02:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:02:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:02:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:02:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:02:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:02:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.022
[INFO] - 03-16 20:02:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.023
[INFO] - 03-16 20:02:21 - [main.summary_metrics:168]: Epoch 110/300 - Test Results:
{'auc': 0.7785779939727464,
 'f1': 0.3009772617319787,
 'loss': 0.5569733243138535,
 'ndcg': 0.6128337551920979,
 'precision': 0.449056603773585,
 'recall': 0.22649371069182397}
[INFO] - 03-16 20:02:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[110] Complete. Time taken: 00:01:03.528
[INFO] - 03-16 20:02:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:02:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:02:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:02:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:02:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:02:21 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7252, 4992, 5152]
[INFO] - 03-16 20:02:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:02:25 - [main.backward:225]: Epoch 111/300 - Iteration 10/199 - Time 0.433 batch, 0.202 data, 0.394 forward
[INFO] - 03-16 20:02:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:02:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0119)
[INFO] - 03-16 20:02:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5516 (0.5877)
[INFO] - 03-16 20:02:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5292 (-140.4874)
[INFO] - 03-16 20:02:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.8832 (23.8537)
[INFO] - 03-16 20:02:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 237.4760 (238.0378)
[INFO] - 03-16 20:02:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:02:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.8337)
[INFO] - 03-16 20:02:39 - [main.backward:225]: Epoch 111/300 - Iteration 60/199 - Time 0.304 batch, 0.063 data, 0.268 forward
[INFO] - 03-16 20:02:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0080 (0.0111)
[INFO] - 03-16 20:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5739 (0.5903)
[INFO] - 03-16 20:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5478 (-140.4896)
[INFO] - 03-16 20:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.1046 (23.9990)
[INFO] - 03-16 20:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 236.0710 (237.1948)
[INFO] - 03-16 20:02:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.8536)
[INFO] - 03-16 20:02:53 - [main.backward:225]: Epoch 111/300 - Iteration 110/199 - Time 0.288 batch, 0.049 data, 0.255 forward
[INFO] - 03-16 20:02:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:02:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0100 (0.0114)
[INFO] - 03-16 20:02:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5824 (0.5900)
[INFO] - 03-16 20:02:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4871 (-140.4743)
[INFO] - 03-16 20:02:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.9517 (24.0337)
[INFO] - 03-16 20:02:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 236.1619 (236.1760)
[INFO] - 03-16 20:02:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:02:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8413)
[INFO] - 03-16 20:03:07 - [main.backward:225]: Epoch 111/300 - Iteration 160/199 - Time 0.287 batch, 0.044 data, 0.253 forward
[INFO] - 03-16 20:03:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0120 (0.0135)
[INFO] - 03-16 20:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5946)
[INFO] - 03-16 20:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5420 (-140.5009)
[INFO] - 03-16 20:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.5518 (23.8067)
[INFO] - 03-16 20:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 234.6230 (234.7317)
[INFO] - 03-16 20:03:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.8086)
[INFO] - 03-16 20:03:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:03:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:03:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:03:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:03:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:03:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:03:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:03:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.791
[INFO] - 03-16 20:03:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.792
[INFO] - 03-16 20:03:22 - [main.summary_metrics:168]: Epoch 111/300 - Test Results:
{'auc': 0.7877003406708596,
 'f1': 0.31475568456700526,
 'loss': 0.5508397410210824,
 'ndcg': 0.6360300972612952,
 'precision': 0.4698113207547169,
 'recall': 0.23679245283018863}
[INFO] - 03-16 20:03:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[111] Complete. Time taken: 00:01:02.115
[INFO] - 03-16 20:03:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:03:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:03:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:03:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:03:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:03:23 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7253, 4996, 5151]
[INFO] - 03-16 20:03:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:03:27 - [main.backward:225]: Epoch 112/300 - Iteration 11/199 - Time 0.408 batch, 0.162 data, 0.376 forward
[INFO] - 03-16 20:03:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0111)
[INFO] - 03-16 20:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5627 (0.5883)
[INFO] - 03-16 20:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5168 (-140.4844)
[INFO] - 03-16 20:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.9457 (23.8504)
[INFO] - 03-16 20:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 236.1393 (236.8221)
[INFO] - 03-16 20:03:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.8465)
[INFO] - 03-16 20:03:41 - [main.backward:225]: Epoch 112/300 - Iteration 61/199 - Time 0.303 batch, 0.059 data, 0.268 forward
[INFO] - 03-16 20:03:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:03:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0121 (0.0111)
[INFO] - 03-16 20:03:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5904 (0.5910)
[INFO] - 03-16 20:03:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4820 (-140.4861)
[INFO] - 03-16 20:03:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.9768 (23.9426)
[INFO] - 03-16 20:03:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 235.9306 (236.3564)
[INFO] - 03-16 20:03:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:03:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8522)
[INFO] - 03-16 20:03:56 - [main.backward:225]: Epoch 112/300 - Iteration 111/199 - Time 0.295 batch, 0.049 data, 0.259 forward
[INFO] - 03-16 20:03:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:03:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0106 (0.0109)
[INFO] - 03-16 20:03:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5955 (0.5907)
[INFO] - 03-16 20:03:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4727 (-140.4726)
[INFO] - 03-16 20:03:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.8288 (23.8631)
[INFO] - 03-16 20:03:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 235.5254 (234.6331)
[INFO] - 03-16 20:03:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:03:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8509)
[INFO] - 03-16 20:04:10 - [main.backward:225]: Epoch 112/300 - Iteration 161/199 - Time 0.293 batch, 0.045 data, 0.258 forward
[INFO] - 03-16 20:04:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0110 (0.0133)
[INFO] - 03-16 20:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5808 (0.5948)
[INFO] - 03-16 20:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5507 (-140.5016)
[INFO] - 03-16 20:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.8428 (23.8715)
[INFO] - 03-16 20:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 233.6332 (234.0399)
[INFO] - 03-16 20:04:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8055)
[INFO] - 03-16 20:04:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:04:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:04:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:04:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:04:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:04:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:04:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:04:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.951
[INFO] - 03-16 20:04:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.952
[INFO] - 03-16 20:04:26 - [main.summary_metrics:168]: Epoch 112/300 - Test Results:
{'auc': 0.7871256223794549,
 'f1': 0.3133623609095307,
 'loss': 0.5483731128484698,
 'ndcg': 0.6333658010236609,
 'precision': 0.4679245283018868,
 'recall': 0.2356918238993711}
[INFO] - 03-16 20:04:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[112] Complete. Time taken: 00:01:02.801
[INFO] - 03-16 20:04:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:04:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:04:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:04:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:04:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:04:26 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7263, 4975, 5099]
[INFO] - 03-16 20:04:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:04:31 - [main.backward:225]: Epoch 113/300 - Iteration 12/199 - Time 0.406 batch, 0.168 data, 0.369 forward
[INFO] - 03-16 20:04:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0085 (0.0111)
[INFO] - 03-16 20:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5872)
[INFO] - 03-16 20:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4547 (-140.4791)
[INFO] - 03-16 20:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 24.0186 (23.8689)
[INFO] - 03-16 20:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 235.5507 (236.4718)
[INFO] - 03-16 20:04:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:04:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8486)
[INFO] - 03-16 20:04:44 - [main.backward:225]: Epoch 113/300 - Iteration 62/199 - Time 0.298 batch, 0.060 data, 0.264 forward
[INFO] - 03-16 20:04:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:04:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0094 (0.0108)
[INFO] - 03-16 20:04:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5892)
[INFO] - 03-16 20:04:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4868 (-140.4850)
[INFO] - 03-16 20:04:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.9929 (24.0723)
[INFO] - 03-16 20:04:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 233.2268 (234.7894)
[INFO] - 03-16 20:04:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:04:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8583)
[INFO] - 03-16 20:04:58 - [main.backward:225]: Epoch 113/300 - Iteration 112/199 - Time 0.289 batch, 0.048 data, 0.255 forward
[INFO] - 03-16 20:04:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:04:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0108 (0.0110)
[INFO] - 03-16 20:04:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5907 (0.5894)
[INFO] - 03-16 20:04:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4884 (-140.4680)
[INFO] - 03-16 20:04:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.7290 (23.8642)
[INFO] - 03-16 20:04:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 233.0642 (233.0337)
[INFO] - 03-16 20:04:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:04:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8508)
[INFO] - 03-16 20:05:12 - [main.backward:225]: Epoch 113/300 - Iteration 162/199 - Time 0.285 batch, 0.045 data, 0.250 forward
[INFO] - 03-16 20:05:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0147 (0.0130)
[INFO] - 03-16 20:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6023 (0.5947)
[INFO] - 03-16 20:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5026 (-140.4978)
[INFO] - 03-16 20:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.5577 (23.6731)
[INFO] - 03-16 20:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 233.9568 (232.9429)
[INFO] - 03-16 20:05:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:05:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.8089)
[INFO] - 03-16 20:05:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:05:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:05:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:05:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:05:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:05:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:05:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:05:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.911
[INFO] - 03-16 20:05:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.912
[INFO] - 03-16 20:05:28 - [main.summary_metrics:168]: Epoch 113/300 - Test Results:
{'auc': 0.7849102790880502,
 'f1': 0.30436381228834064,
 'loss': 0.5541049766620499,
 'ndcg': 0.6252434743955566,
 'precision': 0.4547169811320754,
 'recall': 0.22885220125786165}
[INFO] - 03-16 20:05:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[113] Complete. Time taken: 00:01:02.064
[INFO] - 03-16 20:05:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:05:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:05:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:05:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:05:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:05:28 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7226, 4980, 5136]
[INFO] - 03-16 20:05:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:05:33 - [main.backward:225]: Epoch 114/300 - Iteration 13/199 - Time 0.396 batch, 0.148 data, 0.360 forward
[INFO] - 03-16 20:05:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:05:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0124 (0.0120)
[INFO] - 03-16 20:05:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6073 (0.5883)
[INFO] - 03-16 20:05:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4372 (-140.4772)
[INFO] - 03-16 20:05:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.9241 (23.7149)
[INFO] - 03-16 20:05:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 236.1035 (235.7462)
[INFO] - 03-16 20:05:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:05:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8047 (0.8266)
[INFO] - 03-16 20:05:47 - [main.backward:225]: Epoch 114/300 - Iteration 63/199 - Time 0.309 batch, 0.057 data, 0.275 forward
[INFO] - 03-16 20:05:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:05:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0112 (0.0109)
[INFO] - 03-16 20:05:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5945 (0.5897)
[INFO] - 03-16 20:05:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4867 (-140.4860)
[INFO] - 03-16 20:05:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.9048 (24.0049)
[INFO] - 03-16 20:05:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 233.1038 (234.3879)
[INFO] - 03-16 20:05:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:05:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8480)
[INFO] - 03-16 20:06:01 - [main.backward:225]: Epoch 114/300 - Iteration 113/199 - Time 0.296 batch, 0.046 data, 0.263 forward
[INFO] - 03-16 20:06:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:06:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0097 (0.0109)
[INFO] - 03-16 20:06:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5725 (0.5898)
[INFO] - 03-16 20:06:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4923 (-140.4677)
[INFO] - 03-16 20:06:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.5523 (23.7237)
[INFO] - 03-16 20:06:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 232.5466 (233.0348)
[INFO] - 03-16 20:06:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:06:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8498)
[INFO] - 03-16 20:06:15 - [main.backward:225]: Epoch 114/300 - Iteration 163/199 - Time 0.291 batch, 0.042 data, 0.258 forward
[INFO] - 03-16 20:06:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:06:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0165 (0.0129)
[INFO] - 03-16 20:06:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5955 (0.5945)
[INFO] - 03-16 20:06:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4862 (-140.4950)
[INFO] - 03-16 20:06:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.5548 (23.5917)
[INFO] - 03-16 20:06:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 234.1210 (233.4924)
[INFO] - 03-16 20:06:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:06:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7422 (0.8125)
[INFO] - 03-16 20:06:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:06:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:06:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:06:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:06:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:06:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:06:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:06:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.874
[INFO] - 03-16 20:06:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.875
[INFO] - 03-16 20:06:30 - [main.summary_metrics:168]: Epoch 114/300 - Test Results:
{'auc': 0.7956449816561845,
 'f1': 0.32236090953072083,
 'loss': 0.5503940359631425,
 'ndcg': 0.6441861367376852,
 'precision': 0.4811320754716981,
 'recall': 0.2425314465408805}
[INFO] - 03-16 20:06:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[114] Complete. Time taken: 00:01:01.796
[INFO] - 03-16 20:06:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:06:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:06:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:06:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:06:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:06:30 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7252, 5006, 5158]
[INFO] - 03-16 20:06:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:06:35 - [main.backward:225]: Epoch 115/300 - Iteration 14/199 - Time 0.374 batch, 0.131 data, 0.341 forward
[INFO] - 03-16 20:06:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0110 (0.0114)
[INFO] - 03-16 20:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6006 (0.5867)
[INFO] - 03-16 20:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4601 (-140.4738)
[INFO] - 03-16 20:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.7330 (23.6434)
[INFO] - 03-16 20:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 234.8029 (234.8499)
[INFO] - 03-16 20:06:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8396)
[INFO] - 03-16 20:06:49 - [main.backward:225]: Epoch 115/300 - Iteration 64/199 - Time 0.307 batch, 0.057 data, 0.271 forward
[INFO] - 03-16 20:06:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:06:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0099 (0.0111)
[INFO] - 03-16 20:06:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6016 (0.5890)
[INFO] - 03-16 20:06:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4583 (-140.4869)
[INFO] - 03-16 20:06:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.7491 (23.7934)
[INFO] - 03-16 20:06:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 233.1983 (233.9482)
[INFO] - 03-16 20:06:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:06:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8512)
[INFO] - 03-16 20:07:04 - [main.backward:225]: Epoch 115/300 - Iteration 114/199 - Time 0.297 batch, 0.048 data, 0.261 forward
[INFO] - 03-16 20:07:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:07:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0111 (0.0112)
[INFO] - 03-16 20:07:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5893 (0.5898)
[INFO] - 03-16 20:07:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4909 (-140.4669)
[INFO] - 03-16 20:07:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.5379 (23.6694)
[INFO] - 03-16 20:07:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 231.1042 (232.6178)
[INFO] - 03-16 20:07:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:07:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8478)
[INFO] - 03-16 20:07:18 - [main.backward:225]: Epoch 115/300 - Iteration 164/199 - Time 0.292 batch, 0.044 data, 0.257 forward
[INFO] - 03-16 20:07:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:07:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0150 (0.0124)
[INFO] - 03-16 20:07:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6075 (0.5971)
[INFO] - 03-16 20:07:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4901 (-140.4917)
[INFO] - 03-16 20:07:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.5376 (23.5215)
[INFO] - 03-16 20:07:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 234.5574 (232.6753)
[INFO] - 03-16 20:07:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:07:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.8250)
[INFO] - 03-16 20:07:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:07:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:07:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:07:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:07:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:07:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:07:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:07:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.107
[INFO] - 03-16 20:07:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.108
[INFO] - 03-16 20:07:33 - [main.summary_metrics:168]: Epoch 115/300 - Test Results:
{'auc': 0.806834709119497,
 'f1': 0.3379003386550556,
 'loss': 0.5435204520395467,
 'ndcg': 0.6605620499878059,
 'precision': 0.5037735849056604,
 'recall': 0.25440251572327044}
[INFO] - 03-16 20:07:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[115] Complete. Time taken: 00:01:02.935
[INFO] - 03-16 20:07:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:07:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:07:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:07:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:07:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:07:33 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7218, 4962, 5128]
[INFO] - 03-16 20:07:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:07:38 - [main.backward:225]: Epoch 116/300 - Iteration 15/199 - Time 0.386 batch, 0.161 data, 0.349 forward
[INFO] - 03-16 20:07:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0102 (0.0104)
[INFO] - 03-16 20:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6171 (0.5880)
[INFO] - 03-16 20:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4594 (-140.4674)
[INFO] - 03-16 20:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.6924 (23.5822)
[INFO] - 03-16 20:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 235.2985 (234.7431)
[INFO] - 03-16 20:07:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:07:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8597)
[INFO] - 03-16 20:07:53 - [main.backward:225]: Epoch 116/300 - Iteration 65/199 - Time 0.308 batch, 0.065 data, 0.272 forward
[INFO] - 03-16 20:07:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:07:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0120 (0.0100)
[INFO] - 03-16 20:07:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6150 (0.5887)
[INFO] - 03-16 20:07:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3640 (-140.4865)
[INFO] - 03-16 20:07:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.5105 (23.6671)
[INFO] - 03-16 20:07:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 232.7421 (233.5458)
[INFO] - 03-16 20:07:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:07:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8689)
[INFO] - 03-16 20:08:07 - [main.backward:225]: Epoch 116/300 - Iteration 115/199 - Time 0.295 batch, 0.050 data, 0.261 forward
[INFO] - 03-16 20:08:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:08:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0101)
[INFO] - 03-16 20:08:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5748 (0.5871)
[INFO] - 03-16 20:08:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4888 (-140.4701)
[INFO] - 03-16 20:08:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.5433 (23.6030)
[INFO] - 03-16 20:08:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 230.9019 (232.2328)
[INFO] - 03-16 20:08:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:08:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.8662)
[INFO] - 03-16 20:08:20 - [main.backward:225]: Epoch 116/300 - Iteration 165/199 - Time 0.290 batch, 0.045 data, 0.256 forward
[INFO] - 03-16 20:08:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0120 (0.0126)
[INFO] - 03-16 20:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6027 (0.5949)
[INFO] - 03-16 20:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4845 (-140.4894)
[INFO] - 03-16 20:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.3763 (23.4588)
[INFO] - 03-16 20:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 233.3689 (231.8689)
[INFO] - 03-16 20:08:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8047 (0.8167)
[INFO] - 03-16 20:08:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:08:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:08:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:08:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:08:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:08:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:08:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:08:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.059
[INFO] - 03-16 20:08:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.060
[INFO] - 03-16 20:08:35 - [main.summary_metrics:168]: Epoch 116/300 - Test Results:
{'auc': 0.8114393016247379,
 'f1': 0.3580261248185775,
 'loss': 0.5411998818075633,
 'ndcg': 0.6741144344152128,
 'precision': 0.5339622641509434,
 'recall': 0.26949685534591195}
[INFO] - 03-16 20:08:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[116] Complete. Time taken: 00:01:02.473
[INFO] - 03-16 20:08:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:08:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:08:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:08:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:08:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:08:35 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7236, 4997, 5161]
[INFO] - 03-16 20:08:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:08:41 - [main.backward:225]: Epoch 117/300 - Iteration 16/199 - Time 0.382 batch, 0.128 data, 0.349 forward
[INFO] - 03-16 20:08:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:08:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0098 (0.0106)
[INFO] - 03-16 20:08:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6002 (0.5876)
[INFO] - 03-16 20:08:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4346 (-140.4630)
[INFO] - 03-16 20:08:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.4950 (23.4474)
[INFO] - 03-16 20:08:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 232.3135 (233.4232)
[INFO] - 03-16 20:08:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:08:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.8494)
[INFO] - 03-16 20:08:55 - [main.backward:225]: Epoch 117/300 - Iteration 66/199 - Time 0.300 batch, 0.057 data, 0.266 forward
[INFO] - 03-16 20:08:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:08:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0120 (0.0094)
[INFO] - 03-16 20:08:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6211 (0.5885)
[INFO] - 03-16 20:08:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3522 (-140.4817)
[INFO] - 03-16 20:08:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.4581 (23.5891)
[INFO] - 03-16 20:08:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 232.0544 (232.4547)
[INFO] - 03-16 20:08:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:08:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.8806)
[INFO] - 03-16 20:09:09 - [main.backward:225]: Epoch 117/300 - Iteration 116/199 - Time 0.289 batch, 0.047 data, 0.256 forward
[INFO] - 03-16 20:09:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:09:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0097)
[INFO] - 03-16 20:09:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5780 (0.5876)
[INFO] - 03-16 20:09:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4814 (-140.4737)
[INFO] - 03-16 20:09:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.3910 (23.4426)
[INFO] - 03-16 20:09:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 231.3968 (231.3185)
[INFO] - 03-16 20:09:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:09:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.8705)
[INFO] - 03-16 20:09:23 - [main.backward:225]: Epoch 117/300 - Iteration 166/199 - Time 0.286 batch, 0.043 data, 0.252 forward
[INFO] - 03-16 20:09:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0142 (0.0123)
[INFO] - 03-16 20:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5953)
[INFO] - 03-16 20:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4509 (-140.4803)
[INFO] - 03-16 20:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.4007 (23.4045)
[INFO] - 03-16 20:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 232.7062 (231.6726)
[INFO] - 03-16 20:09:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:09:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.8259)
[INFO] - 03-16 20:09:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:09:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:09:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:09:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:09:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:09:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:09:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:09:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.986
[INFO] - 03-16 20:09:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.987
[INFO] - 03-16 20:09:37 - [main.summary_metrics:168]: Epoch 117/300 - Test Results:
{'auc': 0.8221827830188677,
 'f1': 0.35676826318335747,
 'loss': 0.5392601596664333,
 'ndcg': 0.6768285271139368,
 'precision': 0.5320754716981133,
 'recall': 0.26855345911949685}
[INFO] - 03-16 20:09:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[117] Complete. Time taken: 00:01:01.844
[INFO] - 03-16 20:09:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:09:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:09:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:09:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:09:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:09:37 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7214, 5017, 5138]
[INFO] - 03-16 20:09:38 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:09:43 - [main.backward:225]: Epoch 118/300 - Iteration 17/199 - Time 0.360 batch, 0.116 data, 0.325 forward
[INFO] - 03-16 20:09:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:09:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0136 (0.0108)
[INFO] - 03-16 20:09:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6084 (0.5903)
[INFO] - 03-16 20:09:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4357 (-140.4564)
[INFO] - 03-16 20:09:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.5595 (23.4529)
[INFO] - 03-16 20:09:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 233.3911 (232.4597)
[INFO] - 03-16 20:09:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:09:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7891 (0.8463)
[INFO] - 03-16 20:09:57 - [main.backward:225]: Epoch 118/300 - Iteration 67/199 - Time 0.298 batch, 0.053 data, 0.266 forward
[INFO] - 03-16 20:09:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:09:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0132 (0.0101)
[INFO] - 03-16 20:09:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6214 (0.5891)
[INFO] - 03-16 20:09:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3631 (-140.4810)
[INFO] - 03-16 20:09:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.6918 (23.6330)
[INFO] - 03-16 20:09:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 230.8268 (231.8639)
[INFO] - 03-16 20:09:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:09:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8125 (0.8675)
[INFO] - 03-16 20:10:11 - [main.backward:225]: Epoch 118/300 - Iteration 117/199 - Time 0.288 batch, 0.045 data, 0.255 forward
[INFO] - 03-16 20:10:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:10:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0135 (0.0103)
[INFO] - 03-16 20:10:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5886 (0.5867)
[INFO] - 03-16 20:10:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4644 (-140.4737)
[INFO] - 03-16 20:10:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.5277 (23.5942)
[INFO] - 03-16 20:10:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 232.1683 (231.6545)
[INFO] - 03-16 20:10:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:10:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8047 (0.8575)
[INFO] - 03-16 20:10:24 - [main.backward:225]: Epoch 118/300 - Iteration 167/199 - Time 0.282 batch, 0.042 data, 0.249 forward
[INFO] - 03-16 20:10:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:10:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0141 (0.0124)
[INFO] - 03-16 20:10:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6078 (0.5973)
[INFO] - 03-16 20:10:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4525 (-140.4795)
[INFO] - 03-16 20:10:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.1807 (23.3310)
[INFO] - 03-16 20:10:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 232.0253 (231.6662)
[INFO] - 03-16 20:10:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:10:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8125 (0.8298)
[INFO] - 03-16 20:10:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:10:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:10:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:10:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:10:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:10:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:10:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:10:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.153
[INFO] - 03-16 20:10:38 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.153
[INFO] - 03-16 20:10:38 - [main.summary_metrics:168]: Epoch 118/300 - Test Results:
{'auc': 0.8056798676624739,
 'f1': 0.3429317851959361,
 'loss': 0.539632459596518,
 'ndcg': 0.6500662967261354,
 'precision': 0.5113207547169811,
 'recall': 0.25817610062893087}
[INFO] - 03-16 20:10:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[118] Complete. Time taken: 00:01:01.800
[INFO] - 03-16 20:10:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:10:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:10:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:10:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:10:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:10:39 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7258, 5000, 5140]
[INFO] - 03-16 20:10:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:10:45 - [main.backward:225]: Epoch 119/300 - Iteration 18/199 - Time 0.371 batch, 0.127 data, 0.337 forward
[INFO] - 03-16 20:10:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:10:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0097 (0.0106)
[INFO] - 03-16 20:10:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6099 (0.5902)
[INFO] - 03-16 20:10:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4412 (-140.4557)
[INFO] - 03-16 20:10:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.2439 (23.2517)
[INFO] - 03-16 20:10:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 230.7039 (231.3598)
[INFO] - 03-16 20:10:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:10:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8502)
[INFO] - 03-16 20:10:59 - [main.backward:225]: Epoch 119/300 - Iteration 68/199 - Time 0.303 batch, 0.057 data, 0.271 forward
[INFO] - 03-16 20:10:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0109 (0.0107)
[INFO] - 03-16 20:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5705 (0.5875)
[INFO] - 03-16 20:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4510 (-140.4823)
[INFO] - 03-16 20:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.2804 (23.3152)
[INFO] - 03-16 20:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 229.6951 (230.3453)
[INFO] - 03-16 20:10:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.8562)
[INFO] - 03-16 20:11:13 - [main.backward:225]: Epoch 119/300 - Iteration 118/199 - Time 0.293 batch, 0.046 data, 0.261 forward
[INFO] - 03-16 20:11:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:11:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0093 (0.0100)
[INFO] - 03-16 20:11:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5982 (0.5873)
[INFO] - 03-16 20:11:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4610 (-140.4730)
[INFO] - 03-16 20:11:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.2563 (23.2979)
[INFO] - 03-16 20:11:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 230.4288 (229.7107)
[INFO] - 03-16 20:11:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:11:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8647)
[INFO] - 03-16 20:11:27 - [main.backward:225]: Epoch 119/300 - Iteration 168/199 - Time 0.289 batch, 0.042 data, 0.257 forward
[INFO] - 03-16 20:11:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:11:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0162 (0.0123)
[INFO] - 03-16 20:11:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5886 (0.5956)
[INFO] - 03-16 20:11:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4553 (-140.4796)
[INFO] - 03-16 20:11:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.0932 (23.1434)
[INFO] - 03-16 20:11:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 232.0934 (230.5365)
[INFO] - 03-16 20:11:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:11:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.8286)
[INFO] - 03-16 20:11:36 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:11:36 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:11:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:11:36 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:11:36 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:11:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:11:36 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:11:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.870
[INFO] - 03-16 20:11:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.870
[INFO] - 03-16 20:11:40 - [main.summary_metrics:168]: Epoch 119/300 - Test Results:
{'auc': 0.7921996855345909,
 'f1': 0.32890179003386544,
 'loss': 0.536603273235777,
 'ndcg': 0.647532951193452,
 'precision': 0.49056603773584906,
 'recall': 0.24756289308176102}
[INFO] - 03-16 20:11:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[119] Complete. Time taken: 00:01:01.704
[INFO] - 03-16 20:11:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:11:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:11:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:11:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:11:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:11:40 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7231, 4999, 5128]
[INFO] - 03-16 20:11:42 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:11:47 - [main.backward:225]: Epoch 120/300 - Iteration 19/199 - Time 0.362 batch, 0.108 data, 0.328 forward
[INFO] - 03-16 20:11:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:11:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0145 (0.0106)
[INFO] - 03-16 20:11:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6068 (0.5869)
[INFO] - 03-16 20:11:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4407 (-140.4513)
[INFO] - 03-16 20:11:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.2814 (23.1156)
[INFO] - 03-16 20:11:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 231.2641 (232.5579)
[INFO] - 03-16 20:11:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:11:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.8543)
[INFO] - 03-16 20:12:01 - [main.backward:225]: Epoch 120/300 - Iteration 69/199 - Time 0.305 batch, 0.054 data, 0.272 forward
[INFO] - 03-16 20:12:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:12:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0092)
[INFO] - 03-16 20:12:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5515 (0.5874)
[INFO] - 03-16 20:12:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5498 (-140.4812)
[INFO] - 03-16 20:12:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.2542 (23.3047)
[INFO] - 03-16 20:12:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 229.2441 (230.2744)
[INFO] - 03-16 20:12:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:12:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.8847)
[INFO] - 03-16 20:12:15 - [main.backward:225]: Epoch 120/300 - Iteration 119/199 - Time 0.291 batch, 0.045 data, 0.257 forward
[INFO] - 03-16 20:12:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0115 (0.0102)
[INFO] - 03-16 20:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6039 (0.5888)
[INFO] - 03-16 20:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4470 (-140.4688)
[INFO] - 03-16 20:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.3211 (23.3002)
[INFO] - 03-16 20:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 227.1361 (228.0292)
[INFO] - 03-16 20:12:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.8636)
[INFO] - 03-16 20:12:29 - [main.backward:225]: Epoch 120/300 - Iteration 169/199 - Time 0.287 batch, 0.041 data, 0.254 forward
[INFO] - 03-16 20:12:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0080 (0.0122)
[INFO] - 03-16 20:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5830 (0.5951)
[INFO] - 03-16 20:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4515 (-140.4775)
[INFO] - 03-16 20:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.1463 (23.1668)
[INFO] - 03-16 20:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 230.9000 (228.7865)
[INFO] - 03-16 20:12:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.8295)
[INFO] - 03-16 20:12:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:12:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:12:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:12:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:12:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:12:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:12:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:12:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.979
[INFO] - 03-16 20:12:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.980
[INFO] - 03-16 20:12:42 - [main.summary_metrics:168]: Epoch 120/300 - Test Results:
{'auc': 0.7994101480607965,
 'f1': 0.3286502177068214,
 'loss': 0.5381739727795998,
 'ndcg': 0.6481703489369761,
 'precision': 0.4905660377358491,
 'recall': 0.247248427672956}
[INFO] - 03-16 20:12:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[120] Complete. Time taken: 00:01:01.820
[INFO] - 03-16 20:12:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:12:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:12:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:12:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:12:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:12:42 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7243, 5005, 5151]
[INFO] - 03-16 20:12:44 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:12:49 - [main.backward:225]: Epoch 121/300 - Iteration 20/199 - Time 0.342 batch, 0.112 data, 0.305 forward
[INFO] - 03-16 20:12:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0149 (0.0104)
[INFO] - 03-16 20:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5783 (0.5872)
[INFO] - 03-16 20:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4897 (-140.4489)
[INFO] - 03-16 20:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.2949 (23.0877)
[INFO] - 03-16 20:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 230.9138 (230.7569)
[INFO] - 03-16 20:12:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.8546)
[INFO] - 03-16 20:13:03 - [main.backward:225]: Epoch 121/300 - Iteration 70/199 - Time 0.301 batch, 0.056 data, 0.266 forward
[INFO] - 03-16 20:13:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0098)
[INFO] - 03-16 20:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5391 (0.5849)
[INFO] - 03-16 20:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5443 (-140.4816)
[INFO] - 03-16 20:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.1568 (23.1964)
[INFO] - 03-16 20:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 229.7579 (230.4625)
[INFO] - 03-16 20:13:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.8738)
[INFO] - 03-16 20:13:17 - [main.backward:225]: Epoch 121/300 - Iteration 120/199 - Time 0.291 batch, 0.046 data, 0.257 forward
[INFO] - 03-16 20:13:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0131 (0.0105)
[INFO] - 03-16 20:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5999 (0.5913)
[INFO] - 03-16 20:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4332 (-140.4627)
[INFO] - 03-16 20:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.3799 (23.2407)
[INFO] - 03-16 20:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 229.5238 (228.8407)
[INFO] - 03-16 20:13:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7969 (0.8525)
[INFO] - 03-16 20:13:32 - [main.backward:225]: Epoch 121/300 - Iteration 170/199 - Time 0.290 batch, 0.043 data, 0.257 forward
[INFO] - 03-16 20:13:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:13:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0123)
[INFO] - 03-16 20:13:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5507 (0.5942)
[INFO] - 03-16 20:13:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4689 (-140.4738)
[INFO] - 03-16 20:13:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.0191 (23.1637)
[INFO] - 03-16 20:13:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 230.1252 (228.8029)
[INFO] - 03-16 20:13:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:13:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.8233)
[INFO] - 03-16 20:13:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:13:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:13:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:13:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:13:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:13:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:13:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:13:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.959
[INFO] - 03-16 20:13:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.962
[INFO] - 03-16 20:13:45 - [main.summary_metrics:168]: Epoch 121/300 - Test Results:
{'auc': 0.8009560075995807,
 'f1': 0.3462602805999032,
 'loss': 0.533493226249263,
 'ndcg': 0.6690221456970135,
 'precision': 0.5169811320754716,
 'recall': 0.2604559748427673}
[INFO] - 03-16 20:13:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[121] Complete. Time taken: 00:01:02.581
[INFO] - 03-16 20:13:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:13:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:13:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:13:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:13:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:13:45 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7241, 5009, 5134]
[INFO] - 03-16 20:13:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:13:52 - [main.backward:225]: Epoch 122/300 - Iteration 21/199 - Time 0.351 batch, 0.105 data, 0.319 forward
[INFO] - 03-16 20:13:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0107 (0.0108)
[INFO] - 03-16 20:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5975 (0.5886)
[INFO] - 03-16 20:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4899 (-140.4496)
[INFO] - 03-16 20:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.1996 (23.1180)
[INFO] - 03-16 20:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 230.9640 (230.4731)
[INFO] - 03-16 20:13:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8527)
[INFO] - 03-16 20:14:06 - [main.backward:225]: Epoch 122/300 - Iteration 71/199 - Time 0.298 batch, 0.056 data, 0.264 forward
[INFO] - 03-16 20:14:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0090)
[INFO] - 03-16 20:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5327 (0.5852)
[INFO] - 03-16 20:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5505 (-140.4836)
[INFO] - 03-16 20:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.2005 (23.2429)
[INFO] - 03-16 20:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 229.3943 (229.6094)
[INFO] - 03-16 20:14:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.8955)
[INFO] - 03-16 20:14:19 - [main.backward:225]: Epoch 122/300 - Iteration 121/199 - Time 0.285 batch, 0.046 data, 0.251 forward
[INFO] - 03-16 20:14:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:14:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0097 (0.0095)
[INFO] - 03-16 20:14:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5849 (0.5890)
[INFO] - 03-16 20:14:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5219 (-140.4590)
[INFO] - 03-16 20:14:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.1002 (23.2170)
[INFO] - 03-16 20:14:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 227.7556 (227.6962)
[INFO] - 03-16 20:14:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:14:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8767)
[INFO] - 03-16 20:14:34 - [main.backward:225]: Epoch 122/300 - Iteration 171/199 - Time 0.286 batch, 0.043 data, 0.252 forward
[INFO] - 03-16 20:14:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:14:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0118)
[INFO] - 03-16 20:14:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5513 (0.5937)
[INFO] - 03-16 20:14:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4545 (-140.4698)
[INFO] - 03-16 20:14:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.9079 (23.0887)
[INFO] - 03-16 20:14:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 228.7769 (228.0946)
[INFO] - 03-16 20:14:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:14:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.8323)
[INFO] - 03-16 20:14:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:14:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:14:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:14:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:14:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:14:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:14:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:14:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.971
[INFO] - 03-16 20:14:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.972
[INFO] - 03-16 20:14:47 - [main.summary_metrics:168]: Epoch 122/300 - Test Results:
{'auc': 0.8085485783542976,
 'f1': 0.3403580067731011,
 'loss': 0.5232665976278437,
 'ndcg': 0.667461411759618,
 'precision': 0.5075471698113208,
 'recall': 0.2562106918238994}
[INFO] - 03-16 20:14:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[122] Complete. Time taken: 00:01:01.767
[INFO] - 03-16 20:14:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:14:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:14:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:14:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:14:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:14:47 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7233, 5012, 5138]
[INFO] - 03-16 20:14:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:14:54 - [main.backward:225]: Epoch 123/300 - Iteration 22/199 - Time 0.356 batch, 0.104 data, 0.323 forward
[INFO] - 03-16 20:14:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0101 (0.0097)
[INFO] - 03-16 20:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5901)
[INFO] - 03-16 20:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4889 (-140.4506)
[INFO] - 03-16 20:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 23.0030 (22.9480)
[INFO] - 03-16 20:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 226.9956 (228.5640)
[INFO] - 03-16 20:14:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8692)
[INFO] - 03-16 20:15:09 - [main.backward:225]: Epoch 123/300 - Iteration 72/199 - Time 0.308 batch, 0.056 data, 0.274 forward
[INFO] - 03-16 20:15:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:15:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0089 (0.0086)
[INFO] - 03-16 20:15:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5961 (0.5862)
[INFO] - 03-16 20:15:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3982 (-140.4821)
[INFO] - 03-16 20:15:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.8970 (23.0205)
[INFO] - 03-16 20:15:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 228.6678 (228.6283)
[INFO] - 03-16 20:15:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:15:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8956)
[INFO] - 03-16 20:15:23 - [main.backward:225]: Epoch 123/300 - Iteration 122/199 - Time 0.300 batch, 0.048 data, 0.265 forward
[INFO] - 03-16 20:15:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0115 (0.0098)
[INFO] - 03-16 20:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5674 (0.5877)
[INFO] - 03-16 20:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5232 (-140.4599)
[INFO] - 03-16 20:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.9893 (23.0744)
[INFO] - 03-16 20:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 227.1083 (227.7667)
[INFO] - 03-16 20:15:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.8706)
[INFO] - 03-16 20:15:37 - [main.backward:225]: Epoch 123/300 - Iteration 172/199 - Time 0.293 batch, 0.044 data, 0.258 forward
[INFO] - 03-16 20:15:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:15:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0114)
[INFO] - 03-16 20:15:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5578 (0.5929)
[INFO] - 03-16 20:15:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4399 (-140.4688)
[INFO] - 03-16 20:15:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.9118 (23.0789)
[INFO] - 03-16 20:15:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 229.6430 (228.2719)
[INFO] - 03-16 20:15:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:15:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.8448)
[INFO] - 03-16 20:15:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:15:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:15:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:15:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:15:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:15:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:15:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:15:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.616
[INFO] - 03-16 20:15:50 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.617
[INFO] - 03-16 20:15:50 - [main.summary_metrics:168]: Epoch 123/300 - Test Results:
{'auc': 0.7917208464360586,
 'f1': 0.32110304789550065,
 'loss': 0.5224514339574978,
 'ndcg': 0.645652835674858,
 'precision': 0.4792452830188679,
 'recall': 0.24158805031446542}
[INFO] - 03-16 20:15:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[123] Complete. Time taken: 00:01:03.508
[INFO] - 03-16 20:15:50 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:15:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:15:50 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:15:50 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:15:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:15:50 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 4976, 5123]
[INFO] - 03-16 20:15:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:15:58 - [main.backward:225]: Epoch 124/300 - Iteration 23/199 - Time 0.352 batch, 0.099 data, 0.315 forward
[INFO] - 03-16 20:15:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0073 (0.0098)
[INFO] - 03-16 20:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5911 (0.5921)
[INFO] - 03-16 20:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4582 (-140.4503)
[INFO] - 03-16 20:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.9569 (22.8841)
[INFO] - 03-16 20:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 228.1951 (228.7819)
[INFO] - 03-16 20:15:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.8645)
[INFO] - 03-16 20:16:12 - [main.backward:225]: Epoch 124/300 - Iteration 73/199 - Time 0.303 batch, 0.055 data, 0.268 forward
[INFO] - 03-16 20:16:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0068 (0.0092)
[INFO] - 03-16 20:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6150 (0.5866)
[INFO] - 03-16 20:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3320 (-140.4781)
[INFO] - 03-16 20:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.9520 (22.9727)
[INFO] - 03-16 20:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 228.9427 (227.0871)
[INFO] - 03-16 20:16:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.8783)
[INFO] - 03-16 20:16:27 - [main.backward:225]: Epoch 124/300 - Iteration 123/199 - Time 0.297 batch, 0.046 data, 0.263 forward
[INFO] - 03-16 20:16:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0105 (0.0097)
[INFO] - 03-16 20:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5757 (0.5889)
[INFO] - 03-16 20:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5181 (-140.4606)
[INFO] - 03-16 20:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.8167 (22.9606)
[INFO] - 03-16 20:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 225.4749 (226.2940)
[INFO] - 03-16 20:16:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8758)
[INFO] - 03-16 20:16:41 - [main.backward:225]: Epoch 124/300 - Iteration 173/199 - Time 0.292 batch, 0.042 data, 0.258 forward
[INFO] - 03-16 20:16:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0109)
[INFO] - 03-16 20:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5634 (0.5928)
[INFO] - 03-16 20:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4381 (-140.4653)
[INFO] - 03-16 20:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.7383 (22.8058)
[INFO] - 03-16 20:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 227.2022 (226.4968)
[INFO] - 03-16 20:16:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.8520)
[INFO] - 03-16 20:16:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:16:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:16:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:16:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:16:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:16:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:16:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:16:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.035
[INFO] - 03-16 20:16:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.037
[INFO] - 03-16 20:16:53 - [main.summary_metrics:168]: Epoch 124/300 - Test Results:
{'auc': 0.8036827830188679,
 'f1': 0.3389066279632316,
 'loss': 0.5236605573610189,
 'ndcg': 0.6659763327630568,
 'precision': 0.5056603773584907,
 'recall': 0.2550314465408805}
[INFO] - 03-16 20:16:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[124] Complete. Time taken: 00:01:02.505
[INFO] - 03-16 20:16:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:16:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:16:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:16:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:16:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:16:53 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7275, 5002, 5152]
[INFO] - 03-16 20:16:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:17:01 - [main.backward:225]: Epoch 125/300 - Iteration 24/199 - Time 0.356 batch, 0.099 data, 0.323 forward
[INFO] - 03-16 20:17:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0104 (0.0097)
[INFO] - 03-16 20:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6067 (0.5915)
[INFO] - 03-16 20:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4326 (-140.4518)
[INFO] - 03-16 20:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.9963 (22.7828)
[INFO] - 03-16 20:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 227.2037 (227.9053)
[INFO] - 03-16 20:17:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8696)
[INFO] - 03-16 20:17:15 - [main.backward:225]: Epoch 125/300 - Iteration 74/199 - Time 0.308 batch, 0.055 data, 0.274 forward
[INFO] - 03-16 20:17:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0115 (0.0085)
[INFO] - 03-16 20:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6098 (0.5846)
[INFO] - 03-16 20:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3317 (-140.4739)
[INFO] - 03-16 20:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.9424 (23.0206)
[INFO] - 03-16 20:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 226.0143 (226.7270)
[INFO] - 03-16 20:17:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8938)
[INFO] - 03-16 20:17:29 - [main.backward:225]: Epoch 125/300 - Iteration 124/199 - Time 0.294 batch, 0.046 data, 0.261 forward
[INFO] - 03-16 20:17:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0092 (0.0088)
[INFO] - 03-16 20:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5828 (0.5887)
[INFO] - 03-16 20:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5149 (-140.4614)
[INFO] - 03-16 20:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.8750 (22.9308)
[INFO] - 03-16 20:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 225.5081 (225.7431)
[INFO] - 03-16 20:17:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8872)
[INFO] - 03-16 20:17:43 - [main.backward:225]: Epoch 125/300 - Iteration 174/199 - Time 0.292 batch, 0.042 data, 0.259 forward
[INFO] - 03-16 20:17:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:17:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0096 (0.0109)
[INFO] - 03-16 20:17:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5860 (0.5934)
[INFO] - 03-16 20:17:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4551 (-140.4616)
[INFO] - 03-16 20:17:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.7369 (22.7929)
[INFO] - 03-16 20:17:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 226.9528 (225.6548)
[INFO] - 03-16 20:17:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:17:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8514)
[INFO] - 03-16 20:17:51 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:17:51 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:17:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:17:51 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:17:51 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:17:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:17:51 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:17:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.050
[INFO] - 03-16 20:17:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.050
[INFO] - 03-16 20:17:56 - [main.summary_metrics:168]: Epoch 125/300 - Test Results:
{'auc': 0.8094816561844864,
 'f1': 0.3527431059506531,
 'loss': 0.5179722525798549,
 'ndcg': 0.6747044208258827,
 'precision': 0.5264150943396226,
 'recall': 0.26540880503144654}
[INFO] - 03-16 20:17:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[125] Complete. Time taken: 00:01:03.053
[INFO] - 03-16 20:17:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:17:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:17:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:17:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:17:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:17:56 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7224, 4992, 5139]
[INFO] - 03-16 20:17:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:18:03 - [main.backward:225]: Epoch 126/300 - Iteration 25/199 - Time 0.313 batch, 0.090 data, 0.280 forward
[INFO] - 03-16 20:18:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:18:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0117 (0.0099)
[INFO] - 03-16 20:18:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6223 (0.5934)
[INFO] - 03-16 20:18:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4371 (-140.4519)
[INFO] - 03-16 20:18:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.8736 (22.7175)
[INFO] - 03-16 20:18:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 225.8937 (226.9287)
[INFO] - 03-16 20:18:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:18:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8645)
[INFO] - 03-16 20:18:18 - [main.backward:225]: Epoch 126/300 - Iteration 75/199 - Time 0.292 batch, 0.054 data, 0.258 forward
[INFO] - 03-16 20:18:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:18:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0086 (0.0085)
[INFO] - 03-16 20:18:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6119 (0.5865)
[INFO] - 03-16 20:18:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3529 (-140.4737)
[INFO] - 03-16 20:18:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.8756 (22.9078)
[INFO] - 03-16 20:18:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 225.6080 (226.1477)
[INFO] - 03-16 20:18:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:18:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8956)
[INFO] - 03-16 20:18:32 - [main.backward:225]: Epoch 126/300 - Iteration 125/199 - Time 0.288 batch, 0.045 data, 0.254 forward
[INFO] - 03-16 20:18:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:18:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0107 (0.0096)
[INFO] - 03-16 20:18:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6168 (0.5869)
[INFO] - 03-16 20:18:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4677 (-140.4641)
[INFO] - 03-16 20:18:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.9268 (22.9318)
[INFO] - 03-16 20:18:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 224.5214 (224.9361)
[INFO] - 03-16 20:18:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:18:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8725)
[INFO] - 03-16 20:18:46 - [main.backward:225]: Epoch 126/300 - Iteration 175/199 - Time 0.288 batch, 0.042 data, 0.254 forward
[INFO] - 03-16 20:18:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:18:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0112)
[INFO] - 03-16 20:18:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5855 (0.5915)
[INFO] - 03-16 20:18:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4409 (-140.4633)
[INFO] - 03-16 20:18:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.6650 (22.7736)
[INFO] - 03-16 20:18:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 224.6309 (225.1341)
[INFO] - 03-16 20:18:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:18:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.8441)
[INFO] - 03-16 20:18:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:18:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:18:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:18:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:18:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:18:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:18:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:18:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.200
[INFO] - 03-16 20:18:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.202
[INFO] - 03-16 20:18:58 - [main.summary_metrics:168]: Epoch 126/300 - Test Results:
{'auc': 0.795650386530398,
 'f1': 0.3235607160135461,
 'loss': 0.5240985329586005,
 'ndcg': 0.6482339756425546,
 'precision': 0.4830188679245283,
 'recall': 0.24339622641509434}
[INFO] - 03-16 20:18:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[126] Complete. Time taken: 00:01:02.608
[INFO] - 03-16 20:18:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:18:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:18:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:18:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:18:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:18:58 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7205, 4991, 5144]
[INFO] - 03-16 20:19:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:19:07 - [main.backward:225]: Epoch 127/300 - Iteration 26/199 - Time 0.336 batch, 0.091 data, 0.304 forward
[INFO] - 03-16 20:19:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:19:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0132 (0.0099)
[INFO] - 03-16 20:19:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6224 (0.5920)
[INFO] - 03-16 20:19:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4260 (-140.4500)
[INFO] - 03-16 20:19:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.6964 (22.5688)
[INFO] - 03-16 20:19:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 226.2755 (225.9705)
[INFO] - 03-16 20:19:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:19:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8665)
[INFO] - 03-16 20:19:21 - [main.backward:225]: Epoch 127/300 - Iteration 76/199 - Time 0.303 batch, 0.057 data, 0.267 forward
[INFO] - 03-16 20:19:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:19:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0087)
[INFO] - 03-16 20:19:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5923 (0.5850)
[INFO] - 03-16 20:19:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4232 (-140.4733)
[INFO] - 03-16 20:19:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.5228 (22.6524)
[INFO] - 03-16 20:19:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 224.6075 (225.4284)
[INFO] - 03-16 20:19:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:19:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.8858)
[INFO] - 03-16 20:19:35 - [main.backward:225]: Epoch 127/300 - Iteration 126/199 - Time 0.291 batch, 0.047 data, 0.257 forward
[INFO] - 03-16 20:19:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:19:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0106 (0.0092)
[INFO] - 03-16 20:19:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6096 (0.5901)
[INFO] - 03-16 20:19:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4789 (-140.4658)
[INFO] - 03-16 20:19:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.8661 (22.7793)
[INFO] - 03-16 20:19:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 223.7878 (224.3441)
[INFO] - 03-16 20:19:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:19:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.8809)
[INFO] - 03-16 20:19:49 - [main.backward:225]: Epoch 127/300 - Iteration 176/199 - Time 0.287 batch, 0.043 data, 0.252 forward
[INFO] - 03-16 20:19:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:19:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0091 (0.0105)
[INFO] - 03-16 20:19:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5895 (0.5903)
[INFO] - 03-16 20:19:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4409 (-140.4621)
[INFO] - 03-16 20:19:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.6694 (22.7465)
[INFO] - 03-16 20:19:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 225.2161 (224.7372)
[INFO] - 03-16 20:19:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:19:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.8603)
[INFO] - 03-16 20:19:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:19:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:19:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:19:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:19:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:19:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:19:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:20:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.308
[INFO] - 03-16 20:20:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.309
[INFO] - 03-16 20:20:00 - [main.summary_metrics:168]: Epoch 127/300 - Test Results:
{'auc': 0.8158508254716983,
 'f1': 0.3778422835026608,
 'loss': 0.5201587684279467,
 'ndcg': 0.6868326070539502,
 'precision': 0.5641509433962264,
 'recall': 0.2841981132075472}
[INFO] - 03-16 20:20:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[127] Complete. Time taken: 00:01:01.960
[INFO] - 03-16 20:20:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:20:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:20:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:20:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:20:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:20:00 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7198, 4986, 5124]
[INFO] - 03-16 20:20:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:20:09 - [main.backward:225]: Epoch 128/300 - Iteration 27/199 - Time 0.339 batch, 0.093 data, 0.305 forward
[INFO] - 03-16 20:20:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0091 (0.0096)
[INFO] - 03-16 20:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6133 (0.5921)
[INFO] - 03-16 20:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4393 (-140.4502)
[INFO] - 03-16 20:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.8469 (22.7292)
[INFO] - 03-16 20:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 225.9017 (225.2478)
[INFO] - 03-16 20:20:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.8706)
[INFO] - 03-16 20:20:23 - [main.backward:225]: Epoch 128/300 - Iteration 77/199 - Time 0.299 batch, 0.055 data, 0.265 forward
[INFO] - 03-16 20:20:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:20:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0123 (0.0085)
[INFO] - 03-16 20:20:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5973 (0.5844)
[INFO] - 03-16 20:20:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4162 (-140.4689)
[INFO] - 03-16 20:20:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.6799 (22.7390)
[INFO] - 03-16 20:20:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 224.0733 (224.5779)
[INFO] - 03-16 20:20:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:20:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.8931)
[INFO] - 03-16 20:20:37 - [main.backward:225]: Epoch 128/300 - Iteration 127/199 - Time 0.293 batch, 0.047 data, 0.258 forward
[INFO] - 03-16 20:20:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:20:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0106 (0.0092)
[INFO] - 03-16 20:20:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5980 (0.5870)
[INFO] - 03-16 20:20:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4843 (-140.4677)
[INFO] - 03-16 20:20:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.7944 (22.6663)
[INFO] - 03-16 20:20:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 223.2094 (222.9845)
[INFO] - 03-16 20:20:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:20:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8802)
[INFO] - 03-16 20:20:51 - [main.backward:225]: Epoch 128/300 - Iteration 177/199 - Time 0.290 batch, 0.044 data, 0.255 forward
[INFO] - 03-16 20:20:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0126 (0.0100)
[INFO] - 03-16 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6049 (0.5899)
[INFO] - 03-16 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4252 (-140.4597)
[INFO] - 03-16 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.6371 (22.7655)
[INFO] - 03-16 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 224.8742 (224.5148)
[INFO] - 03-16 20:20:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.8617)
[INFO] - 03-16 20:20:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:20:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:20:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:20:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:20:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:20:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:20:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:21:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.941
[INFO] - 03-16 20:21:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.942
[INFO] - 03-16 20:21:03 - [main.summary_metrics:168]: Epoch 128/300 - Test Results:
{'auc': 0.793446770178197,
 'f1': 0.32381228834059017,
 'loss': 0.5256536055430926,
 'ndcg': 0.6453685346222094,
 'precision': 0.4830188679245283,
 'recall': 0.2437106918238994}
[INFO] - 03-16 20:21:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[128] Complete. Time taken: 00:01:02.283
[INFO] - 03-16 20:21:03 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:21:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:21:03 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:21:03 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:21:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:21:03 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7238, 5015, 5145]
[INFO] - 03-16 20:21:04 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:21:12 - [main.backward:225]: Epoch 129/300 - Iteration 28/199 - Time 0.341 batch, 0.089 data, 0.308 forward
[INFO] - 03-16 20:21:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:21:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0092 (0.0098)
[INFO] - 03-16 20:21:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6222 (0.5926)
[INFO] - 03-16 20:21:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4301 (-140.4520)
[INFO] - 03-16 20:21:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.6439 (22.6019)
[INFO] - 03-16 20:21:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 223.8831 (224.1215)
[INFO] - 03-16 20:21:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:21:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.8660)
[INFO] - 03-16 20:21:26 - [main.backward:225]: Epoch 129/300 - Iteration 78/199 - Time 0.306 batch, 0.054 data, 0.273 forward
[INFO] - 03-16 20:21:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0146 (0.0080)
[INFO] - 03-16 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5873 (0.5822)
[INFO] - 03-16 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4224 (-140.4671)
[INFO] - 03-16 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.5191 (22.5860)
[INFO] - 03-16 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 222.1593 (223.4213)
[INFO] - 03-16 20:21:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7734 (0.8991)
[INFO] - 03-16 20:21:41 - [main.backward:225]: Epoch 129/300 - Iteration 128/199 - Time 0.299 batch, 0.047 data, 0.264 forward
[INFO] - 03-16 20:21:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:21:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0081 (0.0086)
[INFO] - 03-16 20:21:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6018 (0.5867)
[INFO] - 03-16 20:21:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4747 (-140.4649)
[INFO] - 03-16 20:21:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.5735 (22.5462)
[INFO] - 03-16 20:21:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.8967 (223.2230)
[INFO] - 03-16 20:21:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:21:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.8877)
[INFO] - 03-16 20:21:54 - [main.backward:225]: Epoch 129/300 - Iteration 178/199 - Time 0.292 batch, 0.044 data, 0.257 forward
[INFO] - 03-16 20:21:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:21:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0109 (0.0093)
[INFO] - 03-16 20:21:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6148 (0.5916)
[INFO] - 03-16 20:21:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4307 (-140.4551)
[INFO] - 03-16 20:21:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.4837 (22.4571)
[INFO] - 03-16 20:21:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 223.5900 (222.8627)
[INFO] - 03-16 20:21:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:21:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8758)
[INFO] - 03-16 20:22:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:22:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:22:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:22:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:22:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:22:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:22:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:22:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.939
[INFO] - 03-16 20:22:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.942
[INFO] - 03-16 20:22:05 - [main.summary_metrics:168]: Epoch 129/300 - Test Results:
{'auc': 0.8189147667714882,
 'f1': 0.3562651185292694,
 'loss': 0.5053859706694726,
 'ndcg': 0.6816591483817204,
 'precision': 0.5320754716981132,
 'recall': 0.2679245283018868}
[INFO] - 03-16 20:22:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[129] Complete. Time taken: 00:01:03.102
[INFO] - 03-16 20:22:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:22:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:22:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:22:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:22:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:22:06 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7261, 4995, 5138]
[INFO] - 03-16 20:22:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:22:15 - [main.backward:225]: Epoch 130/300 - Iteration 29/199 - Time 0.330 batch, 0.083 data, 0.299 forward
[INFO] - 03-16 20:22:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0155 (0.0091)
[INFO] - 03-16 20:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6081 (0.5921)
[INFO] - 03-16 20:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4227 (-140.4514)
[INFO] - 03-16 20:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.3771 (22.4132)
[INFO] - 03-16 20:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 222.6129 (222.7373)
[INFO] - 03-16 20:22:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:22:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7500 (0.8795)
[INFO] - 03-16 20:22:29 - [main.backward:225]: Epoch 130/300 - Iteration 79/199 - Time 0.302 batch, 0.052 data, 0.269 forward
[INFO] - 03-16 20:22:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0073)
[INFO] - 03-16 20:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5980 (0.5805)
[INFO] - 03-16 20:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4037 (-140.4643)
[INFO] - 03-16 20:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.5592 (22.4940)
[INFO] - 03-16 20:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 222.8748 (222.3743)
[INFO] - 03-16 20:22:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9130)
[INFO] - 03-16 20:22:44 - [main.backward:225]: Epoch 130/300 - Iteration 129/199 - Time 0.297 batch, 0.045 data, 0.264 forward
[INFO] - 03-16 20:22:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0081 (0.0085)
[INFO] - 03-16 20:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5978 (0.5889)
[INFO] - 03-16 20:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4244 (-140.4568)
[INFO] - 03-16 20:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.6215 (22.5834)
[INFO] - 03-16 20:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.8835 (222.2256)
[INFO] - 03-16 20:22:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:22:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.8889)
[INFO] - 03-16 20:22:58 - [main.backward:225]: Epoch 130/300 - Iteration 179/199 - Time 0.292 batch, 0.042 data, 0.259 forward
[INFO] - 03-16 20:22:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0144 (0.0097)
[INFO] - 03-16 20:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6064 (0.5925)
[INFO] - 03-16 20:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4168 (-140.4489)
[INFO] - 03-16 20:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.4782 (22.4554)
[INFO] - 03-16 20:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 223.5854 (222.3988)
[INFO] - 03-16 20:22:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.8692)
[INFO] - 03-16 20:23:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:23:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:23:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:23:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:23:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:23:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:23:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:23:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.888
[INFO] - 03-16 20:23:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.888
[INFO] - 03-16 20:23:08 - [main.summary_metrics:168]: Epoch 130/300 - Test Results:
{'auc': 0.8247766968029352,
 'f1': 0.3772036768263183,
 'loss': 0.4995841587954348,
 'ndcg': 0.6937797268321889,
 'precision': 0.5622641509433963,
 'recall': 0.2840408805031447}
[INFO] - 03-16 20:23:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[130] Complete. Time taken: 00:01:02.879
[INFO] - 03-16 20:23:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:23:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:23:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:23:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:23:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:23:09 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7244, 5016, 5141]
[INFO] - 03-16 20:23:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:23:18 - [main.backward:225]: Epoch 131/300 - Iteration 30/199 - Time 0.328 batch, 0.091 data, 0.289 forward
[INFO] - 03-16 20:23:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:23:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0089 (0.0089)
[INFO] - 03-16 20:23:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6104 (0.5927)
[INFO] - 03-16 20:23:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4107 (-140.4430)
[INFO] - 03-16 20:23:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.4631 (22.4505)
[INFO] - 03-16 20:23:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.5228 (222.9023)
[INFO] - 03-16 20:23:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:23:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.8844)
[INFO] - 03-16 20:23:33 - [main.backward:225]: Epoch 131/300 - Iteration 80/199 - Time 0.300 batch, 0.057 data, 0.263 forward
[INFO] - 03-16 20:23:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0125 (0.0077)
[INFO] - 03-16 20:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6099 (0.5811)
[INFO] - 03-16 20:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3674 (-140.4618)
[INFO] - 03-16 20:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.4052 (22.4624)
[INFO] - 03-16 20:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 223.4221 (222.4735)
[INFO] - 03-16 20:23:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8125 (0.9055)
[INFO] - 03-16 20:23:46 - [main.backward:225]: Epoch 131/300 - Iteration 130/199 - Time 0.291 batch, 0.048 data, 0.255 forward
[INFO] - 03-16 20:23:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:23:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0083 (0.0087)
[INFO] - 03-16 20:23:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6079 (0.5857)
[INFO] - 03-16 20:23:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4206 (-140.4548)
[INFO] - 03-16 20:23:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.4710 (22.5100)
[INFO] - 03-16 20:23:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.2491 (222.0440)
[INFO] - 03-16 20:23:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:23:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8845)
[INFO] - 03-16 20:24:00 - [main.backward:225]: Epoch 131/300 - Iteration 180/199 - Time 0.289 batch, 0.044 data, 0.253 forward
[INFO] - 03-16 20:24:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:24:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0112 (0.0090)
[INFO] - 03-16 20:24:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6109 (0.5909)
[INFO] - 03-16 20:24:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4097 (-140.4480)
[INFO] - 03-16 20:24:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.3374 (22.3448)
[INFO] - 03-16 20:24:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.5261 (221.6436)
[INFO] - 03-16 20:24:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:24:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.8844)
[INFO] - 03-16 20:24:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:24:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:24:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:24:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:24:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:24:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:24:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:24:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.066
[INFO] - 03-16 20:24:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.066
[INFO] - 03-16 20:24:11 - [main.summary_metrics:168]: Epoch 131/300 - Test Results:
{'auc': 0.823738371331237,
 'f1': 0.36789550072568933,
 'loss': 0.4981165876088651,
 'ndcg': 0.6956406183424724,
 'precision': 0.5490566037735849,
 'recall': 0.27680817610062897}
[INFO] - 03-16 20:24:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[131] Complete. Time taken: 00:01:02.549
[INFO] - 03-16 20:24:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:24:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:24:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:24:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:24:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:24:11 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7240, 4996, 5129]
[INFO] - 03-16 20:24:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:24:21 - [main.backward:225]: Epoch 132/300 - Iteration 31/199 - Time 0.325 batch, 0.080 data, 0.291 forward
[INFO] - 03-16 20:24:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:24:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0086)
[INFO] - 03-16 20:24:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5694 (0.5923)
[INFO] - 03-16 20:24:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4478 (-140.4343)
[INFO] - 03-16 20:24:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.3626 (22.3446)
[INFO] - 03-16 20:24:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 223.1874 (222.2716)
[INFO] - 03-16 20:24:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:24:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.8835)
[INFO] - 03-16 20:24:35 - [main.backward:225]: Epoch 132/300 - Iteration 81/199 - Time 0.293 batch, 0.052 data, 0.259 forward
[INFO] - 03-16 20:24:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0105 (0.0073)
[INFO] - 03-16 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6169 (0.5824)
[INFO] - 03-16 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3656 (-140.4559)
[INFO] - 03-16 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.4592 (22.4356)
[INFO] - 03-16 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 223.9910 (222.4127)
[INFO] - 03-16 20:24:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.9114)
[INFO] - 03-16 20:24:49 - [main.backward:225]: Epoch 132/300 - Iteration 131/199 - Time 0.289 batch, 0.045 data, 0.255 forward
[INFO] - 03-16 20:24:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0099 (0.0084)
[INFO] - 03-16 20:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5968 (0.5864)
[INFO] - 03-16 20:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3907 (-140.4499)
[INFO] - 03-16 20:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.5052 (22.4314)
[INFO] - 03-16 20:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.7052 (221.7234)
[INFO] - 03-16 20:24:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8961)
[INFO] - 03-16 20:25:03 - [main.backward:225]: Epoch 132/300 - Iteration 181/199 - Time 0.288 batch, 0.043 data, 0.254 forward
[INFO] - 03-16 20:25:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:25:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0084 (0.0092)
[INFO] - 03-16 20:25:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6004 (0.5928)
[INFO] - 03-16 20:25:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4094 (-140.4442)
[INFO] - 03-16 20:25:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2874 (22.3501)
[INFO] - 03-16 20:25:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.8529 (221.5808)
[INFO] - 03-16 20:25:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:25:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8786)
[INFO] - 03-16 20:25:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:25:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:25:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:25:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:25:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:25:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:25:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:25:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.024
[INFO] - 03-16 20:25:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.024
[INFO] - 03-16 20:25:13 - [main.summary_metrics:168]: Epoch 132/300 - Test Results:
{'auc': 0.8195382599580713,
 'f1': 0.362051282051282,
 'loss': 0.5017232452248627,
 'ndcg': 0.6814540159714242,
 'precision': 0.5396226415094341,
 'recall': 0.27264150943396226}
[INFO] - 03-16 20:25:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[132] Complete. Time taken: 00:01:02.315
[INFO] - 03-16 20:25:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:25:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:25:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:25:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:25:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:25:13 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7248, 5001, 5148]
[INFO] - 03-16 20:25:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:25:24 - [main.backward:225]: Epoch 133/300 - Iteration 32/199 - Time 0.324 batch, 0.078 data, 0.291 forward
[INFO] - 03-16 20:25:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0087)
[INFO] - 03-16 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5744 (0.5915)
[INFO] - 03-16 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4392 (-140.4322)
[INFO] - 03-16 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2801 (22.3272)
[INFO] - 03-16 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 222.0235 (222.8503)
[INFO] - 03-16 20:25:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.8852)
[INFO] - 03-16 20:25:37 - [main.backward:225]: Epoch 133/300 - Iteration 82/199 - Time 0.293 batch, 0.053 data, 0.258 forward
[INFO] - 03-16 20:25:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0087 (0.0075)
[INFO] - 03-16 20:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6171 (0.5827)
[INFO] - 03-16 20:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3407 (-140.4526)
[INFO] - 03-16 20:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.4042 (22.4187)
[INFO] - 03-16 20:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 222.8092 (222.4127)
[INFO] - 03-16 20:25:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9094)
[INFO] - 03-16 20:25:51 - [main.backward:225]: Epoch 133/300 - Iteration 132/199 - Time 0.287 batch, 0.046 data, 0.252 forward
[INFO] - 03-16 20:25:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0090 (0.0082)
[INFO] - 03-16 20:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5965 (0.5867)
[INFO] - 03-16 20:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4409 (-140.4480)
[INFO] - 03-16 20:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.4190 (22.4088)
[INFO] - 03-16 20:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 222.8525 (221.6845)
[INFO] - 03-16 20:25:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8927)
[INFO] - 03-16 20:26:05 - [main.backward:225]: Epoch 133/300 - Iteration 182/199 - Time 0.284 batch, 0.043 data, 0.250 forward
[INFO] - 03-16 20:26:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0110 (0.0091)
[INFO] - 03-16 20:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6001 (0.5912)
[INFO] - 03-16 20:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4018 (-140.4419)
[INFO] - 03-16 20:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2989 (22.3565)
[INFO] - 03-16 20:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 222.3869 (221.7129)
[INFO] - 03-16 20:26:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:26:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8788)
[INFO] - 03-16 20:26:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:26:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:26:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:26:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:26:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:26:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:26:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:26:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.042
[INFO] - 03-16 20:26:15 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.045
[INFO] - 03-16 20:26:15 - [main.summary_metrics:168]: Epoch 133/300 - Test Results:
{'auc': 0.8127263495807128,
 'f1': 0.3515432994678276,
 'loss': 0.5027791788593028,
 'ndcg': 0.6671744486034213,
 'precision': 0.5245283018867924,
 'recall': 0.26454402515723274}
[INFO] - 03-16 20:26:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[133] Complete. Time taken: 00:01:01.570
[INFO] - 03-16 20:26:15 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:26:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:26:15 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:26:15 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:26:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:26:15 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7246, 5002, 5108]
[INFO] - 03-16 20:26:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:26:26 - [main.backward:225]: Epoch 134/300 - Iteration 33/199 - Time 0.337 batch, 0.086 data, 0.301 forward
[INFO] - 03-16 20:26:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:26:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0083)
[INFO] - 03-16 20:26:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5623 (0.5907)
[INFO] - 03-16 20:26:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4476 (-140.4333)
[INFO] - 03-16 20:26:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2428 (22.2173)
[INFO] - 03-16 20:26:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.0045 (222.2307)
[INFO] - 03-16 20:26:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:26:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.8902)
[INFO] - 03-16 20:26:40 - [main.backward:225]: Epoch 134/300 - Iteration 83/199 - Time 0.300 batch, 0.054 data, 0.266 forward
[INFO] - 03-16 20:26:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:26:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0073)
[INFO] - 03-16 20:26:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6091 (0.5837)
[INFO] - 03-16 20:26:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3442 (-140.4457)
[INFO] - 03-16 20:26:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.3348 (22.3891)
[INFO] - 03-16 20:26:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 222.4518 (221.9419)
[INFO] - 03-16 20:26:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:26:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9086)
[INFO] - 03-16 20:26:54 - [main.backward:225]: Epoch 134/300 - Iteration 133/199 - Time 0.292 batch, 0.047 data, 0.258 forward
[INFO] - 03-16 20:26:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0141 (0.0083)
[INFO] - 03-16 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6057 (0.5845)
[INFO] - 03-16 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4715 (-140.4479)
[INFO] - 03-16 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.3236 (22.3139)
[INFO] - 03-16 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.7582 (221.2082)
[INFO] - 03-16 20:26:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7969 (0.8925)
[INFO] - 03-16 20:27:08 - [main.backward:225]: Epoch 134/300 - Iteration 183/199 - Time 0.291 batch, 0.044 data, 0.256 forward
[INFO] - 03-16 20:27:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0119 (0.0088)
[INFO] - 03-16 20:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5950 (0.5910)
[INFO] - 03-16 20:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3990 (-140.4387)
[INFO] - 03-16 20:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.1900 (22.2389)
[INFO] - 03-16 20:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.5435 (221.0915)
[INFO] - 03-16 20:27:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8888)
[INFO] - 03-16 20:27:12 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:27:12 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:27:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:27:12 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:27:12 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:27:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:27:12 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:27:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.020
[INFO] - 03-16 20:27:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.022
[INFO] - 03-16 20:27:17 - [main.summary_metrics:168]: Epoch 134/300 - Test Results:
{'auc': 0.8284825078616352,
 'f1': 0.3977745524915335,
 'loss': 0.49608437481766227,
 'ndcg': 0.7090081007639705,
 'precision': 0.5924528301886792,
 'recall': 0.299685534591195}
[INFO] - 03-16 20:27:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[134] Complete. Time taken: 00:01:02.469
[INFO] - 03-16 20:27:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:27:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:27:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:27:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:27:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:27:17 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7225, 5008, 5141]
[INFO] - 03-16 20:27:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:27:28 - [main.backward:225]: Epoch 135/300 - Iteration 34/199 - Time 0.316 batch, 0.076 data, 0.282 forward
[INFO] - 03-16 20:27:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:27:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0088)
[INFO] - 03-16 20:27:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5625 (0.5906)
[INFO] - 03-16 20:27:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4537 (-140.4342)
[INFO] - 03-16 20:27:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2057 (22.2391)
[INFO] - 03-16 20:27:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.6263 (221.5736)
[INFO] - 03-16 20:27:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:27:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.8838)
[INFO] - 03-16 20:27:42 - [main.backward:225]: Epoch 135/300 - Iteration 84/199 - Time 0.294 batch, 0.051 data, 0.260 forward
[INFO] - 03-16 20:27:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:27:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0107 (0.0076)
[INFO] - 03-16 20:27:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6146 (0.5835)
[INFO] - 03-16 20:27:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3672 (-140.4427)
[INFO] - 03-16 20:27:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.3816 (22.2765)
[INFO] - 03-16 20:27:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 220.6717 (220.9971)
[INFO] - 03-16 20:27:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:27:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.9083)
[INFO] - 03-16 20:27:56 - [main.backward:225]: Epoch 135/300 - Iteration 134/199 - Time 0.289 batch, 0.044 data, 0.256 forward
[INFO] - 03-16 20:27:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:27:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0116 (0.0078)
[INFO] - 03-16 20:27:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6043 (0.5845)
[INFO] - 03-16 20:27:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4749 (-140.4475)
[INFO] - 03-16 20:27:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2872 (22.3547)
[INFO] - 03-16 20:27:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 220.7960 (220.6277)
[INFO] - 03-16 20:27:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:27:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.9023)
[INFO] - 03-16 20:28:10 - [main.backward:225]: Epoch 135/300 - Iteration 184/199 - Time 0.286 batch, 0.041 data, 0.253 forward
[INFO] - 03-16 20:28:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:28:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0086 (0.0084)
[INFO] - 03-16 20:28:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6060 (0.5904)
[INFO] - 03-16 20:28:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3970 (-140.4337)
[INFO] - 03-16 20:28:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2445 (22.3136)
[INFO] - 03-16 20:28:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.4926 (221.0953)
[INFO] - 03-16 20:28:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:28:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8939)
[INFO] - 03-16 20:28:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:28:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:28:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:28:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:28:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:28:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:28:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:28:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.287
[INFO] - 03-16 20:28:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.287
[INFO] - 03-16 20:28:20 - [main.summary_metrics:168]: Epoch 135/300 - Test Results:
{'auc': 0.8198586215932915,
 'f1': 0.35688437348814694,
 'loss': 0.49956283900422865,
 'ndcg': 0.6817170507359822,
 'precision': 0.5320754716981131,
 'recall': 0.2687106918238994}
[INFO] - 03-16 20:28:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[135] Complete. Time taken: 00:01:02.350
[INFO] - 03-16 20:28:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:28:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:28:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:28:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:28:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:28:20 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7250, 4996, 5161]
[INFO] - 03-16 20:28:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:28:31 - [main.backward:225]: Epoch 136/300 - Iteration 35/199 - Time 0.309 batch, 0.079 data, 0.272 forward
[INFO] - 03-16 20:28:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0083 (0.0084)
[INFO] - 03-16 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5965 (0.5902)
[INFO] - 03-16 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4535 (-140.4332)
[INFO] - 03-16 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.1969 (22.2009)
[INFO] - 03-16 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.3493 (222.0176)
[INFO] - 03-16 20:28:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.8848)
[INFO] - 03-16 20:28:44 - [main.backward:225]: Epoch 136/300 - Iteration 85/199 - Time 0.291 batch, 0.052 data, 0.257 forward
[INFO] - 03-16 20:28:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:28:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0091 (0.0071)
[INFO] - 03-16 20:28:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6204 (0.5829)
[INFO] - 03-16 20:28:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3747 (-140.4381)
[INFO] - 03-16 20:28:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.3104 (22.2633)
[INFO] - 03-16 20:28:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.9230 (221.1878)
[INFO] - 03-16 20:28:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:28:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9194)
[INFO] - 03-16 20:28:59 - [main.backward:225]: Epoch 136/300 - Iteration 135/199 - Time 0.289 batch, 0.045 data, 0.254 forward
[INFO] - 03-16 20:28:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0179 (0.0081)
[INFO] - 03-16 20:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5984 (0.5852)
[INFO] - 03-16 20:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4609 (-140.4488)
[INFO] - 03-16 20:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.1347 (22.3486)
[INFO] - 03-16 20:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.5224 (220.4409)
[INFO] - 03-16 20:28:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:28:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.8989)
[INFO] - 03-16 20:29:13 - [main.backward:225]: Epoch 136/300 - Iteration 185/199 - Time 0.288 batch, 0.042 data, 0.254 forward
[INFO] - 03-16 20:29:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0080 (0.0084)
[INFO] - 03-16 20:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6177 (0.5908)
[INFO] - 03-16 20:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3360 (-140.4273)
[INFO] - 03-16 20:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.1542 (22.2162)
[INFO] - 03-16 20:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.3793 (220.6911)
[INFO] - 03-16 20:29:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.8895)
[INFO] - 03-16 20:29:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:29:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:29:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:29:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:29:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:29:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:29:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:29:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.254
[INFO] - 03-16 20:29:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.255
[INFO] - 03-16 20:29:22 - [main.summary_metrics:168]: Epoch 136/300 - Test Results:
{'auc': 0.8214795597484278,
 'f1': 0.3611030478955006,
 'loss': 0.4958226901600195,
 'ndcg': 0.6895611654611233,
 'precision': 0.5377358490566038,
 'recall': 0.27209119496855344}
[INFO] - 03-16 20:29:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[136] Complete. Time taken: 00:01:02.404
[INFO] - 03-16 20:29:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:29:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:29:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:29:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:29:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:29:22 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7216, 4988, 5135]
[INFO] - 03-16 20:29:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:29:34 - [main.backward:225]: Epoch 137/300 - Iteration 36/199 - Time 0.323 batch, 0.082 data, 0.289 forward
[INFO] - 03-16 20:29:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:29:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0084 (0.0081)
[INFO] - 03-16 20:29:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5799 (0.5890)
[INFO] - 03-16 20:29:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4512 (-140.4309)
[INFO] - 03-16 20:29:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.0480 (22.1328)
[INFO] - 03-16 20:29:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 220.4404 (221.5928)
[INFO] - 03-16 20:29:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:29:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8935)
[INFO] - 03-16 20:29:48 - [main.backward:225]: Epoch 137/300 - Iteration 86/199 - Time 0.298 batch, 0.055 data, 0.262 forward
[INFO] - 03-16 20:29:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:29:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0107 (0.0075)
[INFO] - 03-16 20:29:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6060 (0.5846)
[INFO] - 03-16 20:29:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3774 (-140.4321)
[INFO] - 03-16 20:29:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2330 (22.2062)
[INFO] - 03-16 20:29:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 220.5904 (221.1948)
[INFO] - 03-16 20:29:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:29:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.9075)
[INFO] - 03-16 20:30:02 - [main.backward:225]: Epoch 137/300 - Iteration 136/199 - Time 0.292 batch, 0.047 data, 0.258 forward
[INFO] - 03-16 20:30:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:30:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0078)
[INFO] - 03-16 20:30:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6113 (0.5849)
[INFO] - 03-16 20:30:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3959 (-140.4479)
[INFO] - 03-16 20:30:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2373 (22.2998)
[INFO] - 03-16 20:30:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 220.8289 (220.1158)
[INFO] - 03-16 20:30:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:30:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9008)
[INFO] - 03-16 20:30:16 - [main.backward:225]: Epoch 137/300 - Iteration 186/199 - Time 0.289 batch, 0.044 data, 0.254 forward
[INFO] - 03-16 20:30:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0082)
[INFO] - 03-16 20:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6202 (0.5906)
[INFO] - 03-16 20:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3197 (-140.4239)
[INFO] - 03-16 20:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.1974 (22.2582)
[INFO] - 03-16 20:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 220.0566 (220.4141)
[INFO] - 03-16 20:30:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:30:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.8989)
[INFO] - 03-16 20:30:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:30:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:30:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:30:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:30:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:30:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:30:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:30:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.010
[INFO] - 03-16 20:30:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.010
[INFO] - 03-16 20:30:25 - [main.summary_metrics:168]: Epoch 137/300 - Test Results:
{'auc': 0.8281449488993711,
 'f1': 0.38091920657958384,
 'loss': 0.4961961217436401,
 'ndcg': 0.6972044187012718,
 'precision': 0.5679245283018868,
 'recall': 0.2867924528301887}
[INFO] - 03-16 20:30:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[137] Complete. Time taken: 00:01:02.609
[INFO] - 03-16 20:30:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:30:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:30:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:30:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:30:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:30:25 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7240, 4968, 5114]
[INFO] - 03-16 20:30:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:30:37 - [main.backward:225]: Epoch 138/300 - Iteration 37/199 - Time 0.327 batch, 0.077 data, 0.292 forward
[INFO] - 03-16 20:30:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:30:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0114 (0.0085)
[INFO] - 03-16 20:30:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5939 (0.5896)
[INFO] - 03-16 20:30:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4412 (-140.4306)
[INFO] - 03-16 20:30:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.1575 (22.1942)
[INFO] - 03-16 20:30:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 221.1528 (220.7400)
[INFO] - 03-16 20:30:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:30:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.8847)
[INFO] - 03-16 20:30:51 - [main.backward:225]: Epoch 138/300 - Iteration 87/199 - Time 0.302 batch, 0.052 data, 0.267 forward
[INFO] - 03-16 20:30:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:30:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0090 (0.0074)
[INFO] - 03-16 20:30:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5836)
[INFO] - 03-16 20:30:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4529 (-140.4293)
[INFO] - 03-16 20:30:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2523 (22.1789)
[INFO] - 03-16 20:30:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 220.4093 (219.9600)
[INFO] - 03-16 20:30:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:30:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.9075)
[INFO] - 03-16 20:31:05 - [main.backward:225]: Epoch 138/300 - Iteration 137/199 - Time 0.293 batch, 0.046 data, 0.258 forward
[INFO] - 03-16 20:31:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:31:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0081)
[INFO] - 03-16 20:31:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6095 (0.5839)
[INFO] - 03-16 20:31:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3960 (-140.4476)
[INFO] - 03-16 20:31:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.0657 (22.2004)
[INFO] - 03-16 20:31:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.2080 (219.3886)
[INFO] - 03-16 20:31:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:31:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8967)
[INFO] - 03-16 20:31:18 - [main.backward:225]: Epoch 138/300 - Iteration 187/199 - Time 0.287 batch, 0.043 data, 0.252 forward
[INFO] - 03-16 20:31:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0099 (0.0086)
[INFO] - 03-16 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6134 (0.5898)
[INFO] - 03-16 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3553 (-140.4225)
[INFO] - 03-16 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.0339 (22.1142)
[INFO] - 03-16 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.9633 (219.9420)
[INFO] - 03-16 20:31:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8847)
[INFO] - 03-16 20:31:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:31:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:31:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:31:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:31:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:31:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:31:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:31:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.916
[INFO] - 03-16 20:31:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.917
[INFO] - 03-16 20:31:26 - [main.summary_metrics:168]: Epoch 138/300 - Test Results:
{'auc': 0.8186975890985325,
 'f1': 0.37343009192065785,
 'loss': 0.4974332777699085,
 'ndcg': 0.6871877113392775,
 'precision': 0.5566037735849058,
 'recall': 0.28121069182389935}
[INFO] - 03-16 20:31:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[138] Complete. Time taken: 00:01:01.571
[INFO] - 03-16 20:31:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:31:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:31:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:31:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:31:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:31:26 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7217, 4969, 5130]
[INFO] - 03-16 20:31:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:31:38 - [main.backward:225]: Epoch 139/300 - Iteration 38/199 - Time 0.317 batch, 0.069 data, 0.286 forward
[INFO] - 03-16 20:31:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:31:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0081 (0.0079)
[INFO] - 03-16 20:31:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5955 (0.5884)
[INFO] - 03-16 20:31:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4230 (-140.4313)
[INFO] - 03-16 20:31:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.1015 (22.1068)
[INFO] - 03-16 20:31:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 218.5894 (219.9449)
[INFO] - 03-16 20:31:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:31:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.8954)
[INFO] - 03-16 20:31:53 - [main.backward:225]: Epoch 139/300 - Iteration 88/199 - Time 0.298 batch, 0.048 data, 0.266 forward
[INFO] - 03-16 20:31:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0087 (0.0067)
[INFO] - 03-16 20:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5676 (0.5842)
[INFO] - 03-16 20:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4793 (-140.4267)
[INFO] - 03-16 20:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2026 (22.2179)
[INFO] - 03-16 20:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.6402 (219.2660)
[INFO] - 03-16 20:31:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9197)
[INFO] - 03-16 20:32:07 - [main.backward:225]: Epoch 139/300 - Iteration 138/199 - Time 0.292 batch, 0.044 data, 0.259 forward
[INFO] - 03-16 20:32:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:32:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0075)
[INFO] - 03-16 20:32:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6040 (0.5884)
[INFO] - 03-16 20:32:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3856 (-140.4423)
[INFO] - 03-16 20:32:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.0369 (22.2109)
[INFO] - 03-16 20:32:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.3355 (219.2915)
[INFO] - 03-16 20:32:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:32:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9072)
[INFO] - 03-16 20:32:21 - [main.backward:225]: Epoch 139/300 - Iteration 188/199 - Time 0.288 batch, 0.041 data, 0.255 forward
[INFO] - 03-16 20:32:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0098 (0.0088)
[INFO] - 03-16 20:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5985 (0.5880)
[INFO] - 03-16 20:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3629 (-140.4236)
[INFO] - 03-16 20:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.0639 (22.1290)
[INFO] - 03-16 20:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.4853 (218.7516)
[INFO] - 03-16 20:32:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8812)
[INFO] - 03-16 20:32:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:32:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:32:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:32:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:32:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:32:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:32:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:32:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.673
[INFO] - 03-16 20:32:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.674
[INFO] - 03-16 20:32:28 - [main.summary_metrics:168]: Epoch 139/300 - Test Results:
{'auc': 0.830350825471698,
 'f1': 0.37726173197871304,
 'loss': 0.4865976249406923,
 'ndcg': 0.7028962805855212,
 'precision': 0.5622641509433962,
 'recall': 0.28411949685534593}
[INFO] - 03-16 20:32:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[139] Complete. Time taken: 00:01:01.863
[INFO] - 03-16 20:32:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:32:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:32:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:32:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:32:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:32:28 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7238, 5004, 5138]
[INFO] - 03-16 20:32:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:32:41 - [main.backward:225]: Epoch 140/300 - Iteration 39/199 - Time 0.316 batch, 0.069 data, 0.282 forward
[INFO] - 03-16 20:32:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:32:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0077)
[INFO] - 03-16 20:32:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5835 (0.5884)
[INFO] - 03-16 20:32:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4131 (-140.4308)
[INFO] - 03-16 20:32:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.1346 (22.0997)
[INFO] - 03-16 20:32:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.3554 (219.8683)
[INFO] - 03-16 20:32:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:32:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.8928)
[INFO] - 03-16 20:32:54 - [main.backward:225]: Epoch 140/300 - Iteration 89/199 - Time 0.293 batch, 0.048 data, 0.260 forward
[INFO] - 03-16 20:32:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:32:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0076 (0.0070)
[INFO] - 03-16 20:32:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5646 (0.5811)
[INFO] - 03-16 20:32:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4815 (-140.4226)
[INFO] - 03-16 20:32:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2708 (22.1905)
[INFO] - 03-16 20:32:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.5766 (219.7181)
[INFO] - 03-16 20:32:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:32:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9144)
[INFO] - 03-16 20:33:09 - [main.backward:225]: Epoch 140/300 - Iteration 139/199 - Time 0.292 batch, 0.044 data, 0.258 forward
[INFO] - 03-16 20:33:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0079)
[INFO] - 03-16 20:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5973 (0.5869)
[INFO] - 03-16 20:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4218 (-140.4392)
[INFO] - 03-16 20:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9971 (22.1694)
[INFO] - 03-16 20:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.5304 (219.1940)
[INFO] - 03-16 20:33:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.8927)
[INFO] - 03-16 20:33:23 - [main.backward:225]: Epoch 140/300 - Iteration 189/199 - Time 0.289 batch, 0.042 data, 0.255 forward
[INFO] - 03-16 20:33:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:33:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0080)
[INFO] - 03-16 20:33:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6058 (0.5902)
[INFO] - 03-16 20:33:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3698 (-140.4180)
[INFO] - 03-16 20:33:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.0685 (22.0364)
[INFO] - 03-16 20:33:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 220.6498 (219.1859)
[INFO] - 03-16 20:33:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:33:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9003)
[INFO] - 03-16 20:33:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:33:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:33:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:33:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:33:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:33:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:33:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:33:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.073
[INFO] - 03-16 20:33:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.073
[INFO] - 03-16 20:33:31 - [main.summary_metrics:168]: Epoch 140/300 - Test Results:
{'auc': 0.8233900681341718,
 'f1': 0.37449443638122876,
 'loss': 0.49032541115878764,
 'ndcg': 0.6937901978040719,
 'precision': 0.558490566037736,
 'recall': 0.2819182389937107}
[INFO] - 03-16 20:33:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[140] Complete. Time taken: 00:01:02.511
[INFO] - 03-16 20:33:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:33:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:33:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:33:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:33:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:33:31 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7231, 5001, 5113]
[INFO] - 03-16 20:33:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:33:44 - [main.backward:225]: Epoch 141/300 - Iteration 40/199 - Time 0.321 batch, 0.076 data, 0.286 forward
[INFO] - 03-16 20:33:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:33:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0118 (0.0080)
[INFO] - 03-16 20:33:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5899 (0.5883)
[INFO] - 03-16 20:33:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4347 (-140.4313)
[INFO] - 03-16 20:33:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.0934 (22.0210)
[INFO] - 03-16 20:33:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.6034 (219.5238)
[INFO] - 03-16 20:33:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:33:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8928)
[INFO] - 03-16 20:33:58 - [main.backward:225]: Epoch 141/300 - Iteration 90/199 - Time 0.301 batch, 0.053 data, 0.266 forward
[INFO] - 03-16 20:33:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:33:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0081 (0.0072)
[INFO] - 03-16 20:33:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5755 (0.5812)
[INFO] - 03-16 20:33:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4678 (-140.4236)
[INFO] - 03-16 20:33:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2124 (22.1025)
[INFO] - 03-16 20:33:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 218.1834 (219.0307)
[INFO] - 03-16 20:33:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:33:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9111)
[INFO] - 03-16 20:34:11 - [main.backward:225]: Epoch 141/300 - Iteration 140/199 - Time 0.291 batch, 0.045 data, 0.258 forward
[INFO] - 03-16 20:34:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0152 (0.0080)
[INFO] - 03-16 20:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5672 (0.5870)
[INFO] - 03-16 20:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4800 (-140.4384)
[INFO] - 03-16 20:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8927 (22.1071)
[INFO] - 03-16 20:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 218.7425 (218.6952)
[INFO] - 03-16 20:34:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.8973)
[INFO] - 03-16 20:34:25 - [main.backward:225]: Epoch 141/300 - Iteration 190/199 - Time 0.286 batch, 0.041 data, 0.254 forward
[INFO] - 03-16 20:34:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:34:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0109 (0.0082)
[INFO] - 03-16 20:34:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6115 (0.5906)
[INFO] - 03-16 20:34:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3540 (-140.4154)
[INFO] - 03-16 20:34:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9450 (21.9759)
[INFO] - 03-16 20:34:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.1800 (218.6517)
[INFO] - 03-16 20:34:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:34:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.8948)
[INFO] - 03-16 20:34:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:34:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:34:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:34:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:34:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:34:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:34:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:34:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.875
[INFO] - 03-16 20:34:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.876
[INFO] - 03-16 20:34:33 - [main.summary_metrics:168]: Epoch 141/300 - Test Results:
{'auc': 0.8199183700209645,
 'f1': 0.37323657474600863,
 'loss': 0.4902606443888986,
 'ndcg': 0.6948594580486269,
 'precision': 0.5566037735849058,
 'recall': 0.2809748427672957}
[INFO] - 03-16 20:34:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[141] Complete. Time taken: 00:01:01.882
[INFO] - 03-16 20:34:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:34:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:34:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:34:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:34:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:34:33 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7260, 4963, 5118]
[INFO] - 03-16 20:34:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:34:46 - [main.backward:225]: Epoch 142/300 - Iteration 41/199 - Time 0.326 batch, 0.073 data, 0.293 forward
[INFO] - 03-16 20:34:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0102 (0.0080)
[INFO] - 03-16 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5880)
[INFO] - 03-16 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4201 (-140.4301)
[INFO] - 03-16 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.0684 (21.9697)
[INFO] - 03-16 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.3684 (219.3254)
[INFO] - 03-16 20:34:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.8970)
[INFO] - 03-16 20:35:00 - [main.backward:225]: Epoch 142/300 - Iteration 91/199 - Time 0.299 batch, 0.053 data, 0.265 forward
[INFO] - 03-16 20:35:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0097 (0.0069)
[INFO] - 03-16 20:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5868 (0.5832)
[INFO] - 03-16 20:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4628 (-140.4282)
[INFO] - 03-16 20:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.2266 (22.1223)
[INFO] - 03-16 20:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.3253 (218.8363)
[INFO] - 03-16 20:35:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:35:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9197)
[INFO] - 03-16 20:35:14 - [main.backward:225]: Epoch 142/300 - Iteration 141/199 - Time 0.290 batch, 0.046 data, 0.256 forward
[INFO] - 03-16 20:35:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0084 (0.0077)
[INFO] - 03-16 20:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5773 (0.5857)
[INFO] - 03-16 20:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4597 (-140.4329)
[INFO] - 03-16 20:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9998 (22.1047)
[INFO] - 03-16 20:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 218.6001 (218.4059)
[INFO] - 03-16 20:35:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.8997)
[INFO] - 03-16 20:35:28 - [main.backward:225]: Epoch 142/300 - Iteration 191/199 - Time 0.290 batch, 0.044 data, 0.255 forward
[INFO] - 03-16 20:35:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0110 (0.0085)
[INFO] - 03-16 20:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6081 (0.5897)
[INFO] - 03-16 20:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3496 (-140.4118)
[INFO] - 03-16 20:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.7878 (21.8879)
[INFO] - 03-16 20:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 218.3403 (217.5751)
[INFO] - 03-16 20:35:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.8870)
[INFO] - 03-16 20:35:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:35:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:35:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:35:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:35:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:35:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:35:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:35:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.226
[INFO] - 03-16 20:35:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.227
[INFO] - 03-16 20:35:35 - [main.summary_metrics:168]: Epoch 142/300 - Test Results:
{'auc': 0.8307049593815516,
 'f1': 0.38204160619254945,
 'loss': 0.4881887927745122,
 'ndcg': 0.6974275496747359,
 'precision': 0.5698113207547171,
 'recall': 0.2875786163522013}
[INFO] - 03-16 20:35:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[142] Complete. Time taken: 00:01:02.899
[INFO] - 03-16 20:35:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:35:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:35:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:35:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:35:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:35:36 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7244, 4971, 5140]
[INFO] - 03-16 20:35:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:35:49 - [main.backward:225]: Epoch 143/300 - Iteration 42/199 - Time 0.315 batch, 0.067 data, 0.282 forward
[INFO] - 03-16 20:35:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:35:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0068 (0.0078)
[INFO] - 03-16 20:35:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5970 (0.5859)
[INFO] - 03-16 20:35:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4283 (-140.4245)
[INFO] - 03-16 20:35:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9918 (21.9382)
[INFO] - 03-16 20:35:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 218.5260 (218.5797)
[INFO] - 03-16 20:35:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:35:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.8956)
[INFO] - 03-16 20:36:03 - [main.backward:225]: Epoch 143/300 - Iteration 92/199 - Time 0.302 batch, 0.049 data, 0.268 forward
[INFO] - 03-16 20:36:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0071)
[INFO] - 03-16 20:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5755 (0.5813)
[INFO] - 03-16 20:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4558 (-140.4293)
[INFO] - 03-16 20:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.1036 (22.0425)
[INFO] - 03-16 20:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 217.7828 (218.2128)
[INFO] - 03-16 20:36:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9094)
[INFO] - 03-16 20:36:17 - [main.backward:225]: Epoch 143/300 - Iteration 142/199 - Time 0.293 batch, 0.044 data, 0.260 forward
[INFO] - 03-16 20:36:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:36:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0078)
[INFO] - 03-16 20:36:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5676 (0.5841)
[INFO] - 03-16 20:36:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4607 (-140.4329)
[INFO] - 03-16 20:36:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.0695 (22.0860)
[INFO] - 03-16 20:36:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 219.0593 (217.5316)
[INFO] - 03-16 20:36:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:36:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9009)
[INFO] - 03-16 20:36:31 - [main.backward:225]: Epoch 143/300 - Iteration 192/199 - Time 0.289 batch, 0.042 data, 0.255 forward
[INFO] - 03-16 20:36:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:36:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0091 (0.0087)
[INFO] - 03-16 20:36:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5809 (0.5905)
[INFO] - 03-16 20:36:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4029 (-140.4040)
[INFO] - 03-16 20:36:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8366 (21.9823)
[INFO] - 03-16 20:36:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 217.3206 (218.1615)
[INFO] - 03-16 20:36:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:36:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.8850)
[INFO] - 03-16 20:36:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:36:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:36:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:36:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:36:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:36:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:36:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:36:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.889
[INFO] - 03-16 20:36:38 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.890
[INFO] - 03-16 20:36:38 - [main.summary_metrics:168]: Epoch 143/300 - Test Results:
{'auc': 0.8226149764150945,
 'f1': 0.3763909046927914,
 'loss': 0.48874431633299503,
 'ndcg': 0.697304958144698,
 'precision': 0.5603773584905661,
 'recall': 0.28364779874213836}
[INFO] - 03-16 20:36:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[143] Complete. Time taken: 00:01:02.369
[INFO] - 03-16 20:36:38 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:36:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:36:38 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:36:38 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:36:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:36:38 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7213, 4988, 5164]
[INFO] - 03-16 20:36:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:36:52 - [main.backward:225]: Epoch 144/300 - Iteration 43/199 - Time 0.330 batch, 0.071 data, 0.296 forward
[INFO] - 03-16 20:36:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:36:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0079)
[INFO] - 03-16 20:36:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6025 (0.5877)
[INFO] - 03-16 20:36:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4544 (-140.4172)
[INFO] - 03-16 20:36:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9209 (21.9463)
[INFO] - 03-16 20:36:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 218.8910 (219.0649)
[INFO] - 03-16 20:36:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:36:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8961)
[INFO] - 03-16 20:37:06 - [main.backward:225]: Epoch 144/300 - Iteration 93/199 - Time 0.297 batch, 0.051 data, 0.264 forward
[INFO] - 03-16 20:37:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:37:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0070)
[INFO] - 03-16 20:37:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5755 (0.5804)
[INFO] - 03-16 20:37:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4633 (-140.4288)
[INFO] - 03-16 20:37:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9797 (21.9800)
[INFO] - 03-16 20:37:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 217.8006 (218.4972)
[INFO] - 03-16 20:37:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:37:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9142)
[INFO] - 03-16 20:37:19 - [main.backward:225]: Epoch 144/300 - Iteration 143/199 - Time 0.290 batch, 0.044 data, 0.257 forward
[INFO] - 03-16 20:37:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0092 (0.0077)
[INFO] - 03-16 20:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6012 (0.5868)
[INFO] - 03-16 20:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4070 (-140.4288)
[INFO] - 03-16 20:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9560 (21.9800)
[INFO] - 03-16 20:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 217.7500 (217.1291)
[INFO] - 03-16 20:37:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8972)
[INFO] - 03-16 20:37:33 - [main.backward:225]: Epoch 144/300 - Iteration 193/199 - Time 0.287 batch, 0.041 data, 0.254 forward
[INFO] - 03-16 20:37:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:37:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0086)
[INFO] - 03-16 20:37:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5785 (0.5902)
[INFO] - 03-16 20:37:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4146 (-140.4075)
[INFO] - 03-16 20:37:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.7724 (21.8695)
[INFO] - 03-16 20:37:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.7705 (217.3599)
[INFO] - 03-16 20:37:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:37:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.8848)
[INFO] - 03-16 20:37:35 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:37:35 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:37:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:37:35 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:37:35 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:37:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:37:35 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:37:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.586
[INFO] - 03-16 20:37:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.587
[INFO] - 03-16 20:37:39 - [main.summary_metrics:168]: Epoch 144/300 - Test Results:
{'auc': 0.8327876375786164,
 'f1': 0.39676826318335745,
 'loss': 0.48826763463370204,
 'ndcg': 0.7156720309813742,
 'precision': 0.590566037735849,
 'recall': 0.29905660377358495}
[INFO] - 03-16 20:37:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[144] Complete. Time taken: 00:01:01.648
[INFO] - 03-16 20:37:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:37:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:37:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:37:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:37:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:37:40 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7232, 4987, 5147]
[INFO] - 03-16 20:37:41 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:37:53 - [main.backward:225]: Epoch 145/300 - Iteration 44/199 - Time 0.307 batch, 0.067 data, 0.276 forward
[INFO] - 03-16 20:37:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:37:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0077)
[INFO] - 03-16 20:37:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5967 (0.5867)
[INFO] - 03-16 20:37:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4522 (-140.4154)
[INFO] - 03-16 20:37:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9567 (21.8790)
[INFO] - 03-16 20:37:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 217.6923 (217.9501)
[INFO] - 03-16 20:37:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:37:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9031)
[INFO] - 03-16 20:38:07 - [main.backward:225]: Epoch 145/300 - Iteration 94/199 - Time 0.297 batch, 0.050 data, 0.265 forward
[INFO] - 03-16 20:38:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0076 (0.0064)
[INFO] - 03-16 20:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5822 (0.5812)
[INFO] - 03-16 20:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4535 (-140.4269)
[INFO] - 03-16 20:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.0543 (21.9333)
[INFO] - 03-16 20:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 218.8567 (217.8185)
[INFO] - 03-16 20:38:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9267)
[INFO] - 03-16 20:38:22 - [main.backward:225]: Epoch 145/300 - Iteration 144/199 - Time 0.295 batch, 0.044 data, 0.261 forward
[INFO] - 03-16 20:38:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0077)
[INFO] - 03-16 20:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6190 (0.5872)
[INFO] - 03-16 20:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3631 (-140.4244)
[INFO] - 03-16 20:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8994 (21.9276)
[INFO] - 03-16 20:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.5280 (216.7683)
[INFO] - 03-16 20:38:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.8995)
[INFO] - 03-16 20:38:36 - [main.backward:225]: Epoch 145/300 - Iteration 194/199 - Time 0.290 batch, 0.042 data, 0.256 forward
[INFO] - 03-16 20:38:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0080)
[INFO] - 03-16 20:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5961 (0.5914)
[INFO] - 03-16 20:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4229 (-140.4070)
[INFO] - 03-16 20:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.7414 (21.8213)
[INFO] - 03-16 20:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 217.2288 (216.9338)
[INFO] - 03-16 20:38:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:38:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9012)
[INFO] - 03-16 20:38:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:38:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:38:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:38:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:38:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:38:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:38:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:38:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.831
[INFO] - 03-16 20:38:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.832
[INFO] - 03-16 20:38:42 - [main.summary_metrics:168]: Epoch 145/300 - Test Results:
{'auc': 0.8270531315513626,
 'f1': 0.392491533623609,
 'loss': 0.490754341981196,
 'ndcg': 0.7035276745537133,
 'precision': 0.5849056603773585,
 'recall': 0.29559748427672955}
[INFO] - 03-16 20:38:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[145] Complete. Time taken: 00:01:02.410
[INFO] - 03-16 20:38:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:38:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:38:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:38:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:38:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:38:42 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7263, 4973, 5095]
[INFO] - 03-16 20:38:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:38:55 - [main.backward:225]: Epoch 146/300 - Iteration 45/199 - Time 0.292 batch, 0.063 data, 0.259 forward
[INFO] - 03-16 20:38:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:38:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0083 (0.0077)
[INFO] - 03-16 20:38:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5945 (0.5852)
[INFO] - 03-16 20:38:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4413 (-140.4119)
[INFO] - 03-16 20:38:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9516 (21.8578)
[INFO] - 03-16 20:38:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.6315 (217.0244)
[INFO] - 03-16 20:38:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:38:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.8988)
[INFO] - 03-16 20:39:09 - [main.backward:225]: Epoch 146/300 - Iteration 95/199 - Time 0.280 batch, 0.046 data, 0.248 forward
[INFO] - 03-16 20:39:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:39:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0064)
[INFO] - 03-16 20:39:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5964 (0.5814)
[INFO] - 03-16 20:39:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4201 (-140.4268)
[INFO] - 03-16 20:39:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 22.1222 (21.9365)
[INFO] - 03-16 20:39:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.1051 (216.5259)
[INFO] - 03-16 20:39:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:39:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9219)
[INFO] - 03-16 20:39:22 - [main.backward:225]: Epoch 146/300 - Iteration 145/199 - Time 0.277 batch, 0.041 data, 0.246 forward
[INFO] - 03-16 20:39:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:39:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0075)
[INFO] - 03-16 20:39:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6202 (0.5868)
[INFO] - 03-16 20:39:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3612 (-140.4211)
[INFO] - 03-16 20:39:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9128 (21.9391)
[INFO] - 03-16 20:39:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.6025 (216.0160)
[INFO] - 03-16 20:39:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:39:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9059)
[INFO] - 03-16 20:39:36 - [main.backward:225]: Epoch 146/300 - Iteration 195/199 - Time 0.276 batch, 0.039 data, 0.244 forward
[INFO] - 03-16 20:39:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:39:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0075 (0.0076)
[INFO] - 03-16 20:39:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5913)
[INFO] - 03-16 20:39:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4055 (-140.4054)
[INFO] - 03-16 20:39:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6856 (21.7773)
[INFO] - 03-16 20:39:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.0953 (216.6061)
[INFO] - 03-16 20:39:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:39:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9023)
[INFO] - 03-16 20:39:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:39:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:39:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:39:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:39:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:39:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:39:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:39:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.752
[INFO] - 03-16 20:39:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.753
[INFO] - 03-16 20:39:42 - [main.summary_metrics:168]: Epoch 146/300 - Test Results:
{'auc': 0.8158982900943397,
 'f1': 0.35808417997097236,
 'loss': 0.48675599154986166,
 'ndcg': 0.6767272296998402,
 'precision': 0.5339622641509434,
 'recall': 0.2695754716981132}
[INFO] - 03-16 20:39:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[146] Complete. Time taken: 00:00:59.678
[INFO] - 03-16 20:39:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:39:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:39:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:39:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:39:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:39:42 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7256, 4973, 5138]
[INFO] - 03-16 20:39:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:39:56 - [main.backward:225]: Epoch 147/300 - Iteration 46/199 - Time 0.307 batch, 0.060 data, 0.275 forward
[INFO] - 03-16 20:39:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:39:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0074)
[INFO] - 03-16 20:39:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5141 (0.5839)
[INFO] - 03-16 20:39:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4933 (-140.4137)
[INFO] - 03-16 20:39:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9092 (21.8154)
[INFO] - 03-16 20:39:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.8196 (217.1680)
[INFO] - 03-16 20:39:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:39:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9033)
[INFO] - 03-16 20:40:10 - [main.backward:225]: Epoch 147/300 - Iteration 96/199 - Time 0.295 batch, 0.047 data, 0.262 forward
[INFO] - 03-16 20:40:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:40:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0064)
[INFO] - 03-16 20:40:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5860 (0.5798)
[INFO] - 03-16 20:40:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3962 (-140.4227)
[INFO] - 03-16 20:40:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9853 (21.8882)
[INFO] - 03-16 20:40:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.6922 (216.6858)
[INFO] - 03-16 20:40:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:40:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9230)
[INFO] - 03-16 20:40:24 - [main.backward:225]: Epoch 147/300 - Iteration 146/199 - Time 0.292 batch, 0.044 data, 0.258 forward
[INFO] - 03-16 20:40:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0118 (0.0073)
[INFO] - 03-16 20:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6138 (0.5870)
[INFO] - 03-16 20:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3400 (-140.4177)
[INFO] - 03-16 20:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8748 (21.8292)
[INFO] - 03-16 20:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.7715 (215.7480)
[INFO] - 03-16 20:40:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8047 (0.9078)
[INFO] - 03-16 20:40:39 - [main.backward:225]: Epoch 147/300 - Iteration 196/199 - Time 0.294 batch, 0.042 data, 0.259 forward
[INFO] - 03-16 20:40:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0104 (0.0081)
[INFO] - 03-16 20:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6047 (0.5911)
[INFO] - 03-16 20:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3964 (-140.4042)
[INFO] - 03-16 20:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6841 (21.8066)
[INFO] - 03-16 20:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 217.4874 (216.1120)
[INFO] - 03-16 20:40:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:40:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.8938)
[INFO] - 03-16 20:40:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:40:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:40:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:40:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:40:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:40:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:40:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:40:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.155
[INFO] - 03-16 20:40:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.156
[INFO] - 03-16 20:40:45 - [main.summary_metrics:168]: Epoch 147/300 - Test Results:
{'auc': 0.8262857049266248,
 'f1': 0.37871311078858244,
 'loss': 0.48028415227286225,
 'ndcg': 0.6972948734572872,
 'precision': 0.5641509433962264,
 'recall': 0.28529874213836476}
[INFO] - 03-16 20:40:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[147] Complete. Time taken: 00:01:03.645
[INFO] - 03-16 20:40:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:40:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:40:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:40:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:40:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:40:45 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7213, 4995, 5144]
[INFO] - 03-16 20:40:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:41:00 - [main.backward:225]: Epoch 148/300 - Iteration 47/199 - Time 0.314 batch, 0.068 data, 0.281 forward
[INFO] - 03-16 20:41:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:41:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0072)
[INFO] - 03-16 20:41:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5077 (0.5838)
[INFO] - 03-16 20:41:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4893 (-140.4133)
[INFO] - 03-16 20:41:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.7150 (21.7709)
[INFO] - 03-16 20:41:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.3550 (217.1725)
[INFO] - 03-16 20:41:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:41:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9076)
[INFO] - 03-16 20:41:14 - [main.backward:225]: Epoch 148/300 - Iteration 97/199 - Time 0.300 batch, 0.050 data, 0.267 forward
[INFO] - 03-16 20:41:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:41:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0063)
[INFO] - 03-16 20:41:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6131 (0.5832)
[INFO] - 03-16 20:41:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3897 (-140.4182)
[INFO] - 03-16 20:41:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9844 (21.8726)
[INFO] - 03-16 20:41:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.6721 (217.1555)
[INFO] - 03-16 20:41:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:41:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9225)
[INFO] - 03-16 20:41:28 - [main.backward:225]: Epoch 148/300 - Iteration 147/199 - Time 0.293 batch, 0.044 data, 0.260 forward
[INFO] - 03-16 20:41:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:41:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0090 (0.0081)
[INFO] - 03-16 20:41:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5972 (0.5866)
[INFO] - 03-16 20:41:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4263 (-140.4179)
[INFO] - 03-16 20:41:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8651 (21.8466)
[INFO] - 03-16 20:41:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.5257 (216.0958)
[INFO] - 03-16 20:41:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:41:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.8911)
[INFO] - 03-16 20:41:42 - [main.backward:225]: Epoch 148/300 - Iteration 197/199 - Time 0.289 batch, 0.041 data, 0.255 forward
[INFO] - 03-16 20:41:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:41:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0085 (0.0075)
[INFO] - 03-16 20:41:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6074 (0.5903)
[INFO] - 03-16 20:41:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4033 (-140.4031)
[INFO] - 03-16 20:41:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6349 (21.7832)
[INFO] - 03-16 20:41:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 218.6515 (217.1957)
[INFO] - 03-16 20:41:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:41:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9080)
[INFO] - 03-16 20:41:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:41:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:41:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:41:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:41:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:41:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:41:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:41:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.108
[INFO] - 03-16 20:41:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.108
[INFO] - 03-16 20:41:48 - [main.summary_metrics:168]: Epoch 148/300 - Test Results:
{'auc': 0.8369959381551361,
 'f1': 0.4038703434929849,
 'loss': 0.4785015426811682,
 'ndcg': 0.7187903889371099,
 'precision': 0.6018867924528303,
 'recall': 0.3041666666666667}
[INFO] - 03-16 20:41:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[148] Complete. Time taken: 00:01:02.632
[INFO] - 03-16 20:41:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:41:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:41:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:41:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:41:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:41:48 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7225, 4965, 5145]
[INFO] - 03-16 20:41:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:42:03 - [main.backward:225]: Epoch 149/300 - Iteration 48/199 - Time 0.314 batch, 0.064 data, 0.279 forward
[INFO] - 03-16 20:42:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:42:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0069)
[INFO] - 03-16 20:42:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5343 (0.5814)
[INFO] - 03-16 20:42:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4927 (-140.4115)
[INFO] - 03-16 20:42:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8711 (21.7511)
[INFO] - 03-16 20:42:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.8460 (217.1518)
[INFO] - 03-16 20:42:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:42:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9108)
[INFO] - 03-16 20:42:17 - [main.backward:225]: Epoch 149/300 - Iteration 98/199 - Time 0.300 batch, 0.049 data, 0.265 forward
[INFO] - 03-16 20:42:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:42:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0073 (0.0067)
[INFO] - 03-16 20:42:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6031 (0.5831)
[INFO] - 03-16 20:42:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4033 (-140.4149)
[INFO] - 03-16 20:42:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.9280 (21.8797)
[INFO] - 03-16 20:42:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.9848 (216.4327)
[INFO] - 03-16 20:42:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:42:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9189)
[INFO] - 03-16 20:42:31 - [main.backward:225]: Epoch 149/300 - Iteration 148/199 - Time 0.293 batch, 0.044 data, 0.259 forward
[INFO] - 03-16 20:42:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:42:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0076)
[INFO] - 03-16 20:42:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5686 (0.5878)
[INFO] - 03-16 20:42:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4617 (-140.4207)
[INFO] - 03-16 20:42:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8721 (21.8556)
[INFO] - 03-16 20:42:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.2087 (215.3481)
[INFO] - 03-16 20:42:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:42:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.8984)
[INFO] - 03-16 20:42:45 - [main.backward:225]: Epoch 149/300 - Iteration 198/199 - Time 0.291 batch, 0.042 data, 0.256 forward
[INFO] - 03-16 20:42:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0097 (0.0077)
[INFO] - 03-16 20:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6084 (0.5910)
[INFO] - 03-16 20:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4021 (-140.4021)
[INFO] - 03-16 20:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.7796 (21.7622)
[INFO] - 03-16 20:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 217.1868 (215.6158)
[INFO] - 03-16 20:42:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:42:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.9056)
[INFO] - 03-16 20:42:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:42:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:42:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:42:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:42:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:42:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:42:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:42:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.710
[INFO] - 03-16 20:42:50 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.711
[INFO] - 03-16 20:42:50 - [main.summary_metrics:168]: Epoch 149/300 - Test Results:
{'auc': 0.8268366417714886,
 'f1': 0.3899758103531687,
 'loss': 0.47833534217130713,
 'ndcg': 0.6963642446815422,
 'precision': 0.5811320754716981,
 'recall': 0.2937106918238994}
[INFO] - 03-16 20:42:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[149] Complete. Time taken: 00:01:02.577
[INFO] - 03-16 20:42:50 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:42:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:42:50 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:42:50 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:42:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:42:51 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7243, 4982, 5135]
[INFO] - 03-16 20:42:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:43:05 - [main.backward:225]: Epoch 150/300 - Iteration 49/199 - Time 0.306 batch, 0.060 data, 0.275 forward
[INFO] - 03-16 20:43:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:43:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0071)
[INFO] - 03-16 20:43:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5452 (0.5805)
[INFO] - 03-16 20:43:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4861 (-140.4131)
[INFO] - 03-16 20:43:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.7784 (21.7486)
[INFO] - 03-16 20:43:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.7264 (215.6080)
[INFO] - 03-16 20:43:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:43:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9107)
[INFO] - 03-16 20:43:19 - [main.backward:225]: Epoch 150/300 - Iteration 99/199 - Time 0.292 batch, 0.046 data, 0.260 forward
[INFO] - 03-16 20:43:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0101 (0.0070)
[INFO] - 03-16 20:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5992 (0.5843)
[INFO] - 03-16 20:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4202 (-140.4146)
[INFO] - 03-16 20:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8489 (21.8094)
[INFO] - 03-16 20:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 214.9656 (215.4618)
[INFO] - 03-16 20:43:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9148)
[INFO] - 03-16 20:43:33 - [main.backward:225]: Epoch 150/300 - Iteration 149/199 - Time 0.288 batch, 0.041 data, 0.256 forward
[INFO] - 03-16 20:43:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:43:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0075)
[INFO] - 03-16 20:43:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5686 (0.5863)
[INFO] - 03-16 20:43:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4499 (-140.4209)
[INFO] - 03-16 20:43:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8038 (21.7915)
[INFO] - 03-16 20:43:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.2758 (214.5716)
[INFO] - 03-16 20:43:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:43:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9052)
[INFO] - 03-16 20:43:47 - [main.backward:225]: Epoch 150/300 - Iteration 0/199 - Time 0.286 batch, 0.039 data, 0.254 forward
[INFO] - 03-16 20:43:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0073 (0.0081)
[INFO] - 03-16 20:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6111 (0.5914)
[INFO] - 03-16 20:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4167 (-140.3976)
[INFO] - 03-16 20:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6043 (21.6494)
[INFO] - 03-16 20:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 217.1675 (215.6626)
[INFO] - 03-16 20:43:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.8947)
[INFO] - 03-16 20:43:47 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:43:47 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:43:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:43:47 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:43:47 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:43:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:43:47 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:43:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.079
[INFO] - 03-16 20:43:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.080
[INFO] - 03-16 20:43:53 - [main.summary_metrics:168]: Epoch 150/300 - Test Results:
{'auc': 0.8272632992662474,
 'f1': 0.3923560716013545,
 'loss': 0.48271497604881947,
 'ndcg': 0.7106381968726443,
 'precision': 0.5849056603773585,
 'recall': 0.29544025157232706}
[INFO] - 03-16 20:43:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[150] Complete. Time taken: 00:01:02.083
[INFO] - 03-16 20:43:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:43:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:43:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:43:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:43:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:43:53 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7212, 4971, 5145]
[INFO] - 03-16 20:43:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:44:08 - [main.backward:225]: Epoch 151/300 - Iteration 50/199 - Time 0.308 batch, 0.065 data, 0.274 forward
[INFO] - 03-16 20:44:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0081 (0.0071)
[INFO] - 03-16 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5806 (0.5798)
[INFO] - 03-16 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4568 (-140.4141)
[INFO] - 03-16 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6397 (21.6427)
[INFO] - 03-16 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.3549 (216.7014)
[INFO] - 03-16 20:44:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9133)
[INFO] - 03-16 20:44:22 - [main.backward:225]: Epoch 151/300 - Iteration 100/199 - Time 0.294 batch, 0.048 data, 0.261 forward
[INFO] - 03-16 20:44:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:44:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0069)
[INFO] - 03-16 20:44:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6058 (0.5867)
[INFO] - 03-16 20:44:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4096 (-140.4127)
[INFO] - 03-16 20:44:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.7810 (21.7449)
[INFO] - 03-16 20:44:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.0647 (216.1625)
[INFO] - 03-16 20:44:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:44:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9159)
[INFO] - 03-16 20:44:36 - [main.backward:225]: Epoch 151/300 - Iteration 150/199 - Time 0.292 batch, 0.044 data, 0.258 forward
[INFO] - 03-16 20:44:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:44:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0072)
[INFO] - 03-16 20:44:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5737 (0.5870)
[INFO] - 03-16 20:44:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4567 (-140.4202)
[INFO] - 03-16 20:44:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8731 (21.7562)
[INFO] - 03-16 20:44:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.6119 (214.7160)
[INFO] - 03-16 20:44:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:44:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9130)
[INFO] - 03-16 20:44:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:44:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:44:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:44:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:44:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:44:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:44:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:44:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.963
[INFO] - 03-16 20:44:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.963
[INFO] - 03-16 20:44:55 - [main.summary_metrics:168]: Epoch 151/300 - Test Results:
{'auc': 0.825136464884696,
 'f1': 0.38122883405902264,
 'loss': 0.4818078286832734,
 'ndcg': 0.6958141026370221,
 'precision': 0.5679245283018869,
 'recall': 0.287185534591195}
[INFO] - 03-16 20:44:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[151] Complete. Time taken: 00:01:02.014
[INFO] - 03-16 20:44:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:44:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:44:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:44:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:44:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:44:55 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7258, 4996, 5130]
[INFO] - 03-16 20:44:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:44:56 - [main.backward:225]: Epoch 152/300 - Iteration 1/199 - Time 1.691 batch, 1.471 data, 1.658 forward
[INFO] - 03-16 20:44:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:44:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0076)
[INFO] - 03-16 20:44:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5907)
[INFO] - 03-16 20:44:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3396 (-140.3904)
[INFO] - 03-16 20:44:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6460 (21.6063)
[INFO] - 03-16 20:44:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 216.1661 (214.9210)
[INFO] - 03-16 20:44:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:44:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9025)
[INFO] - 03-16 20:45:11 - [main.backward:225]: Epoch 152/300 - Iteration 51/199 - Time 0.315 batch, 0.061 data, 0.282 forward
[INFO] - 03-16 20:45:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0072)
[INFO] - 03-16 20:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5899 (0.5803)
[INFO] - 03-16 20:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4178 (-140.4122)
[INFO] - 03-16 20:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6674 (21.6114)
[INFO] - 03-16 20:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.0343 (215.0079)
[INFO] - 03-16 20:45:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:45:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9056)
[INFO] - 03-16 20:45:25 - [main.backward:225]: Epoch 152/300 - Iteration 101/199 - Time 0.297 batch, 0.047 data, 0.264 forward
[INFO] - 03-16 20:45:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:45:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0108 (0.0071)
[INFO] - 03-16 20:45:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6016 (0.5862)
[INFO] - 03-16 20:45:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4020 (-140.4072)
[INFO] - 03-16 20:45:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8350 (21.7810)
[INFO] - 03-16 20:45:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 214.3392 (214.6462)
[INFO] - 03-16 20:45:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:45:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.9095)
[INFO] - 03-16 20:45:38 - [main.backward:225]: Epoch 152/300 - Iteration 151/199 - Time 0.290 batch, 0.042 data, 0.257 forward
[INFO] - 03-16 20:45:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:45:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0110 (0.0074)
[INFO] - 03-16 20:45:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5993 (0.5840)
[INFO] - 03-16 20:45:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4283 (-140.4219)
[INFO] - 03-16 20:45:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.8383 (21.8205)
[INFO] - 03-16 20:45:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.5510 (213.8389)
[INFO] - 03-16 20:45:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:45:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.9064)
[INFO] - 03-16 20:45:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:45:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:45:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:45:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:45:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:45:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:45:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:45:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.884
[INFO] - 03-16 20:45:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.885
[INFO] - 03-16 20:45:57 - [main.summary_metrics:168]: Epoch 152/300 - Test Results:
{'auc': 0.830420138888889,
 'f1': 0.39612965650701487,
 'loss': 0.47833138845351747,
 'ndcg': 0.7127259056755955,
 'precision': 0.5905660377358491,
 'recall': 0.29827044025157234}
[INFO] - 03-16 20:45:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[152] Complete. Time taken: 00:01:02.575
[INFO] - 03-16 20:45:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:45:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:45:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:45:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:45:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:45:57 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7240, 4969, 5122]
[INFO] - 03-16 20:45:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:45:59 - [main.backward:225]: Epoch 153/300 - Iteration 2/199 - Time 0.996 batch, 0.758 data, 0.958 forward
[INFO] - 03-16 20:45:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0077)
[INFO] - 03-16 20:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5905 (0.5924)
[INFO] - 03-16 20:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3587 (-140.3819)
[INFO] - 03-16 20:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4999 (21.5831)
[INFO] - 03-16 20:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.0760 (214.3776)
[INFO] - 03-16 20:45:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:45:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9021)
[INFO] - 03-16 20:46:13 - [main.backward:225]: Epoch 153/300 - Iteration 52/199 - Time 0.310 batch, 0.060 data, 0.277 forward
[INFO] - 03-16 20:46:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0070)
[INFO] - 03-16 20:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5893 (0.5801)
[INFO] - 03-16 20:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4071 (-140.4130)
[INFO] - 03-16 20:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.5673 (21.5926)
[INFO] - 03-16 20:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.1292 (215.1864)
[INFO] - 03-16 20:46:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:46:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9097)
[INFO] - 03-16 20:46:28 - [main.backward:225]: Epoch 153/300 - Iteration 102/199 - Time 0.300 batch, 0.047 data, 0.266 forward
[INFO] - 03-16 20:46:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0068)
[INFO] - 03-16 20:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5143 (0.5849)
[INFO] - 03-16 20:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5348 (-140.4056)
[INFO] - 03-16 20:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.7403 (21.6501)
[INFO] - 03-16 20:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 214.0542 (214.6030)
[INFO] - 03-16 20:46:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:46:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9167)
[INFO] - 03-16 20:46:41 - [main.backward:225]: Epoch 153/300 - Iteration 152/199 - Time 0.291 batch, 0.044 data, 0.257 forward
[INFO] - 03-16 20:46:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:46:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0097 (0.0074)
[INFO] - 03-16 20:46:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5939 (0.5868)
[INFO] - 03-16 20:46:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4226 (-140.4240)
[INFO] - 03-16 20:46:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.7169 (21.6796)
[INFO] - 03-16 20:46:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.5068 (213.4558)
[INFO] - 03-16 20:46:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:46:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9056)
[INFO] - 03-16 20:46:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:46:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:46:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:46:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:46:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:46:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:46:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:46:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.935
[INFO] - 03-16 20:46:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.936
[INFO] - 03-16 20:46:59 - [main.summary_metrics:168]: Epoch 153/300 - Test Results:
{'auc': 0.841149338312369,
 'f1': 0.4116690856313497,
 'loss': 0.4777393304596907,
 'ndcg': 0.717052232281649,
 'precision': 0.6132075471698114,
 'recall': 0.31014150943396235}
[INFO] - 03-16 20:47:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[153] Complete. Time taken: 00:01:02.420
[INFO] - 03-16 20:47:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:47:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:47:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:47:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:47:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:47:00 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7261, 4987, 5125]
[INFO] - 03-16 20:47:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:47:02 - [main.backward:225]: Epoch 154/300 - Iteration 3/199 - Time 0.771 batch, 0.526 data, 0.738 forward
[INFO] - 03-16 20:47:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0087 (0.0075)
[INFO] - 03-16 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5832 (0.5927)
[INFO] - 03-16 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3365 (-140.3761)
[INFO] - 03-16 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6029 (21.6470)
[INFO] - 03-16 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 214.4117 (214.5771)
[INFO] - 03-16 20:47:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.9054)
[INFO] - 03-16 20:47:16 - [main.backward:225]: Epoch 154/300 - Iteration 53/199 - Time 0.312 batch, 0.061 data, 0.279 forward
[INFO] - 03-16 20:47:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:47:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0068)
[INFO] - 03-16 20:47:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5665 (0.5803)
[INFO] - 03-16 20:47:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4063 (-140.4165)
[INFO] - 03-16 20:47:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.5046 (21.5229)
[INFO] - 03-16 20:47:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.8666 (214.5471)
[INFO] - 03-16 20:47:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:47:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9141)
[INFO] - 03-16 20:47:30 - [main.backward:225]: Epoch 154/300 - Iteration 103/199 - Time 0.297 batch, 0.047 data, 0.264 forward
[INFO] - 03-16 20:47:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0066)
[INFO] - 03-16 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5013 (0.5837)
[INFO] - 03-16 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5907 (-140.4017)
[INFO] - 03-16 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6116 (21.5752)
[INFO] - 03-16 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.9601 (214.5035)
[INFO] - 03-16 20:47:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9158)
[INFO] - 03-16 20:47:45 - [main.backward:225]: Epoch 154/300 - Iteration 153/199 - Time 0.295 batch, 0.043 data, 0.262 forward
[INFO] - 03-16 20:47:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0075)
[INFO] - 03-16 20:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5997 (0.5877)
[INFO] - 03-16 20:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4311 (-140.4207)
[INFO] - 03-16 20:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6316 (21.5928)
[INFO] - 03-16 20:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.9023 (214.1992)
[INFO] - 03-16 20:47:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9058)
[INFO] - 03-16 20:47:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:47:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:47:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:47:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:47:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:47:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:47:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:48:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.002
[INFO] - 03-16 20:48:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.003
[INFO] - 03-16 20:48:03 - [main.summary_metrics:168]: Epoch 154/300 - Test Results:
{'auc': 0.8423236373165619,
 'f1': 0.41292694726656975,
 'loss': 0.47551571198629383,
 'ndcg': 0.7264880257933757,
 'precision': 0.6150943396226415,
 'recall': 0.3110849056603774}
[INFO] - 03-16 20:48:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[154] Complete. Time taken: 00:01:03.690
[INFO] - 03-16 20:48:03 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:48:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:48:03 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:48:03 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:48:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:48:03 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7237, 5007, 5164]
[INFO] - 03-16 20:48:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:48:06 - [main.backward:225]: Epoch 155/300 - Iteration 4/199 - Time 0.629 batch, 0.387 data, 0.595 forward
[INFO] - 03-16 20:48:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0071)
[INFO] - 03-16 20:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5667 (0.5874)
[INFO] - 03-16 20:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3530 (-140.3739)
[INFO] - 03-16 20:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.5376 (21.5137)
[INFO] - 03-16 20:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 215.6766 (214.4100)
[INFO] - 03-16 20:48:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:48:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9111)
[INFO] - 03-16 20:48:21 - [main.backward:225]: Epoch 155/300 - Iteration 54/199 - Time 0.329 batch, 0.065 data, 0.291 forward
[INFO] - 03-16 20:48:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:48:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0066)
[INFO] - 03-16 20:48:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5395 (0.5804)
[INFO] - 03-16 20:48:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4055 (-140.4204)
[INFO] - 03-16 20:48:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6503 (21.5394)
[INFO] - 03-16 20:48:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 214.5711 (214.7801)
[INFO] - 03-16 20:48:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:48:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9194)
[INFO] - 03-16 20:48:35 - [main.backward:225]: Epoch 155/300 - Iteration 104/199 - Time 0.308 batch, 0.051 data, 0.271 forward
[INFO] - 03-16 20:48:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0067)
[INFO] - 03-16 20:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.4957 (0.5811)
[INFO] - 03-16 20:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5815 (-140.4066)
[INFO] - 03-16 20:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.5664 (21.5915)
[INFO] - 03-16 20:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.8487 (213.8138)
[INFO] - 03-16 20:48:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9184)
[INFO] - 03-16 20:48:50 - [main.backward:225]: Epoch 155/300 - Iteration 154/199 - Time 0.303 batch, 0.045 data, 0.267 forward
[INFO] - 03-16 20:48:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0080 (0.0076)
[INFO] - 03-16 20:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5975 (0.5917)
[INFO] - 03-16 20:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4402 (-140.4175)
[INFO] - 03-16 20:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.7357 (21.6327)
[INFO] - 03-16 20:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.8713 (212.4491)
[INFO] - 03-16 20:48:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9030)
[INFO] - 03-16 20:49:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:49:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:49:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:49:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:49:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:49:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:49:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:49:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.233
[INFO] - 03-16 20:49:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.234
[INFO] - 03-16 20:49:08 - [main.summary_metrics:168]: Epoch 155/300 - Test Results:
{'auc': 0.8305498558700212,
 'f1': 0.39858732462506036,
 'loss': 0.4758368705573572,
 'ndcg': 0.7095562684105805,
 'precision': 0.5943396226415095,
 'recall': 0.30007861635220123}
[INFO] - 03-16 20:49:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[155] Complete. Time taken: 00:01:04.824
[INFO] - 03-16 20:49:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:49:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:49:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:49:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:49:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:49:08 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7224, 4994, 5133]
[INFO] - 03-16 20:49:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:49:11 - [main.backward:225]: Epoch 156/300 - Iteration 5/199 - Time 0.574 batch, 0.308 data, 0.540 forward
[INFO] - 03-16 20:49:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:49:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0074)
[INFO] - 03-16 20:49:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5690 (0.5896)
[INFO] - 03-16 20:49:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4465 (-140.3749)
[INFO] - 03-16 20:49:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3743 (21.5845)
[INFO] - 03-16 20:49:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.9833 (213.4263)
[INFO] - 03-16 20:49:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:49:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9052)
[INFO] - 03-16 20:49:25 - [main.backward:225]: Epoch 156/300 - Iteration 55/199 - Time 0.308 batch, 0.060 data, 0.274 forward
[INFO] - 03-16 20:49:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0066)
[INFO] - 03-16 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5237 (0.5783)
[INFO] - 03-16 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4047 (-140.4160)
[INFO] - 03-16 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.5398 (21.5077)
[INFO] - 03-16 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.9085 (213.4465)
[INFO] - 03-16 20:49:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9158)
[INFO] - 03-16 20:49:39 - [main.backward:225]: Epoch 156/300 - Iteration 105/199 - Time 0.298 batch, 0.046 data, 0.264 forward
[INFO] - 03-16 20:49:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:49:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0065)
[INFO] - 03-16 20:49:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.4897 (0.5801)
[INFO] - 03-16 20:49:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.5614 (-140.4103)
[INFO] - 03-16 20:49:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.5591 (21.6363)
[INFO] - 03-16 20:49:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.3703 (213.5602)
[INFO] - 03-16 20:49:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:49:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9156)
[INFO] - 03-16 20:49:54 - [main.backward:225]: Epoch 156/300 - Iteration 155/199 - Time 0.295 batch, 0.042 data, 0.262 forward
[INFO] - 03-16 20:49:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:49:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0076)
[INFO] - 03-16 20:49:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5566 (0.5925)
[INFO] - 03-16 20:49:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4915 (-140.4135)
[INFO] - 03-16 20:49:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4946 (21.6285)
[INFO] - 03-16 20:49:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.4128 (212.5879)
[INFO] - 03-16 20:49:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:49:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9050)
[INFO] - 03-16 20:50:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:50:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:50:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:50:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:50:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:50:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:50:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:50:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.181
[INFO] - 03-16 20:50:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.182
[INFO] - 03-16 20:50:12 - [main.summary_metrics:168]: Epoch 156/300 - Test Results:
{'auc': 0.8320964033018869,
 'f1': 0.395065312046444,
 'loss': 0.4764682319129288,
 'ndcg': 0.7093683234566605,
 'precision': 0.588679245283019,
 'recall': 0.29756289308176104}
[INFO] - 03-16 20:50:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[156] Complete. Time taken: 00:01:03.648
[INFO] - 03-16 20:50:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:50:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:50:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:50:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:50:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:50:12 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 4963, 5109]
[INFO] - 03-16 20:50:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:50:15 - [main.backward:225]: Epoch 157/300 - Iteration 6/199 - Time 0.521 batch, 0.270 data, 0.486 forward
[INFO] - 03-16 20:50:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0072)
[INFO] - 03-16 20:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5488 (0.5879)
[INFO] - 03-16 20:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4230 (-140.3725)
[INFO] - 03-16 20:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3508 (21.4595)
[INFO] - 03-16 20:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.7001 (212.8738)
[INFO] - 03-16 20:50:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9091)
[INFO] - 03-16 20:50:29 - [main.backward:225]: Epoch 157/300 - Iteration 56/199 - Time 0.308 batch, 0.060 data, 0.274 forward
[INFO] - 03-16 20:50:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0065)
[INFO] - 03-16 20:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5349 (0.5791)
[INFO] - 03-16 20:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4287 (-140.4170)
[INFO] - 03-16 20:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.5718 (21.4799)
[INFO] - 03-16 20:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.5873 (213.4959)
[INFO] - 03-16 20:50:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9153)
[INFO] - 03-16 20:50:43 - [main.backward:225]: Epoch 157/300 - Iteration 106/199 - Time 0.294 batch, 0.048 data, 0.259 forward
[INFO] - 03-16 20:50:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:50:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0065)
[INFO] - 03-16 20:50:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5828 (0.5816)
[INFO] - 03-16 20:50:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4324 (-140.4128)
[INFO] - 03-16 20:50:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6364 (21.5970)
[INFO] - 03-16 20:50:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.4799 (213.7091)
[INFO] - 03-16 20:50:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:50:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9222)
[INFO] - 03-16 20:50:57 - [main.backward:225]: Epoch 157/300 - Iteration 156/199 - Time 0.292 batch, 0.043 data, 0.258 forward
[INFO] - 03-16 20:50:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0078)
[INFO] - 03-16 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5558 (0.5917)
[INFO] - 03-16 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4961 (-140.4169)
[INFO] - 03-16 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6106 (21.6018)
[INFO] - 03-16 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.5067 (212.4852)
[INFO] - 03-16 20:50:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9012)
[INFO] - 03-16 20:51:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:51:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:51:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:51:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:51:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:51:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:51:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:51:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.115
[INFO] - 03-16 20:51:15 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.116
[INFO] - 03-16 20:51:15 - [main.summary_metrics:168]: Epoch 157/300 - Test Results:
{'auc': 0.8376702371593292,
 'f1': 0.4053217223028543,
 'loss': 0.47741985557764083,
 'ndcg': 0.7265385262501778,
 'precision': 0.6037735849056604,
 'recall': 0.3053459119496855}
[INFO] - 03-16 20:51:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[157] Complete. Time taken: 00:01:03.291
[INFO] - 03-16 20:51:15 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:51:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:51:15 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:51:15 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:51:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:51:15 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7243, 4981, 5133]
[INFO] - 03-16 20:51:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:51:19 - [main.backward:225]: Epoch 158/300 - Iteration 7/199 - Time 0.507 batch, 0.259 data, 0.477 forward
[INFO] - 03-16 20:51:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0075)
[INFO] - 03-16 20:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5671 (0.5884)
[INFO] - 03-16 20:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4187 (-140.3703)
[INFO] - 03-16 20:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4556 (21.5188)
[INFO] - 03-16 20:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.6215 (213.1811)
[INFO] - 03-16 20:51:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9063)
[INFO] - 03-16 20:51:33 - [main.backward:225]: Epoch 158/300 - Iteration 57/199 - Time 0.318 batch, 0.061 data, 0.285 forward
[INFO] - 03-16 20:51:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0073 (0.0066)
[INFO] - 03-16 20:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5551 (0.5786)
[INFO] - 03-16 20:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4606 (-140.4190)
[INFO] - 03-16 20:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4328 (21.4972)
[INFO] - 03-16 20:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.4201 (213.3722)
[INFO] - 03-16 20:51:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:51:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9180)
[INFO] - 03-16 20:51:48 - [main.backward:225]: Epoch 158/300 - Iteration 107/199 - Time 0.305 batch, 0.049 data, 0.271 forward
[INFO] - 03-16 20:51:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:51:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0064 (0.0073)
[INFO] - 03-16 20:51:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6006 (0.5825)
[INFO] - 03-16 20:51:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4265 (-140.4161)
[INFO] - 03-16 20:51:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6650 (21.5741)
[INFO] - 03-16 20:51:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.9079 (213.2279)
[INFO] - 03-16 20:51:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:51:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9061)
[INFO] - 03-16 20:52:02 - [main.backward:225]: Epoch 158/300 - Iteration 157/199 - Time 0.299 batch, 0.044 data, 0.265 forward
[INFO] - 03-16 20:52:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0071)
[INFO] - 03-16 20:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5632 (0.5917)
[INFO] - 03-16 20:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4951 (-140.4175)
[INFO] - 03-16 20:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4224 (21.5276)
[INFO] - 03-16 20:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.0008 (211.5119)
[INFO] - 03-16 20:52:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:52:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9152)
[INFO] - 03-16 20:52:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:52:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:52:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:52:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:52:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:52:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:52:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:52:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.181
[INFO] - 03-16 20:52:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.182
[INFO] - 03-16 20:52:19 - [main.summary_metrics:168]: Epoch 158/300 - Test Results:
{'auc': 0.8367025681341718,
 'f1': 0.39845186260280585,
 'loss': 0.476477112496174,
 'ndcg': 0.7108416150689767,
 'precision': 0.5943396226415094,
 'recall': 0.29992138364779874}
[INFO] - 03-16 20:52:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[158] Complete. Time taken: 00:01:03.909
[INFO] - 03-16 20:52:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:52:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:52:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:52:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:52:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:52:19 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7222, 4994, 5117]
[INFO] - 03-16 20:52:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:52:23 - [main.backward:225]: Epoch 159/300 - Iteration 8/199 - Time 0.467 batch, 0.224 data, 0.433 forward
[INFO] - 03-16 20:52:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0073)
[INFO] - 03-16 20:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5430 (0.5908)
[INFO] - 03-16 20:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4586 (-140.3695)
[INFO] - 03-16 20:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3252 (21.3899)
[INFO] - 03-16 20:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.4947 (212.8826)
[INFO] - 03-16 20:52:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9055)
[INFO] - 03-16 20:52:37 - [main.backward:225]: Epoch 159/300 - Iteration 58/199 - Time 0.308 batch, 0.061 data, 0.274 forward
[INFO] - 03-16 20:52:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0065)
[INFO] - 03-16 20:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5717 (0.5777)
[INFO] - 03-16 20:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4776 (-140.4168)
[INFO] - 03-16 20:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.2681 (21.3136)
[INFO] - 03-16 20:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.6810 (213.2122)
[INFO] - 03-16 20:52:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9186)
[INFO] - 03-16 20:52:51 - [main.backward:225]: Epoch 159/300 - Iteration 108/199 - Time 0.301 batch, 0.049 data, 0.266 forward
[INFO] - 03-16 20:52:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0075 (0.0064)
[INFO] - 03-16 20:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5898 (0.5819)
[INFO] - 03-16 20:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4207 (-140.4164)
[INFO] - 03-16 20:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4918 (21.4189)
[INFO] - 03-16 20:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.2051 (212.9767)
[INFO] - 03-16 20:52:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9209)
[INFO] - 03-16 20:53:06 - [main.backward:225]: Epoch 159/300 - Iteration 158/199 - Time 0.298 batch, 0.045 data, 0.262 forward
[INFO] - 03-16 20:53:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0071)
[INFO] - 03-16 20:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5599 (0.5908)
[INFO] - 03-16 20:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4788 (-140.4173)
[INFO] - 03-16 20:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.5396 (21.4650)
[INFO] - 03-16 20:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.1315 (212.4248)
[INFO] - 03-16 20:53:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9130)
[INFO] - 03-16 20:53:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:53:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:53:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:53:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:53:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:53:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:53:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:53:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.136
[INFO] - 03-16 20:53:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.137
[INFO] - 03-16 20:53:23 - [main.summary_metrics:168]: Epoch 159/300 - Test Results:
{'auc': 0.8382578616352203,
 'f1': 0.3998451862602805,
 'loss': 0.4714938507839819,
 'ndcg': 0.7143377758900995,
 'precision': 0.5962264150943396,
 'recall': 0.3010220125786164}
[INFO] - 03-16 20:53:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[159] Complete. Time taken: 00:01:03.974
[INFO] - 03-16 20:53:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:53:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:53:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:53:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:53:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:53:23 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7246, 4988, 5107]
[INFO] - 03-16 20:53:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:53:27 - [main.backward:225]: Epoch 160/300 - Iteration 9/199 - Time 0.442 batch, 0.204 data, 0.409 forward
[INFO] - 03-16 20:53:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:53:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0072)
[INFO] - 03-16 20:53:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5135 (0.5867)
[INFO] - 03-16 20:53:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4744 (-140.3729)
[INFO] - 03-16 20:53:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3307 (21.3354)
[INFO] - 03-16 20:53:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.5235 (212.1710)
[INFO] - 03-16 20:53:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:53:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9092)
[INFO] - 03-16 20:53:41 - [main.backward:225]: Epoch 160/300 - Iteration 59/199 - Time 0.312 batch, 0.059 data, 0.279 forward
[INFO] - 03-16 20:53:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0062)
[INFO] - 03-16 20:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5569 (0.5801)
[INFO] - 03-16 20:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4900 (-140.4127)
[INFO] - 03-16 20:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3594 (21.3412)
[INFO] - 03-16 20:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 213.1668 (213.1664)
[INFO] - 03-16 20:53:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9227)
[INFO] - 03-16 20:53:56 - [main.backward:225]: Epoch 160/300 - Iteration 109/199 - Time 0.301 batch, 0.047 data, 0.268 forward
[INFO] - 03-16 20:53:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0076 (0.0066)
[INFO] - 03-16 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5980 (0.5833)
[INFO] - 03-16 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4196 (-140.4145)
[INFO] - 03-16 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.6195 (21.4408)
[INFO] - 03-16 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.8306 (212.4526)
[INFO] - 03-16 20:53:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9122)
[INFO] - 03-16 20:54:10 - [main.backward:225]: Epoch 160/300 - Iteration 159/199 - Time 0.297 batch, 0.043 data, 0.263 forward
[INFO] - 03-16 20:54:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0070)
[INFO] - 03-16 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5687 (0.5920)
[INFO] - 03-16 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4444 (-140.4190)
[INFO] - 03-16 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4317 (21.5161)
[INFO] - 03-16 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.0126 (211.5195)
[INFO] - 03-16 20:54:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9148)
[INFO] - 03-16 20:54:22 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:54:22 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:54:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:54:22 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:54:22 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:54:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:54:22 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:54:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.734
[INFO] - 03-16 20:54:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.736
[INFO] - 03-16 20:54:26 - [main.summary_metrics:168]: Epoch 160/300 - Test Results:
{'auc': 0.8425182455450735,
 'f1': 0.4028640541848088,
 'loss': 0.47277030745692233,
 'ndcg': 0.7217813668775016,
 'precision': 0.6000000000000001,
 'recall': 0.30353773584905663}
[INFO] - 03-16 20:54:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[160] Complete. Time taken: 00:01:03.467
[INFO] - 03-16 20:54:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:54:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:54:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:54:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:54:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:54:26 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7247, 5007, 5142]
[INFO] - 03-16 20:54:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:54:31 - [main.backward:225]: Epoch 161/300 - Iteration 10/199 - Time 0.440 batch, 0.185 data, 0.405 forward
[INFO] - 03-16 20:54:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:54:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0070)
[INFO] - 03-16 20:54:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5305 (0.5871)
[INFO] - 03-16 20:54:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4720 (-140.3770)
[INFO] - 03-16 20:54:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4094 (21.3478)
[INFO] - 03-16 20:54:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.7490 (212.3713)
[INFO] - 03-16 20:54:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:54:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9094)
[INFO] - 03-16 20:54:45 - [main.backward:225]: Epoch 161/300 - Iteration 60/199 - Time 0.308 batch, 0.059 data, 0.274 forward
[INFO] - 03-16 20:54:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:54:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0064)
[INFO] - 03-16 20:54:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5822 (0.5807)
[INFO] - 03-16 20:54:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4908 (-140.4112)
[INFO] - 03-16 20:54:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.2577 (21.3266)
[INFO] - 03-16 20:54:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.4821 (212.2073)
[INFO] - 03-16 20:54:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:54:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9192)
[INFO] - 03-16 20:54:59 - [main.backward:225]: Epoch 161/300 - Iteration 110/199 - Time 0.301 batch, 0.048 data, 0.266 forward
[INFO] - 03-16 20:54:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:54:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0083 (0.0065)
[INFO] - 03-16 20:54:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5961 (0.5842)
[INFO] - 03-16 20:54:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4292 (-140.4053)
[INFO] - 03-16 20:54:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.5117 (21.3573)
[INFO] - 03-16 20:54:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.4312 (211.5655)
[INFO] - 03-16 20:54:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:54:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9103)
[INFO] - 03-16 20:55:14 - [main.backward:225]: Epoch 161/300 - Iteration 160/199 - Time 0.297 batch, 0.044 data, 0.262 forward
[INFO] - 03-16 20:55:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0070)
[INFO] - 03-16 20:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5663 (0.5896)
[INFO] - 03-16 20:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4484 (-140.4187)
[INFO] - 03-16 20:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3467 (21.3722)
[INFO] - 03-16 20:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.4422 (210.9224)
[INFO] - 03-16 20:55:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9117)
[INFO] - 03-16 20:55:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:55:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:55:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:55:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:55:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:55:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:55:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:55:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.299
[INFO] - 03-16 20:55:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.300
[INFO] - 03-16 20:55:30 - [main.summary_metrics:168]: Epoch 161/300 - Test Results:
{'auc': 0.8432056472746331,
 'f1': 0.4126753749395258,
 'loss': 0.47393894189158836,
 'ndcg': 0.7296943938286444,
 'precision': 0.6150943396226415,
 'recall': 0.31077044025157236}
[INFO] - 03-16 20:55:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[161] Complete. Time taken: 00:01:04.173
[INFO] - 03-16 20:55:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:55:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:55:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:55:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:55:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:55:31 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7233, 5006, 5149]
[INFO] - 03-16 20:55:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:55:35 - [main.backward:225]: Epoch 162/300 - Iteration 11/199 - Time 0.446 batch, 0.186 data, 0.410 forward
[INFO] - 03-16 20:55:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:55:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0069)
[INFO] - 03-16 20:55:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5335 (0.5846)
[INFO] - 03-16 20:55:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4617 (-140.3750)
[INFO] - 03-16 20:55:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.2840 (21.2695)
[INFO] - 03-16 20:55:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.3639 (211.4039)
[INFO] - 03-16 20:55:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:55:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9155)
[INFO] - 03-16 20:55:50 - [main.backward:225]: Epoch 162/300 - Iteration 61/199 - Time 0.319 batch, 0.062 data, 0.283 forward
[INFO] - 03-16 20:55:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0064)
[INFO] - 03-16 20:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5951 (0.5795)
[INFO] - 03-16 20:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3805 (-140.4110)
[INFO] - 03-16 20:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3582 (21.2984)
[INFO] - 03-16 20:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.9102 (212.3204)
[INFO] - 03-16 20:55:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9213)
[INFO] - 03-16 20:56:04 - [main.backward:225]: Epoch 162/300 - Iteration 111/199 - Time 0.303 batch, 0.050 data, 0.268 forward
[INFO] - 03-16 20:56:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:56:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0065)
[INFO] - 03-16 20:56:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5929 (0.5815)
[INFO] - 03-16 20:56:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4308 (-140.4053)
[INFO] - 03-16 20:56:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4757 (21.3700)
[INFO] - 03-16 20:56:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.5621 (211.5699)
[INFO] - 03-16 20:56:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:56:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9164)
[INFO] - 03-16 20:56:18 - [main.backward:225]: Epoch 162/300 - Iteration 161/199 - Time 0.297 batch, 0.046 data, 0.262 forward
[INFO] - 03-16 20:56:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:56:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0066)
[INFO] - 03-16 20:56:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5580 (0.5874)
[INFO] - 03-16 20:56:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4522 (-140.4199)
[INFO] - 03-16 20:56:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3275 (21.3586)
[INFO] - 03-16 20:56:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.2256 (210.2454)
[INFO] - 03-16 20:56:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:56:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9189)
[INFO] - 03-16 20:56:29 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:56:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:56:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:56:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:56:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:56:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:56:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:56:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.197
[INFO] - 03-16 20:56:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.198
[INFO] - 03-16 20:56:34 - [main.summary_metrics:168]: Epoch 162/300 - Test Results:
{'auc': 0.8431647012578616,
 'f1': 0.40909530720851467,
 'loss': 0.4690319745085774,
 'ndcg': 0.7246135881791623,
 'precision': 0.6094339622641509,
 'recall': 0.3081761006289308}
[INFO] - 03-16 20:56:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[162] Complete. Time taken: 00:01:03.589
[INFO] - 03-16 20:56:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:56:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:56:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:56:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:56:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:56:34 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7232, 4999, 5166]
[INFO] - 03-16 20:56:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:56:39 - [main.backward:225]: Epoch 163/300 - Iteration 12/199 - Time 0.427 batch, 0.175 data, 0.391 forward
[INFO] - 03-16 20:56:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0066)
[INFO] - 03-16 20:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5850 (0.5855)
[INFO] - 03-16 20:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4168 (-140.3708)
[INFO] - 03-16 20:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.1447 (21.2343)
[INFO] - 03-16 20:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.3021 (211.2083)
[INFO] - 03-16 20:56:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9203)
[INFO] - 03-16 20:56:54 - [main.backward:225]: Epoch 163/300 - Iteration 62/199 - Time 0.315 batch, 0.060 data, 0.282 forward
[INFO] - 03-16 20:56:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:56:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0060)
[INFO] - 03-16 20:56:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5991 (0.5825)
[INFO] - 03-16 20:56:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3720 (-140.4107)
[INFO] - 03-16 20:56:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.2550 (21.1513)
[INFO] - 03-16 20:56:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.3676 (211.6749)
[INFO] - 03-16 20:56:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:56:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9275)
[INFO] - 03-16 20:57:08 - [main.backward:225]: Epoch 163/300 - Iteration 112/199 - Time 0.304 batch, 0.048 data, 0.270 forward
[INFO] - 03-16 20:57:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:57:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0099 (0.0068)
[INFO] - 03-16 20:57:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5928 (0.5825)
[INFO] - 03-16 20:57:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4127 (-140.4071)
[INFO] - 03-16 20:57:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4666 (21.3082)
[INFO] - 03-16 20:57:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 212.1906 (211.2888)
[INFO] - 03-16 20:57:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:57:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9167)
[INFO] - 03-16 20:57:23 - [main.backward:225]: Epoch 163/300 - Iteration 162/199 - Time 0.299 batch, 0.045 data, 0.265 forward
[INFO] - 03-16 20:57:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:57:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0066)
[INFO] - 03-16 20:57:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6010 (0.5885)
[INFO] - 03-16 20:57:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4080 (-140.4225)
[INFO] - 03-16 20:57:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3578 (21.3412)
[INFO] - 03-16 20:57:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.5741 (210.4140)
[INFO] - 03-16 20:57:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:57:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9197)
[INFO] - 03-16 20:57:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:57:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:57:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:57:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:57:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:57:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:57:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:57:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.188
[INFO] - 03-16 20:57:38 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.189
[INFO] - 03-16 20:57:38 - [main.summary_metrics:168]: Epoch 163/300 - Test Results:
{'auc': 0.836805359014675,
 'f1': 0.4011611030478955,
 'loss': 0.4727788085617609,
 'ndcg': 0.7146178379328805,
 'precision': 0.5981132075471699,
 'recall': 0.3020440251572327}
[INFO] - 03-16 20:57:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[163] Complete. Time taken: 00:01:04.314
[INFO] - 03-16 20:57:38 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:57:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:57:38 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:57:38 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:57:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:57:38 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7228, 4992, 5132]
[INFO] - 03-16 20:57:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:57:44 - [main.backward:225]: Epoch 164/300 - Iteration 13/199 - Time 0.400 batch, 0.149 data, 0.369 forward
[INFO] - 03-16 20:57:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:57:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0067)
[INFO] - 03-16 20:57:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5976 (0.5855)
[INFO] - 03-16 20:57:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4225 (-140.3678)
[INFO] - 03-16 20:57:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.2048 (21.1764)
[INFO] - 03-16 20:57:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.1397 (210.9310)
[INFO] - 03-16 20:57:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:57:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9155)
[INFO] - 03-16 20:57:58 - [main.backward:225]: Epoch 164/300 - Iteration 63/199 - Time 0.311 batch, 0.058 data, 0.278 forward
[INFO] - 03-16 20:57:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:57:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0065)
[INFO] - 03-16 20:57:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6067 (0.5814)
[INFO] - 03-16 20:57:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3618 (-140.4068)
[INFO] - 03-16 20:57:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3482 (21.1709)
[INFO] - 03-16 20:57:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.5047 (211.3452)
[INFO] - 03-16 20:57:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:57:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9184)
[INFO] - 03-16 20:58:13 - [main.backward:225]: Epoch 164/300 - Iteration 113/199 - Time 0.302 batch, 0.048 data, 0.267 forward
[INFO] - 03-16 20:58:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:58:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0067)
[INFO] - 03-16 20:58:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5664 (0.5810)
[INFO] - 03-16 20:58:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4347 (-140.4063)
[INFO] - 03-16 20:58:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.4544 (21.4119)
[INFO] - 03-16 20:58:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.2454 (210.5639)
[INFO] - 03-16 20:58:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:58:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9141)
[INFO] - 03-16 20:58:27 - [main.backward:225]: Epoch 164/300 - Iteration 163/199 - Time 0.295 batch, 0.044 data, 0.261 forward
[INFO] - 03-16 20:58:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0089 (0.0068)
[INFO] - 03-16 20:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6019 (0.5901)
[INFO] - 03-16 20:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3911 (-140.4232)
[INFO] - 03-16 20:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3648 (21.4010)
[INFO] - 03-16 20:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.5107 (209.9610)
[INFO] - 03-16 20:58:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9191)
[INFO] - 03-16 20:58:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:58:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:58:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:58:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:58:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:58:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:58:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:58:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.026
[INFO] - 03-16 20:58:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.028
[INFO] - 03-16 20:58:42 - [main.summary_metrics:168]: Epoch 164/300 - Test Results:
{'auc': 0.8446285049790355,
 'f1': 0.41499758103531675,
 'loss': 0.46515692264228997,
 'ndcg': 0.7295217227631311,
 'precision': 0.618867924528302,
 'recall': 0.3124213836477988}
[INFO] - 03-16 20:58:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[164] Complete. Time taken: 00:01:03.593
[INFO] - 03-16 20:58:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:58:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:58:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:58:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:58:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:58:42 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7234, 5021, 5162]
[INFO] - 03-16 20:58:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:58:48 - [main.backward:225]: Epoch 165/300 - Iteration 14/199 - Time 0.397 batch, 0.143 data, 0.359 forward
[INFO] - 03-16 20:58:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0065)
[INFO] - 03-16 20:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5941 (0.5859)
[INFO] - 03-16 20:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4241 (-140.3726)
[INFO] - 03-16 20:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.0860 (21.1810)
[INFO] - 03-16 20:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.3455 (210.2929)
[INFO] - 03-16 20:58:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9209)
[INFO] - 03-16 20:59:02 - [main.backward:225]: Epoch 165/300 - Iteration 64/199 - Time 0.311 batch, 0.057 data, 0.277 forward
[INFO] - 03-16 20:59:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0066)
[INFO] - 03-16 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5947 (0.5802)
[INFO] - 03-16 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3627 (-140.4064)
[INFO] - 03-16 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.1800 (21.1466)
[INFO] - 03-16 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.9624 (210.5930)
[INFO] - 03-16 20:59:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9187)
[INFO] - 03-16 20:59:16 - [main.backward:225]: Epoch 165/300 - Iteration 114/199 - Time 0.301 batch, 0.047 data, 0.267 forward
[INFO] - 03-16 20:59:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0070)
[INFO] - 03-16 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5705 (0.5817)
[INFO] - 03-16 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4411 (-140.4067)
[INFO] - 03-16 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3117 (21.3126)
[INFO] - 03-16 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.0039 (209.8545)
[INFO] - 03-16 20:59:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9125)
[INFO] - 03-16 20:59:31 - [main.backward:225]: Epoch 165/300 - Iteration 164/199 - Time 0.298 batch, 0.043 data, 0.264 forward
[INFO] - 03-16 20:59:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:59:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0095 (0.0073)
[INFO] - 03-16 20:59:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6110 (0.5902)
[INFO] - 03-16 20:59:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3934 (-140.4240)
[INFO] - 03-16 20:59:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.2772 (21.3287)
[INFO] - 03-16 20:59:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.4662 (209.0559)
[INFO] - 03-16 20:59:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:59:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9102)
[INFO] - 03-16 20:59:41 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 20:59:41 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:59:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:59:41 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 20:59:41 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:59:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 20:59:41 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 20:59:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.146
[INFO] - 03-16 20:59:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.148
[INFO] - 03-16 20:59:46 - [main.summary_metrics:168]: Epoch 165/300 - Test Results:
{'auc': 0.8367419418238994,
 'f1': 0.405128205128205,
 'loss': 0.4668907629288967,
 'ndcg': 0.7043945152381808,
 'precision': 0.6037735849056604,
 'recall': 0.3051100628930818}
[INFO] - 03-16 20:59:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[165] Complete. Time taken: 00:01:04.116
[INFO] - 03-16 20:59:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 20:59:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 20:59:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 20:59:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 20:59:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 20:59:46 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7194, 4970, 5148]
[INFO] - 03-16 20:59:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 20:59:52 - [main.backward:225]: Epoch 166/300 - Iteration 15/199 - Time 0.399 batch, 0.142 data, 0.365 forward
[INFO] - 03-16 20:59:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 20:59:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0065)
[INFO] - 03-16 20:59:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5865 (0.5853)
[INFO] - 03-16 20:59:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4277 (-140.3772)
[INFO] - 03-16 20:59:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.1942 (21.1129)
[INFO] - 03-16 20:59:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.7512 (209.8869)
[INFO] - 03-16 20:59:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 20:59:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9165)
[INFO] - 03-16 21:00:06 - [main.backward:225]: Epoch 166/300 - Iteration 65/199 - Time 0.306 batch, 0.060 data, 0.271 forward
[INFO] - 03-16 21:00:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:00:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0128 (0.0065)
[INFO] - 03-16 21:00:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6320 (0.5820)
[INFO] - 03-16 21:00:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3404 (-140.4066)
[INFO] - 03-16 21:00:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.1076 (21.1075)
[INFO] - 03-16 21:00:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.6673 (209.9072)
[INFO] - 03-16 21:00:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:00:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.9172)
[INFO] - 03-16 21:00:20 - [main.backward:225]: Epoch 166/300 - Iteration 115/199 - Time 0.293 batch, 0.049 data, 0.258 forward
[INFO] - 03-16 21:00:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0065)
[INFO] - 03-16 21:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5701 (0.5814)
[INFO] - 03-16 21:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4388 (-140.4095)
[INFO] - 03-16 21:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.3001 (21.2051)
[INFO] - 03-16 21:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 209.3755 (209.6973)
[INFO] - 03-16 21:00:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:00:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9145)
[INFO] - 03-16 21:00:34 - [main.backward:225]: Epoch 166/300 - Iteration 165/199 - Time 0.292 batch, 0.044 data, 0.258 forward
[INFO] - 03-16 21:00:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0072 (0.0070)
[INFO] - 03-16 21:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6126 (0.5893)
[INFO] - 03-16 21:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3747 (-140.4202)
[INFO] - 03-16 21:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.1811 (21.2367)
[INFO] - 03-16 21:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 209.2850 (208.7441)
[INFO] - 03-16 21:00:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:00:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9127)
[INFO] - 03-16 21:00:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:00:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:00:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:00:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:00:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:00:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:00:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:00:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.297
[INFO] - 03-16 21:00:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.299
[INFO] - 03-16 21:00:49 - [main.summary_metrics:168]: Epoch 166/300 - Test Results:
{'auc': 0.8281831433438155,
 'f1': 0.38374455732946283,
 'loss': 0.4744769267755984,
 'ndcg': 0.6945823407702947,
 'precision': 0.5716981132075472,
 'recall': 0.28907232704402513}
[INFO] - 03-16 21:00:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[166] Complete. Time taken: 00:01:03.285
[INFO] - 03-16 21:00:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:00:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:00:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:00:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:00:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:00:49 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7226, 4980, 5129]
[INFO] - 03-16 21:00:51 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:00:55 - [main.backward:225]: Epoch 167/300 - Iteration 16/199 - Time 0.378 batch, 0.126 data, 0.339 forward
[INFO] - 03-16 21:00:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0062)
[INFO] - 03-16 21:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6019 (0.5857)
[INFO] - 03-16 21:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3495 (-140.3739)
[INFO] - 03-16 21:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.0619 (21.1220)
[INFO] - 03-16 21:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 211.0457 (209.9489)
[INFO] - 03-16 21:00:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9258)
[INFO] - 03-16 21:01:10 - [main.backward:225]: Epoch 167/300 - Iteration 66/199 - Time 0.309 batch, 0.055 data, 0.274 forward
[INFO] - 03-16 21:01:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0106 (0.0063)
[INFO] - 03-16 21:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6308 (0.5842)
[INFO] - 03-16 21:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3394 (-140.4108)
[INFO] - 03-16 21:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.1625 (21.1891)
[INFO] - 03-16 21:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.0754 (210.3022)
[INFO] - 03-16 21:01:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.9222)
[INFO] - 03-16 21:01:24 - [main.backward:225]: Epoch 167/300 - Iteration 116/199 - Time 0.297 batch, 0.047 data, 0.263 forward
[INFO] - 03-16 21:01:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:01:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0060)
[INFO] - 03-16 21:01:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5720 (0.5794)
[INFO] - 03-16 21:01:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4367 (-140.4132)
[INFO] - 03-16 21:01:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.0943 (21.1394)
[INFO] - 03-16 21:01:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 207.5324 (209.4269)
[INFO] - 03-16 21:01:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:01:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9273)
[INFO] - 03-16 21:01:38 - [main.backward:225]: Epoch 167/300 - Iteration 166/199 - Time 0.295 batch, 0.043 data, 0.261 forward
[INFO] - 03-16 21:01:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:01:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0070)
[INFO] - 03-16 21:01:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6153 (0.5918)
[INFO] - 03-16 21:01:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4112 (-140.4181)
[INFO] - 03-16 21:01:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.0508 (21.1078)
[INFO] - 03-16 21:01:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 209.2248 (208.0049)
[INFO] - 03-16 21:01:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:01:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9123)
[INFO] - 03-16 21:01:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:01:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:01:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:01:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:01:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:01:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:01:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:01:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.060
[INFO] - 03-16 21:01:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.060
[INFO] - 03-16 21:01:53 - [main.summary_metrics:168]: Epoch 167/300 - Test Results:
{'auc': 0.8299348794549266,
 'f1': 0.3885244315432993,
 'loss': 0.46983738425792637,
 'ndcg': 0.6991977903392321,
 'precision': 0.5792452830188679,
 'recall': 0.2925314465408805}
[INFO] - 03-16 21:01:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[167] Complete. Time taken: 00:01:03.561
[INFO] - 03-16 21:01:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:01:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:01:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:01:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:01:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:01:53 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7239, 4989, 5119]
[INFO] - 03-16 21:01:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:01:59 - [main.backward:225]: Epoch 168/300 - Iteration 17/199 - Time 0.378 batch, 0.122 data, 0.344 forward
[INFO] - 03-16 21:01:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:01:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0075 (0.0066)
[INFO] - 03-16 21:01:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5966 (0.5854)
[INFO] - 03-16 21:01:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3526 (-140.3736)
[INFO] - 03-16 21:01:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.0063 (21.0151)
[INFO] - 03-16 21:01:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.5749 (209.3762)
[INFO] - 03-16 21:01:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:01:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9169)
[INFO] - 03-16 21:02:14 - [main.backward:225]: Epoch 168/300 - Iteration 67/199 - Time 0.307 batch, 0.057 data, 0.272 forward
[INFO] - 03-16 21:02:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:02:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0072 (0.0065)
[INFO] - 03-16 21:02:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6248 (0.5828)
[INFO] - 03-16 21:02:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3410 (-140.4098)
[INFO] - 03-16 21:02:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.2720 (21.0983)
[INFO] - 03-16 21:02:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 210.1955 (209.4688)
[INFO] - 03-16 21:02:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:02:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9158)
[INFO] - 03-16 21:02:28 - [main.backward:225]: Epoch 168/300 - Iteration 117/199 - Time 0.296 batch, 0.047 data, 0.262 forward
[INFO] - 03-16 21:02:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:02:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0080 (0.0061)
[INFO] - 03-16 21:02:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6042 (0.5778)
[INFO] - 03-16 21:02:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4196 (-140.4121)
[INFO] - 03-16 21:02:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.2964 (21.2214)
[INFO] - 03-16 21:02:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.5583 (209.0478)
[INFO] - 03-16 21:02:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:02:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9266)
[INFO] - 03-16 21:02:41 - [main.backward:225]: Epoch 168/300 - Iteration 167/199 - Time 0.289 batch, 0.042 data, 0.256 forward
[INFO] - 03-16 21:02:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:02:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0084 (0.0071)
[INFO] - 03-16 21:02:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5968 (0.5919)
[INFO] - 03-16 21:02:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4076 (-140.4107)
[INFO] - 03-16 21:02:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9101 (21.1974)
[INFO] - 03-16 21:02:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.4412 (208.2003)
[INFO] - 03-16 21:02:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:02:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9116)
[INFO] - 03-16 21:02:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:02:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:02:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:02:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:02:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:02:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:02:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:02:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.038
[INFO] - 03-16 21:02:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.039
[INFO] - 03-16 21:02:55 - [main.summary_metrics:168]: Epoch 168/300 - Test Results:
{'auc': 0.8344876834381552,
 'f1': 0.40129656507014994,
 'loss': 0.47428452149877004,
 'ndcg': 0.7124463802869363,
 'precision': 0.5981132075471699,
 'recall': 0.3022012578616352}
[INFO] - 03-16 21:02:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[168] Complete. Time taken: 00:01:02.092
[INFO] - 03-16 21:02:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:02:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:02:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:02:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:02:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:02:55 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7215, 4942, 5120]
[INFO] - 03-16 21:02:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:03:02 - [main.backward:225]: Epoch 169/300 - Iteration 18/199 - Time 0.379 batch, 0.123 data, 0.342 forward
[INFO] - 03-16 21:03:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:03:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0100 (0.0066)
[INFO] - 03-16 21:03:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6019 (0.5845)
[INFO] - 03-16 21:03:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3416 (-140.3715)
[INFO] - 03-16 21:03:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9718 (21.0189)
[INFO] - 03-16 21:03:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 209.4385 (208.7936)
[INFO] - 03-16 21:03:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:03:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9194)
[INFO] - 03-16 21:03:16 - [main.backward:225]: Epoch 169/300 - Iteration 68/199 - Time 0.303 batch, 0.055 data, 0.271 forward
[INFO] - 03-16 21:03:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:03:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0070)
[INFO] - 03-16 21:03:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5724 (0.5822)
[INFO] - 03-16 21:03:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4080 (-140.4089)
[INFO] - 03-16 21:03:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9566 (21.0152)
[INFO] - 03-16 21:03:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 209.2731 (209.4730)
[INFO] - 03-16 21:03:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:03:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9097)
[INFO] - 03-16 21:03:30 - [main.backward:225]: Epoch 169/300 - Iteration 118/199 - Time 0.295 batch, 0.046 data, 0.262 forward
[INFO] - 03-16 21:03:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0066)
[INFO] - 03-16 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6126 (0.5798)
[INFO] - 03-16 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4042 (-140.4116)
[INFO] - 03-16 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.2605 (21.1114)
[INFO] - 03-16 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 207.9508 (208.1778)
[INFO] - 03-16 21:03:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9158)
[INFO] - 03-16 21:03:44 - [main.backward:225]: Epoch 169/300 - Iteration 168/199 - Time 0.292 batch, 0.043 data, 0.258 forward
[INFO] - 03-16 21:03:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:03:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0070)
[INFO] - 03-16 21:03:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5989 (0.5914)
[INFO] - 03-16 21:03:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4005 (-140.4055)
[INFO] - 03-16 21:03:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.1079 (21.1848)
[INFO] - 03-16 21:03:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.0822 (207.8139)
[INFO] - 03-16 21:03:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:03:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9194)
[INFO] - 03-16 21:03:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:03:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:03:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:03:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:03:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:03:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:03:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:03:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.185
[INFO] - 03-16 21:03:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.185
[INFO] - 03-16 21:03:58 - [main.summary_metrics:168]: Epoch 169/300 - Test Results:
{'auc': 0.8259215474318659,
 'f1': 0.3884663763909046,
 'loss': 0.4757339353141544,
 'ndcg': 0.7001197905300103,
 'precision': 0.5792452830188679,
 'recall': 0.29245283018867924}
[INFO] - 03-16 21:03:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[169] Complete. Time taken: 00:01:02.948
[INFO] - 03-16 21:03:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:03:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:03:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:03:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:03:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:03:58 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7242, 5004, 5157]
[INFO] - 03-16 21:04:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:04:05 - [main.backward:225]: Epoch 170/300 - Iteration 19/199 - Time 0.359 batch, 0.115 data, 0.322 forward
[INFO] - 03-16 21:04:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0119 (0.0065)
[INFO] - 03-16 21:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5896 (0.5850)
[INFO] - 03-16 21:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3818 (-140.3703)
[INFO] - 03-16 21:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9347 (21.0334)
[INFO] - 03-16 21:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.0152 (208.3559)
[INFO] - 03-16 21:04:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8047 (0.9167)
[INFO] - 03-16 21:04:19 - [main.backward:225]: Epoch 170/300 - Iteration 69/199 - Time 0.301 batch, 0.056 data, 0.267 forward
[INFO] - 03-16 21:04:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:04:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0063)
[INFO] - 03-16 21:04:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5262 (0.5799)
[INFO] - 03-16 21:04:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4892 (-140.4112)
[INFO] - 03-16 21:04:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9355 (20.9102)
[INFO] - 03-16 21:04:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.0243 (208.3472)
[INFO] - 03-16 21:04:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:04:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9228)
[INFO] - 03-16 21:04:33 - [main.backward:225]: Epoch 170/300 - Iteration 119/199 - Time 0.296 batch, 0.046 data, 0.262 forward
[INFO] - 03-16 21:04:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:04:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0062)
[INFO] - 03-16 21:04:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6132 (0.5806)
[INFO] - 03-16 21:04:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4160 (-140.4137)
[INFO] - 03-16 21:04:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.1763 (21.1034)
[INFO] - 03-16 21:04:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.2338 (207.9572)
[INFO] - 03-16 21:04:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:04:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9202)
[INFO] - 03-16 21:04:48 - [main.backward:225]: Epoch 170/300 - Iteration 169/199 - Time 0.295 batch, 0.042 data, 0.261 forward
[INFO] - 03-16 21:04:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:04:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0067)
[INFO] - 03-16 21:04:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5932 (0.5906)
[INFO] - 03-16 21:04:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4035 (-140.4022)
[INFO] - 03-16 21:04:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.0151 (21.1214)
[INFO] - 03-16 21:04:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 207.9209 (206.9634)
[INFO] - 03-16 21:04:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:04:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9166)
[INFO] - 03-16 21:04:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:04:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:04:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:04:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:04:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:04:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:04:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:05:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.162
[INFO] - 03-16 21:05:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.163
[INFO] - 03-16 21:05:02 - [main.summary_metrics:168]: Epoch 170/300 - Test Results:
{'auc': 0.8363475825471698,
 'f1': 0.4073923560716013,
 'loss': 0.4708990737227273,
 'ndcg': 0.7158828365720735,
 'precision': 0.6075471698113208,
 'recall': 0.306682389937107}
[INFO] - 03-16 21:05:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[170] Complete. Time taken: 00:01:03.811
[INFO] - 03-16 21:05:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:05:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:05:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:05:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:05:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:05:02 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7220, 4996, 5142]
[INFO] - 03-16 21:05:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:05:09 - [main.backward:225]: Epoch 171/300 - Iteration 20/199 - Time 0.361 batch, 0.107 data, 0.326 forward
[INFO] - 03-16 21:05:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:05:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0063)
[INFO] - 03-16 21:05:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5654 (0.5846)
[INFO] - 03-16 21:05:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4727 (-140.3703)
[INFO] - 03-16 21:05:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9956 (21.0439)
[INFO] - 03-16 21:05:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.9440 (207.7280)
[INFO] - 03-16 21:05:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:05:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9224)
[INFO] - 03-16 21:05:23 - [main.backward:225]: Epoch 171/300 - Iteration 70/199 - Time 0.303 batch, 0.056 data, 0.267 forward
[INFO] - 03-16 21:05:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0014 (0.0062)
[INFO] - 03-16 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5237 (0.5794)
[INFO] - 03-16 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4838 (-140.4076)
[INFO] - 03-16 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.8986 (20.9822)
[INFO] - 03-16 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.2627 (208.7512)
[INFO] - 03-16 21:05:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9217)
[INFO] - 03-16 21:05:38 - [main.backward:225]: Epoch 171/300 - Iteration 120/199 - Time 0.299 batch, 0.047 data, 0.264 forward
[INFO] - 03-16 21:05:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:05:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0066)
[INFO] - 03-16 21:05:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6040 (0.5814)
[INFO] - 03-16 21:05:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4135 (-140.4102)
[INFO] - 03-16 21:05:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.2254 (21.1138)
[INFO] - 03-16 21:05:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 207.7089 (208.2862)
[INFO] - 03-16 21:05:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:05:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9142)
[INFO] - 03-16 21:05:52 - [main.backward:225]: Epoch 171/300 - Iteration 170/199 - Time 0.296 batch, 0.043 data, 0.261 forward
[INFO] - 03-16 21:05:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:05:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0064)
[INFO] - 03-16 21:05:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5252 (0.5889)
[INFO] - 03-16 21:05:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4373 (-140.4030)
[INFO] - 03-16 21:05:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9926 (21.1008)
[INFO] - 03-16 21:05:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.6587 (207.3295)
[INFO] - 03-16 21:05:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:05:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9213)
[INFO] - 03-16 21:06:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:06:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:06:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:06:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:06:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:06:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:06:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:06:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.766
[INFO] - 03-16 21:06:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.767
[INFO] - 03-16 21:06:05 - [main.summary_metrics:168]: Epoch 171/300 - Test Results:
{'auc': 0.83119660639413,
 'f1': 0.39732946298984023,
 'loss': 0.46964091678035585,
 'ndcg': 0.7092760852990283,
 'precision': 0.5924528301886792,
 'recall': 0.2991352201257862}
[INFO] - 03-16 21:06:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[171] Complete. Time taken: 00:01:03.286
[INFO] - 03-16 21:06:05 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:06:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:06:05 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:06:05 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:06:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:06:05 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7254, 4969, 5114]
[INFO] - 03-16 21:06:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:06:13 - [main.backward:225]: Epoch 172/300 - Iteration 21/199 - Time 0.356 batch, 0.108 data, 0.326 forward
[INFO] - 03-16 21:06:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:06:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0063)
[INFO] - 03-16 21:06:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5711 (0.5864)
[INFO] - 03-16 21:06:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4671 (-140.3712)
[INFO] - 03-16 21:06:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.0211 (21.0089)
[INFO] - 03-16 21:06:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.5023 (208.1337)
[INFO] - 03-16 21:06:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:06:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9258)
[INFO] - 03-16 21:06:26 - [main.backward:225]: Epoch 172/300 - Iteration 71/199 - Time 0.297 batch, 0.055 data, 0.265 forward
[INFO] - 03-16 21:06:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:06:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0062)
[INFO] - 03-16 21:06:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5228 (0.5792)
[INFO] - 03-16 21:06:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4765 (-140.4068)
[INFO] - 03-16 21:06:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.8999 (20.9938)
[INFO] - 03-16 21:06:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 207.0285 (208.1247)
[INFO] - 03-16 21:06:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:06:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9191)
[INFO] - 03-16 21:06:40 - [main.backward:225]: Epoch 172/300 - Iteration 121/199 - Time 0.291 batch, 0.047 data, 0.258 forward
[INFO] - 03-16 21:06:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:06:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0062)
[INFO] - 03-16 21:06:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5814 (0.5857)
[INFO] - 03-16 21:06:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4442 (-140.4101)
[INFO] - 03-16 21:06:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.0588 (21.0348)
[INFO] - 03-16 21:06:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.8074 (207.6085)
[INFO] - 03-16 21:06:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:06:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9225)
[INFO] - 03-16 21:06:55 - [main.backward:225]: Epoch 172/300 - Iteration 171/199 - Time 0.291 batch, 0.044 data, 0.257 forward
[INFO] - 03-16 21:06:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0069)
[INFO] - 03-16 21:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5495 (0.5872)
[INFO] - 03-16 21:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4170 (-140.4045)
[INFO] - 03-16 21:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9404 (21.0056)
[INFO] - 03-16 21:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.1658 (206.2012)
[INFO] - 03-16 21:06:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9158)
[INFO] - 03-16 21:07:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:07:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:07:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:07:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:07:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:07:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:07:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:07:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.335
[INFO] - 03-16 21:07:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.337
[INFO] - 03-16 21:07:08 - [main.summary_metrics:168]: Epoch 172/300 - Test Results:
{'auc': 0.8430164766771489,
 'f1': 0.4149975810353168,
 'loss': 0.4658787152992105,
 'ndcg': 0.7284589907236837,
 'precision': 0.6188679245283019,
 'recall': 0.3124213836477988}
[INFO] - 03-16 21:07:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[172] Complete. Time taken: 00:01:03.193
[INFO] - 03-16 21:07:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:07:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:07:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:07:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:07:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:07:08 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7244, 4966, 5118]
[INFO] - 03-16 21:07:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:07:16 - [main.backward:225]: Epoch 173/300 - Iteration 22/199 - Time 0.355 batch, 0.100 data, 0.322 forward
[INFO] - 03-16 21:07:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:07:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0062)
[INFO] - 03-16 21:07:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5833 (0.5870)
[INFO] - 03-16 21:07:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4764 (-140.3744)
[INFO] - 03-16 21:07:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9326 (20.8961)
[INFO] - 03-16 21:07:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 207.8417 (207.0905)
[INFO] - 03-16 21:07:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:07:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9222)
[INFO] - 03-16 21:07:31 - [main.backward:225]: Epoch 173/300 - Iteration 72/199 - Time 0.310 batch, 0.056 data, 0.275 forward
[INFO] - 03-16 21:07:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0060)
[INFO] - 03-16 21:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5927 (0.5809)
[INFO] - 03-16 21:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4181 (-140.4055)
[INFO] - 03-16 21:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9546 (20.9976)
[INFO] - 03-16 21:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 207.8008 (208.3800)
[INFO] - 03-16 21:07:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9272)
[INFO] - 03-16 21:07:45 - [main.backward:225]: Epoch 173/300 - Iteration 122/199 - Time 0.300 batch, 0.046 data, 0.266 forward
[INFO] - 03-16 21:07:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0066)
[INFO] - 03-16 21:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5924 (0.5832)
[INFO] - 03-16 21:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4361 (-140.4072)
[INFO] - 03-16 21:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 21.0510 (21.0202)
[INFO] - 03-16 21:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.5784 (207.4711)
[INFO] - 03-16 21:07:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9131)
[INFO] - 03-16 21:07:59 - [main.backward:225]: Epoch 173/300 - Iteration 172/199 - Time 0.294 batch, 0.043 data, 0.259 forward
[INFO] - 03-16 21:07:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:07:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0017 (0.0067)
[INFO] - 03-16 21:07:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5358 (0.5876)
[INFO] - 03-16 21:07:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4314 (-140.4033)
[INFO] - 03-16 21:07:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9511 (21.1033)
[INFO] - 03-16 21:07:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 207.9080 (206.9242)
[INFO] - 03-16 21:07:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:07:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9183)
[INFO] - 03-16 21:08:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:08:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:08:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:08:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:08:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:08:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:08:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:08:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.212
[INFO] - 03-16 21:08:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.213
[INFO] - 03-16 21:08:11 - [main.summary_metrics:168]: Epoch 173/300 - Test Results:
{'auc': 0.8339264609538783,
 'f1': 0.41242380261248174,
 'loss': 0.46786297022821516,
 'ndcg': 0.717914839406098,
 'precision': 0.6150943396226415,
 'recall': 0.31045597484276727}
[INFO] - 03-16 21:08:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[173] Complete. Time taken: 00:01:03.103
[INFO] - 03-16 21:08:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:08:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:08:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:08:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:08:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:08:11 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7248, 4994, 5123]
[INFO] - 03-16 21:08:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:08:20 - [main.backward:225]: Epoch 174/300 - Iteration 23/199 - Time 0.355 batch, 0.098 data, 0.320 forward
[INFO] - 03-16 21:08:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0088 (0.0064)
[INFO] - 03-16 21:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6049 (0.5868)
[INFO] - 03-16 21:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3867 (-140.3725)
[INFO] - 03-16 21:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9647 (20.9564)
[INFO] - 03-16 21:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.9171 (207.1958)
[INFO] - 03-16 21:08:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:08:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9211)
[INFO] - 03-16 21:08:34 - [main.backward:225]: Epoch 174/300 - Iteration 73/199 - Time 0.312 batch, 0.054 data, 0.278 forward
[INFO] - 03-16 21:08:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0057)
[INFO] - 03-16 21:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5971 (0.5780)
[INFO] - 03-16 21:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4130 (-140.4058)
[INFO] - 03-16 21:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9750 (20.9194)
[INFO] - 03-16 21:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 209.1713 (207.7823)
[INFO] - 03-16 21:08:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9305)
[INFO] - 03-16 21:08:49 - [main.backward:225]: Epoch 174/300 - Iteration 123/199 - Time 0.302 batch, 0.045 data, 0.268 forward
[INFO] - 03-16 21:08:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:08:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0061)
[INFO] - 03-16 21:08:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5825 (0.5828)
[INFO] - 03-16 21:08:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4415 (-140.4069)
[INFO] - 03-16 21:08:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9861 (20.9623)
[INFO] - 03-16 21:08:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.0546 (207.4883)
[INFO] - 03-16 21:08:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:08:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9261)
[INFO] - 03-16 21:09:03 - [main.backward:225]: Epoch 174/300 - Iteration 173/199 - Time 0.298 batch, 0.042 data, 0.264 forward
[INFO] - 03-16 21:09:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:09:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0065)
[INFO] - 03-16 21:09:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5597 (0.5876)
[INFO] - 03-16 21:09:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4301 (-140.4050)
[INFO] - 03-16 21:09:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.8479 (20.9467)
[INFO] - 03-16 21:09:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.7573 (206.1662)
[INFO] - 03-16 21:09:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:09:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9197)
[INFO] - 03-16 21:09:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:09:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:09:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:09:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:09:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:09:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:09:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:09:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.991
[INFO] - 03-16 21:09:15 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.992
[INFO] - 03-16 21:09:15 - [main.summary_metrics:168]: Epoch 174/300 - Test Results:
{'auc': 0.839500393081761,
 'f1': 0.3950653120464441,
 'loss': 0.46303426868910563,
 'ndcg': 0.7110929681120673,
 'precision': 0.588679245283019,
 'recall': 0.29756289308176104}
[INFO] - 03-16 21:09:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[174] Complete. Time taken: 00:01:04.007
[INFO] - 03-16 21:09:15 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:09:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:09:15 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:09:15 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:09:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:09:15 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7230, 4989, 5113]
[INFO] - 03-16 21:09:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:09:24 - [main.backward:225]: Epoch 175/300 - Iteration 24/199 - Time 0.345 batch, 0.097 data, 0.313 forward
[INFO] - 03-16 21:09:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0067)
[INFO] - 03-16 21:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6119 (0.5892)
[INFO] - 03-16 21:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2775 (-140.3679)
[INFO] - 03-16 21:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9918 (20.8660)
[INFO] - 03-16 21:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 208.3571 (206.9697)
[INFO] - 03-16 21:09:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9120)
[INFO] - 03-16 21:09:38 - [main.backward:225]: Epoch 175/300 - Iteration 74/199 - Time 0.306 batch, 0.054 data, 0.274 forward
[INFO] - 03-16 21:09:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0058)
[INFO] - 03-16 21:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6147 (0.5799)
[INFO] - 03-16 21:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4138 (-140.4076)
[INFO] - 03-16 21:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.8588 (20.8996)
[INFO] - 03-16 21:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 207.7603 (207.7265)
[INFO] - 03-16 21:09:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9281)
[INFO] - 03-16 21:09:53 - [main.backward:225]: Epoch 175/300 - Iteration 124/199 - Time 0.299 batch, 0.046 data, 0.266 forward
[INFO] - 03-16 21:09:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0061)
[INFO] - 03-16 21:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5842)
[INFO] - 03-16 21:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4138 (-140.4076)
[INFO] - 03-16 21:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.8408 (20.9083)
[INFO] - 03-16 21:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 205.6511 (206.6994)
[INFO] - 03-16 21:09:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9230)
[INFO] - 03-16 21:10:07 - [main.backward:225]: Epoch 175/300 - Iteration 174/199 - Time 0.294 batch, 0.042 data, 0.260 forward
[INFO] - 03-16 21:10:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0060)
[INFO] - 03-16 21:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5773 (0.5868)
[INFO] - 03-16 21:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4258 (-140.4034)
[INFO] - 03-16 21:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7556 (20.9241)
[INFO] - 03-16 21:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.1626 (206.2460)
[INFO] - 03-16 21:10:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9284)
[INFO] - 03-16 21:10:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:10:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:10:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:10:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:10:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:10:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:10:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:10:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.264
[INFO] - 03-16 21:10:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.265
[INFO] - 03-16 21:10:19 - [main.summary_metrics:168]: Epoch 175/300 - Test Results:
{'auc': 0.8458464688155136,
 'f1': 0.4151330430575713,
 'loss': 0.4607323008763215,
 'ndcg': 0.7367763903431137,
 'precision': 0.6188679245283019,
 'recall': 0.31257861635220124}
[INFO] - 03-16 21:10:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[175] Complete. Time taken: 00:01:03.645
[INFO] - 03-16 21:10:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:10:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:10:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:10:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:10:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:10:19 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7242, 4983, 5160]
[INFO] - 03-16 21:10:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:10:28 - [main.backward:225]: Epoch 176/300 - Iteration 25/199 - Time 0.344 batch, 0.094 data, 0.309 forward
[INFO] - 03-16 21:10:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:10:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0072 (0.0065)
[INFO] - 03-16 21:10:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6117 (0.5892)
[INFO] - 03-16 21:10:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2654 (-140.3632)
[INFO] - 03-16 21:10:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.8725 (20.8078)
[INFO] - 03-16 21:10:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.4641 (206.7488)
[INFO] - 03-16 21:10:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:10:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9184)
[INFO] - 03-16 21:10:42 - [main.backward:225]: Epoch 176/300 - Iteration 75/199 - Time 0.302 batch, 0.055 data, 0.267 forward
[INFO] - 03-16 21:10:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0062)
[INFO] - 03-16 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6138 (0.5798)
[INFO] - 03-16 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3953 (-140.4067)
[INFO] - 03-16 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.8867 (20.8094)
[INFO] - 03-16 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 207.3801 (206.9369)
[INFO] - 03-16 21:10:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9217)
[INFO] - 03-16 21:10:56 - [main.backward:225]: Epoch 176/300 - Iteration 125/199 - Time 0.296 batch, 0.046 data, 0.261 forward
[INFO] - 03-16 21:10:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0085 (0.0068)
[INFO] - 03-16 21:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6070 (0.5832)
[INFO] - 03-16 21:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3468 (-140.4027)
[INFO] - 03-16 21:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.8278 (20.7936)
[INFO] - 03-16 21:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.9646 (206.3689)
[INFO] - 03-16 21:10:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9133)
[INFO] - 03-16 21:11:11 - [main.backward:225]: Epoch 176/300 - Iteration 175/199 - Time 0.295 batch, 0.043 data, 0.260 forward
[INFO] - 03-16 21:11:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0066)
[INFO] - 03-16 21:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5769 (0.5855)
[INFO] - 03-16 21:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4180 (-140.4071)
[INFO] - 03-16 21:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.8311 (20.8744)
[INFO] - 03-16 21:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 205.1669 (205.4047)
[INFO] - 03-16 21:11:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9233)
[INFO] - 03-16 21:11:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:11:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:11:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:11:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:11:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:11:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:11:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:11:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.314
[INFO] - 03-16 21:11:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.314
[INFO] - 03-16 21:11:23 - [main.summary_metrics:168]: Epoch 176/300 - Test Results:
{'auc': 0.836805752096436,
 'f1': 0.4024189646831156,
 'loss': 0.46837837095680485,
 'ndcg': 0.719665155727353,
 'precision': 0.6,
 'recall': 0.3029874213836478}
[INFO] - 03-16 21:11:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[176] Complete. Time taken: 00:01:03.716
[INFO] - 03-16 21:11:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:11:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:11:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:11:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:11:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:11:23 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7233, 4967, 5151]
[INFO] - 03-16 21:11:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:11:32 - [main.backward:225]: Epoch 177/300 - Iteration 26/199 - Time 0.348 batch, 0.088 data, 0.315 forward
[INFO] - 03-16 21:11:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0068)
[INFO] - 03-16 21:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6107 (0.5894)
[INFO] - 03-16 21:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2954 (-140.3629)
[INFO] - 03-16 21:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7733 (20.7660)
[INFO] - 03-16 21:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.8324 (205.7514)
[INFO] - 03-16 21:11:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9162)
[INFO] - 03-16 21:11:46 - [main.backward:225]: Epoch 177/300 - Iteration 76/199 - Time 0.310 batch, 0.053 data, 0.275 forward
[INFO] - 03-16 21:11:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0058)
[INFO] - 03-16 21:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5838 (0.5780)
[INFO] - 03-16 21:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3944 (-140.4088)
[INFO] - 03-16 21:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9173 (20.8139)
[INFO] - 03-16 21:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.1678 (206.1789)
[INFO] - 03-16 21:11:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9278)
[INFO] - 03-16 21:12:00 - [main.backward:225]: Epoch 177/300 - Iteration 126/199 - Time 0.295 batch, 0.046 data, 0.260 forward
[INFO] - 03-16 21:12:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:12:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0089 (0.0063)
[INFO] - 03-16 21:12:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5971 (0.5816)
[INFO] - 03-16 21:12:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3390 (-140.3962)
[INFO] - 03-16 21:12:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.9247 (20.9100)
[INFO] - 03-16 21:12:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.4333 (205.6049)
[INFO] - 03-16 21:12:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:12:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9197)
[INFO] - 03-16 21:12:15 - [main.backward:225]: Epoch 177/300 - Iteration 176/199 - Time 0.294 batch, 0.043 data, 0.259 forward
[INFO] - 03-16 21:12:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0063)
[INFO] - 03-16 21:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5852)
[INFO] - 03-16 21:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4036 (-140.4069)
[INFO] - 03-16 21:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.8907 (20.8827)
[INFO] - 03-16 21:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 205.6317 (204.5577)
[INFO] - 03-16 21:12:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:12:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9256)
[INFO] - 03-16 21:12:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:12:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:12:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:12:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:12:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:12:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:12:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:12:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.902
[INFO] - 03-16 21:12:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.903
[INFO] - 03-16 21:12:26 - [main.summary_metrics:168]: Epoch 177/300 - Test Results:
{'auc': 0.8406770178197065,
 'f1': 0.40537977745524917,
 'loss': 0.4641123927854142,
 'ndcg': 0.7241108865727752,
 'precision': 0.6037735849056604,
 'recall': 0.30542452830188677}
[INFO] - 03-16 21:12:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[177] Complete. Time taken: 00:01:03.240
[INFO] - 03-16 21:12:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:12:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:12:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:12:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:12:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:12:26 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7272, 4999, 5134]
[INFO] - 03-16 21:12:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:12:35 - [main.backward:225]: Epoch 178/300 - Iteration 27/199 - Time 0.342 batch, 0.091 data, 0.309 forward
[INFO] - 03-16 21:12:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:12:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0076 (0.0064)
[INFO] - 03-16 21:12:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6104 (0.5904)
[INFO] - 03-16 21:12:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3304 (-140.3606)
[INFO] - 03-16 21:12:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7102 (20.7120)
[INFO] - 03-16 21:12:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.6477 (206.0817)
[INFO] - 03-16 21:12:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:12:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9214)
[INFO] - 03-16 21:12:49 - [main.backward:225]: Epoch 178/300 - Iteration 77/199 - Time 0.302 batch, 0.053 data, 0.269 forward
[INFO] - 03-16 21:12:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0056)
[INFO] - 03-16 21:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5760 (0.5780)
[INFO] - 03-16 21:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3821 (-140.4075)
[INFO] - 03-16 21:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7681 (20.7294)
[INFO] - 03-16 21:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 205.3581 (206.1321)
[INFO] - 03-16 21:12:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:12:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9306)
[INFO] - 03-16 21:13:04 - [main.backward:225]: Epoch 178/300 - Iteration 127/199 - Time 0.297 batch, 0.046 data, 0.264 forward
[INFO] - 03-16 21:13:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0064)
[INFO] - 03-16 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6005 (0.5828)
[INFO] - 03-16 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3549 (-140.3952)
[INFO] - 03-16 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7628 (20.7602)
[INFO] - 03-16 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 203.3119 (205.1062)
[INFO] - 03-16 21:13:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9177)
[INFO] - 03-16 21:13:17 - [main.backward:225]: Epoch 178/300 - Iteration 177/199 - Time 0.290 batch, 0.042 data, 0.257 forward
[INFO] - 03-16 21:13:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0062)
[INFO] - 03-16 21:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5854)
[INFO] - 03-16 21:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3636 (-140.4112)
[INFO] - 03-16 21:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7401 (20.7931)
[INFO] - 03-16 21:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 205.3368 (204.2093)
[INFO] - 03-16 21:13:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:13:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9275)
[INFO] - 03-16 21:13:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:13:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:13:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:13:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:13:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:13:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:13:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:13:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.030
[INFO] - 03-16 21:13:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.030
[INFO] - 03-16 21:13:29 - [main.summary_metrics:168]: Epoch 178/300 - Test Results:
{'auc': 0.8483596370545075,
 'f1': 0.41815191098209964,
 'loss': 0.457983581878854,
 'ndcg': 0.7298402042129002,
 'precision': 0.6226415094339623,
 'recall': 0.31509433962264155}
[INFO] - 03-16 21:13:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[178] Complete. Time taken: 00:01:02.560
[INFO] - 03-16 21:13:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:13:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:13:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:13:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:13:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:13:29 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7250, 4996, 5144]
[INFO] - 03-16 21:13:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:13:38 - [main.backward:225]: Epoch 179/300 - Iteration 28/199 - Time 0.327 batch, 0.081 data, 0.296 forward
[INFO] - 03-16 21:13:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:13:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0064)
[INFO] - 03-16 21:13:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6163 (0.5923)
[INFO] - 03-16 21:13:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3556 (-140.3611)
[INFO] - 03-16 21:13:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7711 (20.7286)
[INFO] - 03-16 21:13:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 205.8586 (205.0985)
[INFO] - 03-16 21:13:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:13:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9170)
[INFO] - 03-16 21:13:52 - [main.backward:225]: Epoch 179/300 - Iteration 78/199 - Time 0.294 batch, 0.052 data, 0.260 forward
[INFO] - 03-16 21:13:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0058)
[INFO] - 03-16 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5783 (0.5768)
[INFO] - 03-16 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3702 (-140.4071)
[INFO] - 03-16 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.6210 (20.6911)
[INFO] - 03-16 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.2308 (205.7497)
[INFO] - 03-16 21:13:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9237)
[INFO] - 03-16 21:14:06 - [main.backward:225]: Epoch 179/300 - Iteration 128/199 - Time 0.289 batch, 0.044 data, 0.255 forward
[INFO] - 03-16 21:14:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0063)
[INFO] - 03-16 21:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6025 (0.5841)
[INFO] - 03-16 21:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3979 (-140.3980)
[INFO] - 03-16 21:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7611 (20.7019)
[INFO] - 03-16 21:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.7201 (204.2598)
[INFO] - 03-16 21:14:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:14:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9187)
[INFO] - 03-16 21:14:20 - [main.backward:225]: Epoch 179/300 - Iteration 178/199 - Time 0.286 batch, 0.041 data, 0.253 forward
[INFO] - 03-16 21:14:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0086 (0.0064)
[INFO] - 03-16 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6061 (0.5857)
[INFO] - 03-16 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3392 (-140.4133)
[INFO] - 03-16 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.6181 (20.7106)
[INFO] - 03-16 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.8381 (203.1415)
[INFO] - 03-16 21:14:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9200)
[INFO] - 03-16 21:14:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:14:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:14:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:14:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:14:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:14:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:14:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:14:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.850
[INFO] - 03-16 21:14:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.851
[INFO] - 03-16 21:14:30 - [main.summary_metrics:168]: Epoch 179/300 - Test Results:
{'auc': 0.8342036818658282,
 'f1': 0.3977745524915336,
 'loss': 0.4633801905634019,
 'ndcg': 0.7052619691651152,
 'precision': 0.5924528301886793,
 'recall': 0.299685534591195}
[INFO] - 03-16 21:14:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[179] Complete. Time taken: 00:01:01.718
[INFO] - 03-16 21:14:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:14:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:14:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:14:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:14:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:14:30 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 5003, 5135]
[INFO] - 03-16 21:14:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:14:40 - [main.backward:225]: Epoch 180/300 - Iteration 29/199 - Time 0.323 batch, 0.086 data, 0.294 forward
[INFO] - 03-16 21:14:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0100 (0.0064)
[INFO] - 03-16 21:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6087 (0.5921)
[INFO] - 03-16 21:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3714 (-140.3633)
[INFO] - 03-16 21:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7095 (20.6492)
[INFO] - 03-16 21:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 205.0243 (203.7705)
[INFO] - 03-16 21:14:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:14:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9234)
[INFO] - 03-16 21:14:54 - [main.backward:225]: Epoch 180/300 - Iteration 79/199 - Time 0.300 batch, 0.052 data, 0.268 forward
[INFO] - 03-16 21:14:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0062)
[INFO] - 03-16 21:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5922 (0.5759)
[INFO] - 03-16 21:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3524 (-140.4045)
[INFO] - 03-16 21:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.6719 (20.6096)
[INFO] - 03-16 21:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 205.7675 (204.7799)
[INFO] - 03-16 21:14:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9158)
[INFO] - 03-16 21:15:08 - [main.backward:225]: Epoch 180/300 - Iteration 129/199 - Time 0.295 batch, 0.045 data, 0.262 forward
[INFO] - 03-16 21:15:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0064)
[INFO] - 03-16 21:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6048 (0.5837)
[INFO] - 03-16 21:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4155 (-140.3991)
[INFO] - 03-16 21:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7389 (20.6558)
[INFO] - 03-16 21:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.2267 (204.2546)
[INFO] - 03-16 21:15:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9200)
[INFO] - 03-16 21:15:23 - [main.backward:225]: Epoch 180/300 - Iteration 179/199 - Time 0.295 batch, 0.042 data, 0.262 forward
[INFO] - 03-16 21:15:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0066)
[INFO] - 03-16 21:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6027 (0.5858)
[INFO] - 03-16 21:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3327 (-140.4072)
[INFO] - 03-16 21:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5716 (20.6307)
[INFO] - 03-16 21:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.0670 (203.4983)
[INFO] - 03-16 21:15:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:15:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9209)
[INFO] - 03-16 21:15:29 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:15:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:15:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:15:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:15:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:15:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:15:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:15:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.295
[INFO] - 03-16 21:15:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.296
[INFO] - 03-16 21:15:34 - [main.summary_metrics:168]: Epoch 180/300 - Test Results:
{'auc': 0.8409773322851153,
 'f1': 0.40563134978229315,
 'loss': 0.45976554201234066,
 'ndcg': 0.7157147753636708,
 'precision': 0.6037735849056604,
 'recall': 0.30573899371069185}
[INFO] - 03-16 21:15:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[180] Complete. Time taken: 00:01:03.918
[INFO] - 03-16 21:15:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:15:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:15:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:15:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:15:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:15:34 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7220, 5001, 5146]
[INFO] - 03-16 21:15:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:15:44 - [main.backward:225]: Epoch 181/300 - Iteration 30/199 - Time 0.333 batch, 0.090 data, 0.297 forward
[INFO] - 03-16 21:15:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:15:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0066)
[INFO] - 03-16 21:15:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6142 (0.5912)
[INFO] - 03-16 21:15:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3552 (-140.3641)
[INFO] - 03-16 21:15:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5214 (20.5570)
[INFO] - 03-16 21:15:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 205.1956 (204.0512)
[INFO] - 03-16 21:15:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:15:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9204)
[INFO] - 03-16 21:15:58 - [main.backward:225]: Epoch 181/300 - Iteration 80/199 - Time 0.298 batch, 0.056 data, 0.263 forward
[INFO] - 03-16 21:15:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0061)
[INFO] - 03-16 21:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6155 (0.5770)
[INFO] - 03-16 21:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3022 (-140.4049)
[INFO] - 03-16 21:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7119 (20.6316)
[INFO] - 03-16 21:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.6790 (204.5705)
[INFO] - 03-16 21:15:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9264)
[INFO] - 03-16 21:16:13 - [main.backward:225]: Epoch 181/300 - Iteration 130/199 - Time 0.295 batch, 0.048 data, 0.259 forward
[INFO] - 03-16 21:16:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0068 (0.0067)
[INFO] - 03-16 21:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6219 (0.5832)
[INFO] - 03-16 21:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4213 (-140.4031)
[INFO] - 03-16 21:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7542 (20.7089)
[INFO] - 03-16 21:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.4640 (203.6937)
[INFO] - 03-16 21:16:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9113)
[INFO] - 03-16 21:16:27 - [main.backward:225]: Epoch 181/300 - Iteration 180/199 - Time 0.294 batch, 0.044 data, 0.259 forward
[INFO] - 03-16 21:16:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0064 (0.0068)
[INFO] - 03-16 21:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6063 (0.5848)
[INFO] - 03-16 21:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3207 (-140.4031)
[INFO] - 03-16 21:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5167 (20.6089)
[INFO] - 03-16 21:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.1000 (202.9777)
[INFO] - 03-16 21:16:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:16:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9172)
[INFO] - 03-16 21:16:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:16:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:16:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:16:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:16:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:16:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:16:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:16:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.459
[INFO] - 03-16 21:16:38 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.460
[INFO] - 03-16 21:16:38 - [main.summary_metrics:168]: Epoch 181/300 - Test Results:
{'auc': 0.8444111307651992,
 'f1': 0.40518626028059984,
 'loss': 0.45537466041197067,
 'ndcg': 0.7191741440105538,
 'precision': 0.6037735849056604,
 'recall': 0.30518867924528303}
[INFO] - 03-16 21:16:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[181] Complete. Time taken: 00:01:03.816
[INFO] - 03-16 21:16:38 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:16:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:16:38 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:16:38 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:16:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:16:38 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7227, 5034, 5151]
[INFO] - 03-16 21:16:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:16:49 - [main.backward:225]: Epoch 182/300 - Iteration 31/199 - Time 0.340 batch, 0.082 data, 0.304 forward
[INFO] - 03-16 21:16:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:16:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0061)
[INFO] - 03-16 21:16:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5704 (0.5907)
[INFO] - 03-16 21:16:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3962 (-140.3628)
[INFO] - 03-16 21:16:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5508 (20.6298)
[INFO] - 03-16 21:16:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.7062 (204.0708)
[INFO] - 03-16 21:16:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:16:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9246)
[INFO] - 03-16 21:17:03 - [main.backward:225]: Epoch 182/300 - Iteration 81/199 - Time 0.308 batch, 0.053 data, 0.273 forward
[INFO] - 03-16 21:17:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:17:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0057)
[INFO] - 03-16 21:17:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6118 (0.5765)
[INFO] - 03-16 21:17:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3135 (-140.4034)
[INFO] - 03-16 21:17:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.6177 (20.6104)
[INFO] - 03-16 21:17:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 206.0080 (204.6929)
[INFO] - 03-16 21:17:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:17:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9266)
[INFO] - 03-16 21:17:17 - [main.backward:225]: Epoch 182/300 - Iteration 131/199 - Time 0.298 batch, 0.046 data, 0.263 forward
[INFO] - 03-16 21:17:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:17:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0063)
[INFO] - 03-16 21:17:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6032 (0.5840)
[INFO] - 03-16 21:17:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4150 (-140.4020)
[INFO] - 03-16 21:17:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.7365 (20.5993)
[INFO] - 03-16 21:17:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 203.0964 (203.9346)
[INFO] - 03-16 21:17:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:17:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9206)
[INFO] - 03-16 21:17:32 - [main.backward:225]: Epoch 182/300 - Iteration 181/199 - Time 0.297 batch, 0.043 data, 0.262 forward
[INFO] - 03-16 21:17:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:17:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0066)
[INFO] - 03-16 21:17:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6051 (0.5864)
[INFO] - 03-16 21:17:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3318 (-140.3990)
[INFO] - 03-16 21:17:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.4369 (20.6374)
[INFO] - 03-16 21:17:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.6234 (203.0833)
[INFO] - 03-16 21:17:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:17:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9173)
[INFO] - 03-16 21:17:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:17:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:17:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:17:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:17:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:17:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:17:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:17:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.856
[INFO] - 03-16 21:17:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.857
[INFO] - 03-16 21:17:42 - [main.summary_metrics:168]: Epoch 182/300 - Test Results:
{'auc': 0.831429409067086,
 'f1': 0.38922109337203664,
 'loss': 0.4647278822453017,
 'ndcg': 0.7082692943807951,
 'precision': 0.579245283018868,
 'recall': 0.29339622641509433}
[INFO] - 03-16 21:17:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[182] Complete. Time taken: 00:01:03.665
[INFO] - 03-16 21:17:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:17:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:17:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:17:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:17:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:17:42 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7226, 4988, 5135]
[INFO] - 03-16 21:17:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:17:52 - [main.backward:225]: Epoch 183/300 - Iteration 32/199 - Time 0.330 batch, 0.075 data, 0.297 forward
[INFO] - 03-16 21:17:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:17:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0065)
[INFO] - 03-16 21:17:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5670 (0.5897)
[INFO] - 03-16 21:17:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3980 (-140.3665)
[INFO] - 03-16 21:17:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5248 (20.5958)
[INFO] - 03-16 21:17:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.4009 (203.9360)
[INFO] - 03-16 21:17:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:17:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9173)
[INFO] - 03-16 21:18:07 - [main.backward:225]: Epoch 183/300 - Iteration 82/199 - Time 0.305 batch, 0.050 data, 0.271 forward
[INFO] - 03-16 21:18:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0059)
[INFO] - 03-16 21:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6178 (0.5771)
[INFO] - 03-16 21:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3353 (-140.4003)
[INFO] - 03-16 21:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5453 (20.6234)
[INFO] - 03-16 21:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.1195 (204.2276)
[INFO] - 03-16 21:18:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:18:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9295)
[INFO] - 03-16 21:18:21 - [main.backward:225]: Epoch 183/300 - Iteration 132/199 - Time 0.298 batch, 0.044 data, 0.265 forward
[INFO] - 03-16 21:18:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:18:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0087 (0.0066)
[INFO] - 03-16 21:18:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5839 (0.5827)
[INFO] - 03-16 21:18:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4305 (-140.4042)
[INFO] - 03-16 21:18:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5849 (20.5895)
[INFO] - 03-16 21:18:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.5762 (203.0851)
[INFO] - 03-16 21:18:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:18:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9161)
[INFO] - 03-16 21:18:35 - [main.backward:225]: Epoch 183/300 - Iteration 182/199 - Time 0.295 batch, 0.042 data, 0.261 forward
[INFO] - 03-16 21:18:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:18:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0062)
[INFO] - 03-16 21:18:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5930 (0.5847)
[INFO] - 03-16 21:18:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3329 (-140.3967)
[INFO] - 03-16 21:18:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5349 (20.5876)
[INFO] - 03-16 21:18:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 203.4623 (203.0910)
[INFO] - 03-16 21:18:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:18:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9236)
[INFO] - 03-16 21:18:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:18:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:18:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:18:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:18:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:18:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:18:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:18:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.107
[INFO] - 03-16 21:18:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.108
[INFO] - 03-16 21:18:46 - [main.summary_metrics:168]: Epoch 183/300 - Test Results:
{'auc': 0.8353201323375262,
 'f1': 0.4041799709724238,
 'loss': 0.4633237899764279,
 'ndcg': 0.7212665937070988,
 'precision': 0.6018867924528303,
 'recall': 0.304559748427673}
[INFO] - 03-16 21:18:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[183] Complete. Time taken: 00:01:03.821
[INFO] - 03-16 21:18:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:18:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:18:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:18:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:18:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:18:46 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7220, 5001, 5188]
[INFO] - 03-16 21:18:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:18:57 - [main.backward:225]: Epoch 184/300 - Iteration 33/199 - Time 0.345 batch, 0.085 data, 0.309 forward
[INFO] - 03-16 21:18:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0059)
[INFO] - 03-16 21:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5710 (0.5894)
[INFO] - 03-16 21:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3956 (-140.3647)
[INFO] - 03-16 21:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.4727 (20.5400)
[INFO] - 03-16 21:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 203.7884 (203.8483)
[INFO] - 03-16 21:18:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:18:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9244)
[INFO] - 03-16 21:19:11 - [main.backward:225]: Epoch 184/300 - Iteration 83/199 - Time 0.311 batch, 0.054 data, 0.277 forward
[INFO] - 03-16 21:19:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:19:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0058)
[INFO] - 03-16 21:19:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6015 (0.5789)
[INFO] - 03-16 21:19:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3215 (-140.3989)
[INFO] - 03-16 21:19:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.6646 (20.5309)
[INFO] - 03-16 21:19:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.1382 (204.1052)
[INFO] - 03-16 21:19:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:19:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9244)
[INFO] - 03-16 21:19:26 - [main.backward:225]: Epoch 184/300 - Iteration 133/199 - Time 0.302 batch, 0.047 data, 0.268 forward
[INFO] - 03-16 21:19:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:19:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0088 (0.0071)
[INFO] - 03-16 21:19:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5987 (0.5851)
[INFO] - 03-16 21:19:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4356 (-140.4079)
[INFO] - 03-16 21:19:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.6437 (20.6572)
[INFO] - 03-16 21:19:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 203.3011 (203.2586)
[INFO] - 03-16 21:19:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:19:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.9058)
[INFO] - 03-16 21:19:40 - [main.backward:225]: Epoch 184/300 - Iteration 183/199 - Time 0.300 batch, 0.044 data, 0.264 forward
[INFO] - 03-16 21:19:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:19:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0065)
[INFO] - 03-16 21:19:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5913 (0.5850)
[INFO] - 03-16 21:19:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3230 (-140.3954)
[INFO] - 03-16 21:19:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5238 (20.6321)
[INFO] - 03-16 21:19:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.7038 (202.6859)
[INFO] - 03-16 21:19:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:19:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9203)
[INFO] - 03-16 21:19:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:19:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:19:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:19:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:19:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:19:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:19:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:19:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.165
[INFO] - 03-16 21:19:50 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.172
[INFO] - 03-16 21:19:50 - [main.summary_metrics:168]: Epoch 184/300 - Test Results:
{'auc': 0.8384904022536687,
 'f1': 0.4080890179003386,
 'loss': 0.461910067264389,
 'ndcg': 0.718391190931029,
 'precision': 0.6075471698113208,
 'recall': 0.30754716981132074}
[INFO] - 03-16 21:19:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[184] Complete. Time taken: 00:01:04.662
[INFO] - 03-16 21:19:50 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:19:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:19:50 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:19:50 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:19:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:19:50 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7247, 5014, 5160]
[INFO] - 03-16 21:19:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:20:01 - [main.backward:225]: Epoch 185/300 - Iteration 34/199 - Time 0.326 batch, 0.082 data, 0.293 forward
[INFO] - 03-16 21:20:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:20:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0059)
[INFO] - 03-16 21:20:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5671 (0.5875)
[INFO] - 03-16 21:20:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3927 (-140.3661)
[INFO] - 03-16 21:20:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5018 (20.4983)
[INFO] - 03-16 21:20:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 204.9987 (203.2898)
[INFO] - 03-16 21:20:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:20:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9241)
[INFO] - 03-16 21:20:16 - [main.backward:225]: Epoch 185/300 - Iteration 84/199 - Time 0.302 batch, 0.054 data, 0.267 forward
[INFO] - 03-16 21:20:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:20:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0105 (0.0064)
[INFO] - 03-16 21:20:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6009 (0.5794)
[INFO] - 03-16 21:20:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2905 (-140.3979)
[INFO] - 03-16 21:20:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.4115 (20.4558)
[INFO] - 03-16 21:20:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 203.0786 (203.8663)
[INFO] - 03-16 21:20:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:20:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.9186)
[INFO] - 03-16 21:20:30 - [main.backward:225]: Epoch 185/300 - Iteration 134/199 - Time 0.299 batch, 0.047 data, 0.264 forward
[INFO] - 03-16 21:20:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0106 (0.0066)
[INFO] - 03-16 21:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5975 (0.5839)
[INFO] - 03-16 21:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4475 (-140.4112)
[INFO] - 03-16 21:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5252 (20.5795)
[INFO] - 03-16 21:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.9566 (203.0536)
[INFO] - 03-16 21:20:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.9109)
[INFO] - 03-16 21:20:45 - [main.backward:225]: Epoch 185/300 - Iteration 184/199 - Time 0.296 batch, 0.043 data, 0.261 forward
[INFO] - 03-16 21:20:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0065)
[INFO] - 03-16 21:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6041 (0.5866)
[INFO] - 03-16 21:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3378 (-140.3923)
[INFO] - 03-16 21:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.4866 (20.5225)
[INFO] - 03-16 21:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.0782 (202.0202)
[INFO] - 03-16 21:20:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9198)
[INFO] - 03-16 21:20:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:20:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:20:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:20:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:20:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:20:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:20:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:20:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.396
[INFO] - 03-16 21:20:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.397
[INFO] - 03-16 21:20:55 - [main.summary_metrics:168]: Epoch 185/300 - Test Results:
{'auc': 0.82974741221174,
 'f1': 0.39148524431543297,
 'loss': 0.468915963710729,
 'ndcg': 0.6965827772954984,
 'precision': 0.5830188679245284,
 'recall': 0.2949685534591195}
[INFO] - 03-16 21:20:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[185] Complete. Time taken: 00:01:04.332
[INFO] - 03-16 21:20:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:20:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:20:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:20:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:20:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:20:55 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7228, 4977, 5127]
[INFO] - 03-16 21:20:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:21:06 - [main.backward:225]: Epoch 186/300 - Iteration 35/199 - Time 0.341 batch, 0.081 data, 0.306 forward
[INFO] - 03-16 21:21:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:21:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0058)
[INFO] - 03-16 21:21:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5785 (0.5891)
[INFO] - 03-16 21:21:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4113 (-140.3646)
[INFO] - 03-16 21:21:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.4214 (20.5196)
[INFO] - 03-16 21:21:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.9424 (202.4669)
[INFO] - 03-16 21:21:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:21:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9303)
[INFO] - 03-16 21:21:21 - [main.backward:225]: Epoch 186/300 - Iteration 85/199 - Time 0.307 batch, 0.055 data, 0.271 forward
[INFO] - 03-16 21:21:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0056)
[INFO] - 03-16 21:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6041 (0.5792)
[INFO] - 03-16 21:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3052 (-140.3905)
[INFO] - 03-16 21:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3785 (20.3228)
[INFO] - 03-16 21:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 203.1434 (202.5021)
[INFO] - 03-16 21:21:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9327)
[INFO] - 03-16 21:21:35 - [main.backward:225]: Epoch 186/300 - Iteration 135/199 - Time 0.301 batch, 0.048 data, 0.265 forward
[INFO] - 03-16 21:21:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0144 (0.0066)
[INFO] - 03-16 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5923 (0.5838)
[INFO] - 03-16 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4388 (-140.4133)
[INFO] - 03-16 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3402 (20.3937)
[INFO] - 03-16 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 201.8651 (202.0554)
[INFO] - 03-16 21:21:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.9180)
[INFO] - 03-16 21:21:49 - [main.backward:225]: Epoch 186/300 - Iteration 185/199 - Time 0.297 batch, 0.044 data, 0.261 forward
[INFO] - 03-16 21:21:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:21:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0059)
[INFO] - 03-16 21:21:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6123 (0.5872)
[INFO] - 03-16 21:21:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3738 (-140.3902)
[INFO] - 03-16 21:21:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.4537 (20.4906)
[INFO] - 03-16 21:21:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 203.1291 (202.0194)
[INFO] - 03-16 21:21:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:21:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9305)
[INFO] - 03-16 21:21:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:21:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:21:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:21:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:21:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:21:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:21:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:21:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.103
[INFO] - 03-16 21:21:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.104
[INFO] - 03-16 21:21:59 - [main.summary_metrics:168]: Epoch 186/300 - Test Results:
{'auc': 0.8292278236373166,
 'f1': 0.3965747460087082,
 'loss': 0.4599669832193627,
 'ndcg': 0.7041875108887872,
 'precision': 0.590566037735849,
 'recall': 0.29882075471698116}
[INFO] - 03-16 21:21:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[186] Complete. Time taken: 00:01:04.174
[INFO] - 03-16 21:21:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:21:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:21:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:21:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:21:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:21:59 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7239, 4979, 5139]
[INFO] - 03-16 21:22:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:22:11 - [main.backward:225]: Epoch 187/300 - Iteration 36/199 - Time 0.338 batch, 0.078 data, 0.303 forward
[INFO] - 03-16 21:22:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0072 (0.0059)
[INFO] - 03-16 21:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5719 (0.5855)
[INFO] - 03-16 21:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4083 (-140.3629)
[INFO] - 03-16 21:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3849 (20.3684)
[INFO] - 03-16 21:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.1541 (202.6155)
[INFO] - 03-16 21:22:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9252)
[INFO] - 03-16 21:22:25 - [main.backward:225]: Epoch 187/300 - Iteration 86/199 - Time 0.309 batch, 0.052 data, 0.275 forward
[INFO] - 03-16 21:22:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:22:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0062)
[INFO] - 03-16 21:22:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6023 (0.5775)
[INFO] - 03-16 21:22:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3187 (-140.3888)
[INFO] - 03-16 21:22:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3370 (20.3955)
[INFO] - 03-16 21:22:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.1125 (202.7535)
[INFO] - 03-16 21:22:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:22:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9164)
[INFO] - 03-16 21:22:39 - [main.backward:225]: Epoch 187/300 - Iteration 136/199 - Time 0.299 batch, 0.045 data, 0.265 forward
[INFO] - 03-16 21:22:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:22:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0063)
[INFO] - 03-16 21:22:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6035 (0.5818)
[INFO] - 03-16 21:22:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3349 (-140.4134)
[INFO] - 03-16 21:22:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.4404 (20.4211)
[INFO] - 03-16 21:22:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.0984 (202.3829)
[INFO] - 03-16 21:22:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:22:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9183)
[INFO] - 03-16 21:22:54 - [main.backward:225]: Epoch 187/300 - Iteration 186/199 - Time 0.296 batch, 0.042 data, 0.262 forward
[INFO] - 03-16 21:22:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0072 (0.0060)
[INFO] - 03-16 21:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6015 (0.5854)
[INFO] - 03-16 21:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3695 (-140.3915)
[INFO] - 03-16 21:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3890 (20.4186)
[INFO] - 03-16 21:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.9153 (201.3860)
[INFO] - 03-16 21:22:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9316)
[INFO] - 03-16 21:22:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:22:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:22:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:22:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:22:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:22:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:22:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:23:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.188
[INFO] - 03-16 21:23:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.188
[INFO] - 03-16 21:23:03 - [main.summary_metrics:168]: Epoch 187/300 - Test Results:
{'auc': 0.8421761661425575,
 'f1': 0.41021770682148034,
 'loss': 0.4583155634418222,
 'ndcg': 0.7240596066814509,
 'precision': 0.6113207547169811,
 'recall': 0.3089622641509434}
[INFO] - 03-16 21:23:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[187] Complete. Time taken: 00:01:04.011
[INFO] - 03-16 21:23:03 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:23:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:23:03 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:23:03 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:23:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:23:03 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7234, 4956, 5097]
[INFO] - 03-16 21:23:04 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:23:15 - [main.backward:225]: Epoch 188/300 - Iteration 37/199 - Time 0.330 batch, 0.074 data, 0.295 forward
[INFO] - 03-16 21:23:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:23:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0061)
[INFO] - 03-16 21:23:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5812 (0.5862)
[INFO] - 03-16 21:23:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4322 (-140.3652)
[INFO] - 03-16 21:23:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3120 (20.3874)
[INFO] - 03-16 21:23:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 201.5087 (201.8058)
[INFO] - 03-16 21:23:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:23:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9227)
[INFO] - 03-16 21:23:29 - [main.backward:225]: Epoch 188/300 - Iteration 87/199 - Time 0.306 batch, 0.052 data, 0.271 forward
[INFO] - 03-16 21:23:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:23:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0081 (0.0061)
[INFO] - 03-16 21:23:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5794 (0.5789)
[INFO] - 03-16 21:23:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4122 (-140.3899)
[INFO] - 03-16 21:23:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.5448 (20.3483)
[INFO] - 03-16 21:23:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.2345 (201.9737)
[INFO] - 03-16 21:23:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:23:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9242)
[INFO] - 03-16 21:23:43 - [main.backward:225]: Epoch 188/300 - Iteration 137/199 - Time 0.297 batch, 0.046 data, 0.262 forward
[INFO] - 03-16 21:23:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0065)
[INFO] - 03-16 21:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5984 (0.5827)
[INFO] - 03-16 21:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3404 (-140.4114)
[INFO] - 03-16 21:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3837 (20.4794)
[INFO] - 03-16 21:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.1750 (200.4153)
[INFO] - 03-16 21:23:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9114)
[INFO] - 03-16 21:23:57 - [main.backward:225]: Epoch 188/300 - Iteration 187/199 - Time 0.293 batch, 0.043 data, 0.258 forward
[INFO] - 03-16 21:23:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:23:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0065)
[INFO] - 03-16 21:23:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6122 (0.5852)
[INFO] - 03-16 21:23:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3752 (-140.3948)
[INFO] - 03-16 21:23:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2688 (20.4428)
[INFO] - 03-16 21:23:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.5692 (200.5234)
[INFO] - 03-16 21:23:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:23:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9216)
[INFO] - 03-16 21:24:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:24:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:24:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:24:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:24:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:24:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:24:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:24:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.137
[INFO] - 03-16 21:24:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.138
[INFO] - 03-16 21:24:06 - [main.summary_metrics:168]: Epoch 188/300 - Test Results:
{'auc': 0.832743252096436,
 'f1': 0.39336236090953064,
 'loss': 0.46401590925492575,
 'ndcg': 0.7095179995718398,
 'precision': 0.5867924528301887,
 'recall': 0.2960691823899371}
[INFO] - 03-16 21:24:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[188] Complete. Time taken: 00:01:03.351
[INFO] - 03-16 21:24:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:24:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:24:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:24:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:24:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:24:06 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7231, 4976, 5138]
[INFO] - 03-16 21:24:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:24:19 - [main.backward:225]: Epoch 189/300 - Iteration 38/199 - Time 0.327 batch, 0.073 data, 0.294 forward
[INFO] - 03-16 21:24:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:24:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0061)
[INFO] - 03-16 21:24:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5850)
[INFO] - 03-16 21:24:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4068 (-140.3671)
[INFO] - 03-16 21:24:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.4035 (20.3367)
[INFO] - 03-16 21:24:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.7585 (201.9067)
[INFO] - 03-16 21:24:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:24:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9209)
[INFO] - 03-16 21:24:33 - [main.backward:225]: Epoch 189/300 - Iteration 88/199 - Time 0.305 batch, 0.051 data, 0.271 forward
[INFO] - 03-16 21:24:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:24:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0076 (0.0059)
[INFO] - 03-16 21:24:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5538 (0.5794)
[INFO] - 03-16 21:24:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4541 (-140.3906)
[INFO] - 03-16 21:24:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3119 (20.3045)
[INFO] - 03-16 21:24:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 202.5382 (202.1059)
[INFO] - 03-16 21:24:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:24:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9256)
[INFO] - 03-16 21:24:47 - [main.backward:225]: Epoch 189/300 - Iteration 138/199 - Time 0.299 batch, 0.044 data, 0.266 forward
[INFO] - 03-16 21:24:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0062)
[INFO] - 03-16 21:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6041 (0.5846)
[INFO] - 03-16 21:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3185 (-140.4057)
[INFO] - 03-16 21:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2953 (20.3103)
[INFO] - 03-16 21:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.6657 (200.9823)
[INFO] - 03-16 21:24:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9233)
[INFO] - 03-16 21:25:02 - [main.backward:225]: Epoch 189/300 - Iteration 188/199 - Time 0.296 batch, 0.041 data, 0.263 forward
[INFO] - 03-16 21:25:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:25:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0068)
[INFO] - 03-16 21:25:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6033 (0.5860)
[INFO] - 03-16 21:25:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3322 (-140.3987)
[INFO] - 03-16 21:25:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2621 (20.4076)
[INFO] - 03-16 21:25:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.2636 (200.5963)
[INFO] - 03-16 21:25:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:25:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9130)
[INFO] - 03-16 21:25:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:25:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:25:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:25:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:25:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:25:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:25:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:25:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.209
[INFO] - 03-16 21:25:10 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.210
[INFO] - 03-16 21:25:10 - [main.summary_metrics:168]: Epoch 189/300 - Test Results:
{'auc': 0.844820427148847,
 'f1': 0.4068892114175132,
 'loss': 0.45874655128974834,
 'ndcg': 0.7270149271918699,
 'precision': 0.6056603773584904,
 'recall': 0.3066823899371069}
[INFO] - 03-16 21:25:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[189] Complete. Time taken: 00:01:04.032
[INFO] - 03-16 21:25:10 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:25:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:25:10 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:25:10 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:25:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:25:10 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7255, 4988, 5144]
[INFO] - 03-16 21:25:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:25:23 - [main.backward:225]: Epoch 190/300 - Iteration 39/199 - Time 0.326 batch, 0.079 data, 0.293 forward
[INFO] - 03-16 21:25:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0061)
[INFO] - 03-16 21:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5824 (0.5844)
[INFO] - 03-16 21:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3643 (-140.3637)
[INFO] - 03-16 21:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3698 (20.3446)
[INFO] - 03-16 21:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 201.7313 (201.2662)
[INFO] - 03-16 21:25:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:25:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9241)
[INFO] - 03-16 21:25:37 - [main.backward:225]: Epoch 190/300 - Iteration 89/199 - Time 0.299 batch, 0.054 data, 0.265 forward
[INFO] - 03-16 21:25:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0058)
[INFO] - 03-16 21:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5586 (0.5786)
[INFO] - 03-16 21:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4497 (-140.3925)
[INFO] - 03-16 21:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3378 (20.3599)
[INFO] - 03-16 21:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 201.2948 (201.9898)
[INFO] - 03-16 21:25:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:25:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9278)
[INFO] - 03-16 21:25:51 - [main.backward:225]: Epoch 190/300 - Iteration 139/199 - Time 0.296 batch, 0.047 data, 0.263 forward
[INFO] - 03-16 21:25:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0060)
[INFO] - 03-16 21:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5837)
[INFO] - 03-16 21:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3753 (-140.4040)
[INFO] - 03-16 21:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2459 (20.3336)
[INFO] - 03-16 21:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 201.4978 (201.0172)
[INFO] - 03-16 21:25:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:25:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9214)
[INFO] - 03-16 21:26:06 - [main.backward:225]: Epoch 190/300 - Iteration 189/199 - Time 0.295 batch, 0.043 data, 0.261 forward
[INFO] - 03-16 21:26:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:26:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0061)
[INFO] - 03-16 21:26:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6118 (0.5867)
[INFO] - 03-16 21:26:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2909 (-140.3961)
[INFO] - 03-16 21:26:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3906 (20.3305)
[INFO] - 03-16 21:26:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.7667 (200.4072)
[INFO] - 03-16 21:26:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:26:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9231)
[INFO] - 03-16 21:26:09 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:26:09 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:26:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:26:09 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:26:09 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:26:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:26:09 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:26:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.357
[INFO] - 03-16 21:26:14 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.358
[INFO] - 03-16 21:26:14 - [main.summary_metrics:168]: Epoch 190/300 - Test Results:
{'auc': 0.8472575668238993,
 'f1': 0.4154426705370101,
 'loss': 0.45894461470629927,
 'ndcg': 0.7209690529039344,
 'precision': 0.6188679245283019,
 'recall': 0.3129716981132075}
[INFO] - 03-16 21:26:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[190] Complete. Time taken: 00:01:04.253
[INFO] - 03-16 21:26:14 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:26:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:26:14 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:26:14 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:26:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:26:14 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7223, 4998, 5133]
[INFO] - 03-16 21:26:16 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:26:27 - [main.backward:225]: Epoch 191/300 - Iteration 40/199 - Time 0.325 batch, 0.072 data, 0.291 forward
[INFO] - 03-16 21:26:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:26:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0081 (0.0057)
[INFO] - 03-16 21:26:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6017 (0.5849)
[INFO] - 03-16 21:26:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3611 (-140.3624)
[INFO] - 03-16 21:26:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3292 (20.2979)
[INFO] - 03-16 21:26:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.9999 (200.7540)
[INFO] - 03-16 21:26:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:26:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9305)
[INFO] - 03-16 21:26:41 - [main.backward:225]: Epoch 191/300 - Iteration 90/199 - Time 0.301 batch, 0.052 data, 0.266 forward
[INFO] - 03-16 21:26:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0072 (0.0053)
[INFO] - 03-16 21:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5641 (0.5785)
[INFO] - 03-16 21:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4463 (-140.3929)
[INFO] - 03-16 21:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3375 (20.3009)
[INFO] - 03-16 21:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 201.2716 (201.3561)
[INFO] - 03-16 21:26:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:26:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9358)
[INFO] - 03-16 21:26:56 - [main.backward:225]: Epoch 191/300 - Iteration 140/199 - Time 0.296 batch, 0.046 data, 0.262 forward
[INFO] - 03-16 21:26:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:26:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0060)
[INFO] - 03-16 21:26:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5582 (0.5846)
[INFO] - 03-16 21:26:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4721 (-140.4013)
[INFO] - 03-16 21:26:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2742 (20.3095)
[INFO] - 03-16 21:26:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 201.1292 (201.0240)
[INFO] - 03-16 21:26:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:26:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.9253)
[INFO] - 03-16 21:27:10 - [main.backward:225]: Epoch 191/300 - Iteration 190/199 - Time 0.295 batch, 0.043 data, 0.260 forward
[INFO] - 03-16 21:27:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0059)
[INFO] - 03-16 21:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6178 (0.5869)
[INFO] - 03-16 21:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2762 (-140.3911)
[INFO] - 03-16 21:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3394 (20.3105)
[INFO] - 03-16 21:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.7830 (200.2529)
[INFO] - 03-16 21:27:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:27:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9292)
[INFO] - 03-16 21:27:13 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:27:13 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:27:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:27:13 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:27:13 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:27:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:27:13 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:27:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.228
[INFO] - 03-16 21:27:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.229
[INFO] - 03-16 21:27:18 - [main.summary_metrics:168]: Epoch 191/300 - Test Results:
{'auc': 0.8431532036163523,
 'f1': 0.41373971940009674,
 'loss': 0.45864415243536666,
 'ndcg': 0.7202117028313472,
 'precision': 0.6169811320754718,
 'recall': 0.3114779874213837}
[INFO] - 03-16 21:27:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[191] Complete. Time taken: 00:01:03.853
[INFO] - 03-16 21:27:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:27:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:27:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:27:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:27:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:27:18 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7218, 5004, 5138]
[INFO] - 03-16 21:27:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:27:31 - [main.backward:225]: Epoch 192/300 - Iteration 41/199 - Time 0.315 batch, 0.071 data, 0.282 forward
[INFO] - 03-16 21:27:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:27:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0056)
[INFO] - 03-16 21:27:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5793 (0.5851)
[INFO] - 03-16 21:27:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3799 (-140.3589)
[INFO] - 03-16 21:27:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2056 (20.2664)
[INFO] - 03-16 21:27:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 201.1629 (200.5420)
[INFO] - 03-16 21:27:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:27:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9289)
[INFO] - 03-16 21:27:46 - [main.backward:225]: Epoch 192/300 - Iteration 91/199 - Time 0.301 batch, 0.051 data, 0.268 forward
[INFO] - 03-16 21:27:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:27:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0054)
[INFO] - 03-16 21:27:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5696 (0.5776)
[INFO] - 03-16 21:27:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4231 (-140.3947)
[INFO] - 03-16 21:27:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1585 (20.2181)
[INFO] - 03-16 21:27:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.9558 (200.6368)
[INFO] - 03-16 21:27:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:27:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9305)
[INFO] - 03-16 21:28:00 - [main.backward:225]: Epoch 192/300 - Iteration 141/199 - Time 0.293 batch, 0.045 data, 0.259 forward
[INFO] - 03-16 21:28:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:28:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0063)
[INFO] - 03-16 21:28:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5707 (0.5839)
[INFO] - 03-16 21:28:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4548 (-140.4019)
[INFO] - 03-16 21:28:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3099 (20.2091)
[INFO] - 03-16 21:28:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.8419 (200.1076)
[INFO] - 03-16 21:28:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:28:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9172)
[INFO] - 03-16 21:28:14 - [main.backward:225]: Epoch 192/300 - Iteration 191/199 - Time 0.292 batch, 0.042 data, 0.258 forward
[INFO] - 03-16 21:28:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:28:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0056)
[INFO] - 03-16 21:28:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6183 (0.5892)
[INFO] - 03-16 21:28:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2766 (-140.3849)
[INFO] - 03-16 21:28:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2427 (20.2595)
[INFO] - 03-16 21:28:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.3575 (200.3031)
[INFO] - 03-16 21:28:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:28:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9353)
[INFO] - 03-16 21:28:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:28:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:28:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:28:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:28:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:28:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:28:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:28:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.257
[INFO] - 03-16 21:28:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.257
[INFO] - 03-16 21:28:22 - [main.summary_metrics:168]: Epoch 192/300 - Test Results:
{'auc': 0.848674855870021,
 'f1': 0.41695210449927433,
 'loss': 0.4526796637361154,
 'ndcg': 0.729348996028615,
 'precision': 0.620754716981132,
 'recall': 0.31422955974842764}
[INFO] - 03-16 21:28:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[192] Complete. Time taken: 00:01:03.606
[INFO] - 03-16 21:28:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:28:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:28:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:28:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:28:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:28:22 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7207, 4999, 5119]
[INFO] - 03-16 21:28:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:28:36 - [main.backward:225]: Epoch 193/300 - Iteration 42/199 - Time 0.327 batch, 0.073 data, 0.293 forward
[INFO] - 03-16 21:28:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:28:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0084 (0.0051)
[INFO] - 03-16 21:28:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5915 (0.5839)
[INFO] - 03-16 21:28:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3671 (-140.3588)
[INFO] - 03-16 21:28:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2354 (20.1998)
[INFO] - 03-16 21:28:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.5101 (200.0010)
[INFO] - 03-16 21:28:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:28:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9392)
[INFO] - 03-16 21:28:50 - [main.backward:225]: Epoch 193/300 - Iteration 92/199 - Time 0.306 batch, 0.052 data, 0.272 forward
[INFO] - 03-16 21:28:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:28:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0054)
[INFO] - 03-16 21:28:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5772 (0.5763)
[INFO] - 03-16 21:28:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4240 (-140.3950)
[INFO] - 03-16 21:28:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1486 (20.2518)
[INFO] - 03-16 21:28:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.9935 (200.6475)
[INFO] - 03-16 21:28:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:28:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9327)
[INFO] - 03-16 21:29:04 - [main.backward:225]: Epoch 193/300 - Iteration 142/199 - Time 0.300 batch, 0.045 data, 0.266 forward
[INFO] - 03-16 21:29:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0064)
[INFO] - 03-16 21:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5831 (0.5840)
[INFO] - 03-16 21:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4698 (-140.4038)
[INFO] - 03-16 21:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2833 (20.2738)
[INFO] - 03-16 21:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.7006 (199.8893)
[INFO] - 03-16 21:29:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9147)
[INFO] - 03-16 21:29:18 - [main.backward:225]: Epoch 193/300 - Iteration 192/199 - Time 0.294 batch, 0.042 data, 0.260 forward
[INFO] - 03-16 21:29:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:29:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0059)
[INFO] - 03-16 21:29:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5993 (0.5877)
[INFO] - 03-16 21:29:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3468 (-140.3815)
[INFO] - 03-16 21:29:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2396 (20.2728)
[INFO] - 03-16 21:29:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.4021 (199.2848)
[INFO] - 03-16 21:29:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:29:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9309)
[INFO] - 03-16 21:29:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:29:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:29:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:29:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:29:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:29:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:29:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:29:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.860
[INFO] - 03-16 21:29:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.862
[INFO] - 03-16 21:29:25 - [main.summary_metrics:168]: Epoch 193/300 - Test Results:
{'auc': 0.8484450013102726,
 'f1': 0.4157522980164489,
 'loss': 0.45355657137264993,
 'ndcg': 0.7283629717039936,
 'precision': 0.6188679245283019,
 'recall': 0.3133647798742138}
[INFO] - 03-16 21:29:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[193] Complete. Time taken: 00:01:03.263
[INFO] - 03-16 21:29:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:29:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:29:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:29:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:29:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:29:25 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 4987, 5127]
[INFO] - 03-16 21:29:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:29:39 - [main.backward:225]: Epoch 194/300 - Iteration 43/199 - Time 0.326 batch, 0.069 data, 0.291 forward
[INFO] - 03-16 21:29:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:29:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0076 (0.0054)
[INFO] - 03-16 21:29:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5929 (0.5836)
[INFO] - 03-16 21:29:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3677 (-140.3532)
[INFO] - 03-16 21:29:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2311 (20.2354)
[INFO] - 03-16 21:29:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.7072 (200.1622)
[INFO] - 03-16 21:29:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:29:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9315)
[INFO] - 03-16 21:29:54 - [main.backward:225]: Epoch 194/300 - Iteration 93/199 - Time 0.306 batch, 0.050 data, 0.272 forward
[INFO] - 03-16 21:29:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:29:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0088 (0.0054)
[INFO] - 03-16 21:29:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5734 (0.5759)
[INFO] - 03-16 21:29:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4126 (-140.3934)
[INFO] - 03-16 21:29:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1060 (20.1761)
[INFO] - 03-16 21:29:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.9483 (200.0416)
[INFO] - 03-16 21:29:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:29:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9325)
[INFO] - 03-16 21:30:08 - [main.backward:225]: Epoch 194/300 - Iteration 143/199 - Time 0.300 batch, 0.045 data, 0.266 forward
[INFO] - 03-16 21:30:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0061)
[INFO] - 03-16 21:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5973 (0.5839)
[INFO] - 03-16 21:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3875 (-140.3983)
[INFO] - 03-16 21:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.4028 (20.1961)
[INFO] - 03-16 21:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.2458 (199.1763)
[INFO] - 03-16 21:30:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9220)
[INFO] - 03-16 21:30:23 - [main.backward:225]: Epoch 194/300 - Iteration 193/199 - Time 0.298 batch, 0.042 data, 0.263 forward
[INFO] - 03-16 21:30:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:30:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0058)
[INFO] - 03-16 21:30:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5943 (0.5884)
[INFO] - 03-16 21:30:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3667 (-140.3841)
[INFO] - 03-16 21:30:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0373 (20.2439)
[INFO] - 03-16 21:30:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.2403 (199.1854)
[INFO] - 03-16 21:30:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:30:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9342)
[INFO] - 03-16 21:30:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:30:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:30:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:30:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:30:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:30:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:30:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:30:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.128
[INFO] - 03-16 21:30:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.129
[INFO] - 03-16 21:30:29 - [main.summary_metrics:168]: Epoch 194/300 - Test Results:
{'auc': 0.8483618645178197,
 'f1': 0.41563618771165944,
 'loss': 0.45352228712485765,
 'ndcg': 0.7286463116306684,
 'precision': 0.618867924528302,
 'recall': 0.31320754716981136}
[INFO] - 03-16 21:30:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[194] Complete. Time taken: 00:01:04.346
[INFO] - 03-16 21:30:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:30:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:30:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:30:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:30:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:30:29 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7235, 4979, 5111]
[INFO] - 03-16 21:30:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:30:44 - [main.backward:225]: Epoch 195/300 - Iteration 44/199 - Time 0.323 batch, 0.074 data, 0.288 forward
[INFO] - 03-16 21:30:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0054)
[INFO] - 03-16 21:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5963 (0.5860)
[INFO] - 03-16 21:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3565 (-140.3451)
[INFO] - 03-16 21:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2013 (20.2038)
[INFO] - 03-16 21:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.9468 (200.2193)
[INFO] - 03-16 21:30:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9335)
[INFO] - 03-16 21:30:58 - [main.backward:225]: Epoch 195/300 - Iteration 94/199 - Time 0.306 batch, 0.051 data, 0.272 forward
[INFO] - 03-16 21:30:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0052)
[INFO] - 03-16 21:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5913 (0.5749)
[INFO] - 03-16 21:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4016 (-140.3942)
[INFO] - 03-16 21:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2190 (20.2388)
[INFO] - 03-16 21:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 201.0051 (200.7522)
[INFO] - 03-16 21:30:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:30:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9322)
[INFO] - 03-16 21:31:13 - [main.backward:225]: Epoch 195/300 - Iteration 144/199 - Time 0.301 batch, 0.045 data, 0.268 forward
[INFO] - 03-16 21:31:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0084 (0.0061)
[INFO] - 03-16 21:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6129 (0.5840)
[INFO] - 03-16 21:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2667 (-140.3929)
[INFO] - 03-16 21:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2794 (20.2480)
[INFO] - 03-16 21:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.2404 (200.2454)
[INFO] - 03-16 21:31:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:31:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9209)
[INFO] - 03-16 21:31:27 - [main.backward:225]: Epoch 195/300 - Iteration 194/199 - Time 0.295 batch, 0.042 data, 0.262 forward
[INFO] - 03-16 21:31:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:31:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0058)
[INFO] - 03-16 21:31:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6034 (0.5871)
[INFO] - 03-16 21:31:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3674 (-140.3828)
[INFO] - 03-16 21:31:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0611 (20.2344)
[INFO] - 03-16 21:31:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.7026 (199.8351)
[INFO] - 03-16 21:31:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:31:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9314)
[INFO] - 03-16 21:31:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:31:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:31:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:31:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:31:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:31:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:31:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:31:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.249
[INFO] - 03-16 21:31:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.250
[INFO] - 03-16 21:31:33 - [main.summary_metrics:168]: Epoch 195/300 - Test Results:
{'auc': 0.8581599842767295,
 'f1': 0.4217319787131107,
 'loss': 0.451253969136524,
 'ndcg': 0.7430197276254084,
 'precision': 0.6283018867924528,
 'recall': 0.317688679245283}
[INFO] - 03-16 21:31:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[195] Complete. Time taken: 00:01:04.113
[INFO] - 03-16 21:31:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:31:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:31:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:31:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:31:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:31:34 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7222, 4957, 5128]
[INFO] - 03-16 21:31:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:31:48 - [main.backward:225]: Epoch 196/300 - Iteration 45/199 - Time 0.328 batch, 0.070 data, 0.292 forward
[INFO] - 03-16 21:31:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:31:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0052)
[INFO] - 03-16 21:31:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6003 (0.5832)
[INFO] - 03-16 21:31:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3537 (-140.3455)
[INFO] - 03-16 21:31:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1563 (20.1633)
[INFO] - 03-16 21:31:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.7667 (200.0858)
[INFO] - 03-16 21:31:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:31:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9348)
[INFO] - 03-16 21:32:02 - [main.backward:225]: Epoch 196/300 - Iteration 95/199 - Time 0.304 batch, 0.051 data, 0.270 forward
[INFO] - 03-16 21:32:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:32:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0049)
[INFO] - 03-16 21:32:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5813 (0.5747)
[INFO] - 03-16 21:32:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3617 (-140.3909)
[INFO] - 03-16 21:32:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2234 (20.1363)
[INFO] - 03-16 21:32:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 201.2422 (200.6093)
[INFO] - 03-16 21:32:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:32:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9450)
[INFO] - 03-16 21:32:17 - [main.backward:225]: Epoch 196/300 - Iteration 145/199 - Time 0.299 batch, 0.045 data, 0.265 forward
[INFO] - 03-16 21:32:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:32:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0081 (0.0060)
[INFO] - 03-16 21:32:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6219 (0.5855)
[INFO] - 03-16 21:32:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2917 (-140.3855)
[INFO] - 03-16 21:32:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2662 (20.1353)
[INFO] - 03-16 21:32:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.1214 (199.7516)
[INFO] - 03-16 21:32:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:32:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9234)
[INFO] - 03-16 21:32:32 - [main.backward:225]: Epoch 196/300 - Iteration 195/199 - Time 0.297 batch, 0.042 data, 0.263 forward
[INFO] - 03-16 21:32:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:32:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0053)
[INFO] - 03-16 21:32:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5877 (0.5863)
[INFO] - 03-16 21:32:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3591 (-140.3820)
[INFO] - 03-16 21:32:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1554 (20.1616)
[INFO] - 03-16 21:32:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.6955 (199.5378)
[INFO] - 03-16 21:32:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:32:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9402)
[INFO] - 03-16 21:32:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:32:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:32:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:32:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:32:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:32:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:32:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:32:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.181
[INFO] - 03-16 21:32:38 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.181
[INFO] - 03-16 21:32:38 - [main.summary_metrics:168]: Epoch 196/300 - Test Results:
{'auc': 0.860494267557652,
 'f1': 0.4267634252539913,
 'loss': 0.4485754572070619,
 'ndcg': 0.7480192247141019,
 'precision': 0.6358490566037737,
 'recall': 0.3214622641509434}
[INFO] - 03-16 21:32:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[196] Complete. Time taken: 00:01:04.372
[INFO] - 03-16 21:32:38 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:32:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:32:38 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:32:38 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:32:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:32:38 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7231, 4989, 5142]
[INFO] - 03-16 21:32:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:32:53 - [main.backward:225]: Epoch 197/300 - Iteration 46/199 - Time 0.327 batch, 0.065 data, 0.294 forward
[INFO] - 03-16 21:32:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:32:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0053)
[INFO] - 03-16 21:32:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5200 (0.5828)
[INFO] - 03-16 21:32:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4951 (-140.3473)
[INFO] - 03-16 21:32:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1957 (20.1917)
[INFO] - 03-16 21:32:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.1592 (199.8437)
[INFO] - 03-16 21:32:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:32:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9321)
[INFO] - 03-16 21:33:07 - [main.backward:225]: Epoch 197/300 - Iteration 96/199 - Time 0.308 batch, 0.049 data, 0.274 forward
[INFO] - 03-16 21:33:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:33:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0055)
[INFO] - 03-16 21:33:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5778)
[INFO] - 03-16 21:33:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3721 (-140.3858)
[INFO] - 03-16 21:33:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1725 (20.1907)
[INFO] - 03-16 21:33:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.9413 (200.2935)
[INFO] - 03-16 21:33:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:33:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9313)
[INFO] - 03-16 21:33:21 - [main.backward:225]: Epoch 197/300 - Iteration 146/199 - Time 0.296 batch, 0.044 data, 0.262 forward
[INFO] - 03-16 21:33:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0062)
[INFO] - 03-16 21:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6112 (0.5850)
[INFO] - 03-16 21:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2964 (-140.3839)
[INFO] - 03-16 21:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1723 (20.1738)
[INFO] - 03-16 21:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.7356 (199.4085)
[INFO] - 03-16 21:33:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9192)
[INFO] - 03-16 21:33:36 - [main.backward:225]: Epoch 197/300 - Iteration 196/199 - Time 0.295 batch, 0.042 data, 0.261 forward
[INFO] - 03-16 21:33:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:33:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0087 (0.0055)
[INFO] - 03-16 21:33:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5977 (0.5867)
[INFO] - 03-16 21:33:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3148 (-140.3789)
[INFO] - 03-16 21:33:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0890 (20.1171)
[INFO] - 03-16 21:33:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.9196 (198.5997)
[INFO] - 03-16 21:33:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:33:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.9364)
[INFO] - 03-16 21:33:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:33:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:33:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:33:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:33:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:33:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:33:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:33:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.251
[INFO] - 03-16 21:33:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.252
[INFO] - 03-16 21:33:42 - [main.summary_metrics:168]: Epoch 197/300 - Test Results:
{'auc': 0.8495930621069183,
 'f1': 0.41292694726656987,
 'loss': 0.45475005082664266,
 'ndcg': 0.724380753550678,
 'precision': 0.6150943396226415,
 'recall': 0.3110849056603774}
[INFO] - 03-16 21:33:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[197] Complete. Time taken: 00:01:03.980
[INFO] - 03-16 21:33:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:33:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:33:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:33:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:33:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:33:42 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7259, 4979, 5135]
[INFO] - 03-16 21:33:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:33:57 - [main.backward:225]: Epoch 198/300 - Iteration 47/199 - Time 0.319 batch, 0.065 data, 0.287 forward
[INFO] - 03-16 21:33:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:33:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0017 (0.0052)
[INFO] - 03-16 21:33:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5123 (0.5806)
[INFO] - 03-16 21:33:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4887 (-140.3539)
[INFO] - 03-16 21:33:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1981 (20.1258)
[INFO] - 03-16 21:33:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.3887 (199.2463)
[INFO] - 03-16 21:33:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:33:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9364)
[INFO] - 03-16 21:34:11 - [main.backward:225]: Epoch 198/300 - Iteration 97/199 - Time 0.303 batch, 0.049 data, 0.270 forward
[INFO] - 03-16 21:34:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0057 (0.0055)
[INFO] - 03-16 21:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6029 (0.5796)
[INFO] - 03-16 21:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3667 (-140.3821)
[INFO] - 03-16 21:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.3073 (20.1729)
[INFO] - 03-16 21:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.3282 (199.3514)
[INFO] - 03-16 21:34:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9317)
[INFO] - 03-16 21:34:26 - [main.backward:225]: Epoch 198/300 - Iteration 147/199 - Time 0.299 batch, 0.044 data, 0.265 forward
[INFO] - 03-16 21:34:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0095 (0.0060)
[INFO] - 03-16 21:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5853)
[INFO] - 03-16 21:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3997 (-140.3798)
[INFO] - 03-16 21:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2387 (20.2070)
[INFO] - 03-16 21:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.8464 (199.2209)
[INFO] - 03-16 21:34:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.9216)
[INFO] - 03-16 21:34:40 - [main.backward:225]: Epoch 198/300 - Iteration 197/199 - Time 0.294 batch, 0.041 data, 0.261 forward
[INFO] - 03-16 21:34:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0055)
[INFO] - 03-16 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6020 (0.5876)
[INFO] - 03-16 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3161 (-140.3733)
[INFO] - 03-16 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0070 (20.1073)
[INFO] - 03-16 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.0853 (198.3906)
[INFO] - 03-16 21:34:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9342)
[INFO] - 03-16 21:34:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:34:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:34:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:34:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:34:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:34:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:34:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:34:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.255
[INFO] - 03-16 21:34:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.255
[INFO] - 03-16 21:34:46 - [main.summary_metrics:168]: Epoch 198/300 - Test Results:
{'auc': 0.8460923742138365,
 'f1': 0.4089017900338655,
 'loss': 0.4547976120003115,
 'ndcg': 0.718689152982806,
 'precision': 0.609433962264151,
 'recall': 0.30794025157232713}
[INFO] - 03-16 21:34:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[198] Complete. Time taken: 00:01:03.781
[INFO] - 03-16 21:34:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:34:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:34:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:34:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:34:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:34:46 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7222, 5019, 5178]
[INFO] - 03-16 21:34:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:35:01 - [main.backward:225]: Epoch 199/300 - Iteration 48/199 - Time 0.321 batch, 0.067 data, 0.287 forward
[INFO] - 03-16 21:35:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0051)
[INFO] - 03-16 21:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5190 (0.5797)
[INFO] - 03-16 21:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4797 (-140.3610)
[INFO] - 03-16 21:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0914 (20.0776)
[INFO] - 03-16 21:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.9380 (198.8907)
[INFO] - 03-16 21:35:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9344)
[INFO] - 03-16 21:35:15 - [main.backward:225]: Epoch 199/300 - Iteration 98/199 - Time 0.296 batch, 0.050 data, 0.263 forward
[INFO] - 03-16 21:35:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:35:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0088 (0.0055)
[INFO] - 03-16 21:35:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6027 (0.5793)
[INFO] - 03-16 21:35:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3553 (-140.3763)
[INFO] - 03-16 21:35:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1354 (20.0739)
[INFO] - 03-16 21:35:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.3165 (199.6080)
[INFO] - 03-16 21:35:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:35:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9278)
[INFO] - 03-16 21:35:28 - [main.backward:225]: Epoch 199/300 - Iteration 148/199 - Time 0.287 batch, 0.044 data, 0.254 forward
[INFO] - 03-16 21:35:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0061)
[INFO] - 03-16 21:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5790 (0.5842)
[INFO] - 03-16 21:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4425 (-140.3743)
[INFO] - 03-16 21:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.2337 (20.1058)
[INFO] - 03-16 21:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.5077 (199.0310)
[INFO] - 03-16 21:35:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:35:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9187)
[INFO] - 03-16 21:35:42 - [main.backward:225]: Epoch 199/300 - Iteration 198/199 - Time 0.284 batch, 0.041 data, 0.251 forward
[INFO] - 03-16 21:35:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:35:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0083 (0.0058)
[INFO] - 03-16 21:35:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6088 (0.5892)
[INFO] - 03-16 21:35:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3368 (-140.3723)
[INFO] - 03-16 21:35:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1948 (20.1502)
[INFO] - 03-16 21:35:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.9195 (198.7690)
[INFO] - 03-16 21:35:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:35:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9278)
[INFO] - 03-16 21:35:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:35:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:35:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:35:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:35:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:35:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:35:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:35:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.362
[INFO] - 03-16 21:35:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.362
[INFO] - 03-16 21:35:48 - [main.summary_metrics:168]: Epoch 199/300 - Test Results:
{'auc': 0.836649665880503,
 'f1': 0.40412191582002904,
 'loss': 0.4595758665792597,
 'ndcg': 0.7133049866421632,
 'precision': 0.6018867924528302,
 'recall': 0.30448113207547167}
[INFO] - 03-16 21:35:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[199] Complete. Time taken: 00:01:01.923
[INFO] - 03-16 21:35:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:35:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:35:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:35:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:35:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:35:48 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7227, 5005, 5156]
[INFO] - 03-16 21:35:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:36:03 - [main.backward:225]: Epoch 200/300 - Iteration 49/199 - Time 0.318 batch, 0.071 data, 0.283 forward
[INFO] - 03-16 21:36:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0050)
[INFO] - 03-16 21:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5291 (0.5770)
[INFO] - 03-16 21:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4483 (-140.3634)
[INFO] - 03-16 21:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1462 (20.1810)
[INFO] - 03-16 21:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.1103 (199.0016)
[INFO] - 03-16 21:36:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:36:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9373)
[INFO] - 03-16 21:36:18 - [main.backward:225]: Epoch 200/300 - Iteration 99/199 - Time 0.306 batch, 0.052 data, 0.272 forward
[INFO] - 03-16 21:36:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:36:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0107 (0.0057)
[INFO] - 03-16 21:36:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5827)
[INFO] - 03-16 21:36:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3587 (-140.3695)
[INFO] - 03-16 21:36:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0783 (20.0964)
[INFO] - 03-16 21:36:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.4255 (199.2720)
[INFO] - 03-16 21:36:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:36:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.9306)
[INFO] - 03-16 21:36:32 - [main.backward:225]: Epoch 200/300 - Iteration 149/199 - Time 0.301 batch, 0.046 data, 0.267 forward
[INFO] - 03-16 21:36:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0064 (0.0059)
[INFO] - 03-16 21:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5648 (0.5851)
[INFO] - 03-16 21:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4440 (-140.3697)
[INFO] - 03-16 21:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1426 (20.1311)
[INFO] - 03-16 21:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.7356 (199.0264)
[INFO] - 03-16 21:36:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:36:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9248)
[INFO] - 03-16 21:36:47 - [main.backward:225]: Epoch 200/300 - Iteration 0/199 - Time 0.298 batch, 0.043 data, 0.264 forward
[INFO] - 03-16 21:36:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:36:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0096 (0.0055)
[INFO] - 03-16 21:36:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5999 (0.5872)
[INFO] - 03-16 21:36:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3518 (-140.3703)
[INFO] - 03-16 21:36:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9987 (20.0842)
[INFO] - 03-16 21:36:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.8322 (198.5963)
[INFO] - 03-16 21:36:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:36:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8646 (0.9306)
[INFO] - 03-16 21:36:47 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:36:47 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:36:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:36:47 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:36:47 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:36:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:36:47 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:36:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.252
[INFO] - 03-16 21:36:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.253
[INFO] - 03-16 21:36:52 - [main.summary_metrics:168]: Epoch 200/300 - Test Results:
{'auc': 0.850711838312369,
 'f1': 0.42192549588775996,
 'loss': 0.4493666263076495,
 'ndcg': 0.7304967146808441,
 'precision': 0.6283018867924528,
 'recall': 0.3179245283018868}
[INFO] - 03-16 21:36:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[200] Complete. Time taken: 00:01:04.698
[INFO] - 03-16 21:36:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:36:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:36:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:36:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:36:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:36:52 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7218, 4984, 5143]
[INFO] - 03-16 21:36:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:37:08 - [main.backward:225]: Epoch 201/300 - Iteration 50/199 - Time 0.317 batch, 0.067 data, 0.279 forward
[INFO] - 03-16 21:37:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:37:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0085 (0.0047)
[INFO] - 03-16 21:37:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5758)
[INFO] - 03-16 21:37:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3254 (-140.3598)
[INFO] - 03-16 21:37:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9669 (20.0511)
[INFO] - 03-16 21:37:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.8255 (198.9057)
[INFO] - 03-16 21:37:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:37:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9420)
[INFO] - 03-16 21:37:22 - [main.backward:225]: Epoch 201/300 - Iteration 100/199 - Time 0.299 batch, 0.050 data, 0.263 forward
[INFO] - 03-16 21:37:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:37:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0056)
[INFO] - 03-16 21:37:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6120 (0.5813)
[INFO] - 03-16 21:37:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3578 (-140.3683)
[INFO] - 03-16 21:37:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9717 (20.0812)
[INFO] - 03-16 21:37:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.7029 (199.2168)
[INFO] - 03-16 21:37:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:37:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9308)
[INFO] - 03-16 21:37:37 - [main.backward:225]: Epoch 201/300 - Iteration 150/199 - Time 0.296 batch, 0.045 data, 0.261 forward
[INFO] - 03-16 21:37:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:37:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0058)
[INFO] - 03-16 21:37:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5727 (0.5806)
[INFO] - 03-16 21:37:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4357 (-140.3662)
[INFO] - 03-16 21:37:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1267 (20.0410)
[INFO] - 03-16 21:37:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.8708 (198.7997)
[INFO] - 03-16 21:37:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:37:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9236)
[INFO] - 03-16 21:37:51 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:37:51 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:37:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:37:51 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:37:51 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:37:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:37:51 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:37:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.022
[INFO] - 03-16 21:37:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.023
[INFO] - 03-16 21:37:56 - [main.summary_metrics:168]: Epoch 201/300 - Test Results:
{'auc': 0.8438627161949684,
 'f1': 0.41695210449927433,
 'loss': 0.45640046930213146,
 'ndcg': 0.7224658359560954,
 'precision': 0.620754716981132,
 'recall': 0.3142295597484277}
[INFO] - 03-16 21:37:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[201] Complete. Time taken: 00:01:03.880
[INFO] - 03-16 21:37:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:37:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:37:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:37:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:37:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:37:56 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7252, 4994, 5114]
[INFO] - 03-16 21:37:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:37:58 - [main.backward:225]: Epoch 202/300 - Iteration 1/199 - Time 1.745 batch, 1.503 data, 1.700 forward
[INFO] - 03-16 21:37:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:37:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0053)
[INFO] - 03-16 21:37:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5738 (0.5885)
[INFO] - 03-16 21:37:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2925 (-140.3653)
[INFO] - 03-16 21:37:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1325 (20.0732)
[INFO] - 03-16 21:37:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.1057 (198.3117)
[INFO] - 03-16 21:37:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:37:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9405)
[INFO] - 03-16 21:38:12 - [main.backward:225]: Epoch 202/300 - Iteration 51/199 - Time 0.314 batch, 0.062 data, 0.281 forward
[INFO] - 03-16 21:38:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0106 (0.0052)
[INFO] - 03-16 21:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6031 (0.5771)
[INFO] - 03-16 21:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3277 (-140.3570)
[INFO] - 03-16 21:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0891 (20.1174)
[INFO] - 03-16 21:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 200.0258 (198.7484)
[INFO] - 03-16 21:38:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.9352)
[INFO] - 03-16 21:38:27 - [main.backward:225]: Epoch 202/300 - Iteration 101/199 - Time 0.302 batch, 0.049 data, 0.267 forward
[INFO] - 03-16 21:38:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0052)
[INFO] - 03-16 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6117 (0.5826)
[INFO] - 03-16 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3520 (-140.3635)
[INFO] - 03-16 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1839 (20.1471)
[INFO] - 03-16 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.6567 (199.6984)
[INFO] - 03-16 21:38:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9372)
[INFO] - 03-16 21:38:41 - [main.backward:225]: Epoch 202/300 - Iteration 151/199 - Time 0.296 batch, 0.044 data, 0.261 forward
[INFO] - 03-16 21:38:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0057)
[INFO] - 03-16 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6004 (0.5832)
[INFO] - 03-16 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3993 (-140.3621)
[INFO] - 03-16 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0954 (20.0849)
[INFO] - 03-16 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.3926 (198.9247)
[INFO] - 03-16 21:38:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9241)
[INFO] - 03-16 21:38:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:38:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:38:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:38:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:38:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:38:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:38:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:39:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.278
[INFO] - 03-16 21:39:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.279
[INFO] - 03-16 21:39:00 - [main.summary_metrics:168]: Epoch 202/300 - Test Results:
{'auc': 0.840746626048218,
 'f1': 0.4014126753749394,
 'loss': 0.4584899688096916,
 'ndcg': 0.7216054262412992,
 'precision': 0.5981132075471699,
 'recall': 0.30235849056603775}
[INFO] - 03-16 21:39:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[202] Complete. Time taken: 00:01:03.722
[INFO] - 03-16 21:39:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:39:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:39:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:39:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:39:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:39:00 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7253, 4986, 5137]
[INFO] - 03-16 21:39:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:39:02 - [main.backward:225]: Epoch 203/300 - Iteration 2/199 - Time 1.103 batch, 0.875 data, 1.062 forward
[INFO] - 03-16 21:39:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0059)
[INFO] - 03-16 21:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5686 (0.5879)
[INFO] - 03-16 21:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3108 (-140.3645)
[INFO] - 03-16 21:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0416 (20.0497)
[INFO] - 03-16 21:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.6375 (198.1304)
[INFO] - 03-16 21:39:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:39:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9272)
[INFO] - 03-16 21:39:16 - [main.backward:225]: Epoch 203/300 - Iteration 52/199 - Time 0.315 batch, 0.067 data, 0.280 forward
[INFO] - 03-16 21:39:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:39:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0095 (0.0053)
[INFO] - 03-16 21:39:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5783)
[INFO] - 03-16 21:39:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3465 (-140.3566)
[INFO] - 03-16 21:39:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0360 (20.0936)
[INFO] - 03-16 21:39:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.1915 (198.4111)
[INFO] - 03-16 21:39:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:39:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.9291)
[INFO] - 03-16 21:39:31 - [main.backward:225]: Epoch 203/300 - Iteration 102/199 - Time 0.303 batch, 0.050 data, 0.269 forward
[INFO] - 03-16 21:39:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:39:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0053)
[INFO] - 03-16 21:39:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5244 (0.5816)
[INFO] - 03-16 21:39:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4492 (-140.3632)
[INFO] - 03-16 21:39:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0970 (20.0198)
[INFO] - 03-16 21:39:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.3505 (198.6877)
[INFO] - 03-16 21:39:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:39:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9350)
[INFO] - 03-16 21:39:45 - [main.backward:225]: Epoch 203/300 - Iteration 152/199 - Time 0.297 batch, 0.045 data, 0.264 forward
[INFO] - 03-16 21:39:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0083 (0.0062)
[INFO] - 03-16 21:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5918 (0.5842)
[INFO] - 03-16 21:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4157 (-140.3570)
[INFO] - 03-16 21:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1604 (20.0667)
[INFO] - 03-16 21:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.9209 (198.3202)
[INFO] - 03-16 21:39:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:39:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9227)
[INFO] - 03-16 21:39:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:39:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:39:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:39:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:39:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:39:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:39:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:40:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.230
[INFO] - 03-16 21:40:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.231
[INFO] - 03-16 21:40:04 - [main.summary_metrics:168]: Epoch 203/300 - Test Results:
{'auc': 0.8389927607442347,
 'f1': 0.3963231736816641,
 'loss': 0.4555452889496426,
 'ndcg': 0.7120728619464041,
 'precision': 0.590566037735849,
 'recall': 0.29850628930817613}
[INFO] - 03-16 21:40:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[203] Complete. Time taken: 00:01:03.709
[INFO] - 03-16 21:40:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:40:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:40:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:40:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:40:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:40:04 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7247, 4989, 5134]
[INFO] - 03-16 21:40:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:40:06 - [main.backward:225]: Epoch 204/300 - Iteration 3/199 - Time 0.799 batch, 0.536 data, 0.762 forward
[INFO] - 03-16 21:40:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0055)
[INFO] - 03-16 21:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5749 (0.5882)
[INFO] - 03-16 21:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2756 (-140.3608)
[INFO] - 03-16 21:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1163 (20.0766)
[INFO] - 03-16 21:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.1523 (197.9981)
[INFO] - 03-16 21:40:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9342)
[INFO] - 03-16 21:40:21 - [main.backward:225]: Epoch 204/300 - Iteration 53/199 - Time 0.319 batch, 0.061 data, 0.286 forward
[INFO] - 03-16 21:40:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0076 (0.0048)
[INFO] - 03-16 21:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5629 (0.5768)
[INFO] - 03-16 21:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3880 (-140.3580)
[INFO] - 03-16 21:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0808 (20.0414)
[INFO] - 03-16 21:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.3934 (198.6434)
[INFO] - 03-16 21:40:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:40:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9431)
[INFO] - 03-16 21:40:35 - [main.backward:225]: Epoch 204/300 - Iteration 103/199 - Time 0.306 batch, 0.048 data, 0.272 forward
[INFO] - 03-16 21:40:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:40:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0014 (0.0056)
[INFO] - 03-16 21:40:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.4830 (0.5797)
[INFO] - 03-16 21:40:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4839 (-140.3655)
[INFO] - 03-16 21:40:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0531 (20.0726)
[INFO] - 03-16 21:40:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.0569 (199.3417)
[INFO] - 03-16 21:40:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:40:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9294)
[INFO] - 03-16 21:40:50 - [main.backward:225]: Epoch 204/300 - Iteration 153/199 - Time 0.303 batch, 0.044 data, 0.268 forward
[INFO] - 03-16 21:40:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:40:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0059)
[INFO] - 03-16 21:40:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6074 (0.5863)
[INFO] - 03-16 21:40:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4187 (-140.3559)
[INFO] - 03-16 21:40:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1271 (20.0853)
[INFO] - 03-16 21:40:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.7741 (198.3154)
[INFO] - 03-16 21:40:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:40:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9273)
[INFO] - 03-16 21:41:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:41:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:41:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:41:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:41:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:41:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:41:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:41:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.865
[INFO] - 03-16 21:41:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.866
[INFO] - 03-16 21:41:08 - [main.summary_metrics:168]: Epoch 204/300 - Test Results:
{'auc': 0.8471317479035638,
 'f1': 0.416255442670537,
 'loss': 0.4512221744785269,
 'ndcg': 0.7347832512770477,
 'precision': 0.6207547169811322,
 'recall': 0.31336477987421385}
[INFO] - 03-16 21:41:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[204] Complete. Time taken: 00:01:04.575
[INFO] - 03-16 21:41:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:41:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:41:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:41:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:41:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:41:08 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7270, 4971, 5128]
[INFO] - 03-16 21:41:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:41:11 - [main.backward:225]: Epoch 205/300 - Iteration 4/199 - Time 0.655 batch, 0.436 data, 0.625 forward
[INFO] - 03-16 21:41:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:41:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0054)
[INFO] - 03-16 21:41:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5818 (0.5875)
[INFO] - 03-16 21:41:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3279 (-140.3607)
[INFO] - 03-16 21:41:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0283 (20.0733)
[INFO] - 03-16 21:41:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.0783 (197.9214)
[INFO] - 03-16 21:41:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:41:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9364)
[INFO] - 03-16 21:41:25 - [main.backward:225]: Epoch 205/300 - Iteration 54/199 - Time 0.314 batch, 0.065 data, 0.280 forward
[INFO] - 03-16 21:41:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0050)
[INFO] - 03-16 21:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5482 (0.5764)
[INFO] - 03-16 21:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4559 (-140.3588)
[INFO] - 03-16 21:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1165 (20.0344)
[INFO] - 03-16 21:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 199.1131 (198.2604)
[INFO] - 03-16 21:41:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9384)
[INFO] - 03-16 21:41:40 - [main.backward:225]: Epoch 205/300 - Iteration 104/199 - Time 0.302 batch, 0.049 data, 0.268 forward
[INFO] - 03-16 21:41:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:41:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0011 (0.0053)
[INFO] - 03-16 21:41:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.4905 (0.5771)
[INFO] - 03-16 21:41:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4762 (-140.3656)
[INFO] - 03-16 21:41:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0577 (20.0393)
[INFO] - 03-16 21:41:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.9643 (198.6669)
[INFO] - 03-16 21:41:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:41:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9369)
[INFO] - 03-16 21:41:54 - [main.backward:225]: Epoch 205/300 - Iteration 154/199 - Time 0.298 batch, 0.044 data, 0.264 forward
[INFO] - 03-16 21:41:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:41:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0062)
[INFO] - 03-16 21:41:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5868)
[INFO] - 03-16 21:41:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4158 (-140.3589)
[INFO] - 03-16 21:41:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0493 (20.0945)
[INFO] - 03-16 21:41:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.7134 (198.0728)
[INFO] - 03-16 21:41:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:41:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9191)
[INFO] - 03-16 21:42:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:42:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:42:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:42:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:42:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:42:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:42:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:42:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.197
[INFO] - 03-16 21:42:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.198
[INFO] - 03-16 21:42:12 - [main.summary_metrics:168]: Epoch 205/300 - Test Results:
{'auc': 0.8503070623689728,
 'f1': 0.4104112239961295,
 'loss': 0.4533021202087403,
 'ndcg': 0.7283764655302439,
 'precision': 0.6113207547169811,
 'recall': 0.30919811320754714}
[INFO] - 03-16 21:42:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[205] Complete. Time taken: 00:01:04.288
[INFO] - 03-16 21:42:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:42:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:42:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:42:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:42:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:42:13 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7248, 4981, 5152]
[INFO] - 03-16 21:42:14 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:42:16 - [main.backward:225]: Epoch 206/300 - Iteration 5/199 - Time 0.641 batch, 0.384 data, 0.602 forward
[INFO] - 03-16 21:42:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0056)
[INFO] - 03-16 21:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5547 (0.5878)
[INFO] - 03-16 21:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3964 (-140.3574)
[INFO] - 03-16 21:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9012 (20.0266)
[INFO] - 03-16 21:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.8125 (197.7843)
[INFO] - 03-16 21:42:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:42:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9329)
[INFO] - 03-16 21:42:30 - [main.backward:225]: Epoch 206/300 - Iteration 55/199 - Time 0.321 batch, 0.068 data, 0.284 forward
[INFO] - 03-16 21:42:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:42:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0053)
[INFO] - 03-16 21:42:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5368 (0.5757)
[INFO] - 03-16 21:42:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4504 (-140.3625)
[INFO] - 03-16 21:42:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0306 (19.9724)
[INFO] - 03-16 21:42:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.5519 (197.9200)
[INFO] - 03-16 21:42:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:42:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9366)
[INFO] - 03-16 21:42:44 - [main.backward:225]: Epoch 206/300 - Iteration 105/199 - Time 0.304 batch, 0.052 data, 0.269 forward
[INFO] - 03-16 21:42:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0056)
[INFO] - 03-16 21:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.4822 (0.5763)
[INFO] - 03-16 21:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4738 (-140.3655)
[INFO] - 03-16 21:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0504 (19.9762)
[INFO] - 03-16 21:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.4629 (197.9983)
[INFO] - 03-16 21:42:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9325)
[INFO] - 03-16 21:42:59 - [main.backward:225]: Epoch 206/300 - Iteration 155/199 - Time 0.299 batch, 0.046 data, 0.263 forward
[INFO] - 03-16 21:42:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:42:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0063)
[INFO] - 03-16 21:42:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5399 (0.5904)
[INFO] - 03-16 21:42:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4089 (-140.3523)
[INFO] - 03-16 21:42:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.1094 (20.0420)
[INFO] - 03-16 21:42:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.6968 (197.4319)
[INFO] - 03-16 21:42:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:42:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9161)
[INFO] - 03-16 21:43:11 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:43:11 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:43:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:43:11 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:43:11 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:43:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:43:11 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:43:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.251
[INFO] - 03-16 21:43:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.252
[INFO] - 03-16 21:43:16 - [main.summary_metrics:168]: Epoch 206/300 - Test Results:
{'auc': 0.837988469601677,
 'f1': 0.4026124818577649,
 'loss': 0.4548787034952416,
 'ndcg': 0.7112020182873219,
 'precision': 0.6000000000000001,
 'recall': 0.30322327044025155}
[INFO] - 03-16 21:43:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[206] Complete. Time taken: 00:01:03.859
[INFO] - 03-16 21:43:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:43:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:43:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:43:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:43:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:43:16 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7227, 4979, 5120]
[INFO] - 03-16 21:43:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:43:20 - [main.backward:225]: Epoch 207/300 - Iteration 6/199 - Time 0.581 batch, 0.307 data, 0.549 forward
[INFO] - 03-16 21:43:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0055)
[INFO] - 03-16 21:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5608 (0.5867)
[INFO] - 03-16 21:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3826 (-140.3546)
[INFO] - 03-16 21:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9125 (19.9928)
[INFO] - 03-16 21:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.3276 (197.3757)
[INFO] - 03-16 21:43:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9350)
[INFO] - 03-16 21:43:34 - [main.backward:225]: Epoch 207/300 - Iteration 56/199 - Time 0.322 batch, 0.064 data, 0.288 forward
[INFO] - 03-16 21:43:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:43:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0047)
[INFO] - 03-16 21:43:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5259 (0.5757)
[INFO] - 03-16 21:43:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4625 (-140.3673)
[INFO] - 03-16 21:43:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9831 (19.9672)
[INFO] - 03-16 21:43:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.9783 (197.9645)
[INFO] - 03-16 21:43:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:43:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9434)
[INFO] - 03-16 21:43:49 - [main.backward:225]: Epoch 207/300 - Iteration 106/199 - Time 0.306 batch, 0.050 data, 0.271 forward
[INFO] - 03-16 21:43:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:43:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0058)
[INFO] - 03-16 21:43:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5948 (0.5772)
[INFO] - 03-16 21:43:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3942 (-140.3623)
[INFO] - 03-16 21:43:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9591 (19.9733)
[INFO] - 03-16 21:43:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.1332 (197.9210)
[INFO] - 03-16 21:43:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:43:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9309)
[INFO] - 03-16 21:44:03 - [main.backward:225]: Epoch 207/300 - Iteration 156/199 - Time 0.299 batch, 0.045 data, 0.265 forward
[INFO] - 03-16 21:44:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0060)
[INFO] - 03-16 21:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5387 (0.5885)
[INFO] - 03-16 21:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4175 (-140.3527)
[INFO] - 03-16 21:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0175 (19.9941)
[INFO] - 03-16 21:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 198.3672 (197.5802)
[INFO] - 03-16 21:44:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:44:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9242)
[INFO] - 03-16 21:44:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:44:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:44:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:44:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:44:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:44:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:44:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:44:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.156
[INFO] - 03-16 21:44:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.157
[INFO] - 03-16 21:44:21 - [main.summary_metrics:168]: Epoch 207/300 - Test Results:
{'auc': 0.841282330974843,
 'f1': 0.40663763909046924,
 'loss': 0.45730995452928846,
 'ndcg': 0.7254853044966424,
 'precision': 0.6056603773584908,
 'recall': 0.30636792452830197}
[INFO] - 03-16 21:44:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[207] Complete. Time taken: 00:01:04.349
[INFO] - 03-16 21:44:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:44:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:44:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:44:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:44:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:44:21 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7221, 4990, 5133]
[INFO] - 03-16 21:44:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:44:24 - [main.backward:225]: Epoch 208/300 - Iteration 7/199 - Time 0.484 batch, 0.232 data, 0.455 forward
[INFO] - 03-16 21:44:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:44:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0057)
[INFO] - 03-16 21:44:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5600 (0.5887)
[INFO] - 03-16 21:44:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3611 (-140.3528)
[INFO] - 03-16 21:44:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8647 (19.9496)
[INFO] - 03-16 21:44:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.1214 (197.2843)
[INFO] - 03-16 21:44:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:44:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9290)
[INFO] - 03-16 21:44:39 - [main.backward:225]: Epoch 208/300 - Iteration 57/199 - Time 0.314 batch, 0.058 data, 0.280 forward
[INFO] - 03-16 21:44:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:44:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0050)
[INFO] - 03-16 21:44:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5513 (0.5734)
[INFO] - 03-16 21:44:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4208 (-140.3697)
[INFO] - 03-16 21:44:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8576 (19.9719)
[INFO] - 03-16 21:44:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.0405 (198.1766)
[INFO] - 03-16 21:44:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:44:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9370)
[INFO] - 03-16 21:44:53 - [main.backward:225]: Epoch 208/300 - Iteration 107/199 - Time 0.304 batch, 0.047 data, 0.270 forward
[INFO] - 03-16 21:44:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0052)
[INFO] - 03-16 21:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5767 (0.5785)
[INFO] - 03-16 21:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3940 (-140.3634)
[INFO] - 03-16 21:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9850 (19.9308)
[INFO] - 03-16 21:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.9783 (198.3167)
[INFO] - 03-16 21:44:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9322)
[INFO] - 03-16 21:45:07 - [main.backward:225]: Epoch 208/300 - Iteration 157/199 - Time 0.296 batch, 0.043 data, 0.261 forward
[INFO] - 03-16 21:45:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:45:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0061)
[INFO] - 03-16 21:45:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5564 (0.5880)
[INFO] - 03-16 21:45:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4180 (-140.3566)
[INFO] - 03-16 21:45:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9367 (19.9975)
[INFO] - 03-16 21:45:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.5935 (197.5230)
[INFO] - 03-16 21:45:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:45:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9231)
[INFO] - 03-16 21:45:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:45:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:45:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:45:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:45:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:45:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:45:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:45:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.166
[INFO] - 03-16 21:45:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.166
[INFO] - 03-16 21:45:24 - [main.summary_metrics:168]: Epoch 208/300 - Test Results:
{'auc': 0.8463566234276731,
 'f1': 0.41166908563134974,
 'loss': 0.4531713996223433,
 'ndcg': 0.722809825144409,
 'precision': 0.6132075471698113,
 'recall': 0.31014150943396224}
[INFO] - 03-16 21:45:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[208] Complete. Time taken: 00:01:03.544
[INFO] - 03-16 21:45:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:45:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:45:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:45:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:45:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:45:24 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7216, 5008, 5145]
[INFO] - 03-16 21:45:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:45:28 - [main.backward:225]: Epoch 209/300 - Iteration 8/199 - Time 0.489 batch, 0.233 data, 0.454 forward
[INFO] - 03-16 21:45:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:45:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0053)
[INFO] - 03-16 21:45:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5492 (0.5872)
[INFO] - 03-16 21:45:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3952 (-140.3542)
[INFO] - 03-16 21:45:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8514 (19.9357)
[INFO] - 03-16 21:45:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.6481 (197.0611)
[INFO] - 03-16 21:45:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:45:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9360)
[INFO] - 03-16 21:45:43 - [main.backward:225]: Epoch 209/300 - Iteration 58/199 - Time 0.317 batch, 0.060 data, 0.284 forward
[INFO] - 03-16 21:45:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:45:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0047)
[INFO] - 03-16 21:45:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5772 (0.5741)
[INFO] - 03-16 21:45:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4270 (-140.3685)
[INFO] - 03-16 21:45:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8609 (19.8960)
[INFO] - 03-16 21:45:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.5378 (197.8391)
[INFO] - 03-16 21:45:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:45:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9425)
[INFO] - 03-16 21:45:57 - [main.backward:225]: Epoch 209/300 - Iteration 108/199 - Time 0.304 batch, 0.049 data, 0.270 forward
[INFO] - 03-16 21:45:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:45:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0054)
[INFO] - 03-16 21:45:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5891 (0.5796)
[INFO] - 03-16 21:45:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3813 (-140.3622)
[INFO] - 03-16 21:45:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9685 (19.9011)
[INFO] - 03-16 21:45:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.9160 (198.0766)
[INFO] - 03-16 21:45:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:45:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9327)
[INFO] - 03-16 21:46:11 - [main.backward:225]: Epoch 209/300 - Iteration 158/199 - Time 0.294 batch, 0.043 data, 0.261 forward
[INFO] - 03-16 21:46:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0060)
[INFO] - 03-16 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5494 (0.5888)
[INFO] - 03-16 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4173 (-140.3590)
[INFO] - 03-16 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9700 (19.9934)
[INFO] - 03-16 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.2698 (197.3979)
[INFO] - 03-16 21:46:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9245)
[INFO] - 03-16 21:46:22 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:46:22 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:46:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:46:22 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:46:22 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:46:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:46:22 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:46:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.520
[INFO] - 03-16 21:46:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.521
[INFO] - 03-16 21:46:27 - [main.summary_metrics:168]: Epoch 209/300 - Test Results:
{'auc': 0.8536345322327044,
 'f1': 0.4154426705370102,
 'loss': 0.4468484973707538,
 'ndcg': 0.7399975134321735,
 'precision': 0.618867924528302,
 'recall': 0.3129716981132076}
[INFO] - 03-16 21:46:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[209] Complete. Time taken: 00:01:03.314
[INFO] - 03-16 21:46:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:46:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:46:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:46:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:46:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:46:28 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7202, 4997, 5144]
[INFO] - 03-16 21:46:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:46:32 - [main.backward:225]: Epoch 210/300 - Iteration 9/199 - Time 0.454 batch, 0.215 data, 0.420 forward
[INFO] - 03-16 21:46:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:46:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0054)
[INFO] - 03-16 21:46:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5133 (0.5862)
[INFO] - 03-16 21:46:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4157 (-140.3548)
[INFO] - 03-16 21:46:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9159 (19.9322)
[INFO] - 03-16 21:46:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.2336 (197.1646)
[INFO] - 03-16 21:46:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:46:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9348)
[INFO] - 03-16 21:46:46 - [main.backward:225]: Epoch 210/300 - Iteration 59/199 - Time 0.313 batch, 0.061 data, 0.280 forward
[INFO] - 03-16 21:46:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0047)
[INFO] - 03-16 21:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5444 (0.5756)
[INFO] - 03-16 21:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4216 (-140.3663)
[INFO] - 03-16 21:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9127 (19.9102)
[INFO] - 03-16 21:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.3338 (197.4888)
[INFO] - 03-16 21:46:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:46:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9470)
[INFO] - 03-16 21:47:00 - [main.backward:225]: Epoch 210/300 - Iteration 109/199 - Time 0.294 batch, 0.048 data, 0.261 forward
[INFO] - 03-16 21:47:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:47:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0053)
[INFO] - 03-16 21:47:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5790 (0.5777)
[INFO] - 03-16 21:47:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3877 (-140.3586)
[INFO] - 03-16 21:47:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 20.0024 (19.9724)
[INFO] - 03-16 21:47:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.9179 (197.4392)
[INFO] - 03-16 21:47:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:47:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9320)
[INFO] - 03-16 21:47:13 - [main.backward:225]: Epoch 210/300 - Iteration 159/199 - Time 0.289 batch, 0.043 data, 0.256 forward
[INFO] - 03-16 21:47:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0059)
[INFO] - 03-16 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5499 (0.5868)
[INFO] - 03-16 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4094 (-140.3617)
[INFO] - 03-16 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9117 (19.9661)
[INFO] - 03-16 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.2107 (196.5157)
[INFO] - 03-16 21:47:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9311)
[INFO] - 03-16 21:47:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:47:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:47:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:47:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.024
[INFO] - 03-16 21:47:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.025
[INFO] - 03-16 21:47:30 - [main.summary_metrics:168]: Epoch 210/300 - Test Results:
{'auc': 0.8688307783018867,
 'f1': 0.4280212868892114,
 'loss': 0.44405104236882686,
 'ndcg': 0.7616716867560712,
 'precision': 0.6377358490566037,
 'recall': 0.32240566037735846}
[INFO] - 03-16 21:47:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[210] Complete. Time taken: 00:01:02.133
[INFO] - 03-16 21:47:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:47:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:47:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:47:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:47:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:47:30 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7254, 5026, 5133]
[INFO] - 03-16 21:47:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:47:34 - [main.backward:225]: Epoch 211/300 - Iteration 10/199 - Time 0.405 batch, 0.166 data, 0.373 forward
[INFO] - 03-16 21:47:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:47:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0050)
[INFO] - 03-16 21:47:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5251 (0.5858)
[INFO] - 03-16 21:47:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4119 (-140.3507)
[INFO] - 03-16 21:47:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9609 (19.8776)
[INFO] - 03-16 21:47:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.3405 (196.5904)
[INFO] - 03-16 21:47:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:47:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9442)
[INFO] - 03-16 21:47:47 - [main.backward:225]: Epoch 211/300 - Iteration 60/199 - Time 0.295 batch, 0.056 data, 0.261 forward
[INFO] - 03-16 21:47:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:47:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0044)
[INFO] - 03-16 21:47:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5655 (0.5769)
[INFO] - 03-16 21:47:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4262 (-140.3662)
[INFO] - 03-16 21:47:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8283 (19.8513)
[INFO] - 03-16 21:47:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.3251 (197.3840)
[INFO] - 03-16 21:47:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:47:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9459)
[INFO] - 03-16 21:48:01 - [main.backward:225]: Epoch 211/300 - Iteration 110/199 - Time 0.288 batch, 0.046 data, 0.254 forward
[INFO] - 03-16 21:48:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0057 (0.0052)
[INFO] - 03-16 21:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5855 (0.5793)
[INFO] - 03-16 21:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3555 (-140.3525)
[INFO] - 03-16 21:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9619 (19.8738)
[INFO] - 03-16 21:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.8878 (197.3038)
[INFO] - 03-16 21:48:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9363)
[INFO] - 03-16 21:48:16 - [main.backward:225]: Epoch 211/300 - Iteration 160/199 - Time 0.290 batch, 0.042 data, 0.256 forward
[INFO] - 03-16 21:48:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:48:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0057)
[INFO] - 03-16 21:48:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5376 (0.5834)
[INFO] - 03-16 21:48:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4204 (-140.3676)
[INFO] - 03-16 21:48:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9743 (19.9251)
[INFO] - 03-16 21:48:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.1472 (196.7601)
[INFO] - 03-16 21:48:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:48:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9273)
[INFO] - 03-16 21:48:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:48:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:48:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:48:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:48:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:48:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:48:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:48:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.843
[INFO] - 03-16 21:48:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.843
[INFO] - 03-16 21:48:32 - [main.summary_metrics:168]: Epoch 211/300 - Test Results:
{'auc': 0.8512916339098531,
 'f1': 0.42449927431059503,
 'loss': 0.45301012526218243,
 'ndcg': 0.7364509722627004,
 'precision': 0.6320754716981133,
 'recall': 0.31988993710691827}
[INFO] - 03-16 21:48:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[211] Complete. Time taken: 00:01:02.245
[INFO] - 03-16 21:48:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:48:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:48:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:48:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:48:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:48:32 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7216, 5004, 5117]
[INFO] - 03-16 21:48:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:48:37 - [main.backward:225]: Epoch 212/300 - Iteration 11/199 - Time 0.416 batch, 0.172 data, 0.388 forward
[INFO] - 03-16 21:48:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0052)
[INFO] - 03-16 21:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5205 (0.5851)
[INFO] - 03-16 21:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4134 (-140.3505)
[INFO] - 03-16 21:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8881 (19.8892)
[INFO] - 03-16 21:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.3495 (196.2636)
[INFO] - 03-16 21:48:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9416)
[INFO] - 03-16 21:48:50 - [main.backward:225]: Epoch 212/300 - Iteration 61/199 - Time 0.300 batch, 0.059 data, 0.268 forward
[INFO] - 03-16 21:48:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0075 (0.0050)
[INFO] - 03-16 21:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6120 (0.5789)
[INFO] - 03-16 21:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2940 (-140.3689)
[INFO] - 03-16 21:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8732 (19.9046)
[INFO] - 03-16 21:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.8032 (196.6547)
[INFO] - 03-16 21:48:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:48:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9384)
[INFO] - 03-16 21:49:04 - [main.backward:225]: Epoch 212/300 - Iteration 111/199 - Time 0.289 batch, 0.047 data, 0.256 forward
[INFO] - 03-16 21:49:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:49:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0054)
[INFO] - 03-16 21:49:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5804)
[INFO] - 03-16 21:49:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3410 (-140.3492)
[INFO] - 03-16 21:49:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7873 (19.8246)
[INFO] - 03-16 21:49:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.9266 (196.9383)
[INFO] - 03-16 21:49:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:49:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9314)
[INFO] - 03-16 21:49:18 - [main.backward:225]: Epoch 212/300 - Iteration 161/199 - Time 0.284 batch, 0.042 data, 0.252 forward
[INFO] - 03-16 21:49:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:49:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0053)
[INFO] - 03-16 21:49:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5521 (0.5845)
[INFO] - 03-16 21:49:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4103 (-140.3669)
[INFO] - 03-16 21:49:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9218 (19.8913)
[INFO] - 03-16 21:49:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.0912 (196.4307)
[INFO] - 03-16 21:49:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:49:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9352)
[INFO] - 03-16 21:49:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:49:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:49:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:49:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:49:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:49:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:49:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:49:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.975
[INFO] - 03-16 21:49:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.976
[INFO] - 03-16 21:49:33 - [main.summary_metrics:168]: Epoch 212/300 - Test Results:
{'auc': 0.8567927148846959,
 'f1': 0.41418480890178994,
 'loss': 0.44543702887289177,
 'ndcg': 0.7482811707022679,
 'precision': 0.6169811320754718,
 'recall': 0.3120283018867925}
[INFO] - 03-16 21:49:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[212] Complete. Time taken: 00:01:01.007
[INFO] - 03-16 21:49:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:49:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:49:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:49:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:49:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:49:33 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7228, 4996, 5167]
[INFO] - 03-16 21:49:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:49:38 - [main.backward:225]: Epoch 213/300 - Iteration 12/199 - Time 0.398 batch, 0.149 data, 0.364 forward
[INFO] - 03-16 21:49:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:49:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0048)
[INFO] - 03-16 21:49:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5866)
[INFO] - 03-16 21:49:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3869 (-140.3462)
[INFO] - 03-16 21:49:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9089 (19.8770)
[INFO] - 03-16 21:49:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.7927 (196.3396)
[INFO] - 03-16 21:49:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:49:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9450)
[INFO] - 03-16 21:49:52 - [main.backward:225]: Epoch 213/300 - Iteration 62/199 - Time 0.305 batch, 0.056 data, 0.271 forward
[INFO] - 03-16 21:49:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0057 (0.0050)
[INFO] - 03-16 21:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6031 (0.5798)
[INFO] - 03-16 21:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3105 (-140.3670)
[INFO] - 03-16 21:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8406 (19.8925)
[INFO] - 03-16 21:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.4863 (197.0704)
[INFO] - 03-16 21:49:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9372)
[INFO] - 03-16 21:50:06 - [main.backward:225]: Epoch 213/300 - Iteration 112/199 - Time 0.293 batch, 0.046 data, 0.260 forward
[INFO] - 03-16 21:50:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0053)
[INFO] - 03-16 21:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5919 (0.5799)
[INFO] - 03-16 21:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3396 (-140.3477)
[INFO] - 03-16 21:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8322 (19.8723)
[INFO] - 03-16 21:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.8759 (196.9756)
[INFO] - 03-16 21:50:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9352)
[INFO] - 03-16 21:50:20 - [main.backward:225]: Epoch 213/300 - Iteration 162/199 - Time 0.289 batch, 0.042 data, 0.255 forward
[INFO] - 03-16 21:50:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0056)
[INFO] - 03-16 21:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5843 (0.5832)
[INFO] - 03-16 21:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3911 (-140.3718)
[INFO] - 03-16 21:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9545 (19.9566)
[INFO] - 03-16 21:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.1648 (196.2580)
[INFO] - 03-16 21:50:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9309)
[INFO] - 03-16 21:50:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:50:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:50:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:50:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:50:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:50:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:50:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:50:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.024
[INFO] - 03-16 21:50:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.024
[INFO] - 03-16 21:50:35 - [main.summary_metrics:168]: Epoch 213/300 - Test Results:
{'auc': 0.8495680359014675,
 'f1': 0.40518626028059984,
 'loss': 0.4512828444434912,
 'ndcg': 0.7289665299755635,
 'precision': 0.6037735849056604,
 'recall': 0.30518867924528303}
[INFO] - 03-16 21:50:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[213] Complete. Time taken: 00:01:01.873
[INFO] - 03-16 21:50:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:50:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:50:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:50:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:50:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:50:35 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7250, 4987, 5124]
[INFO] - 03-16 21:50:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:50:40 - [main.backward:225]: Epoch 214/300 - Iteration 13/199 - Time 0.394 batch, 0.154 data, 0.358 forward
[INFO] - 03-16 21:50:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:50:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0051)
[INFO] - 03-16 21:50:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5956 (0.5852)
[INFO] - 03-16 21:50:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3912 (-140.3470)
[INFO] - 03-16 21:50:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8917 (19.9175)
[INFO] - 03-16 21:50:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.9146 (195.9936)
[INFO] - 03-16 21:50:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:50:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9423)
[INFO] - 03-16 21:50:54 - [main.backward:225]: Epoch 214/300 - Iteration 63/199 - Time 0.298 batch, 0.058 data, 0.265 forward
[INFO] - 03-16 21:50:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:50:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0048)
[INFO] - 03-16 21:50:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5896 (0.5781)
[INFO] - 03-16 21:50:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3189 (-140.3705)
[INFO] - 03-16 21:50:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7875 (19.8615)
[INFO] - 03-16 21:50:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.3188 (196.4838)
[INFO] - 03-16 21:50:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:50:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9419)
[INFO] - 03-16 21:51:08 - [main.backward:225]: Epoch 214/300 - Iteration 113/199 - Time 0.292 batch, 0.047 data, 0.258 forward
[INFO] - 03-16 21:51:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0052)
[INFO] - 03-16 21:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5794)
[INFO] - 03-16 21:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3582 (-140.3474)
[INFO] - 03-16 21:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6891 (19.8523)
[INFO] - 03-16 21:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.8513 (196.9319)
[INFO] - 03-16 21:51:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9367)
[INFO] - 03-16 21:51:22 - [main.backward:225]: Epoch 214/300 - Iteration 163/199 - Time 0.289 batch, 0.043 data, 0.255 forward
[INFO] - 03-16 21:51:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:51:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0055)
[INFO] - 03-16 21:51:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6022 (0.5845)
[INFO] - 03-16 21:51:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3782 (-140.3723)
[INFO] - 03-16 21:51:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8627 (19.8342)
[INFO] - 03-16 21:51:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.7392 (195.8540)
[INFO] - 03-16 21:51:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:51:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9323)
[INFO] - 03-16 21:51:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:51:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:51:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:51:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:51:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:51:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:51:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:51:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.980
[INFO] - 03-16 21:51:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.980
[INFO] - 03-16 21:51:37 - [main.summary_metrics:168]: Epoch 214/300 - Test Results:
{'auc': 0.8537916666666666,
 'f1': 0.41795839380745037,
 'loss': 0.44256575064989007,
 'ndcg': 0.7312842124552517,
 'precision': 0.6226415094339623,
 'recall': 0.31485849056603776}
[INFO] - 03-16 21:51:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[214] Complete. Time taken: 00:01:02.250
[INFO] - 03-16 21:51:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:51:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:51:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:51:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:51:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:51:37 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7241, 4986, 5117]
[INFO] - 03-16 21:51:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:51:42 - [main.backward:225]: Epoch 215/300 - Iteration 14/199 - Time 0.385 batch, 0.157 data, 0.354 forward
[INFO] - 03-16 21:51:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:51:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0049)
[INFO] - 03-16 21:51:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5866 (0.5859)
[INFO] - 03-16 21:51:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3837 (-140.3500)
[INFO] - 03-16 21:51:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8094 (19.8412)
[INFO] - 03-16 21:51:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.1390 (195.9090)
[INFO] - 03-16 21:51:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:51:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9448)
[INFO] - 03-16 21:51:57 - [main.backward:225]: Epoch 215/300 - Iteration 64/199 - Time 0.309 batch, 0.061 data, 0.276 forward
[INFO] - 03-16 21:51:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0048)
[INFO] - 03-16 21:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6004 (0.5779)
[INFO] - 03-16 21:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2942 (-140.3708)
[INFO] - 03-16 21:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7968 (19.8136)
[INFO] - 03-16 21:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.6743 (196.7006)
[INFO] - 03-16 21:51:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9419)
[INFO] - 03-16 21:52:11 - [main.backward:225]: Epoch 215/300 - Iteration 114/199 - Time 0.300 batch, 0.049 data, 0.267 forward
[INFO] - 03-16 21:52:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:52:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0053)
[INFO] - 03-16 21:52:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5671 (0.5788)
[INFO] - 03-16 21:52:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3890 (-140.3497)
[INFO] - 03-16 21:52:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7935 (19.8303)
[INFO] - 03-16 21:52:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.1790 (196.7384)
[INFO] - 03-16 21:52:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:52:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9356)
[INFO] - 03-16 21:52:26 - [main.backward:225]: Epoch 215/300 - Iteration 164/199 - Time 0.299 batch, 0.045 data, 0.265 forward
[INFO] - 03-16 21:52:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0109 (0.0057)
[INFO] - 03-16 21:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6065 (0.5862)
[INFO] - 03-16 21:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3770 (-140.3697)
[INFO] - 03-16 21:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9186 (19.8997)
[INFO] - 03-16 21:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.3172 (196.0797)
[INFO] - 03-16 21:52:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:52:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8047 (0.9300)
[INFO] - 03-16 21:52:36 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:52:36 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:52:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:52:36 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:52:36 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:52:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:52:36 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:52:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.593
[INFO] - 03-16 21:52:41 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.594
[INFO] - 03-16 21:52:41 - [main.summary_metrics:168]: Epoch 215/300 - Test Results:
{'auc': 0.8612623493186581,
 'f1': 0.42927914852443144,
 'loss': 0.4420956489435032,
 'ndcg': 0.7540650302439644,
 'precision': 0.6396226415094339,
 'recall': 0.32334905660377355}
[INFO] - 03-16 21:52:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[215] Complete. Time taken: 00:01:03.550
[INFO] - 03-16 21:52:41 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:52:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:52:41 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:52:41 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:52:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:52:41 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7238, 4974, 5124]
[INFO] - 03-16 21:52:42 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:52:46 - [main.backward:225]: Epoch 216/300 - Iteration 15/199 - Time 0.390 batch, 0.140 data, 0.353 forward
[INFO] - 03-16 21:52:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:52:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0050)
[INFO] - 03-16 21:52:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5845 (0.5858)
[INFO] - 03-16 21:52:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3858 (-140.3518)
[INFO] - 03-16 21:52:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8575 (19.8329)
[INFO] - 03-16 21:52:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.1385 (195.7323)
[INFO] - 03-16 21:52:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:52:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9413)
[INFO] - 03-16 21:53:00 - [main.backward:225]: Epoch 216/300 - Iteration 65/199 - Time 0.305 batch, 0.059 data, 0.269 forward
[INFO] - 03-16 21:53:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:53:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0051)
[INFO] - 03-16 21:53:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6115 (0.5785)
[INFO] - 03-16 21:53:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2003 (-140.3657)
[INFO] - 03-16 21:53:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7262 (19.8077)
[INFO] - 03-16 21:53:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.9018 (196.2606)
[INFO] - 03-16 21:53:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:53:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9392)
[INFO] - 03-16 21:53:14 - [main.backward:225]: Epoch 216/300 - Iteration 115/199 - Time 0.294 batch, 0.047 data, 0.260 forward
[INFO] - 03-16 21:53:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:53:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0049)
[INFO] - 03-16 21:53:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5697 (0.5776)
[INFO] - 03-16 21:53:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4147 (-140.3576)
[INFO] - 03-16 21:53:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7266 (19.7515)
[INFO] - 03-16 21:53:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.4377 (196.4812)
[INFO] - 03-16 21:53:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:53:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9400)
[INFO] - 03-16 21:53:29 - [main.backward:225]: Epoch 216/300 - Iteration 165/199 - Time 0.292 batch, 0.042 data, 0.259 forward
[INFO] - 03-16 21:53:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:53:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0058)
[INFO] - 03-16 21:53:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6020 (0.5876)
[INFO] - 03-16 21:53:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3714 (-140.3722)
[INFO] - 03-16 21:53:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8202 (19.7895)
[INFO] - 03-16 21:53:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.6087 (195.5340)
[INFO] - 03-16 21:53:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:53:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9269)
[INFO] - 03-16 21:53:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:53:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:53:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:53:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:53:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:53:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:53:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:53:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.035
[INFO] - 03-16 21:53:43 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.036
[INFO] - 03-16 21:53:43 - [main.summary_metrics:168]: Epoch 216/300 - Test Results:
{'auc': 0.8559300314465409,
 'f1': 0.4207256894049346,
 'loss': 0.4494220599768297,
 'ndcg': 0.7420837195016516,
 'precision': 0.6264150943396226,
 'recall': 0.317059748427673}
[INFO] - 03-16 21:53:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[216] Complete. Time taken: 00:01:02.833
[INFO] - 03-16 21:53:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:53:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:53:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:53:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:53:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:53:43 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7225, 4992, 5114]
[INFO] - 03-16 21:53:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:53:50 - [main.backward:225]: Epoch 217/300 - Iteration 16/199 - Time 0.383 batch, 0.130 data, 0.346 forward
[INFO] - 03-16 21:53:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:53:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0053)
[INFO] - 03-16 21:53:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6051 (0.5869)
[INFO] - 03-16 21:53:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3791 (-140.3534)
[INFO] - 03-16 21:53:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7748 (19.8282)
[INFO] - 03-16 21:53:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.5916 (195.6308)
[INFO] - 03-16 21:53:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:53:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9367)
[INFO] - 03-16 21:54:03 - [main.backward:225]: Epoch 217/300 - Iteration 66/199 - Time 0.302 batch, 0.056 data, 0.269 forward
[INFO] - 03-16 21:54:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:54:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0075 (0.0049)
[INFO] - 03-16 21:54:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6155 (0.5805)
[INFO] - 03-16 21:54:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1898 (-140.3623)
[INFO] - 03-16 21:54:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8571 (19.8652)
[INFO] - 03-16 21:54:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.8857 (196.2004)
[INFO] - 03-16 21:54:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:54:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9398)
[INFO] - 03-16 21:54:17 - [main.backward:225]: Epoch 217/300 - Iteration 116/199 - Time 0.289 batch, 0.046 data, 0.256 forward
[INFO] - 03-16 21:54:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:54:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0055)
[INFO] - 03-16 21:54:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5710 (0.5762)
[INFO] - 03-16 21:54:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4125 (-140.3656)
[INFO] - 03-16 21:54:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7803 (19.8183)
[INFO] - 03-16 21:54:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.9664 (196.1299)
[INFO] - 03-16 21:54:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:54:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9305)
[INFO] - 03-16 21:54:30 - [main.backward:225]: Epoch 217/300 - Iteration 166/199 - Time 0.282 batch, 0.042 data, 0.249 forward
[INFO] - 03-16 21:54:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:54:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0060)
[INFO] - 03-16 21:54:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5981 (0.5866)
[INFO] - 03-16 21:54:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3706 (-140.3745)
[INFO] - 03-16 21:54:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8218 (19.7857)
[INFO] - 03-16 21:54:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.4859 (194.8690)
[INFO] - 03-16 21:54:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:54:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9230)
[INFO] - 03-16 21:54:39 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:54:39 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:54:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:54:39 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:54:39 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:54:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:54:39 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:54:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.748
[INFO] - 03-16 21:54:44 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.749
[INFO] - 03-16 21:54:44 - [main.summary_metrics:168]: Epoch 217/300 - Test Results:
{'auc': 0.8518930817610063,
 'f1': 0.41820996613449446,
 'loss': 0.445980163494246,
 'ndcg': 0.7387645481047764,
 'precision': 0.6226415094339623,
 'recall': 0.3151729559748428}
[INFO] - 03-16 21:54:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[217] Complete. Time taken: 00:01:00.465
[INFO] - 03-16 21:54:44 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:54:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:54:44 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:54:44 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:54:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:54:44 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7240, 4976, 5128]
[INFO] - 03-16 21:54:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:54:50 - [main.backward:225]: Epoch 218/300 - Iteration 17/199 - Time 0.367 batch, 0.120 data, 0.332 forward
[INFO] - 03-16 21:54:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:54:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0054)
[INFO] - 03-16 21:54:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5927 (0.5834)
[INFO] - 03-16 21:54:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3906 (-140.3543)
[INFO] - 03-16 21:54:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7881 (19.7560)
[INFO] - 03-16 21:54:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.7992 (195.2690)
[INFO] - 03-16 21:54:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:54:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9362)
[INFO] - 03-16 21:55:04 - [main.backward:225]: Epoch 218/300 - Iteration 67/199 - Time 0.298 batch, 0.055 data, 0.265 forward
[INFO] - 03-16 21:55:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0050)
[INFO] - 03-16 21:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6225 (0.5808)
[INFO] - 03-16 21:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2432 (-140.3687)
[INFO] - 03-16 21:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8681 (19.8209)
[INFO] - 03-16 21:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 197.3553 (196.1059)
[INFO] - 03-16 21:55:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9405)
[INFO] - 03-16 21:55:18 - [main.backward:225]: Epoch 218/300 - Iteration 117/199 - Time 0.291 batch, 0.044 data, 0.259 forward
[INFO] - 03-16 21:55:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0052)
[INFO] - 03-16 21:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6060 (0.5756)
[INFO] - 03-16 21:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3528 (-140.3656)
[INFO] - 03-16 21:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.9620 (19.8467)
[INFO] - 03-16 21:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 196.1426 (196.1136)
[INFO] - 03-16 21:55:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9359)
[INFO] - 03-16 21:55:32 - [main.backward:225]: Epoch 218/300 - Iteration 167/199 - Time 0.289 batch, 0.042 data, 0.256 forward
[INFO] - 03-16 21:55:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:55:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0060)
[INFO] - 03-16 21:55:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6234 (0.5863)
[INFO] - 03-16 21:55:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3685 (-140.3756)
[INFO] - 03-16 21:55:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8789 (19.8948)
[INFO] - 03-16 21:55:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.4714 (195.8033)
[INFO] - 03-16 21:55:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:55:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9222)
[INFO] - 03-16 21:55:41 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:55:41 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:55:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:55:41 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:55:41 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:55:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:55:41 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:55:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.002
[INFO] - 03-16 21:55:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.003
[INFO] - 03-16 21:55:46 - [main.summary_metrics:168]: Epoch 218/300 - Test Results:
{'auc': 0.8507463639937106,
 'f1': 0.4139912917271407,
 'loss': 0.4434841482454376,
 'ndcg': 0.7305741433383485,
 'precision': 0.6169811320754717,
 'recall': 0.31179245283018864}
[INFO] - 03-16 21:55:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[218] Complete. Time taken: 00:01:02.106
[INFO] - 03-16 21:55:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:55:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:55:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:55:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:55:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:55:46 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7205, 4999, 5158]
[INFO] - 03-16 21:55:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:55:53 - [main.backward:225]: Epoch 219/300 - Iteration 18/199 - Time 0.364 batch, 0.115 data, 0.330 forward
[INFO] - 03-16 21:55:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:55:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0047)
[INFO] - 03-16 21:55:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6066 (0.5841)
[INFO] - 03-16 21:55:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3869 (-140.3593)
[INFO] - 03-16 21:55:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.8000 (19.7730)
[INFO] - 03-16 21:55:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.8141 (195.2481)
[INFO] - 03-16 21:55:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:55:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9463)
[INFO] - 03-16 21:56:07 - [main.backward:225]: Epoch 219/300 - Iteration 68/199 - Time 0.303 batch, 0.055 data, 0.270 forward
[INFO] - 03-16 21:56:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0044)
[INFO] - 03-16 21:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5741 (0.5799)
[INFO] - 03-16 21:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3546 (-140.3676)
[INFO] - 03-16 21:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6763 (19.7353)
[INFO] - 03-16 21:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.8728 (195.6992)
[INFO] - 03-16 21:56:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9487)
[INFO] - 03-16 21:56:21 - [main.backward:225]: Epoch 219/300 - Iteration 118/199 - Time 0.294 batch, 0.046 data, 0.260 forward
[INFO] - 03-16 21:56:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:56:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0052)
[INFO] - 03-16 21:56:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6076 (0.5756)
[INFO] - 03-16 21:56:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3429 (-140.3634)
[INFO] - 03-16 21:56:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7319 (19.7500)
[INFO] - 03-16 21:56:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.9072 (196.0188)
[INFO] - 03-16 21:56:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:56:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9325)
[INFO] - 03-16 21:56:35 - [main.backward:225]: Epoch 219/300 - Iteration 168/199 - Time 0.290 batch, 0.042 data, 0.256 forward
[INFO] - 03-16 21:56:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:56:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0058)
[INFO] - 03-16 21:56:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6139 (0.5867)
[INFO] - 03-16 21:56:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3740 (-140.3748)
[INFO] - 03-16 21:56:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7351 (19.7779)
[INFO] - 03-16 21:56:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.0022 (195.5359)
[INFO] - 03-16 21:56:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:56:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9241)
[INFO] - 03-16 21:56:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:56:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:56:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:56:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:56:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:56:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:56:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:56:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:05.032
[INFO] - 03-16 21:56:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:05.033
[INFO] - 03-16 21:56:48 - [main.summary_metrics:168]: Epoch 219/300 - Test Results:
{'auc': 0.8543115828092245,
 'f1': 0.4165070149975809,
 'loss': 0.44980765129985045,
 'ndcg': 0.7422445250337222,
 'precision': 0.620754716981132,
 'recall': 0.3136792452830189}
[INFO] - 03-16 21:56:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[219] Complete. Time taken: 00:01:02.262
[INFO] - 03-16 21:56:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:56:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:56:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:56:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:56:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:56:48 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7232, 4964, 5123]
[INFO] - 03-16 21:56:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:56:55 - [main.backward:225]: Epoch 220/300 - Iteration 19/199 - Time 0.365 batch, 0.125 data, 0.330 forward
[INFO] - 03-16 21:56:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0050)
[INFO] - 03-16 21:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6002 (0.5842)
[INFO] - 03-16 21:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3872 (-140.3564)
[INFO] - 03-16 21:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7296 (19.7179)
[INFO] - 03-16 21:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.7918 (195.0980)
[INFO] - 03-16 21:56:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9433)
[INFO] - 03-16 21:57:09 - [main.backward:225]: Epoch 220/300 - Iteration 69/199 - Time 0.307 batch, 0.059 data, 0.272 forward
[INFO] - 03-16 21:57:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:57:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0047)
[INFO] - 03-16 21:57:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5061 (0.5774)
[INFO] - 03-16 21:57:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4739 (-140.3675)
[INFO] - 03-16 21:57:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5410 (19.7231)
[INFO] - 03-16 21:57:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.2364 (195.4108)
[INFO] - 03-16 21:57:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:57:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9441)
[INFO] - 03-16 21:57:24 - [main.backward:225]: Epoch 220/300 - Iteration 119/199 - Time 0.296 batch, 0.048 data, 0.262 forward
[INFO] - 03-16 21:57:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:57:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0052)
[INFO] - 03-16 21:57:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6024 (0.5788)
[INFO] - 03-16 21:57:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3445 (-140.3609)
[INFO] - 03-16 21:57:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7831 (19.7280)
[INFO] - 03-16 21:57:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.2982 (195.3082)
[INFO] - 03-16 21:57:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:57:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9386)
[INFO] - 03-16 21:57:37 - [main.backward:225]: Epoch 220/300 - Iteration 169/199 - Time 0.291 batch, 0.044 data, 0.257 forward
[INFO] - 03-16 21:57:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:57:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0057)
[INFO] - 03-16 21:57:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5877)
[INFO] - 03-16 21:57:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3560 (-140.3710)
[INFO] - 03-16 21:57:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7995 (19.8236)
[INFO] - 03-16 21:57:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.4512 (194.9953)
[INFO] - 03-16 21:57:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:57:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9261)
[INFO] - 03-16 21:57:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:57:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:57:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:57:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:57:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:57:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:57:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:57:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.087
[INFO] - 03-16 21:57:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.088
[INFO] - 03-16 21:57:49 - [main.summary_metrics:168]: Epoch 220/300 - Test Results:
{'auc': 0.8489434289832286,
 'f1': 0.4119206579583937,
 'loss': 0.45460378983535604,
 'ndcg': 0.7258003107643825,
 'precision': 0.6132075471698114,
 'recall': 0.3104559748427673}
[INFO] - 03-16 21:57:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[220] Complete. Time taken: 00:01:00.433
[INFO] - 03-16 21:57:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:57:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:57:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:57:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:57:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:57:49 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7232, 5012, 5152]
[INFO] - 03-16 21:57:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:57:54 - [main.backward:225]: Epoch 221/300 - Iteration 20/199 - Time 0.280 batch, 0.082 data, 0.253 forward
[INFO] - 03-16 21:57:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0094 (0.0053)
[INFO] - 03-16 21:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5852)
[INFO] - 03-16 21:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3935 (-140.3521)
[INFO] - 03-16 21:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7186 (19.7691)
[INFO] - 03-16 21:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.7610 (195.0499)
[INFO] - 03-16 21:57:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:57:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9367)
[INFO] - 03-16 21:58:06 - [main.backward:225]: Epoch 221/300 - Iteration 70/199 - Time 0.244 batch, 0.043 data, 0.216 forward
[INFO] - 03-16 21:58:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0048)
[INFO] - 03-16 21:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5226 (0.5774)
[INFO] - 03-16 21:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4686 (-140.3711)
[INFO] - 03-16 21:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5410 (19.7172)
[INFO] - 03-16 21:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.4353 (195.5474)
[INFO] - 03-16 21:58:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9387)
[INFO] - 03-16 21:58:17 - [main.backward:225]: Epoch 221/300 - Iteration 120/199 - Time 0.235 batch, 0.037 data, 0.207 forward
[INFO] - 03-16 21:58:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:58:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0050)
[INFO] - 03-16 21:58:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5996 (0.5794)
[INFO] - 03-16 21:58:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3375 (-140.3565)
[INFO] - 03-16 21:58:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7526 (19.7008)
[INFO] - 03-16 21:58:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.3019 (195.5494)
[INFO] - 03-16 21:58:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:58:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9369)
[INFO] - 03-16 21:58:28 - [main.backward:225]: Epoch 221/300 - Iteration 170/199 - Time 0.231 batch, 0.035 data, 0.203 forward
[INFO] - 03-16 21:58:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:58:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0056)
[INFO] - 03-16 21:58:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5334 (0.5848)
[INFO] - 03-16 21:58:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4178 (-140.3751)
[INFO] - 03-16 21:58:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6612 (19.6774)
[INFO] - 03-16 21:58:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.5169 (194.8324)
[INFO] - 03-16 21:58:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:58:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9336)
[INFO] - 03-16 21:58:35 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:58:35 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:58:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:58:35 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:58:35 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:58:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:58:35 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:58:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.098
[INFO] - 03-16 21:58:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.099
[INFO] - 03-16 21:58:39 - [main.summary_metrics:168]: Epoch 221/300 - Test Results:
{'auc': 0.8549470322327045,
 'f1': 0.4217319787131107,
 'loss': 0.4442308141440466,
 'ndcg': 0.7405846855875257,
 'precision': 0.6283018867924529,
 'recall': 0.31768867924528305}
[INFO] - 03-16 21:58:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[221] Complete. Time taken: 00:00:50.127
[INFO] - 03-16 21:58:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:58:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:58:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:58:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:58:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:58:39 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7244, 4978, 5127]
[INFO] - 03-16 21:58:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:58:45 - [main.backward:225]: Epoch 222/300 - Iteration 21/199 - Time 0.298 batch, 0.090 data, 0.269 forward
[INFO] - 03-16 21:58:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:58:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0050)
[INFO] - 03-16 21:58:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5975 (0.5861)
[INFO] - 03-16 21:58:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3982 (-140.3521)
[INFO] - 03-16 21:58:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6660 (19.7027)
[INFO] - 03-16 21:58:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.0347 (194.7793)
[INFO] - 03-16 21:58:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:58:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9386)
[INFO] - 03-16 21:58:57 - [main.backward:225]: Epoch 222/300 - Iteration 71/199 - Time 0.256 batch, 0.046 data, 0.228 forward
[INFO] - 03-16 21:58:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0048)
[INFO] - 03-16 21:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5206 (0.5746)
[INFO] - 03-16 21:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4857 (-140.3751)
[INFO] - 03-16 21:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5845 (19.6863)
[INFO] - 03-16 21:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.4556 (195.2081)
[INFO] - 03-16 21:58:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:58:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9413)
[INFO] - 03-16 21:59:09 - [main.backward:225]: Epoch 222/300 - Iteration 121/199 - Time 0.247 batch, 0.039 data, 0.219 forward
[INFO] - 03-16 21:59:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:59:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0053)
[INFO] - 03-16 21:59:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5739 (0.5827)
[INFO] - 03-16 21:59:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3616 (-140.3560)
[INFO] - 03-16 21:59:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6518 (19.6702)
[INFO] - 03-16 21:59:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.5248 (195.5566)
[INFO] - 03-16 21:59:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:59:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9358)
[INFO] - 03-16 21:59:21 - [main.backward:225]: Epoch 222/300 - Iteration 171/199 - Time 0.244 batch, 0.036 data, 0.216 forward
[INFO] - 03-16 21:59:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:59:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0055)
[INFO] - 03-16 21:59:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5335 (0.5850)
[INFO] - 03-16 21:59:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3975 (-140.3732)
[INFO] - 03-16 21:59:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6286 (19.6786)
[INFO] - 03-16 21:59:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.8248 (195.1843)
[INFO] - 03-16 21:59:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:59:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9298)
[INFO] - 03-16 21:59:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 21:59:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:59:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:59:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 21:59:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:59:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 21:59:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 21:59:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.258
[INFO] - 03-16 21:59:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.259
[INFO] - 03-16 21:59:31 - [main.summary_metrics:168]: Epoch 222/300 - Test Results:
{'auc': 0.8573384761530399,
 'f1': 0.43311078858248664,
 'loss': 0.44535519332405904,
 'ndcg': 0.7427510787103161,
 'precision': 0.6452830188679247,
 'recall': 0.3262578616352202}
[INFO] - 03-16 21:59:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[222] Complete. Time taken: 00:00:52.591
[INFO] - 03-16 21:59:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 21:59:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 21:59:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 21:59:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 21:59:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 21:59:31 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7237, 4965, 5088]
[INFO] - 03-16 21:59:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 21:59:38 - [main.backward:225]: Epoch 223/300 - Iteration 22/199 - Time 0.293 batch, 0.083 data, 0.264 forward
[INFO] - 03-16 21:59:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:59:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0046)
[INFO] - 03-16 21:59:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5905 (0.5879)
[INFO] - 03-16 21:59:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3654 (-140.3511)
[INFO] - 03-16 21:59:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6917 (19.6688)
[INFO] - 03-16 21:59:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.0250 (194.5303)
[INFO] - 03-16 21:59:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:59:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9470)
[INFO] - 03-16 21:59:50 - [main.backward:225]: Epoch 223/300 - Iteration 72/199 - Time 0.251 batch, 0.044 data, 0.224 forward
[INFO] - 03-16 21:59:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 21:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0044)
[INFO] - 03-16 21:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5889 (0.5759)
[INFO] - 03-16 21:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3642 (-140.3732)
[INFO] - 03-16 21:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6083 (19.6830)
[INFO] - 03-16 21:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.2241 (194.9704)
[INFO] - 03-16 21:59:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 21:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9473)
[INFO] - 03-16 22:00:01 - [main.backward:225]: Epoch 223/300 - Iteration 122/199 - Time 0.245 batch, 0.038 data, 0.216 forward
[INFO] - 03-16 22:00:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:00:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0072 (0.0053)
[INFO] - 03-16 22:00:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5788 (0.5813)
[INFO] - 03-16 22:00:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3788 (-140.3572)
[INFO] - 03-16 22:00:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6244 (19.6854)
[INFO] - 03-16 22:00:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.1255 (195.0635)
[INFO] - 03-16 22:00:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:00:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9359)
[INFO] - 03-16 22:00:13 - [main.backward:225]: Epoch 223/300 - Iteration 172/199 - Time 0.243 batch, 0.035 data, 0.215 forward
[INFO] - 03-16 22:00:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:00:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0054)
[INFO] - 03-16 22:00:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5395 (0.5841)
[INFO] - 03-16 22:00:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4150 (-140.3701)
[INFO] - 03-16 22:00:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5648 (19.7165)
[INFO] - 03-16 22:00:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.7232 (195.1707)
[INFO] - 03-16 22:00:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:00:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9336)
[INFO] - 03-16 22:00:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:00:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:00:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:00:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:00:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:00:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:00:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:00:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.258
[INFO] - 03-16 22:00:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.258
[INFO] - 03-16 22:00:24 - [main.summary_metrics:168]: Epoch 223/300 - Test Results:
{'auc': 0.8579734342243186,
 'f1': 0.42953072085147553,
 'loss': 0.4412047161726083,
 'ndcg': 0.7413077213707115,
 'precision': 0.6396226415094339,
 'recall': 0.3236635220125786}
[INFO] - 03-16 22:00:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[223] Complete. Time taken: 00:00:52.543
[INFO] - 03-16 22:00:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:00:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:00:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:00:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:00:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:00:24 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7218, 4990, 5132]
[INFO] - 03-16 22:00:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:00:31 - [main.backward:225]: Epoch 224/300 - Iteration 23/199 - Time 0.297 batch, 0.083 data, 0.267 forward
[INFO] - 03-16 22:00:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:00:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0048)
[INFO] - 03-16 22:00:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5962 (0.5880)
[INFO] - 03-16 22:00:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3468 (-140.3495)
[INFO] - 03-16 22:00:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5901 (19.6554)
[INFO] - 03-16 22:00:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.7448 (194.3714)
[INFO] - 03-16 22:00:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:00:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9437)
[INFO] - 03-16 22:00:43 - [main.backward:225]: Epoch 224/300 - Iteration 73/199 - Time 0.256 batch, 0.046 data, 0.227 forward
[INFO] - 03-16 22:00:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:00:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0042)
[INFO] - 03-16 22:00:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6092 (0.5750)
[INFO] - 03-16 22:00:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3375 (-140.3711)
[INFO] - 03-16 22:00:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5359 (19.6562)
[INFO] - 03-16 22:00:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.7802 (195.0537)
[INFO] - 03-16 22:00:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:00:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9491)
[INFO] - 03-16 22:00:54 - [main.backward:225]: Epoch 224/300 - Iteration 123/199 - Time 0.245 batch, 0.038 data, 0.216 forward
[INFO] - 03-16 22:00:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:00:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0050)
[INFO] - 03-16 22:00:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5812)
[INFO] - 03-16 22:00:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3672 (-140.3568)
[INFO] - 03-16 22:00:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6237 (19.6509)
[INFO] - 03-16 22:00:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.0555 (195.2011)
[INFO] - 03-16 22:00:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:00:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9378)
[INFO] - 03-16 22:01:06 - [main.backward:225]: Epoch 224/300 - Iteration 173/199 - Time 0.240 batch, 0.035 data, 0.212 forward
[INFO] - 03-16 22:01:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:01:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0051)
[INFO] - 03-16 22:01:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5488 (0.5841)
[INFO] - 03-16 22:01:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4127 (-140.3725)
[INFO] - 03-16 22:01:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5801 (19.6460)
[INFO] - 03-16 22:01:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.4759 (194.8613)
[INFO] - 03-16 22:01:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:01:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9359)
[INFO] - 03-16 22:01:11 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:01:11 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:01:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:01:11 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:01:11 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:01:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:01:11 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:01:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.231
[INFO] - 03-16 22:01:15 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.231
[INFO] - 03-16 22:01:15 - [main.summary_metrics:168]: Epoch 224/300 - Test Results:
{'auc': 0.8579783805031446,
 'f1': 0.43185292694726657,
 'loss': 0.4390011447570608,
 'ndcg': 0.7429413163617989,
 'precision': 0.6433962264150944,
 'recall': 0.325314465408805}
[INFO] - 03-16 22:01:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[224] Complete. Time taken: 00:00:51.538
[INFO] - 03-16 22:01:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:01:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:01:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:01:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:01:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:01:16 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7206, 5027, 5175]
[INFO] - 03-16 22:01:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:01:23 - [main.backward:225]: Epoch 225/300 - Iteration 24/199 - Time 0.295 batch, 0.083 data, 0.265 forward
[INFO] - 03-16 22:01:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:01:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0050)
[INFO] - 03-16 22:01:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6107 (0.5890)
[INFO] - 03-16 22:01:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3260 (-140.3488)
[INFO] - 03-16 22:01:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6788 (19.6320)
[INFO] - 03-16 22:01:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.5977 (194.4429)
[INFO] - 03-16 22:01:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:01:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9425)
[INFO] - 03-16 22:01:34 - [main.backward:225]: Epoch 225/300 - Iteration 74/199 - Time 0.254 batch, 0.046 data, 0.225 forward
[INFO] - 03-16 22:01:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0047)
[INFO] - 03-16 22:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6073 (0.5753)
[INFO] - 03-16 22:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3405 (-140.3715)
[INFO] - 03-16 22:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6048 (19.6393)
[INFO] - 03-16 22:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.8589 (194.7381)
[INFO] - 03-16 22:01:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9417)
[INFO] - 03-16 22:01:46 - [main.backward:225]: Epoch 225/300 - Iteration 124/199 - Time 0.247 batch, 0.039 data, 0.218 forward
[INFO] - 03-16 22:01:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:01:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0051)
[INFO] - 03-16 22:01:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5820 (0.5810)
[INFO] - 03-16 22:01:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3483 (-140.3575)
[INFO] - 03-16 22:01:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6002 (19.6411)
[INFO] - 03-16 22:01:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.8406 (195.0307)
[INFO] - 03-16 22:01:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:01:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9367)
[INFO] - 03-16 22:01:58 - [main.backward:225]: Epoch 225/300 - Iteration 174/199 - Time 0.243 batch, 0.036 data, 0.215 forward
[INFO] - 03-16 22:01:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:01:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0051)
[INFO] - 03-16 22:01:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5708 (0.5822)
[INFO] - 03-16 22:01:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3958 (-140.3715)
[INFO] - 03-16 22:01:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7272 (19.6805)
[INFO] - 03-16 22:01:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.1485 (194.7560)
[INFO] - 03-16 22:01:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:01:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9363)
[INFO] - 03-16 22:02:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:02:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:02:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:02:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:02:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:02:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:02:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:02:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.176
[INFO] - 03-16 22:02:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.178
[INFO] - 03-16 22:02:08 - [main.summary_metrics:168]: Epoch 225/300 - Test Results:
{'auc': 0.8703488928197065,
 'f1': 0.4546879535558781,
 'loss': 0.43633612959439894,
 'ndcg': 0.7666414801806117,
 'precision': 0.6773584905660377,
 'recall': 0.34253144654088047}
[INFO] - 03-16 22:02:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[225] Complete. Time taken: 00:00:52.499
[INFO] - 03-16 22:02:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:02:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:02:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:02:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:02:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:02:08 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7260, 5008, 5131]
[INFO] - 03-16 22:02:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:02:15 - [main.backward:225]: Epoch 226/300 - Iteration 25/199 - Time 0.280 batch, 0.077 data, 0.253 forward
[INFO] - 03-16 22:02:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:02:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0057 (0.0050)
[INFO] - 03-16 22:02:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6111 (0.5892)
[INFO] - 03-16 22:02:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3303 (-140.3497)
[INFO] - 03-16 22:02:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7120 (19.6569)
[INFO] - 03-16 22:02:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.9087 (194.2253)
[INFO] - 03-16 22:02:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:02:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9417)
[INFO] - 03-16 22:02:27 - [main.backward:225]: Epoch 226/300 - Iteration 75/199 - Time 0.247 batch, 0.043 data, 0.220 forward
[INFO] - 03-16 22:02:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:02:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0043)
[INFO] - 03-16 22:02:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6085 (0.5760)
[INFO] - 03-16 22:02:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3200 (-140.3681)
[INFO] - 03-16 22:02:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6244 (19.6461)
[INFO] - 03-16 22:02:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.8855 (194.7142)
[INFO] - 03-16 22:02:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:02:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9505)
[INFO] - 03-16 22:02:38 - [main.backward:225]: Epoch 226/300 - Iteration 125/199 - Time 0.239 batch, 0.037 data, 0.213 forward
[INFO] - 03-16 22:02:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:02:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0051)
[INFO] - 03-16 22:02:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5971 (0.5827)
[INFO] - 03-16 22:02:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2715 (-140.3569)
[INFO] - 03-16 22:02:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7104 (19.6236)
[INFO] - 03-16 22:02:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.8779 (195.0799)
[INFO] - 03-16 22:02:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:02:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9364)
[INFO] - 03-16 22:02:49 - [main.backward:225]: Epoch 226/300 - Iteration 175/199 - Time 0.236 batch, 0.034 data, 0.209 forward
[INFO] - 03-16 22:02:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:02:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0057)
[INFO] - 03-16 22:02:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5643 (0.5823)
[INFO] - 03-16 22:02:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4049 (-140.3717)
[INFO] - 03-16 22:02:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5704 (19.6214)
[INFO] - 03-16 22:02:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.4787 (194.6826)
[INFO] - 03-16 22:02:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:02:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9264)
[INFO] - 03-16 22:02:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:02:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:02:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:02:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:02:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:02:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:02:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:02:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.121
[INFO] - 03-16 22:02:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.122
[INFO] - 03-16 22:02:59 - [main.summary_metrics:168]: Epoch 226/300 - Test Results:
{'auc': 0.8639114255765202,
 'f1': 0.44059990324141257,
 'loss': 0.4372117991977268,
 'ndcg': 0.7550008605855746,
 'precision': 0.6566037735849057,
 'recall': 0.33183962264150946}
[INFO] - 03-16 22:02:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[226] Complete. Time taken: 00:00:51.307
[INFO] - 03-16 22:02:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:02:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:02:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:02:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:02:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:02:59 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7217, 5003, 5129]
[INFO] - 03-16 22:03:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:03:06 - [main.backward:225]: Epoch 227/300 - Iteration 26/199 - Time 0.275 batch, 0.073 data, 0.247 forward
[INFO] - 03-16 22:03:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:03:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0050)
[INFO] - 03-16 22:03:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6064 (0.5913)
[INFO] - 03-16 22:03:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3145 (-140.3477)
[INFO] - 03-16 22:03:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7007 (19.6217)
[INFO] - 03-16 22:03:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.1584 (194.2529)
[INFO] - 03-16 22:03:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:03:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9397)
[INFO] - 03-16 22:03:18 - [main.backward:225]: Epoch 227/300 - Iteration 76/199 - Time 0.247 batch, 0.043 data, 0.219 forward
[INFO] - 03-16 22:03:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:03:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0046)
[INFO] - 03-16 22:03:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5620 (0.5747)
[INFO] - 03-16 22:03:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3735 (-140.3660)
[INFO] - 03-16 22:03:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6085 (19.6639)
[INFO] - 03-16 22:03:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.9475 (194.5277)
[INFO] - 03-16 22:03:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:03:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9450)
[INFO] - 03-16 22:03:30 - [main.backward:225]: Epoch 227/300 - Iteration 126/199 - Time 0.243 batch, 0.037 data, 0.215 forward
[INFO] - 03-16 22:03:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0050)
[INFO] - 03-16 22:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6058 (0.5811)
[INFO] - 03-16 22:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2634 (-140.3552)
[INFO] - 03-16 22:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6557 (19.6436)
[INFO] - 03-16 22:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.2310 (194.4622)
[INFO] - 03-16 22:03:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9391)
[INFO] - 03-16 22:03:42 - [main.backward:225]: Epoch 227/300 - Iteration 176/199 - Time 0.240 batch, 0.035 data, 0.212 forward
[INFO] - 03-16 22:03:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:03:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0050)
[INFO] - 03-16 22:03:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5754 (0.5803)
[INFO] - 03-16 22:03:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4223 (-140.3739)
[INFO] - 03-16 22:03:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6402 (19.6520)
[INFO] - 03-16 22:03:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.4653 (194.3998)
[INFO] - 03-16 22:03:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:03:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9373)
[INFO] - 03-16 22:03:47 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:03:47 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:03:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:03:47 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:03:47 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:03:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:03:47 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:03:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.260
[INFO] - 03-16 22:03:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.261
[INFO] - 03-16 22:03:51 - [main.summary_metrics:168]: Epoch 227/300 - Test Results:
{'auc': 0.8593296973270439,
 'f1': 0.43078858248669566,
 'loss': 0.4415584657377168,
 'ndcg': 0.7514650006122457,
 'precision': 0.6415094339622641,
 'recall': 0.3246069182389937}
[INFO] - 03-16 22:03:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[227] Complete. Time taken: 00:00:51.845
[INFO] - 03-16 22:03:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:03:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:03:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:03:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:03:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:03:51 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7218, 5002, 5140]
[INFO] - 03-16 22:03:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:03:59 - [main.backward:225]: Epoch 228/300 - Iteration 27/199 - Time 0.284 batch, 0.073 data, 0.257 forward
[INFO] - 03-16 22:03:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:03:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0050)
[INFO] - 03-16 22:03:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6192 (0.5897)
[INFO] - 03-16 22:03:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3453 (-140.3466)
[INFO] - 03-16 22:03:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6083 (19.6358)
[INFO] - 03-16 22:03:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.1643 (193.8431)
[INFO] - 03-16 22:03:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:03:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9437)
[INFO] - 03-16 22:04:10 - [main.backward:225]: Epoch 228/300 - Iteration 77/199 - Time 0.249 batch, 0.043 data, 0.222 forward
[INFO] - 03-16 22:04:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0042)
[INFO] - 03-16 22:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5784 (0.5734)
[INFO] - 03-16 22:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3832 (-140.3655)
[INFO] - 03-16 22:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5380 (19.6249)
[INFO] - 03-16 22:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.9589 (194.5398)
[INFO] - 03-16 22:04:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:04:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9516)
[INFO] - 03-16 22:04:22 - [main.backward:225]: Epoch 228/300 - Iteration 127/199 - Time 0.244 batch, 0.037 data, 0.217 forward
[INFO] - 03-16 22:04:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:04:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0051)
[INFO] - 03-16 22:04:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5974 (0.5822)
[INFO] - 03-16 22:04:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2686 (-140.3555)
[INFO] - 03-16 22:04:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6748 (19.6354)
[INFO] - 03-16 22:04:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.1317 (194.8093)
[INFO] - 03-16 22:04:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:04:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9352)
[INFO] - 03-16 22:04:34 - [main.backward:225]: Epoch 228/300 - Iteration 177/199 - Time 0.241 batch, 0.034 data, 0.214 forward
[INFO] - 03-16 22:04:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0053)
[INFO] - 03-16 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6112 (0.5812)
[INFO] - 03-16 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3694 (-140.3742)
[INFO] - 03-16 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6752 (19.6217)
[INFO] - 03-16 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.5212 (194.6182)
[INFO] - 03-16 22:04:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9344)
[INFO] - 03-16 22:04:39 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:04:39 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:04:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:04:39 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:04:39 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:04:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:04:39 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:04:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.343
[INFO] - 03-16 22:04:43 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.343
[INFO] - 03-16 22:04:43 - [main.summary_metrics:168]: Epoch 228/300 - Test Results:
{'auc': 0.8658379848008385,
 'f1': 0.4408514755684566,
 'loss': 0.4356912024875858,
 'ndcg': 0.765128428898935,
 'precision': 0.6566037735849057,
 'recall': 0.3321540880503145}
[INFO] - 03-16 22:04:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[228] Complete. Time taken: 00:00:52.196
[INFO] - 03-16 22:04:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:04:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:04:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:04:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:04:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:04:43 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7278, 5005, 5155]
[INFO] - 03-16 22:04:44 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:04:51 - [main.backward:225]: Epoch 229/300 - Iteration 28/199 - Time 0.270 batch, 0.062 data, 0.242 forward
[INFO] - 03-16 22:04:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:04:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0047)
[INFO] - 03-16 22:04:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5972 (0.5903)
[INFO] - 03-16 22:04:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3330 (-140.3409)
[INFO] - 03-16 22:04:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6558 (19.6182)
[INFO] - 03-16 22:04:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.1907 (194.1492)
[INFO] - 03-16 22:04:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:04:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9456)
[INFO] - 03-16 22:05:03 - [main.backward:225]: Epoch 229/300 - Iteration 78/199 - Time 0.246 batch, 0.040 data, 0.219 forward
[INFO] - 03-16 22:05:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:05:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0045)
[INFO] - 03-16 22:05:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5690 (0.5730)
[INFO] - 03-16 22:05:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3902 (-140.3678)
[INFO] - 03-16 22:05:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5893 (19.6173)
[INFO] - 03-16 22:05:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.7968 (194.3855)
[INFO] - 03-16 22:05:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:05:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9469)
[INFO] - 03-16 22:05:14 - [main.backward:225]: Epoch 229/300 - Iteration 128/199 - Time 0.238 batch, 0.034 data, 0.211 forward
[INFO] - 03-16 22:05:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:05:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0055)
[INFO] - 03-16 22:05:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6102 (0.5832)
[INFO] - 03-16 22:05:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2876 (-140.3514)
[INFO] - 03-16 22:05:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6921 (19.6260)
[INFO] - 03-16 22:05:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.4979 (194.5892)
[INFO] - 03-16 22:05:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:05:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9298)
[INFO] - 03-16 22:05:25 - [main.backward:225]: Epoch 229/300 - Iteration 178/199 - Time 0.235 batch, 0.032 data, 0.208 forward
[INFO] - 03-16 22:05:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:05:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0057 (0.0053)
[INFO] - 03-16 22:05:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6064 (0.5810)
[INFO] - 03-16 22:05:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3586 (-140.3724)
[INFO] - 03-16 22:05:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6565 (19.6317)
[INFO] - 03-16 22:05:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.9315 (194.1447)
[INFO] - 03-16 22:05:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:05:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9330)
[INFO] - 03-16 22:05:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:05:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:05:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:05:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:05:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:05:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:05:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:05:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.034
[INFO] - 03-16 22:05:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.035
[INFO] - 03-16 22:05:34 - [main.summary_metrics:168]: Epoch 229/300 - Test Results:
{'auc': 0.8564696016771487,
 'f1': 0.416758587324625,
 'loss': 0.44296715556450617,
 'ndcg': 0.7436502835337279,
 'precision': 0.620754716981132,
 'recall': 0.31399371069182386}
[INFO] - 03-16 22:05:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[229] Complete. Time taken: 00:00:50.656
[INFO] - 03-16 22:05:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:05:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:05:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:05:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:05:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:05:34 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7258, 4980, 5126]
[INFO] - 03-16 22:05:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:05:42 - [main.backward:225]: Epoch 230/300 - Iteration 29/199 - Time 0.271 batch, 0.074 data, 0.241 forward
[INFO] - 03-16 22:05:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:05:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0052)
[INFO] - 03-16 22:05:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5957 (0.5899)
[INFO] - 03-16 22:05:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3150 (-140.3411)
[INFO] - 03-16 22:05:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6589 (19.6252)
[INFO] - 03-16 22:05:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.4238 (193.8812)
[INFO] - 03-16 22:05:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:05:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9376)
[INFO] - 03-16 22:05:53 - [main.backward:225]: Epoch 230/300 - Iteration 79/199 - Time 0.244 batch, 0.045 data, 0.215 forward
[INFO] - 03-16 22:05:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0068 (0.0046)
[INFO] - 03-16 22:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5771 (0.5732)
[INFO] - 03-16 22:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3726 (-140.3739)
[INFO] - 03-16 22:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5127 (19.6143)
[INFO] - 03-16 22:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.3303 (194.2547)
[INFO] - 03-16 22:05:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:05:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9445)
[INFO] - 03-16 22:06:05 - [main.backward:225]: Epoch 230/300 - Iteration 129/199 - Time 0.238 batch, 0.038 data, 0.210 forward
[INFO] - 03-16 22:06:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0053)
[INFO] - 03-16 22:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5974 (0.5835)
[INFO] - 03-16 22:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2927 (-140.3472)
[INFO] - 03-16 22:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6679 (19.6073)
[INFO] - 03-16 22:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.7684 (194.4559)
[INFO] - 03-16 22:06:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:06:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9363)
[INFO] - 03-16 22:06:16 - [main.backward:225]: Epoch 230/300 - Iteration 179/199 - Time 0.237 batch, 0.035 data, 0.209 forward
[INFO] - 03-16 22:06:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:06:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0049)
[INFO] - 03-16 22:06:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6063 (0.5830)
[INFO] - 03-16 22:06:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3575 (-140.3712)
[INFO] - 03-16 22:06:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5806 (19.6017)
[INFO] - 03-16 22:06:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.7161 (194.1743)
[INFO] - 03-16 22:06:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:06:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9409)
[INFO] - 03-16 22:06:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:06:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:06:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:06:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:06:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:06:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:06:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:06:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.144
[INFO] - 03-16 22:06:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.145
[INFO] - 03-16 22:06:25 - [main.summary_metrics:168]: Epoch 230/300 - Test Results:
{'auc': 0.865510842505241,
 'f1': 0.43833575229801636,
 'loss': 0.4347492092260524,
 'ndcg': 0.7560593772113001,
 'precision': 0.6528301886792454,
 'recall': 0.33026729559748425}
[INFO] - 03-16 22:06:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[230] Complete. Time taken: 00:00:51.328
[INFO] - 03-16 22:06:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:06:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:06:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:06:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:06:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:06:25 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7203, 4954, 5119]
[INFO] - 03-16 22:06:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:06:33 - [main.backward:225]: Epoch 231/300 - Iteration 30/199 - Time 0.270 batch, 0.070 data, 0.242 forward
[INFO] - 03-16 22:06:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:06:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0048)
[INFO] - 03-16 22:06:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6089 (0.5886)
[INFO] - 03-16 22:06:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3280 (-140.3378)
[INFO] - 03-16 22:06:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5701 (19.5888)
[INFO] - 03-16 22:06:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.4638 (194.0016)
[INFO] - 03-16 22:06:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:06:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9429)
[INFO] - 03-16 22:06:45 - [main.backward:225]: Epoch 231/300 - Iteration 80/199 - Time 0.246 batch, 0.043 data, 0.218 forward
[INFO] - 03-16 22:06:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:06:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0046)
[INFO] - 03-16 22:06:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6049 (0.5728)
[INFO] - 03-16 22:06:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3018 (-140.3715)
[INFO] - 03-16 22:06:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6241 (19.6039)
[INFO] - 03-16 22:06:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.8061 (194.4067)
[INFO] - 03-16 22:06:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:06:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9458)
[INFO] - 03-16 22:06:56 - [main.backward:225]: Epoch 231/300 - Iteration 130/199 - Time 0.238 batch, 0.038 data, 0.210 forward
[INFO] - 03-16 22:06:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0055)
[INFO] - 03-16 22:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6007 (0.5847)
[INFO] - 03-16 22:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2667 (-140.3428)
[INFO] - 03-16 22:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6285 (19.6035)
[INFO] - 03-16 22:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.6124 (194.3742)
[INFO] - 03-16 22:06:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9286)
[INFO] - 03-16 22:07:08 - [main.backward:225]: Epoch 231/300 - Iteration 180/199 - Time 0.234 batch, 0.035 data, 0.207 forward
[INFO] - 03-16 22:07:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:07:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0054)
[INFO] - 03-16 22:07:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6153 (0.5810)
[INFO] - 03-16 22:07:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3329 (-140.3709)
[INFO] - 03-16 22:07:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6191 (19.6104)
[INFO] - 03-16 22:07:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.3378 (194.3980)
[INFO] - 03-16 22:07:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:07:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9330)
[INFO] - 03-16 22:07:12 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:07:12 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:07:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:07:12 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:07:12 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:07:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:07:12 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:07:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.043
[INFO] - 03-16 22:07:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.045
[INFO] - 03-16 22:07:16 - [main.summary_metrics:168]: Epoch 231/300 - Test Results:
{'auc': 0.8640252882599583,
 'f1': 0.43078858248669566,
 'loss': 0.44113034154784,
 'ndcg': 0.7483426253762208,
 'precision': 0.6415094339622642,
 'recall': 0.32460691823899374}
[INFO] - 03-16 22:07:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[231] Complete. Time taken: 00:00:50.618
[INFO] - 03-16 22:07:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:07:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:07:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:07:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:07:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:07:16 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7250, 4955, 5142]
[INFO] - 03-16 22:07:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:07:24 - [main.backward:225]: Epoch 232/300 - Iteration 31/199 - Time 0.264 batch, 0.064 data, 0.238 forward
[INFO] - 03-16 22:07:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:07:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0050)
[INFO] - 03-16 22:07:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5527 (0.5877)
[INFO] - 03-16 22:07:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3460 (-140.3361)
[INFO] - 03-16 22:07:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4963 (19.5850)
[INFO] - 03-16 22:07:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.7517 (193.8184)
[INFO] - 03-16 22:07:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:07:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9399)
[INFO] - 03-16 22:07:35 - [main.backward:225]: Epoch 232/300 - Iteration 81/199 - Time 0.240 batch, 0.040 data, 0.214 forward
[INFO] - 03-16 22:07:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:07:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0064 (0.0048)
[INFO] - 03-16 22:07:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6123 (0.5728)
[INFO] - 03-16 22:07:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2951 (-140.3694)
[INFO] - 03-16 22:07:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6056 (19.6076)
[INFO] - 03-16 22:07:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.9323 (194.3879)
[INFO] - 03-16 22:07:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:07:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9402)
[INFO] - 03-16 22:07:47 - [main.backward:225]: Epoch 232/300 - Iteration 131/199 - Time 0.236 batch, 0.035 data, 0.209 forward
[INFO] - 03-16 22:07:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:07:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0058)
[INFO] - 03-16 22:07:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6155 (0.5832)
[INFO] - 03-16 22:07:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2670 (-140.3390)
[INFO] - 03-16 22:07:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6806 (19.5972)
[INFO] - 03-16 22:07:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.5502 (194.1758)
[INFO] - 03-16 22:07:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:07:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9266)
[INFO] - 03-16 22:07:58 - [main.backward:225]: Epoch 232/300 - Iteration 181/199 - Time 0.232 batch, 0.033 data, 0.206 forward
[INFO] - 03-16 22:07:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:07:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0051)
[INFO] - 03-16 22:07:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5973 (0.5808)
[INFO] - 03-16 22:07:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3376 (-140.3715)
[INFO] - 03-16 22:07:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6037 (19.5807)
[INFO] - 03-16 22:07:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.3363 (193.7075)
[INFO] - 03-16 22:07:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:07:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9367)
[INFO] - 03-16 22:08:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:08:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:08:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:08:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:08:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:08:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:08:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:08:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.927
[INFO] - 03-16 22:08:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.929
[INFO] - 03-16 22:08:06 - [main.summary_metrics:168]: Epoch 232/300 - Test Results:
{'auc': 0.8664325537211739,
 'f1': 0.4395936139332365,
 'loss': 0.44135406574913044,
 'ndcg': 0.7537248069783504,
 'precision': 0.6547169811320755,
 'recall': 0.3312106918238994}
[INFO] - 03-16 22:08:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[232] Complete. Time taken: 00:00:50.045
[INFO] - 03-16 22:08:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:08:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:08:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:08:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:08:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:08:06 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7231, 4982, 5119]
[INFO] - 03-16 22:08:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:08:14 - [main.backward:225]: Epoch 233/300 - Iteration 32/199 - Time 0.261 batch, 0.060 data, 0.235 forward
[INFO] - 03-16 22:08:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0051)
[INFO] - 03-16 22:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5521 (0.5883)
[INFO] - 03-16 22:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3523 (-140.3415)
[INFO] - 03-16 22:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6106 (19.5786)
[INFO] - 03-16 22:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.4747 (193.6600)
[INFO] - 03-16 22:08:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:08:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9386)
[INFO] - 03-16 22:08:25 - [main.backward:225]: Epoch 233/300 - Iteration 82/199 - Time 0.237 batch, 0.040 data, 0.211 forward
[INFO] - 03-16 22:08:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:08:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0045)
[INFO] - 03-16 22:08:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6096 (0.5745)
[INFO] - 03-16 22:08:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2875 (-140.3645)
[INFO] - 03-16 22:08:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5148 (19.5388)
[INFO] - 03-16 22:08:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.0746 (193.8717)
[INFO] - 03-16 22:08:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:08:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9455)
[INFO] - 03-16 22:08:37 - [main.backward:225]: Epoch 233/300 - Iteration 132/199 - Time 0.232 batch, 0.035 data, 0.205 forward
[INFO] - 03-16 22:08:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:08:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0053)
[INFO] - 03-16 22:08:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5916 (0.5841)
[INFO] - 03-16 22:08:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3607 (-140.3386)
[INFO] - 03-16 22:08:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6284 (19.5711)
[INFO] - 03-16 22:08:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.6488 (194.0374)
[INFO] - 03-16 22:08:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:08:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9337)
[INFO] - 03-16 22:08:48 - [main.backward:225]: Epoch 233/300 - Iteration 182/199 - Time 0.232 batch, 0.033 data, 0.205 forward
[INFO] - 03-16 22:08:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0050)
[INFO] - 03-16 22:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5923 (0.5823)
[INFO] - 03-16 22:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3437 (-140.3722)
[INFO] - 03-16 22:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5681 (19.5691)
[INFO] - 03-16 22:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.3287 (193.8356)
[INFO] - 03-16 22:08:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9352)
[INFO] - 03-16 22:08:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:08:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:08:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:08:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:08:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:08:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:08:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:08:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.092
[INFO] - 03-16 22:08:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.093
[INFO] - 03-16 22:08:56 - [main.summary_metrics:168]: Epoch 233/300 - Test Results:
{'auc': 0.8635212591719078,
 'f1': 0.4320464441219158,
 'loss': 0.4422067166894238,
 'ndcg': 0.7561073191880301,
 'precision': 0.6433962264150945,
 'recall': 0.3255503144654089}
[INFO] - 03-16 22:08:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[233] Complete. Time taken: 00:00:50.333
[INFO] - 03-16 22:08:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:08:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:08:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:08:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:08:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:08:56 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7201, 4986, 5147]
[INFO] - 03-16 22:08:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:09:05 - [main.backward:225]: Epoch 234/300 - Iteration 33/199 - Time 0.272 batch, 0.064 data, 0.244 forward
[INFO] - 03-16 22:09:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0050)
[INFO] - 03-16 22:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5613 (0.5883)
[INFO] - 03-16 22:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3390 (-140.3437)
[INFO] - 03-16 22:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5897 (19.5961)
[INFO] - 03-16 22:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 195.0355 (193.4964)
[INFO] - 03-16 22:09:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9409)
[INFO] - 03-16 22:09:17 - [main.backward:225]: Epoch 234/300 - Iteration 83/199 - Time 0.246 batch, 0.042 data, 0.219 forward
[INFO] - 03-16 22:09:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:09:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0047)
[INFO] - 03-16 22:09:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6092 (0.5755)
[INFO] - 03-16 22:09:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2751 (-140.3599)
[INFO] - 03-16 22:09:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5586 (19.6053)
[INFO] - 03-16 22:09:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.0491 (193.9549)
[INFO] - 03-16 22:09:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:09:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9430)
[INFO] - 03-16 22:09:28 - [main.backward:225]: Epoch 234/300 - Iteration 133/199 - Time 0.241 batch, 0.036 data, 0.214 forward
[INFO] - 03-16 22:09:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:09:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0088 (0.0054)
[INFO] - 03-16 22:09:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5808)
[INFO] - 03-16 22:09:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3878 (-140.3400)
[INFO] - 03-16 22:09:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6518 (19.6127)
[INFO] - 03-16 22:09:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.1494 (194.0217)
[INFO] - 03-16 22:09:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:09:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9305)
[INFO] - 03-16 22:09:40 - [main.backward:225]: Epoch 234/300 - Iteration 183/199 - Time 0.238 batch, 0.033 data, 0.211 forward
[INFO] - 03-16 22:09:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:09:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0051)
[INFO] - 03-16 22:09:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5818)
[INFO] - 03-16 22:09:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3396 (-140.3656)
[INFO] - 03-16 22:09:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6646 (19.6277)
[INFO] - 03-16 22:09:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.1905 (193.9274)
[INFO] - 03-16 22:09:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:09:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9347)
[INFO] - 03-16 22:09:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:09:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:09:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:09:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:09:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:09:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:09:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:09:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.999
[INFO] - 03-16 22:09:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.999
[INFO] - 03-16 22:09:48 - [main.summary_metrics:168]: Epoch 234/300 - Test Results:
{'auc': 0.8589257075471697,
 'f1': 0.4270149975810353,
 'loss': 0.43938499070013587,
 'ndcg': 0.7494093410969309,
 'precision': 0.6358490566037737,
 'recall': 0.32177672955974845}
[INFO] - 03-16 22:09:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[234] Complete. Time taken: 00:00:51.189
[INFO] - 03-16 22:09:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:09:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:09:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:09:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:09:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:09:48 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7235, 4981, 5144]
[INFO] - 03-16 22:09:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:09:56 - [main.backward:225]: Epoch 235/300 - Iteration 34/199 - Time 0.260 batch, 0.063 data, 0.231 forward
[INFO] - 03-16 22:09:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0046)
[INFO] - 03-16 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5713 (0.5886)
[INFO] - 03-16 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3598 (-140.3418)
[INFO] - 03-16 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6263 (19.5973)
[INFO] - 03-16 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.7988 (193.4099)
[INFO] - 03-16 22:09:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9461)
[INFO] - 03-16 22:10:08 - [main.backward:225]: Epoch 235/300 - Iteration 84/199 - Time 0.246 batch, 0.041 data, 0.218 forward
[INFO] - 03-16 22:10:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:10:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0047)
[INFO] - 03-16 22:10:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6061 (0.5758)
[INFO] - 03-16 22:10:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2726 (-140.3563)
[INFO] - 03-16 22:10:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5650 (19.5892)
[INFO] - 03-16 22:10:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.1710 (193.5027)
[INFO] - 03-16 22:10:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:10:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9442)
[INFO] - 03-16 22:10:20 - [main.backward:225]: Epoch 235/300 - Iteration 134/199 - Time 0.239 batch, 0.037 data, 0.211 forward
[INFO] - 03-16 22:10:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:10:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0056)
[INFO] - 03-16 22:10:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5904 (0.5819)
[INFO] - 03-16 22:10:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3775 (-140.3413)
[INFO] - 03-16 22:10:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5480 (19.6061)
[INFO] - 03-16 22:10:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.1947 (193.8868)
[INFO] - 03-16 22:10:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:10:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9281)
[INFO] - 03-16 22:10:31 - [main.backward:225]: Epoch 235/300 - Iteration 184/199 - Time 0.236 batch, 0.034 data, 0.208 forward
[INFO] - 03-16 22:10:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:10:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0052)
[INFO] - 03-16 22:10:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5938 (0.5822)
[INFO] - 03-16 22:10:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3168 (-140.3557)
[INFO] - 03-16 22:10:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5658 (19.5680)
[INFO] - 03-16 22:10:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.0339 (193.5863)
[INFO] - 03-16 22:10:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:10:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9317)
[INFO] - 03-16 22:10:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:10:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:10:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:10:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:10:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:10:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:10:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:10:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.062
[INFO] - 03-16 22:10:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.063
[INFO] - 03-16 22:10:39 - [main.summary_metrics:168]: Epoch 235/300 - Test Results:
{'auc': 0.8674844405136268,
 'f1': 0.44292210933720355,
 'loss': 0.43638811278992967,
 'ndcg': 0.7598881806869384,
 'precision': 0.6603773584905662,
 'recall': 0.33349056603773586}
[INFO] - 03-16 22:10:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[235] Complete. Time taken: 00:00:51.358
[INFO] - 03-16 22:10:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:10:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:10:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:10:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:10:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:10:39 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7228, 4980, 5122]
[INFO] - 03-16 22:10:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:10:48 - [main.backward:225]: Epoch 236/300 - Iteration 35/199 - Time 0.254 batch, 0.059 data, 0.228 forward
[INFO] - 03-16 22:10:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:10:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0046)
[INFO] - 03-16 22:10:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5791 (0.5871)
[INFO] - 03-16 22:10:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3689 (-140.3429)
[INFO] - 03-16 22:10:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5707 (19.5748)
[INFO] - 03-16 22:10:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.3364 (193.2296)
[INFO] - 03-16 22:10:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:10:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9494)
[INFO] - 03-16 22:10:59 - [main.backward:225]: Epoch 236/300 - Iteration 85/199 - Time 0.239 batch, 0.040 data, 0.212 forward
[INFO] - 03-16 22:10:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0045)
[INFO] - 03-16 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5926 (0.5784)
[INFO] - 03-16 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2627 (-140.3500)
[INFO] - 03-16 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5869 (19.5706)
[INFO] - 03-16 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.6006 (193.6556)
[INFO] - 03-16 22:10:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9452)
[INFO] - 03-16 22:11:11 - [main.backward:225]: Epoch 236/300 - Iteration 135/199 - Time 0.236 batch, 0.035 data, 0.209 forward
[INFO] - 03-16 22:11:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0050)
[INFO] - 03-16 22:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5965 (0.5806)
[INFO] - 03-16 22:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3752 (-140.3445)
[INFO] - 03-16 22:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4883 (19.5648)
[INFO] - 03-16 22:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.3210 (193.7214)
[INFO] - 03-16 22:11:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:11:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9341)
[INFO] - 03-16 22:11:22 - [main.backward:225]: Epoch 236/300 - Iteration 185/199 - Time 0.234 batch, 0.033 data, 0.207 forward
[INFO] - 03-16 22:11:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:11:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0055)
[INFO] - 03-16 22:11:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6044 (0.5819)
[INFO] - 03-16 22:11:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2757 (-140.3506)
[INFO] - 03-16 22:11:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5847 (19.5580)
[INFO] - 03-16 22:11:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.4620 (193.4706)
[INFO] - 03-16 22:11:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:11:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9305)
[INFO] - 03-16 22:11:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:11:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:11:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:11:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:11:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:11:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:11:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:11:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.044
[INFO] - 03-16 22:11:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.047
[INFO] - 03-16 22:11:29 - [main.summary_metrics:168]: Epoch 236/300 - Test Results:
{'auc': 0.8567305096960168,
 'f1': 0.43053701015965157,
 'loss': 0.44038792305872376,
 'ndcg': 0.7434491206876921,
 'precision': 0.6415094339622641,
 'recall': 0.3242924528301887}
[INFO] - 03-16 22:11:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[236] Complete. Time taken: 00:00:50.525
[INFO] - 03-16 22:11:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:11:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:11:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:11:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:11:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:11:29 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7217, 4996, 5144]
[INFO] - 03-16 22:11:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:11:39 - [main.backward:225]: Epoch 237/300 - Iteration 36/199 - Time 0.258 batch, 0.059 data, 0.230 forward
[INFO] - 03-16 22:11:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:11:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0045)
[INFO] - 03-16 22:11:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5885)
[INFO] - 03-16 22:11:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3600 (-140.3430)
[INFO] - 03-16 22:11:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5771 (19.5856)
[INFO] - 03-16 22:11:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.4755 (193.2685)
[INFO] - 03-16 22:11:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:11:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9453)
[INFO] - 03-16 22:11:50 - [main.backward:225]: Epoch 237/300 - Iteration 86/199 - Time 0.239 batch, 0.041 data, 0.212 forward
[INFO] - 03-16 22:11:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:11:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0045)
[INFO] - 03-16 22:11:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6166 (0.5776)
[INFO] - 03-16 22:11:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2555 (-140.3436)
[INFO] - 03-16 22:11:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5624 (19.5814)
[INFO] - 03-16 22:11:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.7326 (193.7038)
[INFO] - 03-16 22:11:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:11:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9453)
[INFO] - 03-16 22:12:02 - [main.backward:225]: Epoch 237/300 - Iteration 136/199 - Time 0.237 batch, 0.036 data, 0.210 forward
[INFO] - 03-16 22:12:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:12:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0050)
[INFO] - 03-16 22:12:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6072 (0.5820)
[INFO] - 03-16 22:12:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3198 (-140.3450)
[INFO] - 03-16 22:12:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4911 (19.5673)
[INFO] - 03-16 22:12:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.5699 (193.9226)
[INFO] - 03-16 22:12:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:12:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9369)
[INFO] - 03-16 22:12:13 - [main.backward:225]: Epoch 237/300 - Iteration 186/199 - Time 0.235 batch, 0.034 data, 0.207 forward
[INFO] - 03-16 22:12:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:12:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0051)
[INFO] - 03-16 22:12:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5982 (0.5817)
[INFO] - 03-16 22:12:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2542 (-140.3457)
[INFO] - 03-16 22:12:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5992 (19.5771)
[INFO] - 03-16 22:12:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.6646 (193.7917)
[INFO] - 03-16 22:12:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:12:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9350)
[INFO] - 03-16 22:12:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:12:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:12:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:12:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:12:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:12:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:12:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:12:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.051
[INFO] - 03-16 22:12:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.052
[INFO] - 03-16 22:12:20 - [main.summary_metrics:168]: Epoch 237/300 - Test Results:
{'auc': 0.8696173021488469,
 'f1': 0.45091436865021767,
 'loss': 0.43702421704178335,
 'ndcg': 0.7640645322820027,
 'precision': 0.6716981132075472,
 'recall': 0.33970125786163524}
[INFO] - 03-16 22:12:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[237] Complete. Time taken: 00:00:50.712
[INFO] - 03-16 22:12:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:12:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:12:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:12:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:12:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:12:20 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7244, 4998, 5118]
[INFO] - 03-16 22:12:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:12:29 - [main.backward:225]: Epoch 238/300 - Iteration 37/199 - Time 0.251 batch, 0.057 data, 0.224 forward
[INFO] - 03-16 22:12:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0045)
[INFO] - 03-16 22:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5940 (0.5882)
[INFO] - 03-16 22:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3420 (-140.3407)
[INFO] - 03-16 22:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5018 (19.5360)
[INFO] - 03-16 22:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.9596 (193.1396)
[INFO] - 03-16 22:12:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:12:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9498)
[INFO] - 03-16 22:12:41 - [main.backward:225]: Epoch 238/300 - Iteration 87/199 - Time 0.235 batch, 0.040 data, 0.207 forward
[INFO] - 03-16 22:12:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:12:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0043)
[INFO] - 03-16 22:12:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5688 (0.5784)
[INFO] - 03-16 22:12:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3728 (-140.3452)
[INFO] - 03-16 22:12:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6013 (19.5537)
[INFO] - 03-16 22:12:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.8476 (193.6991)
[INFO] - 03-16 22:12:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:12:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9500)
[INFO] - 03-16 22:12:52 - [main.backward:225]: Epoch 238/300 - Iteration 137/199 - Time 0.231 batch, 0.035 data, 0.204 forward
[INFO] - 03-16 22:12:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:12:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0083 (0.0052)
[INFO] - 03-16 22:12:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5823)
[INFO] - 03-16 22:12:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3088 (-140.3416)
[INFO] - 03-16 22:12:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5488 (19.5657)
[INFO] - 03-16 22:12:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.3707 (193.6265)
[INFO] - 03-16 22:12:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:12:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9358)
[INFO] - 03-16 22:13:03 - [main.backward:225]: Epoch 238/300 - Iteration 187/199 - Time 0.231 batch, 0.033 data, 0.204 forward
[INFO] - 03-16 22:13:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0050)
[INFO] - 03-16 22:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6081 (0.5821)
[INFO] - 03-16 22:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2652 (-140.3420)
[INFO] - 03-16 22:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4972 (19.5564)
[INFO] - 03-16 22:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.9918 (193.1051)
[INFO] - 03-16 22:13:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:13:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9392)
[INFO] - 03-16 22:13:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:13:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:13:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:13:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:13:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:13:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:13:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:13:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.953
[INFO] - 03-16 22:13:10 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.954
[INFO] - 03-16 22:13:10 - [main.summary_metrics:168]: Epoch 238/300 - Test Results:
{'auc': 0.8691520898846959,
 'f1': 0.44714078374455724,
 'loss': 0.4327864159398108,
 'ndcg': 0.7661549517907867,
 'precision': 0.6660377358490566,
 'recall': 0.33687106918238996}
[INFO] - 03-16 22:13:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[238] Complete. Time taken: 00:00:49.899
[INFO] - 03-16 22:13:10 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:13:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:13:10 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:13:10 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:13:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:13:10 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7236, 5007, 5133]
[INFO] - 03-16 22:13:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:13:20 - [main.backward:225]: Epoch 239/300 - Iteration 38/199 - Time 0.256 batch, 0.059 data, 0.230 forward
[INFO] - 03-16 22:13:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:13:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0045)
[INFO] - 03-16 22:13:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5905 (0.5871)
[INFO] - 03-16 22:13:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3422 (-140.3417)
[INFO] - 03-16 22:13:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5136 (19.5161)
[INFO] - 03-16 22:13:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.8430 (192.9298)
[INFO] - 03-16 22:13:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:13:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9501)
[INFO] - 03-16 22:13:31 - [main.backward:225]: Epoch 239/300 - Iteration 88/199 - Time 0.240 batch, 0.042 data, 0.213 forward
[INFO] - 03-16 22:13:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:13:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0045)
[INFO] - 03-16 22:13:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5663 (0.5765)
[INFO] - 03-16 22:13:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4124 (-140.3471)
[INFO] - 03-16 22:13:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5090 (19.5697)
[INFO] - 03-16 22:13:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.9898 (193.7289)
[INFO] - 03-16 22:13:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:13:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9452)
[INFO] - 03-16 22:13:43 - [main.backward:225]: Epoch 239/300 - Iteration 138/199 - Time 0.235 batch, 0.036 data, 0.209 forward
[INFO] - 03-16 22:13:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:13:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0052)
[INFO] - 03-16 22:13:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5931 (0.5822)
[INFO] - 03-16 22:13:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3032 (-140.3428)
[INFO] - 03-16 22:13:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4711 (19.5288)
[INFO] - 03-16 22:13:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.7525 (193.6247)
[INFO] - 03-16 22:13:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:13:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9325)
[INFO] - 03-16 22:13:54 - [main.backward:225]: Epoch 239/300 - Iteration 188/199 - Time 0.234 batch, 0.034 data, 0.207 forward
[INFO] - 03-16 22:13:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:13:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0050)
[INFO] - 03-16 22:13:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6104 (0.5826)
[INFO] - 03-16 22:13:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2651 (-140.3419)
[INFO] - 03-16 22:13:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6009 (19.5771)
[INFO] - 03-16 22:13:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.4319 (193.6966)
[INFO] - 03-16 22:13:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:13:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9380)
[INFO] - 03-16 22:13:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:13:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:13:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:13:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:13:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:13:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:13:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:14:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.326
[INFO] - 03-16 22:14:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.326
[INFO] - 03-16 22:14:01 - [main.summary_metrics:168]: Epoch 239/300 - Test Results:
{'auc': 0.8627775812368973,
 'f1': 0.4408514755684566,
 'loss': 0.43859986418398167,
 'ndcg': 0.755941333398489,
 'precision': 0.6566037735849057,
 'recall': 0.33215408805031443}
[INFO] - 03-16 22:14:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[239] Complete. Time taken: 00:00:50.795
[INFO] - 03-16 22:14:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:14:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:14:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:14:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:14:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:14:01 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7241, 4981, 5106]
[INFO] - 03-16 22:14:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:14:11 - [main.backward:225]: Epoch 240/300 - Iteration 39/199 - Time 0.259 batch, 0.058 data, 0.232 forward
[INFO] - 03-16 22:14:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:14:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0046)
[INFO] - 03-16 22:14:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5891 (0.5857)
[INFO] - 03-16 22:14:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2968 (-140.3454)
[INFO] - 03-16 22:14:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6167 (19.5791)
[INFO] - 03-16 22:14:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.4564 (193.1306)
[INFO] - 03-16 22:14:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:14:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9428)
[INFO] - 03-16 22:14:22 - [main.backward:225]: Epoch 240/300 - Iteration 89/199 - Time 0.243 batch, 0.041 data, 0.215 forward
[INFO] - 03-16 22:14:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:14:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0044)
[INFO] - 03-16 22:14:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5506 (0.5758)
[INFO] - 03-16 22:14:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3783 (-140.3461)
[INFO] - 03-16 22:14:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6319 (19.5721)
[INFO] - 03-16 22:14:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.9931 (193.4644)
[INFO] - 03-16 22:14:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:14:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9480)
[INFO] - 03-16 22:14:33 - [main.backward:225]: Epoch 240/300 - Iteration 139/199 - Time 0.231 batch, 0.036 data, 0.204 forward
[INFO] - 03-16 22:14:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:14:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0064 (0.0052)
[INFO] - 03-16 22:14:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5817 (0.5828)
[INFO] - 03-16 22:14:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3186 (-140.3383)
[INFO] - 03-16 22:14:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4811 (19.5404)
[INFO] - 03-16 22:14:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.5341 (193.6006)
[INFO] - 03-16 22:14:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:14:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9342)
[INFO] - 03-16 22:14:43 - [main.backward:225]: Epoch 240/300 - Iteration 189/199 - Time 0.222 batch, 0.033 data, 0.196 forward
[INFO] - 03-16 22:14:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:14:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0053)
[INFO] - 03-16 22:14:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6079 (0.5817)
[INFO] - 03-16 22:14:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2568 (-140.3417)
[INFO] - 03-16 22:14:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4517 (19.5436)
[INFO] - 03-16 22:14:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.2263 (193.2829)
[INFO] - 03-16 22:14:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:14:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9350)
[INFO] - 03-16 22:14:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:14:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:14:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:14:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:14:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:14:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:14:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:14:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.400
[INFO] - 03-16 22:14:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.401
[INFO] - 03-16 22:14:48 - [main.summary_metrics:168]: Epoch 240/300 - Test Results:
{'auc': 0.8624343881027253,
 'f1': 0.43833575229801636,
 'loss': 0.4339088479647845,
 'ndcg': 0.7514788606507101,
 'precision': 0.6528301886792454,
 'recall': 0.33026729559748425}
[INFO] - 03-16 22:14:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[240] Complete. Time taken: 00:00:47.493
[INFO] - 03-16 22:14:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:14:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:14:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:14:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:14:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:14:48 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7207, 4979, 5109]
[INFO] - 03-16 22:14:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:14:57 - [main.backward:225]: Epoch 241/300 - Iteration 40/199 - Time 0.223 batch, 0.046 data, 0.199 forward
[INFO] - 03-16 22:14:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:14:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0048)
[INFO] - 03-16 22:14:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5803 (0.5862)
[INFO] - 03-16 22:14:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2949 (-140.3437)
[INFO] - 03-16 22:14:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5818 (19.5617)
[INFO] - 03-16 22:14:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.9569 (192.9317)
[INFO] - 03-16 22:14:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:14:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9406)
[INFO] - 03-16 22:15:07 - [main.backward:225]: Epoch 241/300 - Iteration 90/199 - Time 0.205 batch, 0.034 data, 0.181 forward
[INFO] - 03-16 22:15:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:15:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0045)
[INFO] - 03-16 22:15:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5569 (0.5752)
[INFO] - 03-16 22:15:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3762 (-140.3460)
[INFO] - 03-16 22:15:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5970 (19.5643)
[INFO] - 03-16 22:15:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.2026 (193.2462)
[INFO] - 03-16 22:15:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:15:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9477)
[INFO] - 03-16 22:15:16 - [main.backward:225]: Epoch 241/300 - Iteration 140/199 - Time 0.201 batch, 0.030 data, 0.177 forward
[INFO] - 03-16 22:15:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:15:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0053)
[INFO] - 03-16 22:15:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5651 (0.5827)
[INFO] - 03-16 22:15:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3750 (-140.3317)
[INFO] - 03-16 22:15:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5359 (19.5190)
[INFO] - 03-16 22:15:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.5566 (193.2645)
[INFO] - 03-16 22:15:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:15:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9344)
[INFO] - 03-16 22:15:27 - [main.backward:225]: Epoch 241/300 - Iteration 190/199 - Time 0.202 batch, 0.029 data, 0.178 forward
[INFO] - 03-16 22:15:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:15:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0057)
[INFO] - 03-16 22:15:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5989 (0.5822)
[INFO] - 03-16 22:15:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2644 (-140.3304)
[INFO] - 03-16 22:15:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.7007 (19.5903)
[INFO] - 03-16 22:15:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 194.1614 (193.2928)
[INFO] - 03-16 22:15:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:15:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9273)
[INFO] - 03-16 22:15:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:15:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:15:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:15:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:15:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:15:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:15:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:15:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.403
[INFO] - 03-16 22:15:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.404
[INFO] - 03-16 22:15:32 - [main.summary_metrics:168]: Epoch 241/300 - Test Results:
{'auc': 0.8721803262578617,
 'f1': 0.4584615384615385,
 'loss': 0.43440000364515513,
 'ndcg': 0.777259307874589,
 'precision': 0.6830188679245284,
 'recall': 0.3453616352201258}
[INFO] - 03-16 22:15:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[241] Complete. Time taken: 00:00:43.534
[INFO] - 03-16 22:15:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:15:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:15:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:15:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:15:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:15:32 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7274, 4968, 5135]
[INFO] - 03-16 22:15:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:15:41 - [main.backward:225]: Epoch 242/300 - Iteration 41/199 - Time 0.227 batch, 0.054 data, 0.202 forward
[INFO] - 03-16 22:15:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0044)
[INFO] - 03-16 22:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5848)
[INFO] - 03-16 22:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2829 (-140.3332)
[INFO] - 03-16 22:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5529 (19.5579)
[INFO] - 03-16 22:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.0438 (192.9124)
[INFO] - 03-16 22:15:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9510)
[INFO] - 03-16 22:15:52 - [main.backward:225]: Epoch 242/300 - Iteration 91/199 - Time 0.217 batch, 0.038 data, 0.191 forward
[INFO] - 03-16 22:15:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:15:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0044)
[INFO] - 03-16 22:15:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5658 (0.5756)
[INFO] - 03-16 22:15:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3875 (-140.3376)
[INFO] - 03-16 22:15:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5299 (19.5644)
[INFO] - 03-16 22:15:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.7710 (193.4589)
[INFO] - 03-16 22:15:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:15:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9455)
[INFO] - 03-16 22:16:01 - [main.backward:225]: Epoch 242/300 - Iteration 141/199 - Time 0.210 batch, 0.034 data, 0.184 forward
[INFO] - 03-16 22:16:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:16:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0050)
[INFO] - 03-16 22:16:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5695 (0.5835)
[INFO] - 03-16 22:16:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3884 (-140.3229)
[INFO] - 03-16 22:16:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4735 (19.5580)
[INFO] - 03-16 22:16:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.7448 (193.2002)
[INFO] - 03-16 22:16:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:16:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9395)
[INFO] - 03-16 22:16:12 - [main.backward:225]: Epoch 242/300 - Iteration 191/199 - Time 0.208 batch, 0.031 data, 0.183 forward
[INFO] - 03-16 22:16:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0055)
[INFO] - 03-16 22:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6107 (0.5845)
[INFO] - 03-16 22:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2413 (-140.3205)
[INFO] - 03-16 22:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5538 (19.5333)
[INFO] - 03-16 22:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.5695 (192.7980)
[INFO] - 03-16 22:16:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:16:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9277)
[INFO] - 03-16 22:16:13 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:16:13 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:16:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:16:13 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:16:13 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:16:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:16:13 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:16:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.571
[INFO] - 03-16 22:16:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.572
[INFO] - 03-16 22:16:17 - [main.summary_metrics:168]: Epoch 242/300 - Test Results:
{'auc': 0.862430915880503,
 'f1': 0.443115626511853,
 'loss': 0.44030743377413634,
 'ndcg': 0.7582674197979853,
 'precision': 0.6603773584905659,
 'recall': 0.33372641509433953}
[INFO] - 03-16 22:16:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[242] Complete. Time taken: 00:00:44.902
[INFO] - 03-16 22:16:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:16:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:16:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:16:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:16:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:16:17 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7226, 5023, 5119]
[INFO] - 03-16 22:16:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:16:26 - [main.backward:225]: Epoch 243/300 - Iteration 42/199 - Time 0.217 batch, 0.045 data, 0.192 forward
[INFO] - 03-16 22:16:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:16:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0047)
[INFO] - 03-16 22:16:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6042 (0.5846)
[INFO] - 03-16 22:16:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2880 (-140.3243)
[INFO] - 03-16 22:16:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4467 (19.4651)
[INFO] - 03-16 22:16:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.3691 (192.4460)
[INFO] - 03-16 22:16:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:16:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9460)
[INFO] - 03-16 22:16:35 - [main.backward:225]: Epoch 243/300 - Iteration 92/199 - Time 0.203 batch, 0.033 data, 0.179 forward
[INFO] - 03-16 22:16:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:16:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0047)
[INFO] - 03-16 22:16:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5794 (0.5743)
[INFO] - 03-16 22:16:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3767 (-140.3300)
[INFO] - 03-16 22:16:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4701 (19.4802)
[INFO] - 03-16 22:16:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.2318 (192.9750)
[INFO] - 03-16 22:16:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:16:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9408)
[INFO] - 03-16 22:16:46 - [main.backward:225]: Epoch 243/300 - Iteration 142/199 - Time 0.203 batch, 0.031 data, 0.178 forward
[INFO] - 03-16 22:16:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0049)
[INFO] - 03-16 22:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5576 (0.5825)
[INFO] - 03-16 22:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.4048 (-140.3123)
[INFO] - 03-16 22:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4451 (19.4731)
[INFO] - 03-16 22:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.2581 (193.0838)
[INFO] - 03-16 22:16:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9403)
[INFO] - 03-16 22:16:56 - [main.backward:225]: Epoch 243/300 - Iteration 192/199 - Time 0.206 batch, 0.029 data, 0.181 forward
[INFO] - 03-16 22:16:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:16:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0052)
[INFO] - 03-16 22:16:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6074 (0.5852)
[INFO] - 03-16 22:16:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2880 (-140.3045)
[INFO] - 03-16 22:16:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5437 (19.5318)
[INFO] - 03-16 22:16:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.6974 (192.7005)
[INFO] - 03-16 22:16:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:16:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9353)
[INFO] - 03-16 22:16:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:16:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:16:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:16:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:16:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:16:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:16:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:17:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.743
[INFO] - 03-16 22:17:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.744
[INFO] - 03-16 22:17:01 - [main.summary_metrics:168]: Epoch 243/300 - Test Results:
{'auc': 0.8621965408805031,
 'f1': 0.4345621673923561,
 'loss': 0.43562027782864043,
 'ndcg': 0.761510095615536,
 'precision': 0.6471698113207547,
 'recall': 0.32743710691823896}
[INFO] - 03-16 22:17:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[243] Complete. Time taken: 00:00:44.674
[INFO] - 03-16 22:17:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:17:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:17:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:17:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:17:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:17:01 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7234, 4986, 5129]
[INFO] - 03-16 22:17:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:17:11 - [main.backward:225]: Epoch 244/300 - Iteration 43/199 - Time 0.220 batch, 0.045 data, 0.195 forward
[INFO] - 03-16 22:17:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:17:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0048)
[INFO] - 03-16 22:17:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5844)
[INFO] - 03-16 22:17:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2851 (-140.3093)
[INFO] - 03-16 22:17:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6670 (19.5402)
[INFO] - 03-16 22:17:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.9351 (192.5542)
[INFO] - 03-16 22:17:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:17:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9433)
[INFO] - 03-16 22:17:21 - [main.backward:225]: Epoch 244/300 - Iteration 93/199 - Time 0.214 batch, 0.034 data, 0.189 forward
[INFO] - 03-16 22:17:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0043)
[INFO] - 03-16 22:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5806 (0.5743)
[INFO] - 03-16 22:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3616 (-140.3227)
[INFO] - 03-16 22:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4942 (19.5252)
[INFO] - 03-16 22:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.9648 (192.9257)
[INFO] - 03-16 22:17:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:17:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9511)
[INFO] - 03-16 22:17:31 - [main.backward:225]: Epoch 244/300 - Iteration 143/199 - Time 0.207 batch, 0.031 data, 0.182 forward
[INFO] - 03-16 22:17:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:17:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0047)
[INFO] - 03-16 22:17:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5917 (0.5828)
[INFO] - 03-16 22:17:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3160 (-140.2978)
[INFO] - 03-16 22:17:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4087 (19.4901)
[INFO] - 03-16 22:17:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.1832 (192.9545)
[INFO] - 03-16 22:17:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:17:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9409)
[INFO] - 03-16 22:17:41 - [main.backward:225]: Epoch 244/300 - Iteration 193/199 - Time 0.206 batch, 0.029 data, 0.182 forward
[INFO] - 03-16 22:17:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0051)
[INFO] - 03-16 22:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5865 (0.5834)
[INFO] - 03-16 22:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2984 (-140.2900)
[INFO] - 03-16 22:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4922 (19.4744)
[INFO] - 03-16 22:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.7566 (192.7765)
[INFO] - 03-16 22:17:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:17:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9366)
[INFO] - 03-16 22:17:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:17:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:17:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:17:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:17:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:17:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:17:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:17:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.966
[INFO] - 03-16 22:17:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.966
[INFO] - 03-16 22:17:45 - [main.summary_metrics:168]: Epoch 244/300 - Test Results:
{'auc': 0.8710384564989518,
 'f1': 0.4456313497822932,
 'loss': 0.43144636059407165,
 'ndcg': 0.7695910017688418,
 'precision': 0.6641509433962264,
 'recall': 0.3356132075471698}
[INFO] - 03-16 22:17:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[244] Complete. Time taken: 00:00:43.985
[INFO] - 03-16 22:17:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:17:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:17:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:17:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:17:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:17:45 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7254, 4984, 5115]
[INFO] - 03-16 22:17:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:17:55 - [main.backward:225]: Epoch 245/300 - Iteration 44/199 - Time 0.227 batch, 0.046 data, 0.204 forward
[INFO] - 03-16 22:17:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0046)
[INFO] - 03-16 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5907 (0.5843)
[INFO] - 03-16 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2555 (-140.2987)
[INFO] - 03-16 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5406 (19.4915)
[INFO] - 03-16 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.7368 (192.8100)
[INFO] - 03-16 22:17:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9434)
[INFO] - 03-16 22:18:05 - [main.backward:225]: Epoch 245/300 - Iteration 94/199 - Time 0.212 batch, 0.035 data, 0.188 forward
[INFO] - 03-16 22:18:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:18:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0045)
[INFO] - 03-16 22:18:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5953 (0.5753)
[INFO] - 03-16 22:18:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3240 (-140.3124)
[INFO] - 03-16 22:18:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4605 (19.5095)
[INFO] - 03-16 22:18:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.0459 (193.0465)
[INFO] - 03-16 22:18:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:18:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9458)
[INFO] - 03-16 22:18:16 - [main.backward:225]: Epoch 245/300 - Iteration 144/199 - Time 0.210 batch, 0.031 data, 0.186 forward
[INFO] - 03-16 22:18:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0057 (0.0048)
[INFO] - 03-16 22:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6172 (0.5838)
[INFO] - 03-16 22:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2135 (-140.2850)
[INFO] - 03-16 22:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6280 (19.4833)
[INFO] - 03-16 22:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.0248 (193.0351)
[INFO] - 03-16 22:18:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9402)
[INFO] - 03-16 22:18:26 - [main.backward:225]: Epoch 245/300 - Iteration 194/199 - Time 0.207 batch, 0.030 data, 0.183 forward
[INFO] - 03-16 22:18:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:18:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0054)
[INFO] - 03-16 22:18:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5984 (0.5856)
[INFO] - 03-16 22:18:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2808 (-140.2789)
[INFO] - 03-16 22:18:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4950 (19.4846)
[INFO] - 03-16 22:18:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.1709 (193.1393)
[INFO] - 03-16 22:18:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:18:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9309)
[INFO] - 03-16 22:18:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:18:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:18:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:18:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:18:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:18:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:18:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:18:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.524
[INFO] - 03-16 22:18:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.525
[INFO] - 03-16 22:18:30 - [main.summary_metrics:168]: Epoch 245/300 - Test Results:
{'auc': 0.8740184093291404,
 'f1': 0.4496565070149976,
 'loss': 0.4329252990466744,
 'ndcg': 0.7722880407532925,
 'precision': 0.6698113207547168,
 'recall': 0.33875786163522004}
[INFO] - 03-16 22:18:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[245] Complete. Time taken: 00:00:44.689
[INFO] - 03-16 22:18:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:18:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:18:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:18:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:18:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:18:30 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7234, 5003, 5123]
[INFO] - 03-16 22:18:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:18:40 - [main.backward:225]: Epoch 246/300 - Iteration 45/199 - Time 0.225 batch, 0.049 data, 0.199 forward
[INFO] - 03-16 22:18:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0046)
[INFO] - 03-16 22:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5938 (0.5843)
[INFO] - 03-16 22:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2688 (-140.2883)
[INFO] - 03-16 22:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5654 (19.5143)
[INFO] - 03-16 22:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.4792 (192.8379)
[INFO] - 03-16 22:18:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:18:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9477)
[INFO] - 03-16 22:18:50 - [main.backward:225]: Epoch 246/300 - Iteration 95/199 - Time 0.213 batch, 0.036 data, 0.188 forward
[INFO] - 03-16 22:18:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0044)
[INFO] - 03-16 22:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5948 (0.5748)
[INFO] - 03-16 22:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2263 (-140.2963)
[INFO] - 03-16 22:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5310 (19.4916)
[INFO] - 03-16 22:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.2469 (192.9602)
[INFO] - 03-16 22:18:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9489)
[INFO] - 03-16 22:19:00 - [main.backward:225]: Epoch 246/300 - Iteration 145/199 - Time 0.205 batch, 0.032 data, 0.181 forward
[INFO] - 03-16 22:19:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:19:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0064 (0.0049)
[INFO] - 03-16 22:19:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6221 (0.5840)
[INFO] - 03-16 22:19:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2128 (-140.2683)
[INFO] - 03-16 22:19:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5121 (19.4693)
[INFO] - 03-16 22:19:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.6069 (192.8975)
[INFO] - 03-16 22:19:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:19:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9384)
[INFO] - 03-16 22:19:10 - [main.backward:225]: Epoch 246/300 - Iteration 195/199 - Time 0.203 batch, 0.030 data, 0.179 forward
[INFO] - 03-16 22:19:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:19:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0048)
[INFO] - 03-16 22:19:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5827 (0.5835)
[INFO] - 03-16 22:19:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2825 (-140.2681)
[INFO] - 03-16 22:19:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4363 (19.4967)
[INFO] - 03-16 22:19:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.9257 (192.7504)
[INFO] - 03-16 22:19:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:19:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9428)
[INFO] - 03-16 22:19:11 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:19:11 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:19:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:19:11 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:19:11 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:19:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:19:11 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:19:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.282
[INFO] - 03-16 22:19:14 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.282
[INFO] - 03-16 22:19:14 - [main.summary_metrics:168]: Epoch 246/300 - Test Results:
{'auc': 0.8683795204402516,
 'f1': 0.45192065795839376,
 'loss': 0.43313493168429007,
 'ndcg': 0.7745890428515835,
 'precision': 0.6735849056603773,
 'recall': 0.34033018867924525}
[INFO] - 03-16 22:19:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[246] Complete. Time taken: 00:00:43.714
[INFO] - 03-16 22:19:14 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:19:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:19:14 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:19:14 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:19:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:19:14 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7218, 4979, 5159]
[INFO] - 03-16 22:19:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:19:24 - [main.backward:225]: Epoch 247/300 - Iteration 46/199 - Time 0.227 batch, 0.049 data, 0.202 forward
[INFO] - 03-16 22:19:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0048)
[INFO] - 03-16 22:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5273 (0.5832)
[INFO] - 03-16 22:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3763 (-140.2781)
[INFO] - 03-16 22:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5100 (19.4796)
[INFO] - 03-16 22:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.2064 (192.3998)
[INFO] - 03-16 22:19:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9444)
[INFO] - 03-16 22:19:34 - [main.backward:225]: Epoch 247/300 - Iteration 96/199 - Time 0.211 batch, 0.037 data, 0.185 forward
[INFO] - 03-16 22:19:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:19:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0044)
[INFO] - 03-16 22:19:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6129 (0.5774)
[INFO] - 03-16 22:19:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2153 (-140.2860)
[INFO] - 03-16 22:19:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5152 (19.4818)
[INFO] - 03-16 22:19:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.5045 (192.9536)
[INFO] - 03-16 22:19:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:19:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9480)
[INFO] - 03-16 22:19:44 - [main.backward:225]: Epoch 247/300 - Iteration 146/199 - Time 0.208 batch, 0.033 data, 0.182 forward
[INFO] - 03-16 22:19:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0049)
[INFO] - 03-16 22:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6287 (0.5836)
[INFO] - 03-16 22:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1658 (-140.2577)
[INFO] - 03-16 22:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5569 (19.4447)
[INFO] - 03-16 22:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.8187 (192.8818)
[INFO] - 03-16 22:19:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9372)
[INFO] - 03-16 22:19:54 - [main.backward:225]: Epoch 247/300 - Iteration 196/199 - Time 0.206 batch, 0.031 data, 0.180 forward
[INFO] - 03-16 22:19:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:19:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0048)
[INFO] - 03-16 22:19:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6105 (0.5844)
[INFO] - 03-16 22:19:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2762 (-140.2633)
[INFO] - 03-16 22:19:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3142 (19.4663)
[INFO] - 03-16 22:19:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.8772 (192.4674)
[INFO] - 03-16 22:19:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:19:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9403)
[INFO] - 03-16 22:19:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:19:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:19:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:19:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:19:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:19:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:19:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:19:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.267
[INFO] - 03-16 22:19:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.268
[INFO] - 03-16 22:19:58 - [main.summary_metrics:168]: Epoch 247/300 - Test Results:
{'auc': 0.870713967505241,
 'f1': 0.44789550072568934,
 'loss': 0.4282564387331469,
 'ndcg': 0.7738338560968292,
 'precision': 0.6679245283018869,
 'recall': 0.337185534591195}
[INFO] - 03-16 22:19:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[247] Complete. Time taken: 00:00:44.295
[INFO] - 03-16 22:19:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:19:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:19:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:19:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:19:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:19:58 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7233, 5007, 5158]
[INFO] - 03-16 22:19:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:20:08 - [main.backward:225]: Epoch 248/300 - Iteration 47/199 - Time 0.217 batch, 0.044 data, 0.191 forward
[INFO] - 03-16 22:20:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0042)
[INFO] - 03-16 22:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5273 (0.5810)
[INFO] - 03-16 22:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3584 (-140.2745)
[INFO] - 03-16 22:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4774 (19.4889)
[INFO] - 03-16 22:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6889 (192.2298)
[INFO] - 03-16 22:20:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9482)
[INFO] - 03-16 22:20:18 - [main.backward:225]: Epoch 248/300 - Iteration 97/199 - Time 0.207 batch, 0.035 data, 0.180 forward
[INFO] - 03-16 22:20:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:20:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0047)
[INFO] - 03-16 22:20:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5942 (0.5791)
[INFO] - 03-16 22:20:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2087 (-140.2750)
[INFO] - 03-16 22:20:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.6020 (19.5085)
[INFO] - 03-16 22:20:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.3505 (192.7436)
[INFO] - 03-16 22:20:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:20:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9422)
[INFO] - 03-16 22:20:28 - [main.backward:225]: Epoch 248/300 - Iteration 147/199 - Time 0.200 batch, 0.032 data, 0.174 forward
[INFO] - 03-16 22:20:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:20:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0051)
[INFO] - 03-16 22:20:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5938 (0.5838)
[INFO] - 03-16 22:20:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2920 (-140.2522)
[INFO] - 03-16 22:20:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5075 (19.4178)
[INFO] - 03-16 22:20:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.8395 (192.4080)
[INFO] - 03-16 22:20:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:20:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9367)
[INFO] - 03-16 22:20:38 - [main.backward:225]: Epoch 248/300 - Iteration 197/199 - Time 0.201 batch, 0.030 data, 0.175 forward
[INFO] - 03-16 22:20:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:20:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0047)
[INFO] - 03-16 22:20:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6090 (0.5835)
[INFO] - 03-16 22:20:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2535 (-140.2522)
[INFO] - 03-16 22:20:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4082 (19.4374)
[INFO] - 03-16 22:20:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.0568 (192.2069)
[INFO] - 03-16 22:20:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:20:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9469)
[INFO] - 03-16 22:20:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:20:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:20:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:20:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:20:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:20:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:20:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:20:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.100
[INFO] - 03-16 22:20:41 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.102
[INFO] - 03-16 22:20:41 - [main.summary_metrics:168]: Epoch 248/300 - Test Results:
{'auc': 0.8687393867924528,
 'f1': 0.4468892114175133,
 'loss': 0.433056626065972,
 'ndcg': 0.7749955935811541,
 'precision': 0.6660377358490566,
 'recall': 0.3365566037735849}
[INFO] - 03-16 22:20:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[248] Complete. Time taken: 00:00:43.117
[INFO] - 03-16 22:20:41 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:20:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:20:41 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:20:41 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:20:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:20:41 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7213, 4973, 5125]
[INFO] - 03-16 22:20:42 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:20:52 - [main.backward:225]: Epoch 249/300 - Iteration 48/199 - Time 0.217 batch, 0.042 data, 0.193 forward
[INFO] - 03-16 22:20:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:20:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0041)
[INFO] - 03-16 22:20:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.4977 (0.5786)
[INFO] - 03-16 22:20:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3856 (-140.2682)
[INFO] - 03-16 22:20:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4470 (19.4501)
[INFO] - 03-16 22:20:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.8598 (191.9893)
[INFO] - 03-16 22:20:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:20:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9561)
[INFO] - 03-16 22:21:01 - [main.backward:225]: Epoch 249/300 - Iteration 98/199 - Time 0.201 batch, 0.033 data, 0.176 forward
[INFO] - 03-16 22:21:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:21:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0044)
[INFO] - 03-16 22:21:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6059 (0.5802)
[INFO] - 03-16 22:21:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1989 (-140.2764)
[INFO] - 03-16 22:21:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3982 (19.4520)
[INFO] - 03-16 22:21:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.5562 (192.6317)
[INFO] - 03-16 22:21:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:21:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9467)
[INFO] - 03-16 22:21:11 - [main.backward:225]: Epoch 249/300 - Iteration 148/199 - Time 0.199 batch, 0.030 data, 0.175 forward
[INFO] - 03-16 22:21:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0052)
[INFO] - 03-16 22:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5712 (0.5844)
[INFO] - 03-16 22:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3325 (-140.2582)
[INFO] - 03-16 22:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4848 (19.4077)
[INFO] - 03-16 22:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.6662 (192.4076)
[INFO] - 03-16 22:21:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9328)
[INFO] - 03-16 22:21:21 - [main.backward:225]: Epoch 249/300 - Iteration 198/199 - Time 0.198 batch, 0.029 data, 0.173 forward
[INFO] - 03-16 22:21:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0101 (0.0052)
[INFO] - 03-16 22:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6043 (0.5850)
[INFO] - 03-16 22:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2186 (-140.2405)
[INFO] - 03-16 22:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4369 (19.4443)
[INFO] - 03-16 22:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.3954 (192.0039)
[INFO] - 03-16 22:21:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:21:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.9358)
[INFO] - 03-16 22:21:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:21:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:21:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:21:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:21:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:21:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:21:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:21:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.186
[INFO] - 03-16 22:21:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.186
[INFO] - 03-16 22:21:24 - [main.summary_metrics:168]: Epoch 249/300 - Test Results:
{'auc': 0.8571111438679246,
 'f1': 0.4315432994678277,
 'loss': 0.4384685647672577,
 'ndcg': 0.754392918154696,
 'precision': 0.6433962264150944,
 'recall': 0.3249213836477987}
[INFO] - 03-16 22:21:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[249] Complete. Time taken: 00:00:42.662
[INFO] - 03-16 22:21:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:21:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:21:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:21:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:21:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:21:24 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7209, 4985, 5134]
[INFO] - 03-16 22:21:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:21:34 - [main.backward:225]: Epoch 250/300 - Iteration 49/199 - Time 0.206 batch, 0.043 data, 0.181 forward
[INFO] - 03-16 22:21:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0048)
[INFO] - 03-16 22:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5349 (0.5769)
[INFO] - 03-16 22:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3559 (-140.2624)
[INFO] - 03-16 22:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4552 (19.4868)
[INFO] - 03-16 22:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.7645 (191.9942)
[INFO] - 03-16 22:21:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:21:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9447)
[INFO] - 03-16 22:21:44 - [main.backward:225]: Epoch 250/300 - Iteration 99/199 - Time 0.199 batch, 0.034 data, 0.174 forward
[INFO] - 03-16 22:21:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0051)
[INFO] - 03-16 22:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6054 (0.5806)
[INFO] - 03-16 22:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1884 (-140.2797)
[INFO] - 03-16 22:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5181 (19.4861)
[INFO] - 03-16 22:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.6594 (192.4082)
[INFO] - 03-16 22:21:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9381)
[INFO] - 03-16 22:21:53 - [main.backward:225]: Epoch 250/300 - Iteration 149/199 - Time 0.198 batch, 0.032 data, 0.173 forward
[INFO] - 03-16 22:21:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:21:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0051)
[INFO] - 03-16 22:21:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5614 (0.5831)
[INFO] - 03-16 22:21:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3311 (-140.2684)
[INFO] - 03-16 22:21:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4789 (19.4402)
[INFO] - 03-16 22:21:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.5220 (192.2508)
[INFO] - 03-16 22:21:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:21:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9350)
[INFO] - 03-16 22:22:03 - [main.backward:225]: Epoch 250/300 - Iteration 0/199 - Time 0.197 batch, 0.030 data, 0.172 forward
[INFO] - 03-16 22:22:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0053)
[INFO] - 03-16 22:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6144 (0.5864)
[INFO] - 03-16 22:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2076 (-140.2300)
[INFO] - 03-16 22:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3960 (19.4194)
[INFO] - 03-16 22:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.5359 (192.0324)
[INFO] - 03-16 22:22:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:22:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9323)
[INFO] - 03-16 22:22:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:22:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:22:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:22:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:22:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:22:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:22:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:22:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.220
[INFO] - 03-16 22:22:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.221
[INFO] - 03-16 22:22:06 - [main.summary_metrics:168]: Epoch 250/300 - Test Results:
{'auc': 0.8592918632075472,
 'f1': 0.43330430575713597,
 'loss': 0.4360517890738242,
 'ndcg': 0.7512701042565435,
 'precision': 0.6452830188679245,
 'recall': 0.3264937106918239}
[INFO] - 03-16 22:22:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[250] Complete. Time taken: 00:00:42.489
[INFO] - 03-16 22:22:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:22:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:22:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:22:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:22:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:22:06 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7248, 4989, 5137]
[INFO] - 03-16 22:22:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:22:17 - [main.backward:225]: Epoch 251/300 - Iteration 50/199 - Time 0.209 batch, 0.042 data, 0.184 forward
[INFO] - 03-16 22:22:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:22:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0044)
[INFO] - 03-16 22:22:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5936 (0.5785)
[INFO] - 03-16 22:22:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2271 (-140.2575)
[INFO] - 03-16 22:22:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4137 (19.4158)
[INFO] - 03-16 22:22:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.9451 (191.8155)
[INFO] - 03-16 22:22:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:22:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9456)
[INFO] - 03-16 22:22:27 - [main.backward:225]: Epoch 251/300 - Iteration 100/199 - Time 0.203 batch, 0.034 data, 0.178 forward
[INFO] - 03-16 22:22:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:22:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0057 (0.0049)
[INFO] - 03-16 22:22:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6044 (0.5808)
[INFO] - 03-16 22:22:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1991 (-140.2648)
[INFO] - 03-16 22:22:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3869 (19.4263)
[INFO] - 03-16 22:22:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6669 (192.3773)
[INFO] - 03-16 22:22:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:22:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9375)
[INFO] - 03-16 22:22:37 - [main.backward:225]: Epoch 251/300 - Iteration 150/199 - Time 0.203 batch, 0.030 data, 0.179 forward
[INFO] - 03-16 22:22:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:22:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0048)
[INFO] - 03-16 22:22:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5660 (0.5835)
[INFO] - 03-16 22:22:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3190 (-140.2541)
[INFO] - 03-16 22:22:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5163 (19.4269)
[INFO] - 03-16 22:22:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.9671 (192.3040)
[INFO] - 03-16 22:22:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:22:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9403)
[INFO] - 03-16 22:22:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:22:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:22:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:22:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:22:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:22:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:22:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:22:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.231
[INFO] - 03-16 22:22:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.232
[INFO] - 03-16 22:22:49 - [main.summary_metrics:168]: Epoch 251/300 - Test Results:
{'auc': 0.8549505699685536,
 'f1': 0.4343105950653121,
 'loss': 0.4410258175232125,
 'ndcg': 0.7514860882784199,
 'precision': 0.6471698113207547,
 'recall': 0.32712264150943393}
[INFO] - 03-16 22:22:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[251] Complete. Time taken: 00:00:43.061
[INFO] - 03-16 22:22:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:22:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:22:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:22:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:22:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:22:49 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7257, 5012, 5157]
[INFO] - 03-16 22:22:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:22:51 - [main.backward:225]: Epoch 252/300 - Iteration 1/199 - Time 1.063 batch, 0.875 data, 1.014 forward
[INFO] - 03-16 22:22:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:22:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0050)
[INFO] - 03-16 22:22:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5875 (0.5858)
[INFO] - 03-16 22:22:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2973 (-140.2218)
[INFO] - 03-16 22:22:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4949 (19.4485)
[INFO] - 03-16 22:22:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.0232 (191.9582)
[INFO] - 03-16 22:22:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:22:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9397)
[INFO] - 03-16 22:23:00 - [main.backward:225]: Epoch 252/300 - Iteration 51/199 - Time 0.207 batch, 0.041 data, 0.182 forward
[INFO] - 03-16 22:23:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:23:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0045)
[INFO] - 03-16 22:23:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5802 (0.5763)
[INFO] - 03-16 22:23:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1973 (-140.2519)
[INFO] - 03-16 22:23:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4701 (19.5021)
[INFO] - 03-16 22:23:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.9052 (191.8313)
[INFO] - 03-16 22:23:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:23:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9475)
[INFO] - 03-16 22:23:10 - [main.backward:225]: Epoch 252/300 - Iteration 101/199 - Time 0.200 batch, 0.032 data, 0.176 forward
[INFO] - 03-16 22:23:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:23:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0047)
[INFO] - 03-16 22:23:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6100 (0.5800)
[INFO] - 03-16 22:23:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1966 (-140.2515)
[INFO] - 03-16 22:23:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4703 (19.4618)
[INFO] - 03-16 22:23:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.9371 (192.2253)
[INFO] - 03-16 22:23:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:23:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9441)
[INFO] - 03-16 22:23:19 - [main.backward:225]: Epoch 252/300 - Iteration 151/199 - Time 0.196 batch, 0.030 data, 0.172 forward
[INFO] - 03-16 22:23:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:23:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0047)
[INFO] - 03-16 22:23:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5828)
[INFO] - 03-16 22:23:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2778 (-140.2455)
[INFO] - 03-16 22:23:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4550 (19.4241)
[INFO] - 03-16 22:23:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.7848 (192.1813)
[INFO] - 03-16 22:23:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:23:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9394)
[INFO] - 03-16 22:23:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:23:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:23:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:23:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:23:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:23:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:23:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:23:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.561
[INFO] - 03-16 22:23:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.561
[INFO] - 03-16 22:23:32 - [main.summary_metrics:168]: Epoch 252/300 - Test Results:
{'auc': 0.861742072851153,
 'f1': 0.44714078374455724,
 'loss': 0.43628408368428556,
 'ndcg': 0.7607152577162851,
 'precision': 0.6660377358490567,
 'recall': 0.33687106918238996}
[INFO] - 03-16 22:23:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[252] Complete. Time taken: 00:00:42.402
[INFO] - 03-16 22:23:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:23:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:23:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:23:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:23:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:23:32 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7226, 5034, 5160]
[INFO] - 03-16 22:23:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:23:33 - [main.backward:225]: Epoch 253/300 - Iteration 2/199 - Time 0.721 batch, 0.538 data, 0.687 forward
[INFO] - 03-16 22:23:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0052)
[INFO] - 03-16 22:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6039 (0.5848)
[INFO] - 03-16 22:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3021 (-140.2156)
[INFO] - 03-16 22:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3201 (19.3698)
[INFO] - 03-16 22:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.2252 (191.7789)
[INFO] - 03-16 22:23:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:23:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9378)
[INFO] - 03-16 22:23:43 - [main.backward:225]: Epoch 253/300 - Iteration 52/199 - Time 0.222 batch, 0.044 data, 0.197 forward
[INFO] - 03-16 22:23:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0045)
[INFO] - 03-16 22:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5878 (0.5770)
[INFO] - 03-16 22:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1866 (-140.2415)
[INFO] - 03-16 22:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4243 (19.4104)
[INFO] - 03-16 22:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.6660 (191.7351)
[INFO] - 03-16 22:23:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9472)
[INFO] - 03-16 22:23:53 - [main.backward:225]: Epoch 253/300 - Iteration 102/199 - Time 0.205 batch, 0.035 data, 0.180 forward
[INFO] - 03-16 22:23:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:23:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0049)
[INFO] - 03-16 22:23:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5021 (0.5798)
[INFO] - 03-16 22:23:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3334 (-140.2503)
[INFO] - 03-16 22:23:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4007 (19.4177)
[INFO] - 03-16 22:23:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.1078 (192.2617)
[INFO] - 03-16 22:23:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:23:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9409)
[INFO] - 03-16 22:24:02 - [main.backward:225]: Epoch 253/300 - Iteration 152/199 - Time 0.199 batch, 0.032 data, 0.174 forward
[INFO] - 03-16 22:24:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0051)
[INFO] - 03-16 22:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6026 (0.5837)
[INFO] - 03-16 22:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2784 (-140.2338)
[INFO] - 03-16 22:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5057 (19.4152)
[INFO] - 03-16 22:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.9369 (191.9747)
[INFO] - 03-16 22:24:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9316)
[INFO] - 03-16 22:24:11 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:24:11 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:24:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:24:11 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:24:11 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:24:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:24:11 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:24:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.267
[INFO] - 03-16 22:24:14 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.268
[INFO] - 03-16 22:24:14 - [main.summary_metrics:168]: Epoch 253/300 - Test Results:
{'auc': 0.8522834119496855,
 'f1': 0.42424770198355105,
 'loss': 0.44087906741896016,
 'ndcg': 0.7448226899633094,
 'precision': 0.6320754716981132,
 'recall': 0.31957547169811323}
[INFO] - 03-16 22:24:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[253] Complete. Time taken: 00:00:42.304
[INFO] - 03-16 22:24:14 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:24:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:24:14 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:24:14 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:24:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:24:14 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7241, 5017, 5139]
[INFO] - 03-16 22:24:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:24:16 - [main.backward:225]: Epoch 254/300 - Iteration 3/199 - Time 0.477 batch, 0.320 data, 0.453 forward
[INFO] - 03-16 22:24:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0052)
[INFO] - 03-16 22:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5845)
[INFO] - 03-16 22:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2787 (-140.2092)
[INFO] - 03-16 22:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4171 (19.4085)
[INFO] - 03-16 22:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.0233 (191.6032)
[INFO] - 03-16 22:24:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:24:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9346)
[INFO] - 03-16 22:24:25 - [main.backward:225]: Epoch 254/300 - Iteration 53/199 - Time 0.201 batch, 0.042 data, 0.176 forward
[INFO] - 03-16 22:24:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:24:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0045)
[INFO] - 03-16 22:24:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5511 (0.5779)
[INFO] - 03-16 22:24:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2459 (-140.2312)
[INFO] - 03-16 22:24:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3783 (19.3895)
[INFO] - 03-16 22:24:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.2977 (191.5219)
[INFO] - 03-16 22:24:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:24:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9480)
[INFO] - 03-16 22:24:35 - [main.backward:225]: Epoch 254/300 - Iteration 103/199 - Time 0.198 batch, 0.033 data, 0.173 forward
[INFO] - 03-16 22:24:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0012 (0.0046)
[INFO] - 03-16 22:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.4882 (0.5776)
[INFO] - 03-16 22:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3726 (-140.2437)
[INFO] - 03-16 22:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4643 (19.4578)
[INFO] - 03-16 22:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.5672 (192.2264)
[INFO] - 03-16 22:24:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9422)
[INFO] - 03-16 22:24:44 - [main.backward:225]: Epoch 254/300 - Iteration 153/199 - Time 0.195 batch, 0.031 data, 0.170 forward
[INFO] - 03-16 22:24:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0050)
[INFO] - 03-16 22:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5857)
[INFO] - 03-16 22:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2622 (-140.2249)
[INFO] - 03-16 22:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5742 (19.4308)
[INFO] - 03-16 22:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.7576 (192.2012)
[INFO] - 03-16 22:24:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9402)
[INFO] - 03-16 22:24:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:24:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:24:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:24:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:24:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:24:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:24:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:24:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.149
[INFO] - 03-16 22:24:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.150
[INFO] - 03-16 22:24:56 - [main.summary_metrics:168]: Epoch 254/300 - Test Results:
{'auc': 0.8739871593291404,
 'f1': 0.4622351233671988,
 'loss': 0.429606223584221,
 'ndcg': 0.7790142744631101,
 'precision': 0.6886792452830188,
 'recall': 0.34819182389937103}
[INFO] - 03-16 22:24:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[254] Complete. Time taken: 00:00:41.744
[INFO] - 03-16 22:24:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:24:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:24:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:24:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:24:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:24:56 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7235, 5002, 5143]
[INFO] - 03-16 22:24:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:24:58 - [main.backward:225]: Epoch 255/300 - Iteration 4/199 - Time 0.405 batch, 0.221 data, 0.384 forward
[INFO] - 03-16 22:24:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:24:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0049)
[INFO] - 03-16 22:24:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5865 (0.5840)
[INFO] - 03-16 22:24:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2609 (-140.2042)
[INFO] - 03-16 22:24:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3833 (19.4176)
[INFO] - 03-16 22:24:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.7065 (191.9986)
[INFO] - 03-16 22:24:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:24:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9422)
[INFO] - 03-16 22:25:07 - [main.backward:225]: Epoch 255/300 - Iteration 54/199 - Time 0.212 batch, 0.039 data, 0.188 forward
[INFO] - 03-16 22:25:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0041)
[INFO] - 03-16 22:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5276 (0.5752)
[INFO] - 03-16 22:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2958 (-140.2250)
[INFO] - 03-16 22:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5782 (19.4231)
[INFO] - 03-16 22:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.8736 (191.7173)
[INFO] - 03-16 22:25:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9559)
[INFO] - 03-16 22:25:17 - [main.backward:225]: Epoch 255/300 - Iteration 104/199 - Time 0.202 batch, 0.033 data, 0.177 forward
[INFO] - 03-16 22:25:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:25:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0014 (0.0044)
[INFO] - 03-16 22:25:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.4860 (0.5779)
[INFO] - 03-16 22:25:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3822 (-140.2445)
[INFO] - 03-16 22:25:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3680 (19.4375)
[INFO] - 03-16 22:25:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6783 (192.3075)
[INFO] - 03-16 22:25:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:25:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9466)
[INFO] - 03-16 22:25:26 - [main.backward:225]: Epoch 255/300 - Iteration 154/199 - Time 0.198 batch, 0.030 data, 0.173 forward
[INFO] - 03-16 22:25:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0051)
[INFO] - 03-16 22:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5886)
[INFO] - 03-16 22:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2574 (-140.2201)
[INFO] - 03-16 22:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4844 (19.4061)
[INFO] - 03-16 22:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.1170 (191.8395)
[INFO] - 03-16 22:25:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:25:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9394)
[INFO] - 03-16 22:25:35 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:25:35 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:25:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:25:35 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:25:35 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:25:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:25:35 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:25:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.335
[INFO] - 03-16 22:25:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.336
[INFO] - 03-16 22:25:39 - [main.summary_metrics:168]: Epoch 255/300 - Test Results:
{'auc': 0.8729355673480084,
 'f1': 0.4556942428640542,
 'loss': 0.42629510670388016,
 'ndcg': 0.7738315059322634,
 'precision': 0.6792452830188679,
 'recall': 0.3431603773584906}
[INFO] - 03-16 22:25:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[255] Complete. Time taken: 00:00:42.658
[INFO] - 03-16 22:25:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:25:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:25:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:25:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:25:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:25:39 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7224, 4986, 5126]
[INFO] - 03-16 22:25:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:25:40 - [main.backward:225]: Epoch 256/300 - Iteration 5/199 - Time 0.370 batch, 0.206 data, 0.348 forward
[INFO] - 03-16 22:25:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:25:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0048)
[INFO] - 03-16 22:25:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5738 (0.5844)
[INFO] - 03-16 22:25:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2164 (-140.1983)
[INFO] - 03-16 22:25:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4364 (19.4248)
[INFO] - 03-16 22:25:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8233 (191.7399)
[INFO] - 03-16 22:25:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:25:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9423)
[INFO] - 03-16 22:25:50 - [main.backward:225]: Epoch 256/300 - Iteration 55/199 - Time 0.208 batch, 0.042 data, 0.182 forward
[INFO] - 03-16 22:25:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0041)
[INFO] - 03-16 22:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5192 (0.5741)
[INFO] - 03-16 22:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3097 (-140.2266)
[INFO] - 03-16 22:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4714 (19.4314)
[INFO] - 03-16 22:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.0053 (191.8331)
[INFO] - 03-16 22:25:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9528)
[INFO] - 03-16 22:26:00 - [main.backward:225]: Epoch 256/300 - Iteration 105/199 - Time 0.202 batch, 0.034 data, 0.177 forward
[INFO] - 03-16 22:26:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0010 (0.0044)
[INFO] - 03-16 22:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.4793 (0.5760)
[INFO] - 03-16 22:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3626 (-140.2425)
[INFO] - 03-16 22:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3071 (19.4082)
[INFO] - 03-16 22:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6210 (191.7397)
[INFO] - 03-16 22:26:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9475)
[INFO] - 03-16 22:26:10 - [main.backward:225]: Epoch 256/300 - Iteration 155/199 - Time 0.202 batch, 0.031 data, 0.177 forward
[INFO] - 03-16 22:26:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0050)
[INFO] - 03-16 22:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5461 (0.5897)
[INFO] - 03-16 22:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2870 (-140.2184)
[INFO] - 03-16 22:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4649 (19.3939)
[INFO] - 03-16 22:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.2459 (191.9858)
[INFO] - 03-16 22:26:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9378)
[INFO] - 03-16 22:26:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:26:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:26:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:26:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:26:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:26:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:26:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:26:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.205
[INFO] - 03-16 22:26:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.206
[INFO] - 03-16 22:26:22 - [main.summary_metrics:168]: Epoch 256/300 - Test Results:
{'auc': 0.8551738731656184,
 'f1': 0.4378326076439284,
 'loss': 0.4349307716257667,
 'ndcg': 0.7562918835712604,
 'precision': 0.6528301886792454,
 'recall': 0.3296383647798742}
[INFO] - 03-16 22:26:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[256] Complete. Time taken: 00:00:43.153
[INFO] - 03-16 22:26:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:26:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:26:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:26:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:26:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:26:22 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7229, 4955, 5102]
[INFO] - 03-16 22:26:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:26:24 - [main.backward:225]: Epoch 257/300 - Iteration 6/199 - Time 0.354 batch, 0.176 data, 0.328 forward
[INFO] - 03-16 22:26:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:26:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0048)
[INFO] - 03-16 22:26:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5494 (0.5856)
[INFO] - 03-16 22:26:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2079 (-140.2004)
[INFO] - 03-16 22:26:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3002 (19.4027)
[INFO] - 03-16 22:26:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.1924 (191.3985)
[INFO] - 03-16 22:26:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:26:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9436)
[INFO] - 03-16 22:26:34 - [main.backward:225]: Epoch 257/300 - Iteration 56/199 - Time 0.225 batch, 0.040 data, 0.201 forward
[INFO] - 03-16 22:26:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0041)
[INFO] - 03-16 22:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5401 (0.5751)
[INFO] - 03-16 22:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2962 (-140.2240)
[INFO] - 03-16 22:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4608 (19.4193)
[INFO] - 03-16 22:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.7822 (191.4062)
[INFO] - 03-16 22:26:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:26:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9548)
[INFO] - 03-16 22:26:44 - [main.backward:225]: Epoch 257/300 - Iteration 106/199 - Time 0.214 batch, 0.033 data, 0.189 forward
[INFO] - 03-16 22:26:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0046)
[INFO] - 03-16 22:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5982 (0.5780)
[INFO] - 03-16 22:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2967 (-140.2335)
[INFO] - 03-16 22:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.5205 (19.4271)
[INFO] - 03-16 22:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.9301 (191.6728)
[INFO] - 03-16 22:26:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9436)
[INFO] - 03-16 22:26:54 - [main.backward:225]: Epoch 257/300 - Iteration 156/199 - Time 0.208 batch, 0.030 data, 0.184 forward
[INFO] - 03-16 22:26:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0054)
[INFO] - 03-16 22:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5399 (0.5870)
[INFO] - 03-16 22:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2829 (-140.2155)
[INFO] - 03-16 22:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4712 (19.4077)
[INFO] - 03-16 22:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.2517 (191.9303)
[INFO] - 03-16 22:26:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9294)
[INFO] - 03-16 22:27:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:27:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:27:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:27:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:27:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:27:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:27:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:27:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.272
[INFO] - 03-16 22:27:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.272
[INFO] - 03-16 22:27:06 - [main.summary_metrics:168]: Epoch 257/300 - Test Results:
{'auc': 0.8611649305555555,
 'f1': 0.44965650701499765,
 'loss': 0.4309650406787481,
 'ndcg': 0.767712517982776,
 'precision': 0.6698113207547168,
 'recall': 0.33875786163522004}
[INFO] - 03-16 22:27:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[257] Complete. Time taken: 00:00:44.375
[INFO] - 03-16 22:27:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:27:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:27:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:27:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:27:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:27:06 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7225, 5006, 5171]
[INFO] - 03-16 22:27:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:27:08 - [main.backward:225]: Epoch 258/300 - Iteration 7/199 - Time 0.341 batch, 0.173 data, 0.311 forward
[INFO] - 03-16 22:27:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0051)
[INFO] - 03-16 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5444 (0.5854)
[INFO] - 03-16 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2007 (-140.1949)
[INFO] - 03-16 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2160 (19.3877)
[INFO] - 03-16 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.7243 (191.7902)
[INFO] - 03-16 22:27:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9353)
[INFO] - 03-16 22:27:19 - [main.backward:225]: Epoch 258/300 - Iteration 57/199 - Time 0.219 batch, 0.043 data, 0.193 forward
[INFO] - 03-16 22:27:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:27:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0042)
[INFO] - 03-16 22:27:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5508 (0.5755)
[INFO] - 03-16 22:27:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2847 (-140.2249)
[INFO] - 03-16 22:27:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3558 (19.3811)
[INFO] - 03-16 22:27:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6034 (191.6421)
[INFO] - 03-16 22:27:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:27:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9491)
[INFO] - 03-16 22:27:29 - [main.backward:225]: Epoch 258/300 - Iteration 107/199 - Time 0.212 batch, 0.034 data, 0.187 forward
[INFO] - 03-16 22:27:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:27:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0045)
[INFO] - 03-16 22:27:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5868 (0.5780)
[INFO] - 03-16 22:27:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2800 (-140.2329)
[INFO] - 03-16 22:27:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3327 (19.4040)
[INFO] - 03-16 22:27:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.9444 (191.7671)
[INFO] - 03-16 22:27:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:27:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9475)
[INFO] - 03-16 22:27:39 - [main.backward:225]: Epoch 258/300 - Iteration 157/199 - Time 0.209 batch, 0.031 data, 0.184 forward
[INFO] - 03-16 22:27:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:27:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0052)
[INFO] - 03-16 22:27:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5498 (0.5873)
[INFO] - 03-16 22:27:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2731 (-140.2118)
[INFO] - 03-16 22:27:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4050 (19.3911)
[INFO] - 03-16 22:27:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 193.2119 (191.9860)
[INFO] - 03-16 22:27:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:27:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9325)
[INFO] - 03-16 22:27:47 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:27:47 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:27:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:27:47 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:27:47 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:27:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:27:47 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:27:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.300
[INFO] - 03-16 22:27:50 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.300
[INFO] - 03-16 22:27:50 - [main.summary_metrics:168]: Epoch 258/300 - Test Results:
{'auc': 0.8660231918238993,
 'f1': 0.4429221093372036,
 'loss': 0.4298843612231048,
 'ndcg': 0.7680356739308309,
 'precision': 0.660377358490566,
 'recall': 0.3334905660377358}
[INFO] - 03-16 22:27:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[258] Complete. Time taken: 00:00:44.244
[INFO] - 03-16 22:27:50 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:27:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:27:50 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:27:50 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:27:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:27:50 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7269, 5002, 5156]
[INFO] - 03-16 22:27:51 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:27:53 - [main.backward:225]: Epoch 259/300 - Iteration 8/199 - Time 0.315 batch, 0.145 data, 0.287 forward
[INFO] - 03-16 22:27:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:27:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0051)
[INFO] - 03-16 22:27:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5447 (0.5839)
[INFO] - 03-16 22:27:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2661 (-140.1969)
[INFO] - 03-16 22:27:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2561 (19.3937)
[INFO] - 03-16 22:27:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.2624 (191.6479)
[INFO] - 03-16 22:27:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:27:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9386)
[INFO] - 03-16 22:28:03 - [main.backward:225]: Epoch 259/300 - Iteration 58/199 - Time 0.220 batch, 0.040 data, 0.196 forward
[INFO] - 03-16 22:28:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0039)
[INFO] - 03-16 22:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5611 (0.5753)
[INFO] - 03-16 22:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2776 (-140.2250)
[INFO] - 03-16 22:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3942 (19.3835)
[INFO] - 03-16 22:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5486 (191.3874)
[INFO] - 03-16 22:28:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9558)
[INFO] - 03-16 22:28:13 - [main.backward:225]: Epoch 259/300 - Iteration 108/199 - Time 0.209 batch, 0.033 data, 0.184 forward
[INFO] - 03-16 22:28:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:28:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0047)
[INFO] - 03-16 22:28:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5814 (0.5797)
[INFO] - 03-16 22:28:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2876 (-140.2326)
[INFO] - 03-16 22:28:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4120 (19.4098)
[INFO] - 03-16 22:28:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.4162 (191.5634)
[INFO] - 03-16 22:28:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:28:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9428)
[INFO] - 03-16 22:28:23 - [main.backward:225]: Epoch 259/300 - Iteration 158/199 - Time 0.205 batch, 0.030 data, 0.180 forward
[INFO] - 03-16 22:28:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:28:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0048)
[INFO] - 03-16 22:28:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5395 (0.5873)
[INFO] - 03-16 22:28:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2582 (-140.2084)
[INFO] - 03-16 22:28:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4011 (19.4006)
[INFO] - 03-16 22:28:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.7885 (191.7122)
[INFO] - 03-16 22:28:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:28:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9402)
[INFO] - 03-16 22:28:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:28:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:28:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:28:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:28:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:28:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:28:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:28:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.236
[INFO] - 03-16 22:28:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.237
[INFO] - 03-16 22:28:34 - [main.summary_metrics:168]: Epoch 259/300 - Test Results:
{'auc': 0.8539158805031444,
 'f1': 0.43179487179487186,
 'loss': 0.4349658452639789,
 'ndcg': 0.7544696759319539,
 'precision': 0.6433962264150942,
 'recall': 0.32523584905660374}
[INFO] - 03-16 22:28:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[259] Complete. Time taken: 00:00:44.116
[INFO] - 03-16 22:28:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:28:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:28:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:28:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:28:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:28:34 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7226, 4976, 5119]
[INFO] - 03-16 22:28:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:28:37 - [main.backward:225]: Epoch 260/300 - Iteration 9/199 - Time 0.289 batch, 0.120 data, 0.262 forward
[INFO] - 03-16 22:28:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:28:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0012 (0.0049)
[INFO] - 03-16 22:28:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5243 (0.5862)
[INFO] - 03-16 22:28:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3159 (-140.1952)
[INFO] - 03-16 22:28:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4356 (19.3909)
[INFO] - 03-16 22:28:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.7184 (191.4635)
[INFO] - 03-16 22:28:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:28:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9424)
[INFO] - 03-16 22:28:47 - [main.backward:225]: Epoch 260/300 - Iteration 59/199 - Time 0.212 batch, 0.040 data, 0.186 forward
[INFO] - 03-16 22:28:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0041)
[INFO] - 03-16 22:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5609 (0.5775)
[INFO] - 03-16 22:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2859 (-140.2246)
[INFO] - 03-16 22:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3763 (19.3867)
[INFO] - 03-16 22:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.0914 (191.3047)
[INFO] - 03-16 22:28:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:28:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9511)
[INFO] - 03-16 22:28:57 - [main.backward:225]: Epoch 260/300 - Iteration 109/199 - Time 0.204 batch, 0.033 data, 0.179 forward
[INFO] - 03-16 22:28:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:28:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0076 (0.0046)
[INFO] - 03-16 22:28:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5791)
[INFO] - 03-16 22:28:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2815 (-140.2360)
[INFO] - 03-16 22:28:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4261 (19.4024)
[INFO] - 03-16 22:28:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.2242 (191.6104)
[INFO] - 03-16 22:28:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:28:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9448)
[INFO] - 03-16 22:29:07 - [main.backward:225]: Epoch 260/300 - Iteration 159/199 - Time 0.204 batch, 0.030 data, 0.179 forward
[INFO] - 03-16 22:29:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:29:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0011 (0.0050)
[INFO] - 03-16 22:29:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5449 (0.5849)
[INFO] - 03-16 22:29:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2595 (-140.1973)
[INFO] - 03-16 22:29:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3887 (19.3684)
[INFO] - 03-16 22:29:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.0006 (191.8244)
[INFO] - 03-16 22:29:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:29:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9373)
[INFO] - 03-16 22:29:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:29:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:29:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:29:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:29:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:29:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:29:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:29:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.228
[INFO] - 03-16 22:29:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.229
[INFO] - 03-16 22:29:18 - [main.summary_metrics:168]: Epoch 260/300 - Test Results:
{'auc': 0.8637800707547169,
 'f1': 0.44839864537977747,
 'loss': 0.43212577207233427,
 'ndcg': 0.7638161893976573,
 'precision': 0.6679245283018868,
 'recall': 0.337814465408805}
[INFO] - 03-16 22:29:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[260] Complete. Time taken: 00:00:43.566
[INFO] - 03-16 22:29:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:29:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:29:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:29:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:29:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:29:18 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7227, 4987, 5157]
[INFO] - 03-16 22:29:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:29:21 - [main.backward:225]: Epoch 261/300 - Iteration 10/199 - Time 0.301 batch, 0.116 data, 0.278 forward
[INFO] - 03-16 22:29:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:29:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0052)
[INFO] - 03-16 22:29:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5266 (0.5859)
[INFO] - 03-16 22:29:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3374 (-140.1934)
[INFO] - 03-16 22:29:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3538 (19.3676)
[INFO] - 03-16 22:29:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.0099 (191.3580)
[INFO] - 03-16 22:29:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:29:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9344)
[INFO] - 03-16 22:29:31 - [main.backward:225]: Epoch 261/300 - Iteration 60/199 - Time 0.223 batch, 0.040 data, 0.198 forward
[INFO] - 03-16 22:29:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:29:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0043)
[INFO] - 03-16 22:29:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5565 (0.5765)
[INFO] - 03-16 22:29:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2883 (-140.2216)
[INFO] - 03-16 22:29:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3262 (19.3771)
[INFO] - 03-16 22:29:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8758 (191.2122)
[INFO] - 03-16 22:29:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:29:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9478)
[INFO] - 03-16 22:29:41 - [main.backward:225]: Epoch 261/300 - Iteration 110/199 - Time 0.212 batch, 0.033 data, 0.187 forward
[INFO] - 03-16 22:29:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0051)
[INFO] - 03-16 22:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5828 (0.5798)
[INFO] - 03-16 22:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1935 (-140.2352)
[INFO] - 03-16 22:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4197 (19.3898)
[INFO] - 03-16 22:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.0608 (191.6155)
[INFO] - 03-16 22:29:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9355)
[INFO] - 03-16 22:29:51 - [main.backward:225]: Epoch 261/300 - Iteration 160/199 - Time 0.207 batch, 0.030 data, 0.182 forward
[INFO] - 03-16 22:29:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:29:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0052)
[INFO] - 03-16 22:29:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5547 (0.5846)
[INFO] - 03-16 22:29:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2463 (-140.1961)
[INFO] - 03-16 22:29:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3698 (19.3961)
[INFO] - 03-16 22:29:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.0453 (191.6698)
[INFO] - 03-16 22:29:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:29:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9306)
[INFO] - 03-16 22:29:59 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:29:59 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:29:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:29:59 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:29:59 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:29:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:29:59 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:30:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.212
[INFO] - 03-16 22:30:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.212
[INFO] - 03-16 22:30:02 - [main.summary_metrics:168]: Epoch 261/300 - Test Results:
{'auc': 0.8598931800314465,
 'f1': 0.4341170778906628,
 'loss': 0.4335843863937091,
 'ndcg': 0.7575335406727722,
 'precision': 0.6471698113207547,
 'recall': 0.3268867924528302}
[INFO] - 03-16 22:30:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[261] Complete. Time taken: 00:00:44.023
[INFO] - 03-16 22:30:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:30:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:30:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:30:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:30:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:30:02 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7243, 5019, 5161]
[INFO] - 03-16 22:30:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:30:05 - [main.backward:225]: Epoch 262/300 - Iteration 11/199 - Time 0.297 batch, 0.118 data, 0.270 forward
[INFO] - 03-16 22:30:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:30:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0054)
[INFO] - 03-16 22:30:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5197 (0.5846)
[INFO] - 03-16 22:30:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3436 (-140.1999)
[INFO] - 03-16 22:30:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3095 (19.3775)
[INFO] - 03-16 22:30:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.7754 (191.2977)
[INFO] - 03-16 22:30:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:30:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9342)
[INFO] - 03-16 22:30:15 - [main.backward:225]: Epoch 262/300 - Iteration 61/199 - Time 0.214 batch, 0.041 data, 0.189 forward
[INFO] - 03-16 22:30:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:30:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0041)
[INFO] - 03-16 22:30:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5965 (0.5787)
[INFO] - 03-16 22:30:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2285 (-140.2188)
[INFO] - 03-16 22:30:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4547 (19.3635)
[INFO] - 03-16 22:30:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.4527 (191.2122)
[INFO] - 03-16 22:30:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:30:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9539)
[INFO] - 03-16 22:30:25 - [main.backward:225]: Epoch 262/300 - Iteration 111/199 - Time 0.207 batch, 0.033 data, 0.183 forward
[INFO] - 03-16 22:30:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:30:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0085 (0.0047)
[INFO] - 03-16 22:30:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5844 (0.5792)
[INFO] - 03-16 22:30:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1879 (-140.2291)
[INFO] - 03-16 22:30:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4001 (19.3640)
[INFO] - 03-16 22:30:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.2227 (191.4286)
[INFO] - 03-16 22:30:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:30:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9459)
[INFO] - 03-16 22:30:35 - [main.backward:225]: Epoch 262/300 - Iteration 161/199 - Time 0.205 batch, 0.030 data, 0.181 forward
[INFO] - 03-16 22:30:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:30:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0048)
[INFO] - 03-16 22:30:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5452 (0.5824)
[INFO] - 03-16 22:30:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2483 (-140.1995)
[INFO] - 03-16 22:30:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3799 (19.3771)
[INFO] - 03-16 22:30:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.3056 (191.4792)
[INFO] - 03-16 22:30:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:30:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9397)
[INFO] - 03-16 22:30:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:30:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:30:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:30:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:30:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:30:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:30:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:30:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.282
[INFO] - 03-16 22:30:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.283
[INFO] - 03-16 22:30:46 - [main.summary_metrics:168]: Epoch 262/300 - Test Results:
{'auc': 0.8606126506813416,
 'f1': 0.44059990324141257,
 'loss': 0.43174632493105075,
 'ndcg': 0.7600226435683075,
 'precision': 0.6566037735849057,
 'recall': 0.33183962264150946}
[INFO] - 03-16 22:30:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[262] Complete. Time taken: 00:00:43.569
[INFO] - 03-16 22:30:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:30:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:30:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:30:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:30:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:30:46 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7263, 4984, 5145]
[INFO] - 03-16 22:30:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:30:49 - [main.backward:225]: Epoch 263/300 - Iteration 12/199 - Time 0.282 batch, 0.100 data, 0.258 forward
[INFO] - 03-16 22:30:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0051)
[INFO] - 03-16 22:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5911 (0.5842)
[INFO] - 03-16 22:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2319 (-140.2055)
[INFO] - 03-16 22:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3803 (19.3555)
[INFO] - 03-16 22:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5179 (191.1435)
[INFO] - 03-16 22:30:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:30:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9335)
[INFO] - 03-16 22:30:59 - [main.backward:225]: Epoch 263/300 - Iteration 62/199 - Time 0.212 batch, 0.039 data, 0.188 forward
[INFO] - 03-16 22:30:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:30:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0042)
[INFO] - 03-16 22:30:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5965 (0.5782)
[INFO] - 03-16 22:30:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2475 (-140.2156)
[INFO] - 03-16 22:30:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3444 (19.3450)
[INFO] - 03-16 22:30:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.1221 (190.9721)
[INFO] - 03-16 22:30:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:30:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9505)
[INFO] - 03-16 22:31:08 - [main.backward:225]: Epoch 263/300 - Iteration 112/199 - Time 0.202 batch, 0.033 data, 0.177 forward
[INFO] - 03-16 22:31:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0047)
[INFO] - 03-16 22:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5800)
[INFO] - 03-16 22:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1900 (-140.2258)
[INFO] - 03-16 22:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3351 (19.3669)
[INFO] - 03-16 22:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.5867 (191.4295)
[INFO] - 03-16 22:31:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9447)
[INFO] - 03-16 22:31:18 - [main.backward:225]: Epoch 263/300 - Iteration 162/199 - Time 0.199 batch, 0.030 data, 0.174 forward
[INFO] - 03-16 22:31:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0045)
[INFO] - 03-16 22:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5843 (0.5828)
[INFO] - 03-16 22:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2253 (-140.1966)
[INFO] - 03-16 22:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3609 (19.3455)
[INFO] - 03-16 22:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6532 (191.5919)
[INFO] - 03-16 22:31:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9473)
[INFO] - 03-16 22:31:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:31:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:31:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:31:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:31:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:31:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:31:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:31:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.094
[INFO] - 03-16 22:31:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.096
[INFO] - 03-16 22:31:28 - [main.summary_metrics:168]: Epoch 263/300 - Test Results:
{'auc': 0.8636924135220125,
 'f1': 0.4496565070149976,
 'loss': 0.4307574112450302,
 'ndcg': 0.7656691754649074,
 'precision': 0.6698113207547169,
 'recall': 0.3387578616352201}
[INFO] - 03-16 22:31:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[263] Complete. Time taken: 00:00:42.729
[INFO] - 03-16 22:31:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:31:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:31:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:31:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:31:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:31:28 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7232, 5004, 5152]
[INFO] - 03-16 22:31:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:31:32 - [main.backward:225]: Epoch 264/300 - Iteration 13/199 - Time 0.279 batch, 0.098 data, 0.255 forward
[INFO] - 03-16 22:31:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0050)
[INFO] - 03-16 22:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5946 (0.5851)
[INFO] - 03-16 22:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1693 (-140.2082)
[INFO] - 03-16 22:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3374 (19.3262)
[INFO] - 03-16 22:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.6933 (191.1769)
[INFO] - 03-16 22:31:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:31:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9385)
[INFO] - 03-16 22:31:42 - [main.backward:225]: Epoch 264/300 - Iteration 63/199 - Time 0.209 batch, 0.039 data, 0.186 forward
[INFO] - 03-16 22:31:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0040)
[INFO] - 03-16 22:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5957 (0.5788)
[INFO] - 03-16 22:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2447 (-140.2140)
[INFO] - 03-16 22:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3490 (19.3355)
[INFO] - 03-16 22:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6721 (191.0840)
[INFO] - 03-16 22:31:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9531)
[INFO] - 03-16 22:31:51 - [main.backward:225]: Epoch 264/300 - Iteration 113/199 - Time 0.202 batch, 0.032 data, 0.179 forward
[INFO] - 03-16 22:31:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:31:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0046)
[INFO] - 03-16 22:31:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5802)
[INFO] - 03-16 22:31:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1741 (-140.2191)
[INFO] - 03-16 22:31:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3902 (19.3524)
[INFO] - 03-16 22:31:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.7227 (191.2210)
[INFO] - 03-16 22:31:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:31:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9431)
[INFO] - 03-16 22:32:01 - [main.backward:225]: Epoch 264/300 - Iteration 163/199 - Time 0.200 batch, 0.029 data, 0.177 forward
[INFO] - 03-16 22:32:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:32:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0048)
[INFO] - 03-16 22:32:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5987 (0.5832)
[INFO] - 03-16 22:32:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2095 (-140.1990)
[INFO] - 03-16 22:32:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3553 (19.3531)
[INFO] - 03-16 22:32:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8380 (191.3808)
[INFO] - 03-16 22:32:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:32:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9428)
[INFO] - 03-16 22:32:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:32:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:32:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:32:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:32:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:32:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:32:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:32:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.048
[INFO] - 03-16 22:32:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.049
[INFO] - 03-16 22:32:11 - [main.summary_metrics:168]: Epoch 264/300 - Test Results:
{'auc': 0.8653612421383649,
 'f1': 0.44210933720367673,
 'loss': 0.42607223791446325,
 'ndcg': 0.7695163803030546,
 'precision': 0.6584905660377358,
 'recall': 0.3330974842767295}
[INFO] - 03-16 22:32:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[264] Complete. Time taken: 00:00:42.714
[INFO] - 03-16 22:32:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:32:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:32:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:32:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:32:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:32:11 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7228, 4983, 5143]
[INFO] - 03-16 22:32:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:32:15 - [main.backward:225]: Epoch 265/300 - Iteration 14/199 - Time 0.265 batch, 0.096 data, 0.240 forward
[INFO] - 03-16 22:32:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:32:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0048)
[INFO] - 03-16 22:32:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5965 (0.5842)
[INFO] - 03-16 22:32:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1675 (-140.2052)
[INFO] - 03-16 22:32:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3821 (19.3522)
[INFO] - 03-16 22:32:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5950 (191.2287)
[INFO] - 03-16 22:32:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:32:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9455)
[INFO] - 03-16 22:32:25 - [main.backward:225]: Epoch 265/300 - Iteration 64/199 - Time 0.213 batch, 0.040 data, 0.188 forward
[INFO] - 03-16 22:32:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0040)
[INFO] - 03-16 22:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6038 (0.5807)
[INFO] - 03-16 22:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2027 (-140.2109)
[INFO] - 03-16 22:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4518 (19.3602)
[INFO] - 03-16 22:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.8557 (190.9843)
[INFO] - 03-16 22:32:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9547)
[INFO] - 03-16 22:32:35 - [main.backward:225]: Epoch 265/300 - Iteration 114/199 - Time 0.208 batch, 0.033 data, 0.184 forward
[INFO] - 03-16 22:32:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:32:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0048)
[INFO] - 03-16 22:32:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5628 (0.5789)
[INFO] - 03-16 22:32:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1899 (-140.2163)
[INFO] - 03-16 22:32:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3537 (19.3885)
[INFO] - 03-16 22:32:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8418 (191.3639)
[INFO] - 03-16 22:32:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:32:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9414)
[INFO] - 03-16 22:32:44 - [main.backward:225]: Epoch 265/300 - Iteration 164/199 - Time 0.201 batch, 0.030 data, 0.177 forward
[INFO] - 03-16 22:32:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:32:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0049)
[INFO] - 03-16 22:32:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6070 (0.5844)
[INFO] - 03-16 22:32:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2098 (-140.2001)
[INFO] - 03-16 22:32:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4525 (19.3755)
[INFO] - 03-16 22:32:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.1323 (191.3655)
[INFO] - 03-16 22:32:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:32:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9366)
[INFO] - 03-16 22:32:51 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:32:51 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:32:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:32:51 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:32:51 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:32:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:32:51 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:32:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.132
[INFO] - 03-16 22:32:54 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.132
[INFO] - 03-16 22:32:54 - [main.summary_metrics:168]: Epoch 265/300 - Test Results:
{'auc': 0.8559743186582806,
 'f1': 0.42927914852443155,
 'loss': 0.43241986265922233,
 'ndcg': 0.7534464668815181,
 'precision': 0.6396226415094339,
 'recall': 0.32334905660377355}
[INFO] - 03-16 22:32:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[265] Complete. Time taken: 00:00:43.083
[INFO] - 03-16 22:32:54 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:32:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:32:54 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:32:54 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:32:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:32:54 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7222, 4985, 5133]
[INFO] - 03-16 22:32:55 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:32:58 - [main.backward:225]: Epoch 266/300 - Iteration 15/199 - Time 0.262 batch, 0.091 data, 0.237 forward
[INFO] - 03-16 22:32:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0050)
[INFO] - 03-16 22:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5987 (0.5829)
[INFO] - 03-16 22:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1456 (-140.2063)
[INFO] - 03-16 22:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3097 (19.3455)
[INFO] - 03-16 22:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3133 (191.0264)
[INFO] - 03-16 22:32:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:32:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9382)
[INFO] - 03-16 22:33:08 - [main.backward:225]: Epoch 266/300 - Iteration 65/199 - Time 0.209 batch, 0.040 data, 0.184 forward
[INFO] - 03-16 22:33:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:33:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0043)
[INFO] - 03-16 22:33:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6276 (0.5787)
[INFO] - 03-16 22:33:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0702 (-140.2112)
[INFO] - 03-16 22:33:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3931 (19.3371)
[INFO] - 03-16 22:33:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8076 (190.8131)
[INFO] - 03-16 22:33:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:33:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9513)
[INFO] - 03-16 22:33:17 - [main.backward:225]: Epoch 266/300 - Iteration 115/199 - Time 0.200 batch, 0.033 data, 0.176 forward
[INFO] - 03-16 22:33:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:33:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0044)
[INFO] - 03-16 22:33:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5703 (0.5768)
[INFO] - 03-16 22:33:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1849 (-140.2227)
[INFO] - 03-16 22:33:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2847 (19.3521)
[INFO] - 03-16 22:33:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.9266 (191.2212)
[INFO] - 03-16 22:33:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:33:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9447)
[INFO] - 03-16 22:33:27 - [main.backward:225]: Epoch 266/300 - Iteration 165/199 - Time 0.198 batch, 0.030 data, 0.174 forward
[INFO] - 03-16 22:33:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:33:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0064 (0.0051)
[INFO] - 03-16 22:33:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5942 (0.5850)
[INFO] - 03-16 22:33:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2332 (-140.2023)
[INFO] - 03-16 22:33:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2562 (19.3259)
[INFO] - 03-16 22:33:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.1357 (191.1496)
[INFO] - 03-16 22:33:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:33:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9352)
[INFO] - 03-16 22:33:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:33:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:33:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:33:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:33:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:33:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:33:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:33:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.167
[INFO] - 03-16 22:33:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.168
[INFO] - 03-16 22:33:37 - [main.summary_metrics:168]: Epoch 266/300 - Test Results:
{'auc': 0.8653671056079664,
 'f1': 0.4506627963231737,
 'loss': 0.4293572669719,
 'ndcg': 0.7677766477941895,
 'precision': 0.6716981132075472,
 'recall': 0.3393867924528302}
[INFO] - 03-16 22:33:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[266] Complete. Time taken: 00:00:42.766
[INFO] - 03-16 22:33:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:33:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:33:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:33:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:33:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:33:37 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7244, 4980, 5119]
[INFO] - 03-16 22:33:38 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:33:41 - [main.backward:225]: Epoch 267/300 - Iteration 16/199 - Time 0.257 batch, 0.081 data, 0.230 forward
[INFO] - 03-16 22:33:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:33:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0047)
[INFO] - 03-16 22:33:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5924 (0.5835)
[INFO] - 03-16 22:33:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1983 (-140.2013)
[INFO] - 03-16 22:33:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3470 (19.3053)
[INFO] - 03-16 22:33:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.3251 (190.8154)
[INFO] - 03-16 22:33:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:33:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9417)
[INFO] - 03-16 22:33:52 - [main.backward:225]: Epoch 267/300 - Iteration 66/199 - Time 0.224 batch, 0.038 data, 0.199 forward
[INFO] - 03-16 22:33:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0042)
[INFO] - 03-16 22:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6141 (0.5802)
[INFO] - 03-16 22:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0682 (-140.2103)
[INFO] - 03-16 22:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3106 (19.3410)
[INFO] - 03-16 22:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8667 (190.8070)
[INFO] - 03-16 22:33:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9514)
[INFO] - 03-16 22:34:01 - [main.backward:225]: Epoch 267/300 - Iteration 116/199 - Time 0.211 batch, 0.032 data, 0.186 forward
[INFO] - 03-16 22:34:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:34:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0046)
[INFO] - 03-16 22:34:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5751 (0.5773)
[INFO] - 03-16 22:34:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1903 (-140.2254)
[INFO] - 03-16 22:34:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3985 (19.3630)
[INFO] - 03-16 22:34:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.8075 (191.2001)
[INFO] - 03-16 22:34:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:34:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9416)
[INFO] - 03-16 22:34:11 - [main.backward:225]: Epoch 267/300 - Iteration 166/199 - Time 0.206 batch, 0.030 data, 0.182 forward
[INFO] - 03-16 22:34:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0052)
[INFO] - 03-16 22:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6069 (0.5863)
[INFO] - 03-16 22:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2329 (-140.2026)
[INFO] - 03-16 22:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3403 (19.3544)
[INFO] - 03-16 22:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.0090 (191.1975)
[INFO] - 03-16 22:34:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:34:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9358)
[INFO] - 03-16 22:34:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:34:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:34:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:34:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:34:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:34:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:34:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:34:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.434
[INFO] - 03-16 22:34:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.435
[INFO] - 03-16 22:34:21 - [main.summary_metrics:168]: Epoch 267/300 - Test Results:
{'auc': 0.8614532232704402,
 'f1': 0.43682631833575225,
 'loss': 0.43001172949033206,
 'ndcg': 0.7604326678326744,
 'precision': 0.6509433962264151,
 'recall': 0.3290094339622642}
[INFO] - 03-16 22:34:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[267] Complete. Time taken: 00:00:44.485
[INFO] - 03-16 22:34:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:34:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:34:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:34:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:34:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:34:21 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7235, 4952, 5110]
[INFO] - 03-16 22:34:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:34:26 - [main.backward:225]: Epoch 268/300 - Iteration 17/199 - Time 0.245 batch, 0.077 data, 0.221 forward
[INFO] - 03-16 22:34:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0046)
[INFO] - 03-16 22:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5836)
[INFO] - 03-16 22:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1862 (-140.1961)
[INFO] - 03-16 22:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3056 (19.3399)
[INFO] - 03-16 22:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.9248 (190.9261)
[INFO] - 03-16 22:34:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:34:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9434)
[INFO] - 03-16 22:34:35 - [main.backward:225]: Epoch 268/300 - Iteration 67/199 - Time 0.207 batch, 0.037 data, 0.183 forward
[INFO] - 03-16 22:34:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:34:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0041)
[INFO] - 03-16 22:34:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6235 (0.5805)
[INFO] - 03-16 22:34:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0618 (-140.2060)
[INFO] - 03-16 22:34:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2958 (19.3371)
[INFO] - 03-16 22:34:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.7145 (190.6997)
[INFO] - 03-16 22:34:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:34:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9559)
[INFO] - 03-16 22:34:45 - [main.backward:225]: Epoch 268/300 - Iteration 117/199 - Time 0.205 batch, 0.032 data, 0.181 forward
[INFO] - 03-16 22:34:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0043)
[INFO] - 03-16 22:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5928 (0.5733)
[INFO] - 03-16 22:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1311 (-140.2277)
[INFO] - 03-16 22:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3744 (19.3664)
[INFO] - 03-16 22:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.5536 (191.0304)
[INFO] - 03-16 22:34:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:34:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9489)
[INFO] - 03-16 22:34:55 - [main.backward:225]: Epoch 268/300 - Iteration 167/199 - Time 0.202 batch, 0.030 data, 0.178 forward
[INFO] - 03-16 22:34:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:34:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0094 (0.0051)
[INFO] - 03-16 22:34:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5959 (0.5854)
[INFO] - 03-16 22:34:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2430 (-140.2038)
[INFO] - 03-16 22:34:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3136 (19.3515)
[INFO] - 03-16 22:34:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4259 (191.3861)
[INFO] - 03-16 22:34:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:34:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9358)
[INFO] - 03-16 22:35:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:35:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:35:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:35:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:35:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:35:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:35:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:35:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.050
[INFO] - 03-16 22:35:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.051
[INFO] - 03-16 22:35:04 - [main.summary_metrics:168]: Epoch 268/300 - Test Results:
{'auc': 0.8576455712788261,
 'f1': 0.4368263183357522,
 'loss': 0.43068363214488803,
 'ndcg': 0.7581195182186445,
 'precision': 0.6509433962264151,
 'recall': 0.3290094339622642}
[INFO] - 03-16 22:35:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[268] Complete. Time taken: 00:00:43.056
[INFO] - 03-16 22:35:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:35:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:35:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:35:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:35:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:35:04 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7237, 4973, 5135]
[INFO] - 03-16 22:35:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:35:09 - [main.backward:225]: Epoch 269/300 - Iteration 18/199 - Time 0.248 batch, 0.076 data, 0.223 forward
[INFO] - 03-16 22:35:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0057 (0.0048)
[INFO] - 03-16 22:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5962 (0.5834)
[INFO] - 03-16 22:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1974 (-140.1909)
[INFO] - 03-16 22:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3761 (19.3108)
[INFO] - 03-16 22:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.7921 (190.9159)
[INFO] - 03-16 22:35:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9413)
[INFO] - 03-16 22:35:19 - [main.backward:225]: Epoch 269/300 - Iteration 68/199 - Time 0.220 batch, 0.038 data, 0.196 forward
[INFO] - 03-16 22:35:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0044)
[INFO] - 03-16 22:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5760 (0.5790)
[INFO] - 03-16 22:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2082 (-140.2060)
[INFO] - 03-16 22:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2039 (19.3265)
[INFO] - 03-16 22:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.6097 (190.8471)
[INFO] - 03-16 22:35:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9506)
[INFO] - 03-16 22:35:29 - [main.backward:225]: Epoch 269/300 - Iteration 118/199 - Time 0.212 batch, 0.033 data, 0.187 forward
[INFO] - 03-16 22:35:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:35:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0047)
[INFO] - 03-16 22:35:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5934 (0.5762)
[INFO] - 03-16 22:35:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1058 (-140.2214)
[INFO] - 03-16 22:35:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3086 (19.3405)
[INFO] - 03-16 22:35:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.0439 (191.0164)
[INFO] - 03-16 22:35:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:35:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9427)
[INFO] - 03-16 22:35:39 - [main.backward:225]: Epoch 269/300 - Iteration 168/199 - Time 0.208 batch, 0.030 data, 0.183 forward
[INFO] - 03-16 22:35:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0052)
[INFO] - 03-16 22:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5929 (0.5868)
[INFO] - 03-16 22:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2257 (-140.2060)
[INFO] - 03-16 22:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3913 (19.3794)
[INFO] - 03-16 22:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.6888 (191.1328)
[INFO] - 03-16 22:35:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9352)
[INFO] - 03-16 22:35:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:35:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:35:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:35:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:35:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:35:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:35:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:35:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.980
[INFO] - 03-16 22:35:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.981
[INFO] - 03-16 22:35:48 - [main.summary_metrics:168]: Epoch 269/300 - Test Results:
{'auc': 0.8594808045073374,
 'f1': 0.43431059506531194,
 'loss': 0.42978067639188944,
 'ndcg': 0.7573541651736275,
 'precision': 0.6471698113207549,
 'recall': 0.32712264150943404}
[INFO] - 03-16 22:35:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[269] Complete. Time taken: 00:00:43.789
[INFO] - 03-16 22:35:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:35:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:35:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:35:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:35:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:35:48 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7243, 4981, 5121]
[INFO] - 03-16 22:35:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:35:53 - [main.backward:225]: Epoch 270/300 - Iteration 19/199 - Time 0.232 batch, 0.073 data, 0.206 forward
[INFO] - 03-16 22:35:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:35:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0050)
[INFO] - 03-16 22:35:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6050 (0.5826)
[INFO] - 03-16 22:35:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1827 (-140.1872)
[INFO] - 03-16 22:35:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2862 (19.3321)
[INFO] - 03-16 22:35:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8072 (190.8148)
[INFO] - 03-16 22:35:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:35:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9376)
[INFO] - 03-16 22:36:02 - [main.backward:225]: Epoch 270/300 - Iteration 69/199 - Time 0.204 batch, 0.037 data, 0.180 forward
[INFO] - 03-16 22:36:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0043)
[INFO] - 03-16 22:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5067 (0.5777)
[INFO] - 03-16 22:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3653 (-140.2062)
[INFO] - 03-16 22:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2179 (19.3451)
[INFO] - 03-16 22:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.2893 (190.8807)
[INFO] - 03-16 22:36:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9491)
[INFO] - 03-16 22:36:12 - [main.backward:225]: Epoch 270/300 - Iteration 119/199 - Time 0.201 batch, 0.031 data, 0.177 forward
[INFO] - 03-16 22:36:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:36:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0059 (0.0044)
[INFO] - 03-16 22:36:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6135 (0.5786)
[INFO] - 03-16 22:36:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1188 (-140.2166)
[INFO] - 03-16 22:36:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3532 (19.3477)
[INFO] - 03-16 22:36:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.2417 (190.8637)
[INFO] - 03-16 22:36:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:36:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9478)
[INFO] - 03-16 22:36:22 - [main.backward:225]: Epoch 270/300 - Iteration 169/199 - Time 0.201 batch, 0.029 data, 0.177 forward
[INFO] - 03-16 22:36:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:36:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0050)
[INFO] - 03-16 22:36:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5790 (0.5862)
[INFO] - 03-16 22:36:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2305 (-140.2039)
[INFO] - 03-16 22:36:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2528 (19.3386)
[INFO] - 03-16 22:36:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8309 (191.0820)
[INFO] - 03-16 22:36:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:36:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9413)
[INFO] - 03-16 22:36:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:36:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:36:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:36:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:36:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:36:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:36:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:36:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.314
[INFO] - 03-16 22:36:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.314
[INFO] - 03-16 22:36:31 - [main.summary_metrics:168]: Epoch 270/300 - Test Results:
{'auc': 0.8554202699161426,
 'f1': 0.42927914852443155,
 'loss': 0.4306357222183196,
 'ndcg': 0.7572709526313981,
 'precision': 0.6396226415094339,
 'recall': 0.32334905660377355}
[INFO] - 03-16 22:36:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[270] Complete. Time taken: 00:00:43.161
[INFO] - 03-16 22:36:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:36:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:36:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:36:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:36:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:36:31 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7234, 4984, 5095]
[INFO] - 03-16 22:36:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:36:36 - [main.backward:225]: Epoch 271/300 - Iteration 20/199 - Time 0.242 batch, 0.071 data, 0.217 forward
[INFO] - 03-16 22:36:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:36:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0045)
[INFO] - 03-16 22:36:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5930 (0.5833)
[INFO] - 03-16 22:36:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2217 (-140.1850)
[INFO] - 03-16 22:36:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2386 (19.2924)
[INFO] - 03-16 22:36:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4685 (190.5597)
[INFO] - 03-16 22:36:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:36:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9451)
[INFO] - 03-16 22:36:46 - [main.backward:225]: Epoch 271/300 - Iteration 70/199 - Time 0.205 batch, 0.038 data, 0.181 forward
[INFO] - 03-16 22:36:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:36:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0017 (0.0041)
[INFO] - 03-16 22:36:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5149 (0.5755)
[INFO] - 03-16 22:36:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3702 (-140.2077)
[INFO] - 03-16 22:36:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2246 (19.3171)
[INFO] - 03-16 22:36:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.7235 (190.7097)
[INFO] - 03-16 22:36:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:36:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9511)
[INFO] - 03-16 22:36:55 - [main.backward:225]: Epoch 271/300 - Iteration 120/199 - Time 0.201 batch, 0.032 data, 0.177 forward
[INFO] - 03-16 22:36:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:36:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0046)
[INFO] - 03-16 22:36:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6053 (0.5793)
[INFO] - 03-16 22:36:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1202 (-140.2133)
[INFO] - 03-16 22:36:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2578 (19.3283)
[INFO] - 03-16 22:36:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.6061 (191.0729)
[INFO] - 03-16 22:36:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:36:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9445)
[INFO] - 03-16 22:37:05 - [main.backward:225]: Epoch 271/300 - Iteration 170/199 - Time 0.198 batch, 0.030 data, 0.174 forward
[INFO] - 03-16 22:37:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0050)
[INFO] - 03-16 22:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5254 (0.5838)
[INFO] - 03-16 22:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2049 (-140.2029)
[INFO] - 03-16 22:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2142 (19.3272)
[INFO] - 03-16 22:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.8759 (191.2317)
[INFO] - 03-16 22:37:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9384)
[INFO] - 03-16 22:37:11 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:37:11 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:37:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:37:11 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:37:11 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:37:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:37:11 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:37:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.231
[INFO] - 03-16 22:37:14 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.232
[INFO] - 03-16 22:37:14 - [main.summary_metrics:168]: Epoch 271/300 - Test Results:
{'auc': 0.8661258844339622,
 'f1': 0.45217223028543785,
 'loss': 0.4249923770832566,
 'ndcg': 0.7678093764134105,
 'precision': 0.6735849056603773,
 'recall': 0.34064465408805034}
[INFO] - 03-16 22:37:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[271] Complete. Time taken: 00:00:42.459
[INFO] - 03-16 22:37:14 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:37:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:37:14 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:37:14 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:37:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:37:14 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7253, 5008, 5132]
[INFO] - 03-16 22:37:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:37:19 - [main.backward:225]: Epoch 272/300 - Iteration 21/199 - Time 0.242 batch, 0.071 data, 0.216 forward
[INFO] - 03-16 22:37:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0046)
[INFO] - 03-16 22:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5854 (0.5840)
[INFO] - 03-16 22:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2079 (-140.1841)
[INFO] - 03-16 22:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1997 (19.2716)
[INFO] - 03-16 22:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3517 (190.6939)
[INFO] - 03-16 22:37:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:37:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9461)
[INFO] - 03-16 22:37:29 - [main.backward:225]: Epoch 272/300 - Iteration 71/199 - Time 0.210 batch, 0.038 data, 0.185 forward
[INFO] - 03-16 22:37:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:37:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0038)
[INFO] - 03-16 22:37:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5118 (0.5746)
[INFO] - 03-16 22:37:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3574 (-140.2102)
[INFO] - 03-16 22:37:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1595 (19.2654)
[INFO] - 03-16 22:37:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5267 (190.5449)
[INFO] - 03-16 22:37:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:37:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9583)
[INFO] - 03-16 22:37:38 - [main.backward:225]: Epoch 272/300 - Iteration 121/199 - Time 0.203 batch, 0.032 data, 0.178 forward
[INFO] - 03-16 22:37:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:37:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0046)
[INFO] - 03-16 22:37:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5790 (0.5808)
[INFO] - 03-16 22:37:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2732 (-140.2110)
[INFO] - 03-16 22:37:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2823 (19.2928)
[INFO] - 03-16 22:37:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.4322 (190.9126)
[INFO] - 03-16 22:37:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:37:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9442)
[INFO] - 03-16 22:37:48 - [main.backward:225]: Epoch 272/300 - Iteration 171/199 - Time 0.199 batch, 0.030 data, 0.175 forward
[INFO] - 03-16 22:37:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:37:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0049)
[INFO] - 03-16 22:37:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5382 (0.5835)
[INFO] - 03-16 22:37:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1896 (-140.1960)
[INFO] - 03-16 22:37:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2575 (19.2792)
[INFO] - 03-16 22:37:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.6266 (191.1748)
[INFO] - 03-16 22:37:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:37:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9381)
[INFO] - 03-16 22:37:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:37:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:37:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:37:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:37:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:37:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:37:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:37:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.007
[INFO] - 03-16 22:37:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.008
[INFO] - 03-16 22:37:56 - [main.summary_metrics:168]: Epoch 272/300 - Test Results:
{'auc': 0.8596038063417192,
 'f1': 0.4393420416061926,
 'loss': 0.4296600243670386,
 'ndcg': 0.7609743279017501,
 'precision': 0.6547169811320752,
 'recall': 0.3308962264150943}
[INFO] - 03-16 22:37:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[272] Complete. Time taken: 00:00:42.441
[INFO] - 03-16 22:37:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:37:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:37:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:37:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:37:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:37:56 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7198, 4989, 5142]
[INFO] - 03-16 22:37:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:38:02 - [main.backward:225]: Epoch 273/300 - Iteration 22/199 - Time 0.245 batch, 0.065 data, 0.221 forward
[INFO] - 03-16 22:38:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0048)
[INFO] - 03-16 22:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5850 (0.5844)
[INFO] - 03-16 22:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2187 (-140.1859)
[INFO] - 03-16 22:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2265 (19.2529)
[INFO] - 03-16 22:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5754 (190.5253)
[INFO] - 03-16 22:38:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9410)
[INFO] - 03-16 22:38:12 - [main.backward:225]: Epoch 273/300 - Iteration 72/199 - Time 0.213 batch, 0.037 data, 0.188 forward
[INFO] - 03-16 22:38:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0039)
[INFO] - 03-16 22:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5978 (0.5756)
[INFO] - 03-16 22:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1922 (-140.2139)
[INFO] - 03-16 22:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2927 (19.2770)
[INFO] - 03-16 22:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.2487 (190.5394)
[INFO] - 03-16 22:38:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:38:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9577)
[INFO] - 03-16 22:38:22 - [main.backward:225]: Epoch 273/300 - Iteration 122/199 - Time 0.208 batch, 0.032 data, 0.183 forward
[INFO] - 03-16 22:38:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0047)
[INFO] - 03-16 22:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5819)
[INFO] - 03-16 22:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2440 (-140.2080)
[INFO] - 03-16 22:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2618 (19.2938)
[INFO] - 03-16 22:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4656 (190.8535)
[INFO] - 03-16 22:38:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:38:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9453)
[INFO] - 03-16 22:38:31 - [main.backward:225]: Epoch 273/300 - Iteration 172/199 - Time 0.202 batch, 0.030 data, 0.177 forward
[INFO] - 03-16 22:38:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:38:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0049)
[INFO] - 03-16 22:38:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5304 (0.5808)
[INFO] - 03-16 22:38:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1727 (-140.1898)
[INFO] - 03-16 22:38:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2719 (19.2788)
[INFO] - 03-16 22:38:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 192.2086 (191.1289)
[INFO] - 03-16 22:38:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:38:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9402)
[INFO] - 03-16 22:38:36 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:38:36 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:38:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:38:36 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:38:36 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:38:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:38:36 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:38:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.314
[INFO] - 03-16 22:38:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.314
[INFO] - 03-16 22:38:40 - [main.summary_metrics:168]: Epoch 273/300 - Test Results:
{'auc': 0.8675025222746333,
 'f1': 0.45695210449927426,
 'loss': 0.4255983061080709,
 'ndcg': 0.7714987976623777,
 'precision': 0.681132075471698,
 'recall': 0.3441037735849056}
[INFO] - 03-16 22:38:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[273] Complete. Time taken: 00:00:43.304
[INFO] - 03-16 22:38:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:38:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:38:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:38:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:38:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:38:40 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7242, 4986, 5119]
[INFO] - 03-16 22:38:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:38:45 - [main.backward:225]: Epoch 274/300 - Iteration 23/199 - Time 0.233 batch, 0.063 data, 0.208 forward
[INFO] - 03-16 22:38:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:38:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0048)
[INFO] - 03-16 22:38:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5980 (0.5862)
[INFO] - 03-16 22:38:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1444 (-140.1784)
[INFO] - 03-16 22:38:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2876 (19.2712)
[INFO] - 03-16 22:38:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5755 (190.5832)
[INFO] - 03-16 22:38:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:38:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9465)
[INFO] - 03-16 22:38:54 - [main.backward:225]: Epoch 274/300 - Iteration 73/199 - Time 0.203 batch, 0.037 data, 0.178 forward
[INFO] - 03-16 22:38:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:38:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0041)
[INFO] - 03-16 22:38:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6133 (0.5747)
[INFO] - 03-16 22:38:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1653 (-140.2113)
[INFO] - 03-16 22:38:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2844 (19.3120)
[INFO] - 03-16 22:38:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5687 (190.8722)
[INFO] - 03-16 22:38:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:38:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9555)
[INFO] - 03-16 22:39:04 - [main.backward:225]: Epoch 274/300 - Iteration 123/199 - Time 0.199 batch, 0.033 data, 0.174 forward
[INFO] - 03-16 22:39:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0049)
[INFO] - 03-16 22:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5817)
[INFO] - 03-16 22:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2426 (-140.2077)
[INFO] - 03-16 22:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2915 (19.3347)
[INFO] - 03-16 22:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.3617 (191.0195)
[INFO] - 03-16 22:39:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.9384)
[INFO] - 03-16 22:39:14 - [main.backward:225]: Epoch 274/300 - Iteration 173/199 - Time 0.198 batch, 0.030 data, 0.172 forward
[INFO] - 03-16 22:39:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0050)
[INFO] - 03-16 22:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5530 (0.5820)
[INFO] - 03-16 22:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1913 (-140.1876)
[INFO] - 03-16 22:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3321 (19.3288)
[INFO] - 03-16 22:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.5165 (191.2793)
[INFO] - 03-16 22:39:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:39:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9347)
[INFO] - 03-16 22:39:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:39:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:39:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:39:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:39:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:39:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:39:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:39:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.248
[INFO] - 03-16 22:39:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.248
[INFO] - 03-16 22:39:22 - [main.summary_metrics:168]: Epoch 274/300 - Test Results:
{'auc': 0.8624500131027253,
 'f1': 0.43556845670053207,
 'loss': 0.42729307566548796,
 'ndcg': 0.7596746735014737,
 'precision': 0.649056603773585,
 'recall': 0.3280660377358492}
[INFO] - 03-16 22:39:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[274] Complete. Time taken: 00:00:42.538
[INFO] - 03-16 22:39:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:39:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:39:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:39:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:39:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:39:22 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7209, 5002, 5162]
[INFO] - 03-16 22:39:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:39:28 - [main.backward:225]: Epoch 275/300 - Iteration 24/199 - Time 0.234 batch, 0.066 data, 0.209 forward
[INFO] - 03-16 22:39:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:39:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0048)
[INFO] - 03-16 22:39:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6163 (0.5873)
[INFO] - 03-16 22:39:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0248 (-140.1712)
[INFO] - 03-16 22:39:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3504 (19.2972)
[INFO] - 03-16 22:39:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.3003 (190.6696)
[INFO] - 03-16 22:39:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:39:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9443)
[INFO] - 03-16 22:39:38 - [main.backward:225]: Epoch 275/300 - Iteration 74/199 - Time 0.214 batch, 0.038 data, 0.189 forward
[INFO] - 03-16 22:39:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:39:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0038)
[INFO] - 03-16 22:39:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6144 (0.5752)
[INFO] - 03-16 22:39:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1578 (-140.2105)
[INFO] - 03-16 22:39:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3068 (19.2916)
[INFO] - 03-16 22:39:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3183 (190.8336)
[INFO] - 03-16 22:39:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:39:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9587)
[INFO] - 03-16 22:39:48 - [main.backward:225]: Epoch 275/300 - Iteration 124/199 - Time 0.209 batch, 0.033 data, 0.183 forward
[INFO] - 03-16 22:39:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0050)
[INFO] - 03-16 22:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5916 (0.5803)
[INFO] - 03-16 22:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1899 (-140.2053)
[INFO] - 03-16 22:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3920 (19.3221)
[INFO] - 03-16 22:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.3766 (191.0703)
[INFO] - 03-16 22:39:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9350)
[INFO] - 03-16 22:39:58 - [main.backward:225]: Epoch 275/300 - Iteration 174/199 - Time 0.207 batch, 0.031 data, 0.181 forward
[INFO] - 03-16 22:39:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:39:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0046)
[INFO] - 03-16 22:39:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5794 (0.5812)
[INFO] - 03-16 22:39:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1983 (-140.1863)
[INFO] - 03-16 22:39:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2987 (19.2957)
[INFO] - 03-16 22:39:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5797 (191.0633)
[INFO] - 03-16 22:39:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:39:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9439)
[INFO] - 03-16 22:40:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:40:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:40:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:40:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:40:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:40:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:40:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:40:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.163
[INFO] - 03-16 22:40:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.164
[INFO] - 03-16 22:40:07 - [main.summary_metrics:168]: Epoch 275/300 - Test Results:
{'auc': 0.8562481328616351,
 'f1': 0.4280212868892114,
 'loss': 0.4293739980661645,
 'ndcg': 0.7496221022502559,
 'precision': 0.6377358490566037,
 'recall': 0.32240566037735846}
[INFO] - 03-16 22:40:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[275] Complete. Time taken: 00:00:44.351
[INFO] - 03-16 22:40:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:40:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:40:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:40:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:40:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:40:07 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7261, 5020, 5157]
[INFO] - 03-16 22:40:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:40:12 - [main.backward:225]: Epoch 276/300 - Iteration 25/199 - Time 0.234 batch, 0.066 data, 0.209 forward
[INFO] - 03-16 22:40:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:40:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0049)
[INFO] - 03-16 22:40:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5972 (0.5871)
[INFO] - 03-16 22:40:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0609 (-140.1671)
[INFO] - 03-16 22:40:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2852 (19.2836)
[INFO] - 03-16 22:40:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5044 (190.4655)
[INFO] - 03-16 22:40:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:40:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9370)
[INFO] - 03-16 22:40:22 - [main.backward:225]: Epoch 276/300 - Iteration 75/199 - Time 0.213 batch, 0.039 data, 0.187 forward
[INFO] - 03-16 22:40:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0038)
[INFO] - 03-16 22:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6150 (0.5749)
[INFO] - 03-16 22:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1670 (-140.2143)
[INFO] - 03-16 22:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3470 (19.3034)
[INFO] - 03-16 22:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.9781 (190.7611)
[INFO] - 03-16 22:40:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9572)
[INFO] - 03-16 22:40:32 - [main.backward:225]: Epoch 276/300 - Iteration 125/199 - Time 0.205 batch, 0.034 data, 0.179 forward
[INFO] - 03-16 22:40:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:40:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0050)
[INFO] - 03-16 22:40:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5968 (0.5813)
[INFO] - 03-16 22:40:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0540 (-140.2027)
[INFO] - 03-16 22:40:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.4061 (19.3332)
[INFO] - 03-16 22:40:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6872 (191.0444)
[INFO] - 03-16 22:40:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:40:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9366)
[INFO] - 03-16 22:40:41 - [main.backward:225]: Epoch 276/300 - Iteration 175/199 - Time 0.200 batch, 0.031 data, 0.174 forward
[INFO] - 03-16 22:40:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0047)
[INFO] - 03-16 22:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5805)
[INFO] - 03-16 22:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1822 (-140.1869)
[INFO] - 03-16 22:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2791 (19.3157)
[INFO] - 03-16 22:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.2979 (191.2041)
[INFO] - 03-16 22:40:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9419)
[INFO] - 03-16 22:40:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:40:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:40:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:40:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:40:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:40:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:40:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:40:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.184
[INFO] - 03-16 22:40:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.185
[INFO] - 03-16 22:40:49 - [main.summary_metrics:168]: Epoch 276/300 - Test Results:
{'auc': 0.8619365828092244,
 'f1': 0.43682631833575225,
 'loss': 0.4262546697852495,
 'ndcg': 0.7605725713932748,
 'precision': 0.6509433962264151,
 'recall': 0.3290094339622642}
[INFO] - 03-16 22:40:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[276] Complete. Time taken: 00:00:42.674
[INFO] - 03-16 22:40:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:40:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:40:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:40:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:40:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:40:49 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7255, 4998, 5143]
[INFO] - 03-16 22:40:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:40:56 - [main.backward:225]: Epoch 277/300 - Iteration 26/199 - Time 0.255 batch, 0.061 data, 0.229 forward
[INFO] - 03-16 22:40:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0046)
[INFO] - 03-16 22:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6112 (0.5902)
[INFO] - 03-16 22:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0818 (-140.1589)
[INFO] - 03-16 22:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3394 (19.2725)
[INFO] - 03-16 22:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4162 (190.4640)
[INFO] - 03-16 22:40:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9419)
[INFO] - 03-16 22:41:06 - [main.backward:225]: Epoch 277/300 - Iteration 76/199 - Time 0.217 batch, 0.037 data, 0.192 forward
[INFO] - 03-16 22:41:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:41:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0039)
[INFO] - 03-16 22:41:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5603 (0.5735)
[INFO] - 03-16 22:41:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2641 (-140.2233)
[INFO] - 03-16 22:41:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3523 (19.2993)
[INFO] - 03-16 22:41:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6793 (190.7236)
[INFO] - 03-16 22:41:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:41:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9563)
[INFO] - 03-16 22:41:15 - [main.backward:225]: Epoch 277/300 - Iteration 126/199 - Time 0.208 batch, 0.032 data, 0.183 forward
[INFO] - 03-16 22:41:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0051)
[INFO] - 03-16 22:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6036 (0.5814)
[INFO] - 03-16 22:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0411 (-140.2038)
[INFO] - 03-16 22:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3446 (19.3154)
[INFO] - 03-16 22:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8684 (190.9251)
[INFO] - 03-16 22:41:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9387)
[INFO] - 03-16 22:41:25 - [main.backward:225]: Epoch 277/300 - Iteration 176/199 - Time 0.204 batch, 0.031 data, 0.179 forward
[INFO] - 03-16 22:41:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0049)
[INFO] - 03-16 22:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5790 (0.5797)
[INFO] - 03-16 22:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2020 (-140.1945)
[INFO] - 03-16 22:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3076 (19.2982)
[INFO] - 03-16 22:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5269 (191.0604)
[INFO] - 03-16 22:41:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:41:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9384)
[INFO] - 03-16 22:41:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:41:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:41:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:41:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:41:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:41:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:41:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:41:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.313
[INFO] - 03-16 22:41:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.315
[INFO] - 03-16 22:41:33 - [main.summary_metrics:168]: Epoch 277/300 - Test Results:
{'auc': 0.8578726087526206,
 'f1': 0.4405999032414127,
 'loss': 0.43060538489463707,
 'ndcg': 0.7552205233157036,
 'precision': 0.6566037735849056,
 'recall': 0.33183962264150935}
[INFO] - 03-16 22:41:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[277] Complete. Time taken: 00:00:43.944
[INFO] - 03-16 22:41:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:41:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:41:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:41:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:41:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:41:33 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7247, 4994, 5149]
[INFO] - 03-16 22:41:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:41:39 - [main.backward:225]: Epoch 278/300 - Iteration 27/199 - Time 0.225 batch, 0.059 data, 0.200 forward
[INFO] - 03-16 22:41:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:41:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0049)
[INFO] - 03-16 22:41:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5966 (0.5890)
[INFO] - 03-16 22:41:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1544 (-140.1634)
[INFO] - 03-16 22:41:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3712 (19.2763)
[INFO] - 03-16 22:41:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.0681 (190.5513)
[INFO] - 03-16 22:41:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:41:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9382)
[INFO] - 03-16 22:41:49 - [main.backward:225]: Epoch 278/300 - Iteration 77/199 - Time 0.204 batch, 0.037 data, 0.178 forward
[INFO] - 03-16 22:41:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:41:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0040)
[INFO] - 03-16 22:41:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5709 (0.5746)
[INFO] - 03-16 22:41:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2876 (-140.2375)
[INFO] - 03-16 22:41:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2390 (19.2705)
[INFO] - 03-16 22:41:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8286 (190.5799)
[INFO] - 03-16 22:41:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:41:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9556)
[INFO] - 03-16 22:41:59 - [main.backward:225]: Epoch 278/300 - Iteration 127/199 - Time 0.204 batch, 0.033 data, 0.179 forward
[INFO] - 03-16 22:41:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:41:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0048)
[INFO] - 03-16 22:41:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5905 (0.5816)
[INFO] - 03-16 22:41:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0732 (-140.2207)
[INFO] - 03-16 22:41:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3231 (19.2882)
[INFO] - 03-16 22:41:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.7751 (190.5736)
[INFO] - 03-16 22:41:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:41:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9414)
[INFO] - 03-16 22:42:09 - [main.backward:225]: Epoch 278/300 - Iteration 177/199 - Time 0.202 batch, 0.031 data, 0.177 forward
[INFO] - 03-16 22:42:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:42:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0048)
[INFO] - 03-16 22:42:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5983 (0.5793)
[INFO] - 03-16 22:42:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1445 (-140.2167)
[INFO] - 03-16 22:42:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3702 (19.2845)
[INFO] - 03-16 22:42:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.4250 (191.1298)
[INFO] - 03-16 22:42:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:42:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9403)
[INFO] - 03-16 22:42:13 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:42:13 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:42:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:42:13 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:42:13 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:42:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:42:13 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:42:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.289
[INFO] - 03-16 22:42:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.292
[INFO] - 03-16 22:42:16 - [main.summary_metrics:168]: Epoch 278/300 - Test Results:
{'auc': 0.8465163456498952,
 'f1': 0.4255055636187711,
 'loss': 0.43290183998603743,
 'ndcg': 0.7417145167801853,
 'precision': 0.6339622641509435,
 'recall': 0.32051886792452833}
[INFO] - 03-16 22:42:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[278] Complete. Time taken: 00:00:43.368
[INFO] - 03-16 22:42:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:42:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:42:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:42:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:42:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:42:17 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7226, 4989, 5112]
[INFO] - 03-16 22:42:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:42:23 - [main.backward:225]: Epoch 279/300 - Iteration 28/199 - Time 0.221 batch, 0.055 data, 0.196 forward
[INFO] - 03-16 22:42:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0047)
[INFO] - 03-16 22:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6120 (0.5895)
[INFO] - 03-16 22:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1973 (-140.1852)
[INFO] - 03-16 22:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2244 (19.2798)
[INFO] - 03-16 22:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.7141 (190.7562)
[INFO] - 03-16 22:42:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9452)
[INFO] - 03-16 22:42:34 - [main.backward:225]: Epoch 279/300 - Iteration 78/199 - Time 0.221 batch, 0.037 data, 0.195 forward
[INFO] - 03-16 22:42:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:42:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0041)
[INFO] - 03-16 22:42:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5551 (0.5722)
[INFO] - 03-16 22:42:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3020 (-140.2432)
[INFO] - 03-16 22:42:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2245 (19.2633)
[INFO] - 03-16 22:42:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3580 (190.5596)
[INFO] - 03-16 22:42:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:42:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9531)
[INFO] - 03-16 22:42:44 - [main.backward:225]: Epoch 279/300 - Iteration 128/199 - Time 0.211 batch, 0.032 data, 0.185 forward
[INFO] - 03-16 22:42:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0048)
[INFO] - 03-16 22:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6163 (0.5831)
[INFO] - 03-16 22:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1134 (-140.2367)
[INFO] - 03-16 22:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3316 (19.3041)
[INFO] - 03-16 22:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.0938 (190.6167)
[INFO] - 03-16 22:42:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:42:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9442)
[INFO] - 03-16 22:42:54 - [main.backward:225]: Epoch 279/300 - Iteration 178/199 - Time 0.211 batch, 0.031 data, 0.185 forward
[INFO] - 03-16 22:42:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:42:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0046)
[INFO] - 03-16 22:42:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6000 (0.5804)
[INFO] - 03-16 22:42:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1797 (-140.2390)
[INFO] - 03-16 22:42:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3227 (19.2835)
[INFO] - 03-16 22:42:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8573 (190.8674)
[INFO] - 03-16 22:42:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:42:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9409)
[INFO] - 03-16 22:42:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:42:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:42:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:42:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:42:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:42:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:42:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:43:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.937
[INFO] - 03-16 22:43:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.937
[INFO] - 03-16 22:43:02 - [main.summary_metrics:168]: Epoch 279/300 - Test Results:
{'auc': 0.8488346108490565,
 'f1': 0.424247701983551,
 'loss': 0.432400561858523,
 'ndcg': 0.7442376811292083,
 'precision': 0.6320754716981132,
 'recall': 0.31957547169811323}
[INFO] - 03-16 22:43:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[279] Complete. Time taken: 00:00:45.874
[INFO] - 03-16 22:43:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:43:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:43:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:43:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:43:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:43:02 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7252, 4990, 5167]
[INFO] - 03-16 22:43:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:43:09 - [main.backward:225]: Epoch 280/300 - Iteration 29/199 - Time 0.224 batch, 0.055 data, 0.198 forward
[INFO] - 03-16 22:43:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:43:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0049)
[INFO] - 03-16 22:43:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6041 (0.5908)
[INFO] - 03-16 22:43:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2180 (-140.2026)
[INFO] - 03-16 22:43:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2593 (19.2697)
[INFO] - 03-16 22:43:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.7554 (190.4947)
[INFO] - 03-16 22:43:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:43:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9391)
[INFO] - 03-16 22:43:19 - [main.backward:225]: Epoch 280/300 - Iteration 79/199 - Time 0.210 batch, 0.037 data, 0.183 forward
[INFO] - 03-16 22:43:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0037)
[INFO] - 03-16 22:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5717 (0.5717)
[INFO] - 03-16 22:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2841 (-140.2524)
[INFO] - 03-16 22:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2376 (19.2602)
[INFO] - 03-16 22:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.2481 (190.4172)
[INFO] - 03-16 22:43:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:43:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9602)
[INFO] - 03-16 22:43:28 - [main.backward:225]: Epoch 280/300 - Iteration 129/199 - Time 0.202 batch, 0.032 data, 0.176 forward
[INFO] - 03-16 22:43:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:43:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0049)
[INFO] - 03-16 22:43:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6038 (0.5829)
[INFO] - 03-16 22:43:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1250 (-140.2505)
[INFO] - 03-16 22:43:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3957 (19.3030)
[INFO] - 03-16 22:43:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.9025 (190.5462)
[INFO] - 03-16 22:43:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:43:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9414)
[INFO] - 03-16 22:43:38 - [main.backward:225]: Epoch 280/300 - Iteration 179/199 - Time 0.199 batch, 0.030 data, 0.174 forward
[INFO] - 03-16 22:43:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:43:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0046)
[INFO] - 03-16 22:43:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6062 (0.5789)
[INFO] - 03-16 22:43:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2157 (-140.2581)
[INFO] - 03-16 22:43:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3713 (19.2853)
[INFO] - 03-16 22:43:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.7414 (190.8026)
[INFO] - 03-16 22:43:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:43:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9428)
[INFO] - 03-16 22:43:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:43:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:43:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:43:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:43:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:43:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:43:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:43:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.045
[INFO] - 03-16 22:43:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.046
[INFO] - 03-16 22:43:45 - [main.summary_metrics:168]: Epoch 280/300 - Test Results:
{'auc': 0.8488530856918238,
 'f1': 0.4267634252539913,
 'loss': 0.4332757143824357,
 'ndcg': 0.7435429624408841,
 'precision': 0.6358490566037737,
 'recall': 0.3214622641509434}
[INFO] - 03-16 22:43:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[280] Complete. Time taken: 00:00:42.396
[INFO] - 03-16 22:43:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:43:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:43:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:43:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:43:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:43:45 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7238, 4972, 5104]
[INFO] - 03-16 22:43:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:43:51 - [main.backward:225]: Epoch 281/300 - Iteration 30/199 - Time 0.220 batch, 0.054 data, 0.195 forward
[INFO] - 03-16 22:43:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:43:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0050)
[INFO] - 03-16 22:43:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5990 (0.5890)
[INFO] - 03-16 22:43:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2184 (-140.2205)
[INFO] - 03-16 22:43:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3635 (19.2634)
[INFO] - 03-16 22:43:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6177 (190.3381)
[INFO] - 03-16 22:43:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:43:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9391)
[INFO] - 03-16 22:44:01 - [main.backward:225]: Epoch 281/300 - Iteration 80/199 - Time 0.207 batch, 0.035 data, 0.183 forward
[INFO] - 03-16 22:44:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0040)
[INFO] - 03-16 22:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6123 (0.5731)
[INFO] - 03-16 22:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2033 (-140.2685)
[INFO] - 03-16 22:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3034 (19.2450)
[INFO] - 03-16 22:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.2484 (190.3042)
[INFO] - 03-16 22:44:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9569)
[INFO] - 03-16 22:44:11 - [main.backward:225]: Epoch 281/300 - Iteration 130/199 - Time 0.203 batch, 0.031 data, 0.179 forward
[INFO] - 03-16 22:44:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:44:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0049)
[INFO] - 03-16 22:44:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6058 (0.5817)
[INFO] - 03-16 22:44:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1408 (-140.2569)
[INFO] - 03-16 22:44:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3020 (19.2893)
[INFO] - 03-16 22:44:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.7627 (190.3814)
[INFO] - 03-16 22:44:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:44:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9398)
[INFO] - 03-16 22:44:21 - [main.backward:225]: Epoch 281/300 - Iteration 180/199 - Time 0.202 batch, 0.029 data, 0.178 forward
[INFO] - 03-16 22:44:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0086 (0.0050)
[INFO] - 03-16 22:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6116 (0.5812)
[INFO] - 03-16 22:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2156 (-140.2630)
[INFO] - 03-16 22:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3023 (19.2802)
[INFO] - 03-16 22:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3795 (190.6788)
[INFO] - 03-16 22:44:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9337)
[INFO] - 03-16 22:44:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:44:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:44:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:44:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:44:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:44:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:44:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:44:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.353
[INFO] - 03-16 22:44:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.354
[INFO] - 03-16 22:44:28 - [main.summary_metrics:168]: Epoch 281/300 - Test Results:
{'auc': 0.8498628472222222,
 'f1': 0.4227382680212869,
 'loss': 0.43145072373604126,
 'ndcg': 0.7439475655585078,
 'precision': 0.630188679245283,
 'recall': 0.3183176100628931}
[INFO] - 03-16 22:44:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[281] Complete. Time taken: 00:00:43.562
[INFO] - 03-16 22:44:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:44:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:44:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:44:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:44:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:44:28 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7216, 5001, 5156]
[INFO] - 03-16 22:44:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:44:35 - [main.backward:225]: Epoch 282/300 - Iteration 31/199 - Time 0.221 batch, 0.057 data, 0.194 forward
[INFO] - 03-16 22:44:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0045)
[INFO] - 03-16 22:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5636 (0.5882)
[INFO] - 03-16 22:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2693 (-140.2425)
[INFO] - 03-16 22:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1826 (19.2591)
[INFO] - 03-16 22:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.2099 (190.2410)
[INFO] - 03-16 22:44:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9461)
[INFO] - 03-16 22:44:45 - [main.backward:225]: Epoch 282/300 - Iteration 81/199 - Time 0.205 batch, 0.037 data, 0.179 forward
[INFO] - 03-16 22:44:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:44:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0039)
[INFO] - 03-16 22:44:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6126 (0.5726)
[INFO] - 03-16 22:44:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1909 (-140.2842)
[INFO] - 03-16 22:44:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3084 (19.2433)
[INFO] - 03-16 22:44:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.9808 (190.3519)
[INFO] - 03-16 22:44:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:44:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9569)
[INFO] - 03-16 22:44:54 - [main.backward:225]: Epoch 282/300 - Iteration 131/199 - Time 0.199 batch, 0.032 data, 0.174 forward
[INFO] - 03-16 22:44:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0043)
[INFO] - 03-16 22:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5948 (0.5821)
[INFO] - 03-16 22:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1464 (-140.2520)
[INFO] - 03-16 22:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3750 (19.2867)
[INFO] - 03-16 22:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.2011 (190.4140)
[INFO] - 03-16 22:44:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9500)
[INFO] - 03-16 22:45:04 - [main.backward:225]: Epoch 282/300 - Iteration 181/199 - Time 0.199 batch, 0.030 data, 0.175 forward
[INFO] - 03-16 22:45:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:45:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0047)
[INFO] - 03-16 22:45:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5877 (0.5815)
[INFO] - 03-16 22:45:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2639 (-140.2551)
[INFO] - 03-16 22:45:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2779 (19.2680)
[INFO] - 03-16 22:45:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4233 (190.8423)
[INFO] - 03-16 22:45:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:45:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9411)
[INFO] - 03-16 22:45:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:45:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:45:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:45:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:45:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:45:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:45:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:45:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.115
[INFO] - 03-16 22:45:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.116
[INFO] - 03-16 22:45:11 - [main.summary_metrics:168]: Epoch 282/300 - Test Results:
{'auc': 0.8446873689727463,
 'f1': 0.41418480890179,
 'loss': 0.4329592294752972,
 'ndcg': 0.7387634380522312,
 'precision': 0.6169811320754718,
 'recall': 0.3120283018867925}
[INFO] - 03-16 22:45:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[282] Complete. Time taken: 00:00:42.533
[INFO] - 03-16 22:45:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:45:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:45:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:45:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:45:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:45:11 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7263, 5008, 5159]
[INFO] - 03-16 22:45:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:45:18 - [main.backward:225]: Epoch 283/300 - Iteration 32/199 - Time 0.217 batch, 0.058 data, 0.191 forward
[INFO] - 03-16 22:45:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:45:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0049)
[INFO] - 03-16 22:45:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5729 (0.5878)
[INFO] - 03-16 22:45:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3030 (-140.2549)
[INFO] - 03-16 22:45:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1615 (19.2479)
[INFO] - 03-16 22:45:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3778 (190.3937)
[INFO] - 03-16 22:45:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:45:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9384)
[INFO] - 03-16 22:45:27 - [main.backward:225]: Epoch 283/300 - Iteration 82/199 - Time 0.200 batch, 0.038 data, 0.175 forward
[INFO] - 03-16 22:45:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0068 (0.0038)
[INFO] - 03-16 22:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6131 (0.5743)
[INFO] - 03-16 22:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2393 (-140.3031)
[INFO] - 03-16 22:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2894 (19.2395)
[INFO] - 03-16 22:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.0305 (190.3515)
[INFO] - 03-16 22:45:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9564)
[INFO] - 03-16 22:45:37 - [main.backward:225]: Epoch 283/300 - Iteration 132/199 - Time 0.197 batch, 0.033 data, 0.172 forward
[INFO] - 03-16 22:45:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:45:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0046)
[INFO] - 03-16 22:45:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5952 (0.5811)
[INFO] - 03-16 22:45:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2373 (-140.2553)
[INFO] - 03-16 22:45:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2820 (19.3037)
[INFO] - 03-16 22:45:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4418 (190.5860)
[INFO] - 03-16 22:45:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:45:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9480)
[INFO] - 03-16 22:45:47 - [main.backward:225]: Epoch 283/300 - Iteration 182/199 - Time 0.198 batch, 0.031 data, 0.173 forward
[INFO] - 03-16 22:45:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:45:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0048)
[INFO] - 03-16 22:45:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5794)
[INFO] - 03-16 22:45:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2721 (-140.2576)
[INFO] - 03-16 22:45:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2178 (19.2826)
[INFO] - 03-16 22:45:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.9603 (190.8570)
[INFO] - 03-16 22:45:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:45:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9394)
[INFO] - 03-16 22:45:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:45:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:45:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:45:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:45:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:45:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:45:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:45:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.261
[INFO] - 03-16 22:45:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.262
[INFO] - 03-16 22:45:53 - [main.summary_metrics:168]: Epoch 283/300 - Test Results:
{'auc': 0.8479920728511531,
 'f1': 0.42153846153846153,
 'loss': 0.43287564076517615,
 'ndcg': 0.7396867562687619,
 'precision': 0.6283018867924528,
 'recall': 0.31745283018867926}
[INFO] - 03-16 22:45:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[283] Complete. Time taken: 00:00:42.560
[INFO] - 03-16 22:45:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:45:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:45:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:45:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:45:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:45:53 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7211, 4986, 5107]
[INFO] - 03-16 22:45:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:46:01 - [main.backward:225]: Epoch 284/300 - Iteration 33/199 - Time 0.223 batch, 0.052 data, 0.198 forward
[INFO] - 03-16 22:46:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:46:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0046)
[INFO] - 03-16 22:46:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5717 (0.5865)
[INFO] - 03-16 22:46:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3112 (-140.2697)
[INFO] - 03-16 22:46:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2697 (19.2598)
[INFO] - 03-16 22:46:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.0530 (190.3100)
[INFO] - 03-16 22:46:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:46:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9441)
[INFO] - 03-16 22:46:11 - [main.backward:225]: Epoch 284/300 - Iteration 83/199 - Time 0.206 batch, 0.036 data, 0.181 forward
[INFO] - 03-16 22:46:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0039)
[INFO] - 03-16 22:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6081 (0.5750)
[INFO] - 03-16 22:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2722 (-140.3168)
[INFO] - 03-16 22:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2710 (19.2464)
[INFO] - 03-16 22:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8152 (190.2896)
[INFO] - 03-16 22:46:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9561)
[INFO] - 03-16 22:46:20 - [main.backward:225]: Epoch 284/300 - Iteration 133/199 - Time 0.201 batch, 0.032 data, 0.176 forward
[INFO] - 03-16 22:46:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:46:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0050)
[INFO] - 03-16 22:46:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5908 (0.5801)
[INFO] - 03-16 22:46:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2989 (-140.2694)
[INFO] - 03-16 22:46:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2158 (19.2879)
[INFO] - 03-16 22:46:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.9819 (190.4428)
[INFO] - 03-16 22:46:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:46:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9367)
[INFO] - 03-16 22:46:30 - [main.backward:225]: Epoch 284/300 - Iteration 183/199 - Time 0.201 batch, 0.030 data, 0.176 forward
[INFO] - 03-16 22:46:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0044)
[INFO] - 03-16 22:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6008 (0.5802)
[INFO] - 03-16 22:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2681 (-140.2585)
[INFO] - 03-16 22:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3075 (19.2790)
[INFO] - 03-16 22:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3488 (190.7052)
[INFO] - 03-16 22:46:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9452)
[INFO] - 03-16 22:46:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:46:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:46:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:46:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:46:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:46:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:46:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:46:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.088
[INFO] - 03-16 22:46:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.090
[INFO] - 03-16 22:46:36 - [main.summary_metrics:168]: Epoch 284/300 - Test Results:
{'auc': 0.8470681996855345,
 'f1': 0.4126753749395259,
 'loss': 0.4327412479808497,
 'ndcg': 0.7381039907511079,
 'precision': 0.6150943396226414,
 'recall': 0.3107704402515723}
[INFO] - 03-16 22:46:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[284] Complete. Time taken: 00:00:42.703
[INFO] - 03-16 22:46:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:46:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:46:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:46:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:46:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:46:36 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7249, 4997, 5162]
[INFO] - 03-16 22:46:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:46:44 - [main.backward:225]: Epoch 285/300 - Iteration 34/199 - Time 0.217 batch, 0.050 data, 0.193 forward
[INFO] - 03-16 22:46:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:46:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0046)
[INFO] - 03-16 22:46:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5737 (0.5880)
[INFO] - 03-16 22:46:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3192 (-140.2743)
[INFO] - 03-16 22:46:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2898 (19.2713)
[INFO] - 03-16 22:46:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5440 (190.4484)
[INFO] - 03-16 22:46:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:46:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9430)
[INFO] - 03-16 22:46:53 - [main.backward:225]: Epoch 285/300 - Iteration 84/199 - Time 0.202 batch, 0.034 data, 0.179 forward
[INFO] - 03-16 22:46:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:46:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0040)
[INFO] - 03-16 22:46:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6124 (0.5742)
[INFO] - 03-16 22:46:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2984 (-140.3171)
[INFO] - 03-16 22:46:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2363 (19.2421)
[INFO] - 03-16 22:46:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.2233 (190.3112)
[INFO] - 03-16 22:46:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:46:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9542)
[INFO] - 03-16 22:47:03 - [main.backward:225]: Epoch 285/300 - Iteration 134/199 - Time 0.201 batch, 0.030 data, 0.177 forward
[INFO] - 03-16 22:47:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:47:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0064 (0.0050)
[INFO] - 03-16 22:47:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5947 (0.5819)
[INFO] - 03-16 22:47:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2690 (-140.2726)
[INFO] - 03-16 22:47:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2302 (19.2739)
[INFO] - 03-16 22:47:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.1451 (190.4491)
[INFO] - 03-16 22:47:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:47:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9373)
[INFO] - 03-16 22:47:14 - [main.backward:225]: Epoch 285/300 - Iteration 184/199 - Time 0.205 batch, 0.029 data, 0.181 forward
[INFO] - 03-16 22:47:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:47:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0044)
[INFO] - 03-16 22:47:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5900 (0.5805)
[INFO] - 03-16 22:47:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2699 (-140.2531)
[INFO] - 03-16 22:47:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2149 (19.2732)
[INFO] - 03-16 22:47:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.4452 (190.7762)
[INFO] - 03-16 22:47:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:47:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9450)
[INFO] - 03-16 22:47:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:47:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:47:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:47:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:47:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:47:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:47:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:47:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.408
[INFO] - 03-16 22:47:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.408
[INFO] - 03-16 22:47:20 - [main.summary_metrics:168]: Epoch 285/300 - Test Results:
{'auc': 0.8491913653039832,
 'f1': 0.4227382680212869,
 'loss': 0.4326238992479112,
 'ndcg': 0.7421450507349721,
 'precision': 0.630188679245283,
 'recall': 0.3183176100628931}
[INFO] - 03-16 22:47:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[285] Complete. Time taken: 00:00:44.335
[INFO] - 03-16 22:47:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:47:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:47:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:47:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:47:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:47:20 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7244, 5008, 5161]
[INFO] - 03-16 22:47:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:47:29 - [main.backward:225]: Epoch 286/300 - Iteration 35/199 - Time 0.253 batch, 0.065 data, 0.228 forward
[INFO] - 03-16 22:47:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:47:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0046)
[INFO] - 03-16 22:47:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5922 (0.5868)
[INFO] - 03-16 22:47:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3680 (-140.2679)
[INFO] - 03-16 22:47:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2056 (19.2463)
[INFO] - 03-16 22:47:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.9425 (190.2082)
[INFO] - 03-16 22:47:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:47:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9440)
[INFO] - 03-16 22:47:39 - [main.backward:225]: Epoch 286/300 - Iteration 85/199 - Time 0.223 batch, 0.042 data, 0.197 forward
[INFO] - 03-16 22:47:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0073 (0.0039)
[INFO] - 03-16 22:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6060 (0.5770)
[INFO] - 03-16 22:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2814 (-140.3029)
[INFO] - 03-16 22:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2811 (19.2502)
[INFO] - 03-16 22:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4252 (190.2201)
[INFO] - 03-16 22:47:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:47:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9550)
[INFO] - 03-16 22:47:50 - [main.backward:225]: Epoch 286/300 - Iteration 135/199 - Time 0.217 batch, 0.035 data, 0.192 forward
[INFO] - 03-16 22:47:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:47:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0048)
[INFO] - 03-16 22:47:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6050 (0.5795)
[INFO] - 03-16 22:47:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2387 (-140.2625)
[INFO] - 03-16 22:47:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2633 (19.2860)
[INFO] - 03-16 22:47:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.2572 (190.5118)
[INFO] - 03-16 22:47:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:47:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9416)
[INFO] - 03-16 22:48:00 - [main.backward:225]: Epoch 286/300 - Iteration 185/199 - Time 0.214 batch, 0.033 data, 0.189 forward
[INFO] - 03-16 22:48:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:48:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0049)
[INFO] - 03-16 22:48:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6052 (0.5802)
[INFO] - 03-16 22:48:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2123 (-140.2471)
[INFO] - 03-16 22:48:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2587 (19.2638)
[INFO] - 03-16 22:48:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.1234 (190.6525)
[INFO] - 03-16 22:48:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:48:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9358)
[INFO] - 03-16 22:48:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:48:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:48:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:48:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:48:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:48:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:48:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:48:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.341
[INFO] - 03-16 22:48:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.342
[INFO] - 03-16 22:48:06 - [main.summary_metrics:168]: Epoch 286/300 - Test Results:
{'auc': 0.8466521553983228,
 'f1': 0.4204741170778905,
 'loss': 0.43346642243487277,
 'ndcg': 0.7399087953818609,
 'precision': 0.6264150943396227,
 'recall': 0.31674528301886795}
[INFO] - 03-16 22:48:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[286] Complete. Time taken: 00:00:45.790
[INFO] - 03-16 22:48:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:48:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:48:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:48:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:48:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:48:06 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7244, 5018, 5147]
[INFO] - 03-16 22:48:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:48:15 - [main.backward:225]: Epoch 287/300 - Iteration 36/199 - Time 0.238 batch, 0.058 data, 0.212 forward
[INFO] - 03-16 22:48:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0050)
[INFO] - 03-16 22:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5661 (0.5858)
[INFO] - 03-16 22:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3640 (-140.2592)
[INFO] - 03-16 22:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2751 (19.2606)
[INFO] - 03-16 22:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4850 (190.3653)
[INFO] - 03-16 22:48:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9390)
[INFO] - 03-16 22:48:25 - [main.backward:225]: Epoch 287/300 - Iteration 86/199 - Time 0.219 batch, 0.039 data, 0.193 forward
[INFO] - 03-16 22:48:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:48:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0042)
[INFO] - 03-16 22:48:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6117 (0.5764)
[INFO] - 03-16 22:48:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2560 (-140.2932)
[INFO] - 03-16 22:48:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3311 (19.2707)
[INFO] - 03-16 22:48:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3338 (190.5064)
[INFO] - 03-16 22:48:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:48:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9509)
[INFO] - 03-16 22:48:35 - [main.backward:225]: Epoch 287/300 - Iteration 136/199 - Time 0.212 batch, 0.034 data, 0.186 forward
[INFO] - 03-16 22:48:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0050)
[INFO] - 03-16 22:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5945 (0.5800)
[INFO] - 03-16 22:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1683 (-140.2543)
[INFO] - 03-16 22:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2504 (19.2930)
[INFO] - 03-16 22:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6341 (190.5833)
[INFO] - 03-16 22:48:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:48:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9381)
[INFO] - 03-16 22:48:45 - [main.backward:225]: Epoch 287/300 - Iteration 186/199 - Time 0.210 batch, 0.032 data, 0.184 forward
[INFO] - 03-16 22:48:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0047)
[INFO] - 03-16 22:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5985 (0.5790)
[INFO] - 03-16 22:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1672 (-140.2430)
[INFO] - 03-16 22:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1762 (19.2892)
[INFO] - 03-16 22:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.9857 (190.8608)
[INFO] - 03-16 22:48:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9398)
[INFO] - 03-16 22:48:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:48:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:48:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:48:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.269
[INFO] - 03-16 22:48:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.270
[INFO] - 03-16 22:48:51 - [main.summary_metrics:168]: Epoch 287/300 - Test Results:
{'auc': 0.846168107966457,
 'f1': 0.42192549588775996,
 'loss': 0.4329202051422631,
 'ndcg': 0.7416710919616661,
 'precision': 0.6283018867924529,
 'recall': 0.31792452830188683}
[INFO] - 03-16 22:48:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[287] Complete. Time taken: 00:00:44.854
[INFO] - 03-16 22:48:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:48:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:48:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:48:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:48:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:48:51 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7201, 4986, 5147]
[INFO] - 03-16 22:48:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:49:00 - [main.backward:225]: Epoch 288/300 - Iteration 37/199 - Time 0.244 batch, 0.058 data, 0.219 forward
[INFO] - 03-16 22:49:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:49:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0043)
[INFO] - 03-16 22:49:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5846 (0.5856)
[INFO] - 03-16 22:49:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3588 (-140.2485)
[INFO] - 03-16 22:49:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2053 (19.2623)
[INFO] - 03-16 22:49:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.0878 (190.3170)
[INFO] - 03-16 22:49:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:49:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9495)
[INFO] - 03-16 22:49:10 - [main.backward:225]: Epoch 288/300 - Iteration 87/199 - Time 0.218 batch, 0.039 data, 0.193 forward
[INFO] - 03-16 22:49:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0040)
[INFO] - 03-16 22:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5811 (0.5760)
[INFO] - 03-16 22:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3508 (-140.2824)
[INFO] - 03-16 22:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3683 (19.2482)
[INFO] - 03-16 22:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5318 (190.2108)
[INFO] - 03-16 22:49:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9553)
[INFO] - 03-16 22:49:20 - [main.backward:225]: Epoch 288/300 - Iteration 137/199 - Time 0.211 batch, 0.034 data, 0.186 forward
[INFO] - 03-16 22:49:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:49:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0046)
[INFO] - 03-16 22:49:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5922 (0.5808)
[INFO] - 03-16 22:49:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1528 (-140.2476)
[INFO] - 03-16 22:49:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2030 (19.2804)
[INFO] - 03-16 22:49:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.7288 (190.4429)
[INFO] - 03-16 22:49:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:49:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9456)
[INFO] - 03-16 22:49:30 - [main.backward:225]: Epoch 288/300 - Iteration 187/199 - Time 0.209 batch, 0.032 data, 0.183 forward
[INFO] - 03-16 22:49:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:49:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0077 (0.0045)
[INFO] - 03-16 22:49:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5922 (0.5808)
[INFO] - 03-16 22:49:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1661 (-140.2390)
[INFO] - 03-16 22:49:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2788 (19.2685)
[INFO] - 03-16 22:49:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.9130 (190.7957)
[INFO] - 03-16 22:49:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:49:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9452)
[INFO] - 03-16 22:49:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:49:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:49:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:49:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:49:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:49:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:49:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:49:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.307
[INFO] - 03-16 22:49:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.308
[INFO] - 03-16 22:49:36 - [main.summary_metrics:168]: Epoch 288/300 - Test Results:
{'auc': 0.8464998689727463,
 'f1': 0.4154426705370101,
 'loss': 0.431181052026009,
 'ndcg': 0.7365492543741599,
 'precision': 0.6188679245283019,
 'recall': 0.3129716981132075}
[INFO] - 03-16 22:49:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[288] Complete. Time taken: 00:00:44.763
[INFO] - 03-16 22:49:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:49:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:49:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:49:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:49:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:49:36 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7233, 4975, 5098]
[INFO] - 03-16 22:49:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:49:45 - [main.backward:225]: Epoch 289/300 - Iteration 38/199 - Time 0.238 batch, 0.058 data, 0.212 forward
[INFO] - 03-16 22:49:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0043)
[INFO] - 03-16 22:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5867)
[INFO] - 03-16 22:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2751 (-140.2437)
[INFO] - 03-16 22:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2047 (19.2507)
[INFO] - 03-16 22:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.6331 (190.3478)
[INFO] - 03-16 22:49:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9499)
[INFO] - 03-16 22:49:55 - [main.backward:225]: Epoch 289/300 - Iteration 88/199 - Time 0.221 batch, 0.039 data, 0.196 forward
[INFO] - 03-16 22:49:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:49:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0042)
[INFO] - 03-16 22:49:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5747 (0.5749)
[INFO] - 03-16 22:49:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3897 (-140.2786)
[INFO] - 03-16 22:49:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3264 (19.2386)
[INFO] - 03-16 22:49:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.5882 (190.2607)
[INFO] - 03-16 22:49:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:49:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9500)
[INFO] - 03-16 22:50:06 - [main.backward:225]: Epoch 289/300 - Iteration 138/199 - Time 0.215 batch, 0.034 data, 0.189 forward
[INFO] - 03-16 22:50:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0047)
[INFO] - 03-16 22:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6029 (0.5816)
[INFO] - 03-16 22:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1391 (-140.2339)
[INFO] - 03-16 22:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1224 (19.2465)
[INFO] - 03-16 22:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3945 (190.3033)
[INFO] - 03-16 22:50:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:50:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9420)
[INFO] - 03-16 22:50:15 - [main.backward:225]: Epoch 289/300 - Iteration 188/199 - Time 0.211 batch, 0.032 data, 0.185 forward
[INFO] - 03-16 22:50:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0049)
[INFO] - 03-16 22:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5964 (0.5800)
[INFO] - 03-16 22:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1282 (-140.2391)
[INFO] - 03-16 22:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3407 (19.2599)
[INFO] - 03-16 22:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.9442 (190.6858)
[INFO] - 03-16 22:50:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:50:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9394)
[INFO] - 03-16 22:50:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:50:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:50:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:50:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:50:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:50:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:50:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:50:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.302
[INFO] - 03-16 22:50:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.302
[INFO] - 03-16 22:50:21 - [main.summary_metrics:168]: Epoch 289/300 - Test Results:
{'auc': 0.8449681276205452,
 'f1': 0.4217319787131108,
 'loss': 0.4326321910802174,
 'ndcg': 0.7321350041882967,
 'precision': 0.6283018867924529,
 'recall': 0.31768867924528305}
[INFO] - 03-16 22:50:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[289] Complete. Time taken: 00:00:45.144
[INFO] - 03-16 22:50:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:50:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:50:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:50:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:50:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:50:21 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7220, 4992, 5117]
[INFO] - 03-16 22:50:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:50:30 - [main.backward:225]: Epoch 290/300 - Iteration 39/199 - Time 0.240 batch, 0.053 data, 0.216 forward
[INFO] - 03-16 22:50:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0047)
[INFO] - 03-16 22:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5866 (0.5849)
[INFO] - 03-16 22:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2079 (-140.2370)
[INFO] - 03-16 22:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2744 (19.2259)
[INFO] - 03-16 22:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.2689 (190.2292)
[INFO] - 03-16 22:50:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9437)
[INFO] - 03-16 22:50:41 - [main.backward:225]: Epoch 290/300 - Iteration 89/199 - Time 0.222 batch, 0.038 data, 0.197 forward
[INFO] - 03-16 22:50:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0038)
[INFO] - 03-16 22:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5701 (0.5764)
[INFO] - 03-16 22:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3970 (-140.2733)
[INFO] - 03-16 22:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2419 (19.2194)
[INFO] - 03-16 22:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.3372 (190.1787)
[INFO] - 03-16 22:50:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9580)
[INFO] - 03-16 22:50:51 - [main.backward:225]: Epoch 290/300 - Iteration 139/199 - Time 0.217 batch, 0.033 data, 0.192 forward
[INFO] - 03-16 22:50:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:50:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0049)
[INFO] - 03-16 22:50:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5804)
[INFO] - 03-16 22:50:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1878 (-140.2281)
[INFO] - 03-16 22:50:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1646 (19.2333)
[INFO] - 03-16 22:50:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3682 (190.1920)
[INFO] - 03-16 22:50:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:50:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9387)
[INFO] - 03-16 22:51:01 - [main.backward:225]: Epoch 290/300 - Iteration 189/199 - Time 0.214 batch, 0.031 data, 0.189 forward
[INFO] - 03-16 22:51:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0046)
[INFO] - 03-16 22:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6184 (0.5824)
[INFO] - 03-16 22:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0781 (-140.2351)
[INFO] - 03-16 22:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2679 (19.2615)
[INFO] - 03-16 22:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.1508 (190.6632)
[INFO] - 03-16 22:51:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9427)
[INFO] - 03-16 22:51:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:51:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:51:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:51:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:51:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:51:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:51:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:51:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.493
[INFO] - 03-16 22:51:07 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.493
[INFO] - 03-16 22:51:07 - [main.summary_metrics:168]: Epoch 290/300 - Test Results:
{'auc': 0.8492329664570233,
 'f1': 0.4240541848089017,
 'loss': 0.43127348422004497,
 'ndcg': 0.7390624462997712,
 'precision': 0.6320754716981133,
 'recall': 0.31933962264150945}
[INFO] - 03-16 22:51:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[290] Complete. Time taken: 00:00:46.033
[INFO] - 03-16 22:51:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:51:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:51:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:51:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:51:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:51:07 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7228, 4997, 5136]
[INFO] - 03-16 22:51:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:51:17 - [main.backward:225]: Epoch 291/300 - Iteration 40/199 - Time 0.240 batch, 0.055 data, 0.214 forward
[INFO] - 03-16 22:51:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:51:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0043)
[INFO] - 03-16 22:51:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5912 (0.5842)
[INFO] - 03-16 22:51:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2290 (-140.2333)
[INFO] - 03-16 22:51:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2248 (19.2166)
[INFO] - 03-16 22:51:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5365 (189.9841)
[INFO] - 03-16 22:51:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:51:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9476)
[INFO] - 03-16 22:51:27 - [main.backward:225]: Epoch 291/300 - Iteration 90/199 - Time 0.223 batch, 0.039 data, 0.197 forward
[INFO] - 03-16 22:51:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:51:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0041)
[INFO] - 03-16 22:51:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5552 (0.5755)
[INFO] - 03-16 22:51:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3882 (-140.2693)
[INFO] - 03-16 22:51:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2987 (19.2245)
[INFO] - 03-16 22:51:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3945 (190.0770)
[INFO] - 03-16 22:51:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:51:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9530)
[INFO] - 03-16 22:51:37 - [main.backward:225]: Epoch 291/300 - Iteration 140/199 - Time 0.216 batch, 0.034 data, 0.189 forward
[INFO] - 03-16 22:51:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:51:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0052)
[INFO] - 03-16 22:51:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5578 (0.5805)
[INFO] - 03-16 22:51:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2975 (-140.2200)
[INFO] - 03-16 22:51:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2266 (19.2556)
[INFO] - 03-16 22:51:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8365 (190.3304)
[INFO] - 03-16 22:51:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:51:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9311)
[INFO] - 03-16 22:51:47 - [main.backward:225]: Epoch 291/300 - Iteration 190/199 - Time 0.211 batch, 0.032 data, 0.185 forward
[INFO] - 03-16 22:51:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:51:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0049)
[INFO] - 03-16 22:51:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6184 (0.5837)
[INFO] - 03-16 22:51:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0898 (-140.2254)
[INFO] - 03-16 22:51:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3887 (19.2696)
[INFO] - 03-16 22:51:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.1214 (190.6179)
[INFO] - 03-16 22:51:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:51:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9358)
[INFO] - 03-16 22:51:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:51:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:51:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:51:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:51:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:51:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:51:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:51:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.038
[INFO] - 03-16 22:51:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.040
[INFO] - 03-16 22:51:52 - [main.summary_metrics:168]: Epoch 291/300 - Test Results:
{'auc': 0.8473496789832287,
 'f1': 0.42148040638606676,
 'loss': 0.43187545961903817,
 'ndcg': 0.7410156814966331,
 'precision': 0.6283018867924529,
 'recall': 0.31737421383647796}
[INFO] - 03-16 22:51:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[291] Complete. Time taken: 00:00:44.837
[INFO] - 03-16 22:51:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:51:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:51:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:51:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:51:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:51:52 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7232, 4984, 5145]
[INFO] - 03-16 22:51:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:52:01 - [main.backward:225]: Epoch 292/300 - Iteration 41/199 - Time 0.234 batch, 0.054 data, 0.208 forward
[INFO] - 03-16 22:52:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:52:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0044)
[INFO] - 03-16 22:52:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5914 (0.5828)
[INFO] - 03-16 22:52:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2177 (-140.2367)
[INFO] - 03-16 22:52:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2104 (19.2311)
[INFO] - 03-16 22:52:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.8161 (190.0278)
[INFO] - 03-16 22:52:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:52:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9480)
[INFO] - 03-16 22:52:12 - [main.backward:225]: Epoch 292/300 - Iteration 91/199 - Time 0.216 batch, 0.039 data, 0.191 forward
[INFO] - 03-16 22:52:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:52:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0039)
[INFO] - 03-16 22:52:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5695 (0.5747)
[INFO] - 03-16 22:52:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2963 (-140.2657)
[INFO] - 03-16 22:52:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2166 (19.2346)
[INFO] - 03-16 22:52:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4344 (190.0767)
[INFO] - 03-16 22:52:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:52:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9586)
[INFO] - 03-16 22:52:22 - [main.backward:225]: Epoch 292/300 - Iteration 141/199 - Time 0.214 batch, 0.034 data, 0.189 forward
[INFO] - 03-16 22:52:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:52:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0049)
[INFO] - 03-16 22:52:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5625 (0.5819)
[INFO] - 03-16 22:52:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2648 (-140.2188)
[INFO] - 03-16 22:52:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1628 (19.2550)
[INFO] - 03-16 22:52:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.9537 (190.3089)
[INFO] - 03-16 22:52:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:52:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9400)
[INFO] - 03-16 22:52:33 - [main.backward:225]: Epoch 292/300 - Iteration 191/199 - Time 0.213 batch, 0.032 data, 0.187 forward
[INFO] - 03-16 22:52:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:52:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0045)
[INFO] - 03-16 22:52:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6018 (0.5830)
[INFO] - 03-16 22:52:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0956 (-140.2137)
[INFO] - 03-16 22:52:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3422 (19.2818)
[INFO] - 03-16 22:52:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.8527 (190.5080)
[INFO] - 03-16 22:52:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:52:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9441)
[INFO] - 03-16 22:52:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:52:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:52:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:52:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:52:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:52:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:52:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:52:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.517
[INFO] - 03-16 22:52:38 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.517
[INFO] - 03-16 22:52:38 - [main.summary_metrics:168]: Epoch 292/300 - Test Results:
{'auc': 0.8443612748951783,
 'f1': 0.41248185776487656,
 'loss': 0.43254549527518166,
 'ndcg': 0.734319424095351,
 'precision': 0.6150943396226415,
 'recall': 0.3105345911949686}
[INFO] - 03-16 22:52:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[292] Complete. Time taken: 00:00:45.730
[INFO] - 03-16 22:52:38 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:52:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:52:38 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:52:38 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:52:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:52:38 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7199, 4996, 5153]
[INFO] - 03-16 22:52:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:52:48 - [main.backward:225]: Epoch 293/300 - Iteration 42/199 - Time 0.236 batch, 0.053 data, 0.211 forward
[INFO] - 03-16 22:52:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:52:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0045)
[INFO] - 03-16 22:52:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5913 (0.5831)
[INFO] - 03-16 22:52:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2554 (-140.2363)
[INFO] - 03-16 22:52:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1575 (19.2181)
[INFO] - 03-16 22:52:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.8595 (189.8790)
[INFO] - 03-16 22:52:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:52:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9425)
[INFO] - 03-16 22:52:58 - [main.backward:225]: Epoch 293/300 - Iteration 92/199 - Time 0.217 batch, 0.037 data, 0.192 forward
[INFO] - 03-16 22:52:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0039)
[INFO] - 03-16 22:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5761 (0.5735)
[INFO] - 03-16 22:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2971 (-140.2654)
[INFO] - 03-16 22:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3562 (19.2342)
[INFO] - 03-16 22:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.2685 (190.0784)
[INFO] - 03-16 22:52:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9556)
[INFO] - 03-16 22:53:07 - [main.backward:225]: Epoch 293/300 - Iteration 142/199 - Time 0.209 batch, 0.033 data, 0.185 forward
[INFO] - 03-16 22:53:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0048)
[INFO] - 03-16 22:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5699 (0.5816)
[INFO] - 03-16 22:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2700 (-140.2148)
[INFO] - 03-16 22:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2513 (19.2500)
[INFO] - 03-16 22:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4468 (190.2366)
[INFO] - 03-16 22:53:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:53:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9445)
[INFO] - 03-16 22:53:17 - [main.backward:225]: Epoch 293/300 - Iteration 192/199 - Time 0.206 batch, 0.030 data, 0.182 forward
[INFO] - 03-16 22:53:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:53:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0047)
[INFO] - 03-16 22:53:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6059 (0.5851)
[INFO] - 03-16 22:53:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1822 (-140.1999)
[INFO] - 03-16 22:53:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2468 (19.2459)
[INFO] - 03-16 22:53:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.9859 (190.4120)
[INFO] - 03-16 22:53:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:53:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9441)
[INFO] - 03-16 22:53:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:53:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:53:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:53:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:53:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:53:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:53:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:53:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.087
[INFO] - 03-16 22:53:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.088
[INFO] - 03-16 22:53:22 - [main.summary_metrics:168]: Epoch 293/300 - Test Results:
{'auc': 0.8501610980083855,
 'f1': 0.4240541848089017,
 'loss': 0.43098781680061127,
 'ndcg': 0.7428688776764153,
 'precision': 0.6320754716981132,
 'recall': 0.31933962264150945}
[INFO] - 03-16 22:53:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[293] Complete. Time taken: 00:00:43.964
[INFO] - 03-16 22:53:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:53:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:53:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:53:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:53:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:53:22 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7233, 4972, 5125]
[INFO] - 03-16 22:53:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:53:31 - [main.backward:225]: Epoch 294/300 - Iteration 43/199 - Time 0.221 batch, 0.045 data, 0.197 forward
[INFO] - 03-16 22:53:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0046)
[INFO] - 03-16 22:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5898 (0.5828)
[INFO] - 03-16 22:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2687 (-140.2323)
[INFO] - 03-16 22:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1948 (19.2146)
[INFO] - 03-16 22:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.2436 (189.9603)
[INFO] - 03-16 22:53:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:53:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9395)
[INFO] - 03-16 22:53:41 - [main.backward:225]: Epoch 294/300 - Iteration 93/199 - Time 0.207 batch, 0.034 data, 0.183 forward
[INFO] - 03-16 22:53:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0037)
[INFO] - 03-16 22:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5774 (0.5741)
[INFO] - 03-16 22:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2857 (-140.2619)
[INFO] - 03-16 22:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2243 (19.2071)
[INFO] - 03-16 22:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.1818 (189.9452)
[INFO] - 03-16 22:53:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:53:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9598)
[INFO] - 03-16 22:53:51 - [main.backward:225]: Epoch 294/300 - Iteration 143/199 - Time 0.203 batch, 0.031 data, 0.179 forward
[INFO] - 03-16 22:53:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:53:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0049)
[INFO] - 03-16 22:53:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5984 (0.5826)
[INFO] - 03-16 22:53:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1932 (-140.2091)
[INFO] - 03-16 22:53:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2643 (19.2332)
[INFO] - 03-16 22:53:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4756 (190.2785)
[INFO] - 03-16 22:53:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:53:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9392)
[INFO] - 03-16 22:54:00 - [main.backward:225]: Epoch 294/300 - Iteration 193/199 - Time 0.200 batch, 0.029 data, 0.176 forward
[INFO] - 03-16 22:54:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0049)
[INFO] - 03-16 22:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5911 (0.5845)
[INFO] - 03-16 22:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2260 (-140.1967)
[INFO] - 03-16 22:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2086 (19.2542)
[INFO] - 03-16 22:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.7471 (190.4985)
[INFO] - 03-16 22:54:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:54:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9420)
[INFO] - 03-16 22:54:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:54:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:54:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:54:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:54:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:54:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:54:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:54:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.037
[INFO] - 03-16 22:54:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.038
[INFO] - 03-16 22:54:04 - [main.summary_metrics:168]: Epoch 294/300 - Test Results:
{'auc': 0.840320427148847,
 'f1': 0.4051282051282051,
 'loss': 0.43410475123503417,
 'ndcg': 0.7315813618084214,
 'precision': 0.6037735849056604,
 'recall': 0.3051100628930818}
[INFO] - 03-16 22:54:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[294] Complete. Time taken: 00:00:42.865
[INFO] - 03-16 22:54:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:54:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:54:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:54:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:54:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:54:04 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7257, 5011, 5169]
[INFO] - 03-16 22:54:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:54:14 - [main.backward:225]: Epoch 295/300 - Iteration 44/199 - Time 0.224 batch, 0.048 data, 0.201 forward
[INFO] - 03-16 22:54:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:54:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0046)
[INFO] - 03-16 22:54:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5914 (0.5839)
[INFO] - 03-16 22:54:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2577 (-140.2311)
[INFO] - 03-16 22:54:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2851 (19.2161)
[INFO] - 03-16 22:54:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.0577 (190.0801)
[INFO] - 03-16 22:54:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:54:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9436)
[INFO] - 03-16 22:54:24 - [main.backward:225]: Epoch 295/300 - Iteration 94/199 - Time 0.211 batch, 0.035 data, 0.187 forward
[INFO] - 03-16 22:54:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:54:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0041)
[INFO] - 03-16 22:54:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5773 (0.5746)
[INFO] - 03-16 22:54:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2544 (-140.2508)
[INFO] - 03-16 22:54:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2703 (19.2080)
[INFO] - 03-16 22:54:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.3903 (189.9984)
[INFO] - 03-16 22:54:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:54:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9555)
[INFO] - 03-16 22:54:34 - [main.backward:225]: Epoch 295/300 - Iteration 144/199 - Time 0.205 batch, 0.031 data, 0.181 forward
[INFO] - 03-16 22:54:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0050)
[INFO] - 03-16 22:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6208 (0.5814)
[INFO] - 03-16 22:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0999 (-140.2016)
[INFO] - 03-16 22:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2614 (19.2161)
[INFO] - 03-16 22:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 191.6456 (190.3125)
[INFO] - 03-16 22:54:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9377)
[INFO] - 03-16 22:54:44 - [main.backward:225]: Epoch 295/300 - Iteration 194/199 - Time 0.203 batch, 0.030 data, 0.179 forward
[INFO] - 03-16 22:54:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:54:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0048)
[INFO] - 03-16 22:54:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5930 (0.5833)
[INFO] - 03-16 22:54:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2202 (-140.1975)
[INFO] - 03-16 22:54:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2361 (19.2446)
[INFO] - 03-16 22:54:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.7454 (190.4928)
[INFO] - 03-16 22:54:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:54:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9394)
[INFO] - 03-16 22:54:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:54:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:54:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:54:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:54:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:54:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:54:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:54:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.995
[INFO] - 03-16 22:54:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.996
[INFO] - 03-16 22:54:48 - [main.summary_metrics:168]: Epoch 295/300 - Test Results:
{'auc': 0.8473934420859539,
 'f1': 0.4187711659409773,
 'loss': 0.43064463186364,
 'ndcg': 0.7393398533349772,
 'precision': 0.6245283018867924,
 'recall': 0.315251572327044}
[INFO] - 03-16 22:54:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[295] Complete. Time taken: 00:00:43.406
[INFO] - 03-16 22:54:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:54:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:54:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:54:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:54:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:54:48 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7226, 4995, 5153]
[INFO] - 03-16 22:54:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:54:58 - [main.backward:225]: Epoch 296/300 - Iteration 45/199 - Time 0.223 batch, 0.043 data, 0.199 forward
[INFO] - 03-16 22:54:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:54:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0043)
[INFO] - 03-16 22:54:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5985 (0.5835)
[INFO] - 03-16 22:54:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2445 (-140.2249)
[INFO] - 03-16 22:54:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2699 (19.2162)
[INFO] - 03-16 22:54:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.0548 (190.0652)
[INFO] - 03-16 22:54:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:54:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9503)
[INFO] - 03-16 22:55:08 - [main.backward:225]: Epoch 296/300 - Iteration 95/199 - Time 0.211 batch, 0.035 data, 0.185 forward
[INFO] - 03-16 22:55:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:55:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0038)
[INFO] - 03-16 22:55:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5946 (0.5743)
[INFO] - 03-16 22:55:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1796 (-140.2457)
[INFO] - 03-16 22:55:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3458 (19.2074)
[INFO] - 03-16 22:55:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.6156 (189.9572)
[INFO] - 03-16 22:55:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:55:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9572)
[INFO] - 03-16 22:55:18 - [main.backward:225]: Epoch 296/300 - Iteration 145/199 - Time 0.205 batch, 0.031 data, 0.180 forward
[INFO] - 03-16 22:55:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0048)
[INFO] - 03-16 22:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6145 (0.5824)
[INFO] - 03-16 22:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0862 (-140.1967)
[INFO] - 03-16 22:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2905 (19.2098)
[INFO] - 03-16 22:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.2445 (189.9654)
[INFO] - 03-16 22:55:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:55:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9402)
[INFO] - 03-16 22:55:28 - [main.backward:225]: Epoch 296/300 - Iteration 195/199 - Time 0.203 batch, 0.029 data, 0.178 forward
[INFO] - 03-16 22:55:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:55:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0047)
[INFO] - 03-16 22:55:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5836 (0.5824)
[INFO] - 03-16 22:55:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2228 (-140.1960)
[INFO] - 03-16 22:55:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1726 (19.2475)
[INFO] - 03-16 22:55:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.4076 (190.4063)
[INFO] - 03-16 22:55:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:55:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9411)
[INFO] - 03-16 22:55:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:55:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:55:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:55:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:55:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:55:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:55:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:55:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.269
[INFO] - 03-16 22:55:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.269
[INFO] - 03-16 22:55:32 - [main.summary_metrics:168]: Epoch 296/300 - Test Results:
{'auc': 0.8457466260482178,
 'f1': 0.42399612965650707,
 'loss': 0.43158339438048543,
 'ndcg': 0.7373330004178476,
 'precision': 0.6320754716981132,
 'recall': 0.3192610062893082}
[INFO] - 03-16 22:55:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[296] Complete. Time taken: 00:00:43.778
[INFO] - 03-16 22:55:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:55:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:55:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:55:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:55:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:55:32 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7213, 4979, 5131]
[INFO] - 03-16 22:55:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:55:42 - [main.backward:225]: Epoch 297/300 - Iteration 46/199 - Time 0.220 batch, 0.046 data, 0.195 forward
[INFO] - 03-16 22:55:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:55:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0042)
[INFO] - 03-16 22:55:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5256 (0.5822)
[INFO] - 03-16 22:55:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3865 (-140.2264)
[INFO] - 03-16 22:55:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1614 (19.2247)
[INFO] - 03-16 22:55:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.0815 (190.0186)
[INFO] - 03-16 22:55:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:55:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9483)
[INFO] - 03-16 22:55:52 - [main.backward:225]: Epoch 297/300 - Iteration 96/199 - Time 0.212 batch, 0.034 data, 0.188 forward
[INFO] - 03-16 22:55:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0072 (0.0038)
[INFO] - 03-16 22:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5963 (0.5753)
[INFO] - 03-16 22:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1733 (-140.2377)
[INFO] - 03-16 22:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2678 (19.2212)
[INFO] - 03-16 22:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.8564 (190.1354)
[INFO] - 03-16 22:55:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9563)
[INFO] - 03-16 22:56:02 - [main.backward:225]: Epoch 297/300 - Iteration 146/199 - Time 0.209 batch, 0.031 data, 0.185 forward
[INFO] - 03-16 22:56:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:56:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0046)
[INFO] - 03-16 22:56:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6097 (0.5812)
[INFO] - 03-16 22:56:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.0677 (-140.1900)
[INFO] - 03-16 22:56:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2758 (19.2247)
[INFO] - 03-16 22:56:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.6825 (190.2854)
[INFO] - 03-16 22:56:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:56:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9414)
[INFO] - 03-16 22:56:12 - [main.backward:225]: Epoch 297/300 - Iteration 196/199 - Time 0.207 batch, 0.029 data, 0.182 forward
[INFO] - 03-16 22:56:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:56:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0044)
[INFO] - 03-16 22:56:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6015 (0.5837)
[INFO] - 03-16 22:56:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1996 (-140.1969)
[INFO] - 03-16 22:56:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1956 (19.2539)
[INFO] - 03-16 22:56:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.5343 (190.4428)
[INFO] - 03-16 22:56:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:56:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9455)
[INFO] - 03-16 22:56:13 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:56:13 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:56:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:56:13 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:56:13 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:56:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:56:13 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:56:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.164
[INFO] - 03-16 22:56:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.164
[INFO] - 03-16 22:56:16 - [main.summary_metrics:168]: Epoch 297/300 - Test Results:
{'auc': 0.845116679769392,
 'f1': 0.4164489598451862,
 'loss': 0.43077970914620767,
 'ndcg': 0.7405387602727602,
 'precision': 0.6207547169811322,
 'recall': 0.3136006289308177}
[INFO] - 03-16 22:56:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[297] Complete. Time taken: 00:00:44.194
[INFO] - 03-16 22:56:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:56:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:56:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:56:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:56:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:56:16 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7242, 4980, 5144]
[INFO] - 03-16 22:56:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:56:26 - [main.backward:225]: Epoch 298/300 - Iteration 47/199 - Time 0.216 batch, 0.045 data, 0.191 forward
[INFO] - 03-16 22:56:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0017 (0.0040)
[INFO] - 03-16 22:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5227 (0.5810)
[INFO] - 03-16 22:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3858 (-140.2289)
[INFO] - 03-16 22:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2400 (19.2227)
[INFO] - 03-16 22:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.3995 (189.9855)
[INFO] - 03-16 22:56:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:56:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9515)
[INFO] - 03-16 22:56:36 - [main.backward:225]: Epoch 298/300 - Iteration 97/199 - Time 0.208 batch, 0.035 data, 0.183 forward
[INFO] - 03-16 22:56:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:56:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0041)
[INFO] - 03-16 22:56:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6017 (0.5765)
[INFO] - 03-16 22:56:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1696 (-140.2322)
[INFO] - 03-16 22:56:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2718 (19.2303)
[INFO] - 03-16 22:56:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.9830 (190.0370)
[INFO] - 03-16 22:56:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:56:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9559)
[INFO] - 03-16 22:56:46 - [main.backward:225]: Epoch 298/300 - Iteration 147/199 - Time 0.206 batch, 0.031 data, 0.181 forward
[INFO] - 03-16 22:56:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:56:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0048)
[INFO] - 03-16 22:56:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5738 (0.5815)
[INFO] - 03-16 22:56:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2135 (-140.1845)
[INFO] - 03-16 22:56:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2695 (19.2310)
[INFO] - 03-16 22:56:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4951 (190.1326)
[INFO] - 03-16 22:56:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:56:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9444)
[INFO] - 03-16 22:56:56 - [main.backward:225]: Epoch 298/300 - Iteration 197/199 - Time 0.204 batch, 0.029 data, 0.180 forward
[INFO] - 03-16 22:56:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:56:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0093 (0.0047)
[INFO] - 03-16 22:56:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5964 (0.5830)
[INFO] - 03-16 22:56:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1784 (-140.1948)
[INFO] - 03-16 22:56:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2293 (19.2661)
[INFO] - 03-16 22:56:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.2401 (190.4545)
[INFO] - 03-16 22:56:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:56:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9398)
[INFO] - 03-16 22:56:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:56:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:56:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:56:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:56:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:56:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:56:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:57:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.192
[INFO] - 03-16 22:57:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.193
[INFO] - 03-16 22:57:00 - [main.summary_metrics:168]: Epoch 298/300 - Test Results:
{'auc': 0.8454451650943396,
 'f1': 0.4210933720367682,
 'loss': 0.43059709884035763,
 'ndcg': 0.7404596183898535,
 'precision': 0.6283018867924528,
 'recall': 0.3169025157232704}
[INFO] - 03-16 22:57:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[298] Complete. Time taken: 00:00:43.746
[INFO] - 03-16 22:57:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:57:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:57:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:57:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:57:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:57:00 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7216, 4973, 5124]
[INFO] - 03-16 22:57:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:57:10 - [main.backward:225]: Epoch 299/300 - Iteration 48/199 - Time 0.209 batch, 0.044 data, 0.183 forward
[INFO] - 03-16 22:57:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:57:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0007 (0.0039)
[INFO] - 03-16 22:57:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5141 (0.5792)
[INFO] - 03-16 22:57:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3640 (-140.2317)
[INFO] - 03-16 22:57:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1413 (19.2260)
[INFO] - 03-16 22:57:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.3339 (189.9398)
[INFO] - 03-16 22:57:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:57:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9549)
[INFO] - 03-16 22:57:19 - [main.backward:225]: Epoch 299/300 - Iteration 98/199 - Time 0.202 batch, 0.034 data, 0.177 forward
[INFO] - 03-16 22:57:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:57:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0039)
[INFO] - 03-16 22:57:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6023 (0.5774)
[INFO] - 03-16 22:57:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1447 (-140.2236)
[INFO] - 03-16 22:57:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.3173 (19.2156)
[INFO] - 03-16 22:57:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.3938 (189.8411)
[INFO] - 03-16 22:57:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:57:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9556)
[INFO] - 03-16 22:57:29 - [main.backward:225]: Epoch 299/300 - Iteration 148/199 - Time 0.201 batch, 0.031 data, 0.176 forward
[INFO] - 03-16 22:57:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:57:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0044)
[INFO] - 03-16 22:57:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5742 (0.5824)
[INFO] - 03-16 22:57:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2746 (-140.1820)
[INFO] - 03-16 22:57:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2653 (19.2068)
[INFO] - 03-16 22:57:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.8488 (190.0024)
[INFO] - 03-16 22:57:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:57:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9478)
[INFO] - 03-16 22:57:40 - [main.backward:225]: Epoch 299/300 - Iteration 198/199 - Time 0.205 batch, 0.030 data, 0.180 forward
[INFO] - 03-16 22:57:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0086 (0.0047)
[INFO] - 03-16 22:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6080 (0.5841)
[INFO] - 03-16 22:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1571 (-140.1881)
[INFO] - 03-16 22:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1848 (19.2503)
[INFO] - 03-16 22:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.0213 (190.2385)
[INFO] - 03-16 22:57:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:57:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9431)
[INFO] - 03-16 22:57:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:57:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:57:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:57:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:57:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:57:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:57:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:57:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.728
[INFO] - 03-16 22:57:44 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.729
[INFO] - 03-16 22:57:44 - [main.summary_metrics:168]: Epoch 299/300 - Test Results:
{'auc': 0.847841784591195,
 'f1': 0.41248185776487667,
 'loss': 0.43008530581172405,
 'ndcg': 0.742127472264749,
 'precision': 0.6150943396226415,
 'recall': 0.3105345911949685}
[INFO] - 03-16 22:57:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[299] Complete. Time taken: 00:00:44.534
[INFO] - 03-16 22:57:44 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:57:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 03-16 22:57:44 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (8480, 8)
[INFO] - 03-16 22:57:44 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:57:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=3, type_aware=True) mode.
[INFO] - 03-16 22:57:44 - [outfit_datasets.generator.run:142]: Sampling 3x outfits from 3 sets: [7251, 4989, 5136]
[INFO] - 03-16 22:57:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (25440, 8)
[INFO] - 03-16 22:57:55 - [main.backward:225]: Epoch 300/300 - Iteration 49/199 - Time 0.220 batch, 0.044 data, 0.196 forward
[INFO] - 03-16 22:57:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:57:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0038)
[INFO] - 03-16 22:57:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5298 (0.5755)
[INFO] - 03-16 22:57:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.3106 (-140.2302)
[INFO] - 03-16 22:57:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.1955 (19.2220)
[INFO] - 03-16 22:57:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.2879 (189.8892)
[INFO] - 03-16 22:57:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:57:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9525)
[INFO] - 03-16 22:58:06 - [main.backward:225]: Epoch 300/300 - Iteration 99/199 - Time 0.222 batch, 0.035 data, 0.197 forward
[INFO] - 03-16 22:58:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0039)
[INFO] - 03-16 22:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5989 (0.5807)
[INFO] - 03-16 22:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1063 (-140.2135)
[INFO] - 03-16 22:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2404 (19.2375)
[INFO] - 03-16 22:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.6321 (190.1759)
[INFO] - 03-16 22:58:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9545)
[INFO] - 03-16 22:58:16 - [main.backward:225]: Epoch 300/300 - Iteration 149/199 - Time 0.214 batch, 0.032 data, 0.189 forward
[INFO] - 03-16 22:58:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0045)
[INFO] - 03-16 22:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5683 (0.5820)
[INFO] - 03-16 22:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.2861 (-140.1929)
[INFO] - 03-16 22:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2841 (19.2368)
[INFO] - 03-16 22:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 190.4207 (190.1773)
[INFO] - 03-16 22:58:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:58:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9433)
[INFO] - 03-16 22:58:25 - [main.backward:225]: Epoch 300/300 - Iteration 0/199 - Time 0.208 batch, 0.030 data, 0.183 forward
[INFO] - 03-16 22:58:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 03-16 22:58:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0047)
[INFO] - 03-16 22:58:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6059 (0.5838)
[INFO] - 03-16 22:58:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -140.1834 (-140.1943)
[INFO] - 03-16 22:58:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 19.2307 (19.2450)
[INFO] - 03-16 22:58:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 189.8784 (190.3110)
[INFO] - 03-16 22:58:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 03-16 22:58:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9271 (0.9374)
[INFO] - 03-16 22:58:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:58:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:58:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:58:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1051, 8)
[INFO] - 03-16 22:58:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:58:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:58:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (10510, 8)
[INFO] - 03-16 22:58:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.281
[INFO] - 03-16 22:58:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.282
[INFO] - 03-16 22:58:29 - [main.summary_metrics:168]: Epoch 300/300 - Test Results:
{'auc': 0.8446098991090146,
 'f1': 0.41228834059022734,
 'loss': 0.4303751184315552,
 'ndcg': 0.7371750299078133,
 'precision': 0.6150943396226415,
 'recall': 0.3102987421383648}
[INFO] - 03-16 22:58:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[300] Complete. Time taken: 00:00:44.664
[INFO] - 03-16 22:58:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 04:47:10.195
[INFO] - 03-16 22:58:29 - [main.evaluate:264]: Start Compatibility Evaluation
[INFO] - 03-16 22:58:29 - [main.get_net:27]: Creating net: 
FashionRecommenderParam: {
  factory: FashionRecommenderParam,
  name: FashionRecommender,
  num_users: 53,
  backbone: resnet34,
  embd_dim: 128,
  num_transformer_layers: 3,
  num_heads: 2,
  num_proto: 64,
  dropout: 0.3,
  num_points: 0,
  num_seeds: 1,
  loss_weight: {
    rank_loss: 1.0,
    l1reg: 0.01,
    l2reg: 0.001,
  },
  use_visual: True,
  use_semantic: False,
  use_nn_feature: False,
  max_items: 3,
  drop_path_rate: 0.1,
  margin: 0.5,
  temperature: 0.1,
  l2_scale: 0.01,
  l1_scale: 0.001,
  proto_reg_weight: 0.1,
  momentum: 0.9,
  curriculum_epochs: 50,
}
[INFO] - 03-16 22:58:29 - [torchutils.misc.load_pretrained:292]: Loading pre-trained model from logs\2025exp_tuple53_Outfit5_008\checkpoints\best_model_245_val_auc=0.8740.pt.
[INFO] - 03-16 22:58:29 - [torchutils.misc.load_pretrained:305]: Missing keys: 
[INFO] - 03-16 22:58:29 - [torchutils.misc.load_pretrained:306]: Unexpected keys: 
[INFO] - 03-16 22:58:29 - [torchutils.misc.load_pretrained:307]: Unmatched keys: 
[INFO] - 03-16 22:58:29 - [outfit_datasets.dataloader.__init__:28]: Loading [32mtest[0m data
[INFO] - 03-16 22:58:29 - [outfit_datasets.dataloader.__init__:29]: DataLoader: batch size ([32m128[0m), number of workers ([32m0[0m)
[INFO] - 03-16 22:58:29 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_53\test_pos
[INFO] - 03-16 22:58:29 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mtest positive[0m tuples with shape: [32m(1944, 8)[0m
[INFO] - 03-16 22:58:29 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_53\test_neg
[INFO] - 03-16 22:58:29 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mtest negative[0m tuples with shape: [32m(19440, 8)[0m
[INFO] - 03-16 22:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:58:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1944, 8)
[INFO] - 03-16 22:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:58:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (19440, 8)
[INFO] - 03-16 22:58:29 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 03-16 22:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 03-16 22:58:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (1944, 8)
[INFO] - 03-16 22:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 03-16 22:58:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 03-16 22:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (19440, 8)
[INFO] - 03-16 22:58:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:21.774
[INFO] - 03-16 22:58:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:21.774
[CRITICAL] - 03-16 22:58:51 - [main.evaluate:272]: Test results:
{'auc': 0.8779101769826609,
 'f1': 0.3428419405393281,
 'loss': 0.43429410993669,
 'ndcg': 0.8112993731781623,
 'precision': 0.7999999999999998,
 'recall': 0.21820402252378415}
[INFO] - 03-16 22:58:51 - [main.evaluate:278]: Averaged loss: mean - 0.4343, std - 0.0000
[INFO] - 03-16 22:58:51 - [main.evaluate:278]: Averaged ndcg: mean - 0.8113, std - 0.0000
[INFO] - 03-16 22:58:51 - [main.evaluate:278]: Averaged auc: mean - 0.8779, std - 0.0000
[INFO] - 03-16 22:58:51 - [main.evaluate:278]: Averaged recall: mean - 0.2182, std - 0.0000
[INFO] - 03-16 22:58:51 - [main.evaluate:278]: Averaged f1: mean - 0.3428, std - 0.0000
[INFO] - 03-16 22:58:51 - [main.evaluate:278]: Averaged precision: mean - 0.8000, std - 0.0000
