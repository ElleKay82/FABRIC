[INFO] - 02-27 17:47:50 - [main.get_net:27]: Creating net: 
FashionRecommenderParam: {
  factory: FashionRecommenderParam,
  name: FashionRecommender,
  num_users: 32,
  backbone: resnet34,
  embd_dim: 128,
  num_transformer_layers: 4,
  num_heads: 2,
  num_proto: 128,
  dropout: 0.3,
  num_points: 0,
  num_seeds: 1,
  loss_weight: {
    rank_loss: 1.0,
    l1reg: 0.01,
    l2reg: 0.0001,
  },
  use_visual: True,
  use_semantic: False,
  use_nn_feature: False,
  max_items: 3,
  drop_path_rate: 0.1,
  margin: 0.5,
  temperature: 0.1,
  l2_scale: 0.001,
  l1_scale: 0.0001,
  proto_reg_weight: 0.1,
  momentum: 0.9,
  curriculum_epochs: 50,
}
[INFO] - 02-27 17:47:54 - [main.train:254]: Validation data: OutfitLoaderParam: {
  factory: OutfitLoaderParam,
  phase: valid,
  readers: [
    {
      reader: TensorLMDB,
      path: ./outfit-datasets/polyvore-u/processed/features/resnet34,
      data_transform: None,
    },
  ],
  dataset: {
    data_mode: PointwiseOutfit,
    pos_mode: Fix,
    neg_mode: Fix,
    pos_param: {},
    neg_param: {},
  },
  num_types: 3,
  max_items: 4,
  num_users: 32,
  num_fitb_choices: 4,
  batch_size: 128,
  num_workers: 0,
  drop_last: False,
  shuffle: False,
  pos_fn: ./outfit-datasets/polyvore-u/processed/original/tuples_32\valid_pos,
  neg_fn: ./outfit-datasets/polyvore-u/processed/original/tuples_32\valid_neg,
}
[INFO] - 02-27 17:47:54 - [outfit_datasets.dataloader.__init__:28]: Loading [32mvalid[0m data
[INFO] - 02-27 17:47:54 - [outfit_datasets.dataloader.__init__:29]: DataLoader: batch size ([32m128[0m), number of workers ([32m0[0m)
[INFO] - 02-27 17:47:54 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_32\valid_pos
[INFO] - 02-27 17:47:54 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mvalid positive[0m tuples with shape: [32m(534, 10)[0m
[INFO] - 02-27 17:47:54 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_32\valid_neg
[INFO] - 02-27 17:47:54 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mvalid negative[0m tuples with shape: [32m(5340, 10)[0m
[INFO] - 02-27 17:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:47:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:47:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:47:54 - [outfit_datasets.dataloader.__init__:28]: Loading [32mtrain[0m data
[INFO] - 02-27 17:47:54 - [outfit_datasets.dataloader.__init__:29]: DataLoader: batch size ([32m128[0m), number of workers ([32m0[0m)
[INFO] - 02-27 17:47:54 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_32\train_pos
[INFO] - 02-27 17:47:54 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mtrain positive[0m tuples with shape: [32m(5133, 10)[0m
[INFO] - 02-27 17:47:54 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_32\train_neg
[INFO] - 02-27 17:47:55 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mtrain negative[0m tuples with shape: [32m(51330, 10)[0m
[INFO] - 02-27 17:47:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:47:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:47:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:47:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:47:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:47:55 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2194, 2208, 1]
[INFO] - 02-27 17:47:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:47:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=500.
[INFO] - 02-27 17:47:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:47:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:47:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:47:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:47:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:47:56 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2206, 2220, 1]
[INFO] - 02-27 17:47:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:48:15 - [main.backward:225]: Epoch 1/500 - Iteration 50/95 - Time 0.394 batch, 0.065 data, 0.349 forward
[INFO] - 02-27 17:48:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0220 (0.0219)
[INFO] - 02-27 17:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5948 (0.5976)
[INFO] - 02-27 17:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5265 (-278.3747)
[INFO] - 02-27 17:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 35.2508 (34.9090)
[INFO] - 02-27 17:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 411.8950 (411.7625)
[INFO] - 02-27 17:48:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5156 (0.4944)
[INFO] - 02-27 17:48:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:48:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:48:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:48:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:48:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:48:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:48:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:48:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.925
[INFO] - 02-27 17:48:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.926
[INFO] - 02-27 17:48:34 - [main.summary_metrics:168]: Epoch 1/500 - Test Results:
{'auc': 0.5228453348864055,
 'f1': 0.07336700336700339,
 'loss': 0.6923835334144713,
 'ndcg': 0.27483080090392287,
 'precision': 0.09687500000000002,
 'recall': 0.059252450980392155}
[INFO] - 02-27 17:48:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:38.364
[INFO] - 02-27 17:48:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:48:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:48:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:48:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:48:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:48:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2201, 2203, 1]
[INFO] - 02-27 17:48:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:48:37 - [main.backward:225]: Epoch 2/500 - Iteration 5/95 - Time 0.534 batch, 0.228 data, 0.492 forward
[INFO] - 02-27 17:48:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0217)
[INFO] - 02-27 17:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5978 (0.5981)
[INFO] - 02-27 17:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5584 (-287.5493)
[INFO] - 02-27 17:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 35.2986 (35.3644)
[INFO] - 02-27 17:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 408.9631 (410.7724)
[INFO] - 02-27 17:48:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:48:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4766 (0.5147)
[INFO] - 02-27 17:48:54 - [main.backward:225]: Epoch 2/500 - Iteration 55/95 - Time 0.357 batch, 0.052 data, 0.322 forward
[INFO] - 02-27 17:48:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0216 (0.0216)
[INFO] - 02-27 17:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5965 (0.5981)
[INFO] - 02-27 17:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5648 (-287.5607)
[INFO] - 02-27 17:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 35.4693 (35.4540)
[INFO] - 02-27 17:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 409.2624 (409.8805)
[INFO] - 02-27 17:48:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.5242)
[INFO] - 02-27 17:49:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:49:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:49:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:49:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:49:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:49:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:49:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:49:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.139
[INFO] - 02-27 17:49:10 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.140
[INFO] - 02-27 17:49:11 - [main.summary_metrics:168]: Epoch 2/500 - Test Results:
{'auc': 0.5388412345330289,
 'f1': 0.0831523569023569,
 'loss': 0.6913498546713871,
 'ndcg': 0.2947261284109288,
 'precision': 0.109375,
 'recall': 0.06737132352941178}
[INFO] - 02-27 17:49:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[2] Complete. Time taken: 00:00:36.577
[INFO] - 02-27 17:49:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:49:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:49:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:49:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:49:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:49:11 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3041, 2204, 2217, 1]
[INFO] - 02-27 17:49:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:49:15 - [main.backward:225]: Epoch 3/500 - Iteration 10/95 - Time 0.439 batch, 0.124 data, 0.402 forward
[INFO] - 02-27 17:49:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:49:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0219 (0.0216)
[INFO] - 02-27 17:49:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5980 (0.5982)
[INFO] - 02-27 17:49:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5668 (-287.5657)
[INFO] - 02-27 17:49:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 35.3503 (35.3634)
[INFO] - 02-27 17:49:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 411.7962 (410.6507)
[INFO] - 02-27 17:49:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:49:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.4922 (0.5294)
[INFO] - 02-27 17:49:32 - [main.backward:225]: Epoch 3/500 - Iteration 60/95 - Time 0.357 batch, 0.053 data, 0.318 forward
[INFO] - 02-27 17:49:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:49:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0213 (0.0215)
[INFO] - 02-27 17:49:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5968 (0.5983)
[INFO] - 02-27 17:49:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5668 (-287.5664)
[INFO] - 02-27 17:49:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 35.2117 (35.2378)
[INFO] - 02-27 17:49:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 411.8400 (411.2715)
[INFO] - 02-27 17:49:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:49:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5703 (0.5433)
[INFO] - 02-27 17:49:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:49:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:49:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:49:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:49:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:49:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:49:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:49:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.995
[INFO] - 02-27 17:49:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.996
[INFO] - 02-27 17:49:47 - [main.summary_metrics:168]: Epoch 3/500 - Test Results:
{'auc': 0.5424020109882188,
 'f1': 0.07728535353535354,
 'loss': 0.6908618281344372,
 'ndcg': 0.2946423169296414,
 'precision': 0.103125,
 'recall': 0.06191789215686274}
[INFO] - 02-27 17:49:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[3] Complete. Time taken: 00:00:36.143
[INFO] - 02-27 17:49:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:49:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:49:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:49:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:49:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:49:47 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2204, 2198, 1]
[INFO] - 02-27 17:49:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:49:53 - [main.backward:225]: Epoch 4/500 - Iteration 15/95 - Time 0.382 batch, 0.089 data, 0.349 forward
[INFO] - 02-27 17:49:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:49:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0215)
[INFO] - 02-27 17:49:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5981 (0.5984)
[INFO] - 02-27 17:49:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5665 (-287.5663)
[INFO] - 02-27 17:49:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 35.1030 (35.1318)
[INFO] - 02-27 17:49:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 411.3280 (411.1757)
[INFO] - 02-27 17:49:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:49:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.5447)
[INFO] - 02-27 17:50:09 - [main.backward:225]: Epoch 4/500 - Iteration 65/95 - Time 0.342 batch, 0.050 data, 0.306 forward
[INFO] - 02-27 17:50:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:50:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0214)
[INFO] - 02-27 17:50:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5965 (0.5976)
[INFO] - 02-27 17:50:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5667 (-287.5672)
[INFO] - 02-27 17:50:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.8085 (34.8955)
[INFO] - 02-27 17:50:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 415.7870 (413.7554)
[INFO] - 02-27 17:50:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:50:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5703 (0.5495)
[INFO] - 02-27 17:50:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:50:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:50:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:50:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:50:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:50:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:50:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:50:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.880
[INFO] - 02-27 17:50:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.881
[INFO] - 02-27 17:50:23 - [main.summary_metrics:168]: Epoch 4/500 - Test Results:
{'auc': 0.5677669492429325,
 'f1': 0.10606376262626264,
 'loss': 0.6879887623304624,
 'ndcg': 0.32478898540621104,
 'precision': 0.140625,
 'recall': 0.08538165266106443}
[INFO] - 02-27 17:50:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[4] Complete. Time taken: 00:00:35.833
[INFO] - 02-27 17:50:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:50:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:50:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:50:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:50:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:50:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2190, 2212, 1]
[INFO] - 02-27 17:50:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:50:30 - [main.backward:225]: Epoch 5/500 - Iteration 20/95 - Time 0.380 batch, 0.088 data, 0.338 forward
[INFO] - 02-27 17:50:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0210 (0.0213)
[INFO] - 02-27 17:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6012 (0.5974)
[INFO] - 02-27 17:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5657 (-287.5666)
[INFO] - 02-27 17:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.4663 (34.6290)
[INFO] - 02-27 17:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 417.7448 (415.6935)
[INFO] - 02-27 17:50:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6406 (0.5589)
[INFO] - 02-27 17:50:47 - [main.backward:225]: Epoch 5/500 - Iteration 70/95 - Time 0.355 batch, 0.053 data, 0.315 forward
[INFO] - 02-27 17:50:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0218 (0.0212)
[INFO] - 02-27 17:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5957 (0.5974)
[INFO] - 02-27 17:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5665 (-287.5661)
[INFO] - 02-27 17:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1294 (34.2961)
[INFO] - 02-27 17:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 417.9687 (417.3884)
[INFO] - 02-27 17:50:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5391 (0.5747)
[INFO] - 02-27 17:50:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:50:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:50:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:50:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:50:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:50:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:50:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:50:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.808
[INFO] - 02-27 17:50:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.809
[INFO] - 02-27 17:50:59 - [main.summary_metrics:168]: Epoch 5/500 - Test Results:
{'auc': 0.5746622273909563,
 'f1': 0.11027146464646467,
 'loss': 0.6841571912202946,
 'ndcg': 0.3356924296504381,
 'precision': 0.14687500000000003,
 'recall': 0.08844100140056022}
[INFO] - 02-27 17:50:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[5] Complete. Time taken: 00:00:36.114
[INFO] - 02-27 17:50:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:50:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:50:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:50:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:50:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:50:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2198, 2196, 1]
[INFO] - 02-27 17:51:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:51:08 - [main.backward:225]: Epoch 6/500 - Iteration 25/95 - Time 0.374 batch, 0.071 data, 0.340 forward
[INFO] - 02-27 17:51:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0204 (0.0210)
[INFO] - 02-27 17:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5985 (0.5972)
[INFO] - 02-27 17:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5635 (-287.5649)
[INFO] - 02-27 17:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0534 (34.0389)
[INFO] - 02-27 17:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 416.7627 (417.6512)
[INFO] - 02-27 17:51:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:51:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6172 (0.5863)
[INFO] - 02-27 17:51:25 - [main.backward:225]: Epoch 6/500 - Iteration 75/95 - Time 0.352 batch, 0.050 data, 0.315 forward
[INFO] - 02-27 17:51:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0212 (0.0208)
[INFO] - 02-27 17:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5987 (0.5975)
[INFO] - 02-27 17:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5633 (-287.5643)
[INFO] - 02-27 17:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.8912 (34.0473)
[INFO] - 02-27 17:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 416.5402 (417.1969)
[INFO] - 02-27 17:51:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5859 (0.6031)
[INFO] - 02-27 17:51:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:51:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:51:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:51:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:51:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:51:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:51:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:51:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.783
[INFO] - 02-27 17:51:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.784
[INFO] - 02-27 17:51:35 - [main.summary_metrics:168]: Epoch 6/500 - Test Results:
{'auc': 0.5877554146658663,
 'f1': 0.1451788720538721,
 'loss': 0.6780999615667477,
 'ndcg': 0.3631329163612773,
 'precision': 0.19375,
 'recall': 0.1162596288515406}
[INFO] - 02-27 17:51:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[6] Complete. Time taken: 00:00:36.050
[INFO] - 02-27 17:51:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:51:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:51:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:51:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:51:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:51:35 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3043, 2207, 2203, 1]
[INFO] - 02-27 17:51:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:51:46 - [main.backward:225]: Epoch 7/500 - Iteration 30/95 - Time 0.384 batch, 0.067 data, 0.343 forward
[INFO] - 02-27 17:51:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:51:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0208 (0.0207)
[INFO] - 02-27 17:51:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5961 (0.5971)
[INFO] - 02-27 17:51:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5618 (-287.5628)
[INFO] - 02-27 17:51:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1492 (34.0016)
[INFO] - 02-27 17:51:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 413.1386 (414.9507)
[INFO] - 02-27 17:51:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:51:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6250 (0.6058)
[INFO] - 02-27 17:52:03 - [main.backward:225]: Epoch 7/500 - Iteration 80/95 - Time 0.348 batch, 0.049 data, 0.309 forward
[INFO] - 02-27 17:52:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:52:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0214 (0.0203)
[INFO] - 02-27 17:52:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5934 (0.5967)
[INFO] - 02-27 17:52:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5638 (-287.5635)
[INFO] - 02-27 17:52:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7323 (33.8857)
[INFO] - 02-27 17:52:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 413.6091 (414.4747)
[INFO] - 02-27 17:52:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:52:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5625 (0.6289)
[INFO] - 02-27 17:52:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:52:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:52:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:52:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:52:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:52:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:52:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:52:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.751
[INFO] - 02-27 17:52:10 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.751
[INFO] - 02-27 17:52:10 - [main.summary_metrics:168]: Epoch 7/500 - Test Results:
{'auc': 0.610170362078655,
 'f1': 0.14599431818181818,
 'loss': 0.6728927724340712,
 'ndcg': 0.37469717267355485,
 'precision': 0.19374999999999998,
 'recall': 0.11741946778711485}
[INFO] - 02-27 17:52:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[7] Complete. Time taken: 00:00:35.708
[INFO] - 02-27 17:52:10 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:52:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:52:10 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:52:10 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:52:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:52:10 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3052, 2192, 2212, 1]
[INFO] - 02-27 17:52:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:52:23 - [main.backward:225]: Epoch 8/500 - Iteration 35/95 - Time 0.364 batch, 0.061 data, 0.326 forward
[INFO] - 02-27 17:52:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0202 (0.0201)
[INFO] - 02-27 17:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5970 (0.5972)
[INFO] - 02-27 17:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5630 (-287.5621)
[INFO] - 02-27 17:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7670 (33.7657)
[INFO] - 02-27 17:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 415.6023 (414.3629)
[INFO] - 02-27 17:52:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:52:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6094 (0.6341)
[INFO] - 02-27 17:52:40 - [main.backward:225]: Epoch 8/500 - Iteration 85/95 - Time 0.348 batch, 0.047 data, 0.311 forward
[INFO] - 02-27 17:52:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:52:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0205 (0.0200)
[INFO] - 02-27 17:52:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5967)
[INFO] - 02-27 17:52:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5630 (-287.5621)
[INFO] - 02-27 17:52:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.8098 (33.9268)
[INFO] - 02-27 17:52:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 414.1047 (413.9618)
[INFO] - 02-27 17:52:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:52:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6016 (0.6380)
[INFO] - 02-27 17:52:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:52:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:52:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:52:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:52:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:52:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:52:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:52:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.075
[INFO] - 02-27 17:52:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.076
[INFO] - 02-27 17:52:47 - [main.summary_metrics:168]: Epoch 8/500 - Test Results:
{'auc': 0.6189507043013284,
 'f1': 0.15236005892255894,
 'loss': 0.6669399044855873,
 'ndcg': 0.384397401135623,
 'precision': 0.203125,
 'recall': 0.12214635854341735}
[INFO] - 02-27 17:52:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[8] Complete. Time taken: 00:00:36.132
[INFO] - 02-27 17:52:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:52:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:52:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:52:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:52:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:52:47 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3085, 2201, 2217, 1]
[INFO] - 02-27 17:52:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:53:01 - [main.backward:225]: Epoch 9/500 - Iteration 40/95 - Time 0.364 batch, 0.061 data, 0.328 forward
[INFO] - 02-27 17:53:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:53:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0194 (0.0197)
[INFO] - 02-27 17:53:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5959 (0.5959)
[INFO] - 02-27 17:53:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5609 (-287.5607)
[INFO] - 02-27 17:53:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.6216 (33.7852)
[INFO] - 02-27 17:53:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 414.5334 (413.8483)
[INFO] - 02-27 17:53:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:53:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.6434)
[INFO] - 02-27 17:53:18 - [main.backward:225]: Epoch 9/500 - Iteration 90/95 - Time 0.347 batch, 0.045 data, 0.313 forward
[INFO] - 02-27 17:53:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0184 (0.0192)
[INFO] - 02-27 17:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5982 (0.5959)
[INFO] - 02-27 17:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5563 (-287.5594)
[INFO] - 02-27 17:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7666 (33.7504)
[INFO] - 02-27 17:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 413.7198 (414.2830)
[INFO] - 02-27 17:53:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.6672)
[INFO] - 02-27 17:53:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:53:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:53:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:53:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:53:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:53:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:53:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:53:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.835
[INFO] - 02-27 17:53:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.836
[INFO] - 02-27 17:53:22 - [main.summary_metrics:168]: Epoch 9/500 - Test Results:
{'auc': 0.6372654485200944,
 'f1': 0.1774010942760943,
 'loss': 0.6611456584856565,
 'ndcg': 0.40274921403481007,
 'precision': 0.23750000000000002,
 'recall': 0.14174982492997198}
[INFO] - 02-27 17:53:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[9] Complete. Time taken: 00:00:35.834
[INFO] - 02-27 17:53:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:53:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:53:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:53:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:53:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:53:22 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3029, 2182, 2214, 1]
[INFO] - 02-27 17:53:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:53:39 - [main.backward:225]: Epoch 10/500 - Iteration 45/95 - Time 0.361 batch, 0.057 data, 0.323 forward
[INFO] - 02-27 17:53:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:53:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0206 (0.0192)
[INFO] - 02-27 17:53:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5963 (0.5962)
[INFO] - 02-27 17:53:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5597 (-287.5583)
[INFO] - 02-27 17:53:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0567 (33.9105)
[INFO] - 02-27 17:53:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 412.2169 (413.0314)
[INFO] - 02-27 17:53:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:53:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.5938 (0.6744)
[INFO] - 02-27 17:53:55 - [main.backward:225]: Epoch 10/500 - Iteration 0/95 - Time 0.342 batch, 0.046 data, 0.305 forward
[INFO] - 02-27 17:53:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:53:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0197 (0.0190)
[INFO] - 02-27 17:53:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5931 (0.5960)
[INFO] - 02-27 17:53:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5583 (-287.5590)
[INFO] - 02-27 17:53:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1619 (34.0076)
[INFO] - 02-27 17:53:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 411.9756 (411.7261)
[INFO] - 02-27 17:53:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:53:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6328 (0.6678)
[INFO] - 02-27 17:53:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:53:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:53:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:53:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:53:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:53:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:53:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:53:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.781
[INFO] - 02-27 17:53:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.782
[INFO] - 02-27 17:53:58 - [main.summary_metrics:168]: Epoch 10/500 - Test Results:
{'auc': 0.64894808192885,
 'f1': 0.16582702020202023,
 'loss': 0.6536124320718966,
 'ndcg': 0.42524745260486796,
 'precision': 0.221875,
 'recall': 0.13255864845938375}
[INFO] - 02-27 17:53:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[10] Complete. Time taken: 00:00:35.321
[INFO] - 02-27 17:53:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:53:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:53:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:53:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:53:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:53:58 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3064, 2212, 2208, 1]
[INFO] - 02-27 17:53:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:54:15 - [main.backward:225]: Epoch 11/500 - Iteration 50/95 - Time 0.350 batch, 0.051 data, 0.316 forward
[INFO] - 02-27 17:54:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0187 (0.0186)
[INFO] - 02-27 17:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5934 (0.5959)
[INFO] - 02-27 17:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5570 (-287.5586)
[INFO] - 02-27 17:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9840 (34.0296)
[INFO] - 02-27 17:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 412.1172 (411.8157)
[INFO] - 02-27 17:54:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.6894)
[INFO] - 02-27 17:54:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:54:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:54:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:54:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:54:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:54:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:54:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:54:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.866
[INFO] - 02-27 17:54:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.867
[INFO] - 02-27 17:54:34 - [main.summary_metrics:168]: Epoch 11/500 - Test Results:
{'auc': 0.6576867276935283,
 'f1': 0.18284617003367004,
 'loss': 0.6459553929126292,
 'ndcg': 0.43575714422016987,
 'precision': 0.24375,
 'recall': 0.14658613445378152}
[INFO] - 02-27 17:54:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[11] Complete. Time taken: 00:00:36.872
[INFO] - 02-27 17:54:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:54:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:54:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:54:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:54:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:54:35 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3020, 2181, 2218, 1]
[INFO] - 02-27 17:54:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:54:37 - [main.backward:225]: Epoch 12/500 - Iteration 5/95 - Time 0.495 batch, 0.208 data, 0.455 forward
[INFO] - 02-27 17:54:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0168 (0.0183)
[INFO] - 02-27 17:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5955 (0.5956)
[INFO] - 02-27 17:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5578 (-287.5574)
[INFO] - 02-27 17:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0238 (33.9808)
[INFO] - 02-27 17:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 410.4054 (411.0848)
[INFO] - 02-27 17:54:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7109 (0.6902)
[INFO] - 02-27 17:54:54 - [main.backward:225]: Epoch 12/500 - Iteration 55/95 - Time 0.344 batch, 0.053 data, 0.307 forward
[INFO] - 02-27 17:54:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0194 (0.0183)
[INFO] - 02-27 17:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5933 (0.5951)
[INFO] - 02-27 17:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5592 (-287.5587)
[INFO] - 02-27 17:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1321 (34.1096)
[INFO] - 02-27 17:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 411.6632 (410.6200)
[INFO] - 02-27 17:54:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6797 (0.6986)
[INFO] - 02-27 17:55:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:55:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:55:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:55:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:55:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:55:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:55:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:55:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.894
[INFO] - 02-27 17:55:10 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.894
[INFO] - 02-27 17:55:10 - [main.summary_metrics:168]: Epoch 12/500 - Test Results:
{'auc': 0.6647331991007187,
 'f1': 0.16914246632996635,
 'loss': 0.6426550780457512,
 'ndcg': 0.43302801729096146,
 'precision': 0.225,
 'recall': 0.13580182072829133}
[INFO] - 02-27 17:55:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[12] Complete. Time taken: 00:00:34.984
[INFO] - 02-27 17:55:10 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:55:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:55:10 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:55:10 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:55:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:55:10 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2185, 2219, 1]
[INFO] - 02-27 17:55:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:55:14 - [main.backward:225]: Epoch 13/500 - Iteration 10/95 - Time 0.418 batch, 0.118 data, 0.381 forward
[INFO] - 02-27 17:55:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0168 (0.0183)
[INFO] - 02-27 17:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5961 (0.5946)
[INFO] - 02-27 17:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5594 (-287.5589)
[INFO] - 02-27 17:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9558 (33.9983)
[INFO] - 02-27 17:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 409.7581 (411.1778)
[INFO] - 02-27 17:55:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:55:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7734 (0.6869)
[INFO] - 02-27 17:55:31 - [main.backward:225]: Epoch 13/500 - Iteration 60/95 - Time 0.348 batch, 0.050 data, 0.311 forward
[INFO] - 02-27 17:55:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:55:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0197 (0.0178)
[INFO] - 02-27 17:55:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5905 (0.5943)
[INFO] - 02-27 17:55:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5583 (-287.5575)
[INFO] - 02-27 17:55:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.3492 (34.0961)
[INFO] - 02-27 17:55:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 410.5120 (409.8660)
[INFO] - 02-27 17:55:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:55:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6875 (0.7045)
[INFO] - 02-27 17:55:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:55:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:55:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:55:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:55:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:55:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:55:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:55:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.877
[INFO] - 02-27 17:55:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.877
[INFO] - 02-27 17:55:45 - [main.summary_metrics:168]: Epoch 13/500 - Test Results:
{'auc': 0.680160278265718,
 'f1': 0.18755681818181819,
 'loss': 0.6386025263824007,
 'ndcg': 0.4340021685678673,
 'precision': 0.25,
 'recall': 0.150358893557423}
[INFO] - 02-27 17:55:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[13] Complete. Time taken: 00:00:35.512
[INFO] - 02-27 17:55:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:55:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:55:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:55:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:55:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:55:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2189, 2215, 1]
[INFO] - 02-27 17:55:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:55:51 - [main.backward:225]: Epoch 14/500 - Iteration 15/95 - Time 0.375 batch, 0.097 data, 0.339 forward
[INFO] - 02-27 17:55:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:55:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0179 (0.0178)
[INFO] - 02-27 17:55:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5986 (0.5938)
[INFO] - 02-27 17:55:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5566 (-287.5565)
[INFO] - 02-27 17:55:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1634 (34.1559)
[INFO] - 02-27 17:55:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 411.3974 (410.0436)
[INFO] - 02-27 17:55:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:55:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6562 (0.7108)
[INFO] - 02-27 17:56:07 - [main.backward:225]: Epoch 14/500 - Iteration 65/95 - Time 0.341 batch, 0.051 data, 0.305 forward
[INFO] - 02-27 17:56:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0187 (0.0177)
[INFO] - 02-27 17:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5957 (0.5950)
[INFO] - 02-27 17:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5567 (-287.5552)
[INFO] - 02-27 17:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.3223 (34.2369)
[INFO] - 02-27 17:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 411.2202 (409.8902)
[INFO] - 02-27 17:56:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:56:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6641 (0.7078)
[INFO] - 02-27 17:56:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:56:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:56:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:56:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:56:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:56:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:56:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:56:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.721
[INFO] - 02-27 17:56:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.722
[INFO] - 02-27 17:56:20 - [main.summary_metrics:168]: Epoch 14/500 - Test Results:
{'auc': 0.6757570319794584,
 'f1': 0.1671980218855219,
 'loss': 0.6346702301395281,
 'ndcg': 0.4347972582026158,
 'precision': 0.221875,
 'recall': 0.13445378151260504}
[INFO] - 02-27 17:56:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[14] Complete. Time taken: 00:00:35.179
[INFO] - 02-27 17:56:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:56:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:56:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:56:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:56:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:56:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3025, 2220, 2216, 1]
[INFO] - 02-27 17:56:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:56:28 - [main.backward:225]: Epoch 15/500 - Iteration 20/95 - Time 0.387 batch, 0.080 data, 0.350 forward
[INFO] - 02-27 17:56:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:56:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0162 (0.0175)
[INFO] - 02-27 17:56:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5972 (0.5936)
[INFO] - 02-27 17:56:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5542 (-287.5556)
[INFO] - 02-27 17:56:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1826 (34.2676)
[INFO] - 02-27 17:56:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 408.8433 (408.7495)
[INFO] - 02-27 17:56:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:56:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7344 (0.7109)
[INFO] - 02-27 17:56:45 - [main.backward:225]: Epoch 15/500 - Iteration 70/95 - Time 0.352 batch, 0.048 data, 0.316 forward
[INFO] - 02-27 17:56:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:56:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0183 (0.0173)
[INFO] - 02-27 17:56:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5951 (0.5940)
[INFO] - 02-27 17:56:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5527 (-287.5529)
[INFO] - 02-27 17:56:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0328 (34.1100)
[INFO] - 02-27 17:56:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 406.7065 (408.5270)
[INFO] - 02-27 17:56:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:56:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7266 (0.7234)
[INFO] - 02-27 17:56:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:56:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:56:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:56:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:56:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:56:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:56:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:56:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.729
[INFO] - 02-27 17:56:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.729
[INFO] - 02-27 17:56:56 - [main.summary_metrics:168]: Epoch 15/500 - Test Results:
{'auc': 0.6864417166376354,
 'f1': 0.19489478114478115,
 'loss': 0.6301983795471687,
 'ndcg': 0.44544162896890876,
 'precision': 0.259375,
 'recall': 0.15641631652661064}
[INFO] - 02-27 17:56:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[15] Complete. Time taken: 00:00:35.834
[INFO] - 02-27 17:56:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:56:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:56:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:56:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:56:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:56:56 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2212, 2211, 1]
[INFO] - 02-27 17:56:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:57:05 - [main.backward:225]: Epoch 16/500 - Iteration 25/95 - Time 0.370 batch, 0.075 data, 0.332 forward
[INFO] - 02-27 17:57:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:57:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0154 (0.0171)
[INFO] - 02-27 17:57:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5936)
[INFO] - 02-27 17:57:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5527 (-287.5521)
[INFO] - 02-27 17:57:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.2101 (34.0779)
[INFO] - 02-27 17:57:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 405.7561 (407.2750)
[INFO] - 02-27 17:57:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:57:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.7233)
[INFO] - 02-27 17:57:22 - [main.backward:225]: Epoch 16/500 - Iteration 75/95 - Time 0.342 batch, 0.047 data, 0.308 forward
[INFO] - 02-27 17:57:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:57:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0172 (0.0166)
[INFO] - 02-27 17:57:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5967 (0.5937)
[INFO] - 02-27 17:57:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5516 (-287.5535)
[INFO] - 02-27 17:57:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0028 (34.0946)
[INFO] - 02-27 17:57:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 404.6532 (406.0534)
[INFO] - 02-27 17:57:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:57:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.6953 (0.7347)
[INFO] - 02-27 17:57:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:57:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:57:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:57:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:57:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:57:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:57:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:57:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.747
[INFO] - 02-27 17:57:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.748
[INFO] - 02-27 17:57:31 - [main.summary_metrics:168]: Epoch 16/500 - Test Results:
{'auc': 0.693180195975449,
 'f1': 0.17377209595959597,
 'loss': 0.6265897930735641,
 'ndcg': 0.4540647308272635,
 'precision': 0.23125,
 'recall': 0.13947829131652661}
[INFO] - 02-27 17:57:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[16] Complete. Time taken: 00:00:35.275
[INFO] - 02-27 17:57:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:57:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:57:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:57:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:57:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:57:31 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2203, 2212, 1]
[INFO] - 02-27 17:57:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:57:42 - [main.backward:225]: Epoch 17/500 - Iteration 30/95 - Time 0.360 batch, 0.063 data, 0.325 forward
[INFO] - 02-27 17:57:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0171 (0.0165)
[INFO] - 02-27 17:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5933)
[INFO] - 02-27 17:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5547 (-287.5547)
[INFO] - 02-27 17:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0634 (34.0900)
[INFO] - 02-27 17:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 405.4985 (405.1172)
[INFO] - 02-27 17:57:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7578 (0.7391)
[INFO] - 02-27 17:57:59 - [main.backward:225]: Epoch 17/500 - Iteration 80/95 - Time 0.339 batch, 0.047 data, 0.303 forward
[INFO] - 02-27 17:57:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0157 (0.0161)
[INFO] - 02-27 17:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6015 (0.5934)
[INFO] - 02-27 17:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5483 (-287.5533)
[INFO] - 02-27 17:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1906 (34.0832)
[INFO] - 02-27 17:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 405.5647 (405.3990)
[INFO] - 02-27 17:57:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:57:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7734 (0.7547)
[INFO] - 02-27 17:58:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:58:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:58:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:58:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:58:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:58:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:58:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:58:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.784
[INFO] - 02-27 17:58:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.785
[INFO] - 02-27 17:58:06 - [main.summary_metrics:168]: Epoch 17/500 - Test Results:
{'auc': 0.6974250681890404,
 'f1': 0.18284617003367007,
 'loss': 0.6213043134925585,
 'ndcg': 0.4614473220527159,
 'precision': 0.24375,
 'recall': 0.1465861344537815}
[INFO] - 02-27 17:58:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[17] Complete. Time taken: 00:00:34.969
[INFO] - 02-27 17:58:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:58:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:58:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:58:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:58:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:58:06 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3061, 2187, 2214, 1]
[INFO] - 02-27 17:58:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:58:19 - [main.backward:225]: Epoch 18/500 - Iteration 35/95 - Time 0.362 batch, 0.061 data, 0.324 forward
[INFO] - 02-27 17:58:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:58:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0155 (0.0166)
[INFO] - 02-27 17:58:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5920 (0.5933)
[INFO] - 02-27 17:58:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5509 (-287.5493)
[INFO] - 02-27 17:58:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.3154 (34.1915)
[INFO] - 02-27 17:58:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 406.1774 (405.1426)
[INFO] - 02-27 17:58:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:58:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7969 (0.7358)
[INFO] - 02-27 17:58:36 - [main.backward:225]: Epoch 18/500 - Iteration 85/95 - Time 0.347 batch, 0.047 data, 0.310 forward
[INFO] - 02-27 17:58:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:58:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0154 (0.0162)
[INFO] - 02-27 17:58:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5951 (0.5933)
[INFO] - 02-27 17:58:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5528 (-287.5525)
[INFO] - 02-27 17:58:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1833 (34.2230)
[INFO] - 02-27 17:58:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 405.3849 (404.6489)
[INFO] - 02-27 17:58:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:58:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7891 (0.7450)
[INFO] - 02-27 17:58:39 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:58:39 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:58:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:58:39 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:58:39 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:58:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:58:39 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:58:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.814
[INFO] - 02-27 17:58:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.816
[INFO] - 02-27 17:58:42 - [main.summary_metrics:168]: Epoch 18/500 - Test Results:
{'auc': 0.6976321527385464,
 'f1': 0.19757996632996633,
 'loss': 0.6241423960886539,
 'ndcg': 0.47996344861548307,
 'precision': 0.26249999999999996,
 'recall': 0.15874474789915966}
[INFO] - 02-27 17:58:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[18] Complete. Time taken: 00:00:35.819
[INFO] - 02-27 17:58:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:58:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:58:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:58:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:58:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:58:42 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2190, 2208, 1]
[INFO] - 02-27 17:58:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:58:56 - [main.backward:225]: Epoch 19/500 - Iteration 40/95 - Time 0.353 batch, 0.055 data, 0.319 forward
[INFO] - 02-27 17:58:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:58:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0162 (0.0155)
[INFO] - 02-27 17:58:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5888 (0.5931)
[INFO] - 02-27 17:58:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5531 (-287.5547)
[INFO] - 02-27 17:58:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9173 (33.9464)
[INFO] - 02-27 17:58:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 405.7690 (405.8359)
[INFO] - 02-27 17:58:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:58:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.7642)
[INFO] - 02-27 17:59:13 - [main.backward:225]: Epoch 19/500 - Iteration 90/95 - Time 0.343 batch, 0.044 data, 0.309 forward
[INFO] - 02-27 17:59:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:59:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0166 (0.0157)
[INFO] - 02-27 17:59:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5906 (0.5914)
[INFO] - 02-27 17:59:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5481 (-287.5514)
[INFO] - 02-27 17:59:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.2178 (34.0442)
[INFO] - 02-27 17:59:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 403.8730 (404.2196)
[INFO] - 02-27 17:59:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:59:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7188 (0.7648)
[INFO] - 02-27 17:59:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:59:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:59:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:59:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:59:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:59:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:59:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:59:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.775
[INFO] - 02-27 17:59:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.777
[INFO] - 02-27 17:59:18 - [main.summary_metrics:168]: Epoch 19/500 - Test Results:
{'auc': 0.6927951523133763,
 'f1': 0.18269044612794613,
 'loss': 0.6168123136564654,
 'ndcg': 0.46122700821533047,
 'precision': 0.24375000000000002,
 'recall': 0.14631039915966387}
[INFO] - 02-27 17:59:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[19] Complete. Time taken: 00:00:35.468
[INFO] - 02-27 17:59:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:59:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:59:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:59:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:59:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:59:18 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3039, 2208, 2201, 1]
[INFO] - 02-27 17:59:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 17:59:33 - [main.backward:225]: Epoch 20/500 - Iteration 45/95 - Time 0.349 batch, 0.054 data, 0.314 forward
[INFO] - 02-27 17:59:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:59:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0145 (0.0154)
[INFO] - 02-27 17:59:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5961 (0.5912)
[INFO] - 02-27 17:59:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5516 (-287.5501)
[INFO] - 02-27 17:59:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7180 (33.9550)
[INFO] - 02-27 17:59:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 405.4427 (403.8298)
[INFO] - 02-27 17:59:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:59:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7656 (0.7606)
[INFO] - 02-27 17:59:50 - [main.backward:225]: Epoch 20/500 - Iteration 0/95 - Time 0.338 batch, 0.044 data, 0.302 forward
[INFO] - 02-27 17:59:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 17:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0149 (0.0153)
[INFO] - 02-27 17:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5912 (0.5916)
[INFO] - 02-27 17:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5527 (-287.5512)
[INFO] - 02-27 17:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7599 (33.8292)
[INFO] - 02-27 17:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 403.0103 (402.6630)
[INFO] - 02-27 17:59:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 17:59:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7656 (0.7683)
[INFO] - 02-27 17:59:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 17:59:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:59:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:59:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 17:59:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:59:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 17:59:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 17:59:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.837
[INFO] - 02-27 17:59:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.838
[INFO] - 02-27 17:59:53 - [main.summary_metrics:168]: Epoch 20/500 - Test Results:
{'auc': 0.7007407738830826,
 'f1': 0.19989478114478115,
 'loss': 0.6173129466231345,
 'ndcg': 0.4566884519595521,
 'precision': 0.265625,
 'recall': 0.1605829831932773}
[INFO] - 02-27 17:59:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[20] Complete. Time taken: 00:00:34.991
[INFO] - 02-27 17:59:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 17:59:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 17:59:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 17:59:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 17:59:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 17:59:53 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3092, 2176, 2198, 1]
[INFO] - 02-27 17:59:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:00:10 - [main.backward:225]: Epoch 21/500 - Iteration 50/95 - Time 0.352 batch, 0.050 data, 0.319 forward
[INFO] - 02-27 18:00:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:00:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0142 (0.0153)
[INFO] - 02-27 18:00:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5964 (0.5912)
[INFO] - 02-27 18:00:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5491 (-287.5511)
[INFO] - 02-27 18:00:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9379 (33.8111)
[INFO] - 02-27 18:00:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 403.3137 (403.4489)
[INFO] - 02-27 18:00:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:00:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7891 (0.7691)
[INFO] - 02-27 18:00:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:00:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:00:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:00:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:00:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:00:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:00:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:00:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.850
[INFO] - 02-27 18:00:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.851
[INFO] - 02-27 18:00:28 - [main.summary_metrics:168]: Epoch 21/500 - Test Results:
{'auc': 0.7061628126740892,
 'f1': 0.19242424242424244,
 'loss': 0.6094103779019775,
 'ndcg': 0.46575844299156144,
 'precision': 0.25625,
 'recall': 0.15430234593837533}
[INFO] - 02-27 18:00:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[21] Complete. Time taken: 00:00:35.343
[INFO] - 02-27 18:00:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:00:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:00:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:00:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:00:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:00:28 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3024, 2193, 2185, 1]
[INFO] - 02-27 18:00:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:00:30 - [main.backward:225]: Epoch 22/500 - Iteration 5/95 - Time 0.493 batch, 0.207 data, 0.464 forward
[INFO] - 02-27 18:00:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:00:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0143 (0.0149)
[INFO] - 02-27 18:00:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5931 (0.5902)
[INFO] - 02-27 18:00:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5523 (-287.5507)
[INFO] - 02-27 18:00:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1667 (33.9879)
[INFO] - 02-27 18:00:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 402.9819 (403.4972)
[INFO] - 02-27 18:00:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:00:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.7720)
[INFO] - 02-27 18:00:47 - [main.backward:225]: Epoch 22/500 - Iteration 55/95 - Time 0.351 batch, 0.052 data, 0.315 forward
[INFO] - 02-27 18:00:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0145 (0.0151)
[INFO] - 02-27 18:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5951 (0.5918)
[INFO] - 02-27 18:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5508)
[INFO] - 02-27 18:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1925 (34.0909)
[INFO] - 02-27 18:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 402.8588 (402.7238)
[INFO] - 02-27 18:00:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:00:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7656 (0.7736)
[INFO] - 02-27 18:01:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:01:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:01:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:01:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:01:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:01:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:01:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:01:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.785
[INFO] - 02-27 18:01:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.786
[INFO] - 02-27 18:01:04 - [main.summary_metrics:168]: Epoch 22/500 - Test Results:
{'auc': 0.7249394415241586,
 'f1': 0.2388247053872054,
 'loss': 0.6040897192261998,
 'ndcg': 0.5091406631186237,
 'precision': 0.31875000000000003,
 'recall': 0.19121586134453783}
[INFO] - 02-27 18:01:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[22] Complete. Time taken: 00:00:35.897
[INFO] - 02-27 18:01:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:01:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:01:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:01:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:01:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:01:04 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3007, 2214, 2195, 1]
[INFO] - 02-27 18:01:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:01:08 - [main.backward:225]: Epoch 23/500 - Iteration 10/95 - Time 0.435 batch, 0.131 data, 0.398 forward
[INFO] - 02-27 18:01:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:01:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0124 (0.0141)
[INFO] - 02-27 18:01:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.6010 (0.5916)
[INFO] - 02-27 18:01:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5479)
[INFO] - 02-27 18:01:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7743 (34.0552)
[INFO] - 02-27 18:01:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 401.0374 (402.3510)
[INFO] - 02-27 18:01:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:01:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.7942)
[INFO] - 02-27 18:01:25 - [main.backward:225]: Epoch 23/500 - Iteration 60/95 - Time 0.349 batch, 0.053 data, 0.312 forward
[INFO] - 02-27 18:01:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:01:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0122 (0.0144)
[INFO] - 02-27 18:01:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5899 (0.5911)
[INFO] - 02-27 18:01:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5518 (-287.5492)
[INFO] - 02-27 18:01:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9448 (33.9593)
[INFO] - 02-27 18:01:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 402.5001 (402.8335)
[INFO] - 02-27 18:01:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:01:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.7859)
[INFO] - 02-27 18:01:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:01:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:01:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:01:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:01:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:01:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:01:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:01:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.777
[INFO] - 02-27 18:01:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.778
[INFO] - 02-27 18:01:40 - [main.summary_metrics:168]: Epoch 23/500 - Test Results:
{'auc': 0.7269334020372855,
 'f1': 0.2549757996632997,
 'loss': 0.5994875018988504,
 'ndcg': 0.5148881482336332,
 'precision': 0.34062499999999996,
 'recall': 0.20406162464985994}
[INFO] - 02-27 18:01:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[23] Complete. Time taken: 00:00:35.943
[INFO] - 02-27 18:01:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:01:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:01:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:01:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:01:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:01:40 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3027, 2212, 2227, 1]
[INFO] - 02-27 18:01:41 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:01:45 - [main.backward:225]: Epoch 24/500 - Iteration 15/95 - Time 0.372 batch, 0.096 data, 0.335 forward
[INFO] - 02-27 18:01:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:01:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0137 (0.0142)
[INFO] - 02-27 18:01:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5867 (0.5899)
[INFO] - 02-27 18:01:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5550 (-287.5547)
[INFO] - 02-27 18:01:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0431 (34.0503)
[INFO] - 02-27 18:01:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 404.1206 (403.0249)
[INFO] - 02-27 18:01:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:01:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7812 (0.7884)
[INFO] - 02-27 18:02:02 - [main.backward:225]: Epoch 24/500 - Iteration 65/95 - Time 0.342 batch, 0.051 data, 0.305 forward
[INFO] - 02-27 18:02:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0115 (0.0139)
[INFO] - 02-27 18:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5903)
[INFO] - 02-27 18:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5505 (-287.5524)
[INFO] - 02-27 18:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1033 (34.2181)
[INFO] - 02-27 18:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 400.7851 (401.9435)
[INFO] - 02-27 18:02:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8020)
[INFO] - 02-27 18:02:12 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:02:12 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:02:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:02:12 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:02:12 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:02:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:02:12 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:02:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.857
[INFO] - 02-27 18:02:15 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.858
[INFO] - 02-27 18:02:15 - [main.summary_metrics:168]: Epoch 24/500 - Test Results:
{'auc': 0.7383990035352376,
 'f1': 0.2668686868686869,
 'loss': 0.5994559518181806,
 'ndcg': 0.5418566970241511,
 'precision': 0.35624999999999996,
 'recall': 0.21361607142857142}
[INFO] - 02-27 18:02:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[24] Complete. Time taken: 00:00:35.096
[INFO] - 02-27 18:02:15 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:02:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:02:15 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:02:15 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:02:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:02:15 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2191, 2199, 1]
[INFO] - 02-27 18:02:16 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:02:22 - [main.backward:225]: Epoch 25/500 - Iteration 20/95 - Time 0.373 batch, 0.082 data, 0.336 forward
[INFO] - 02-27 18:02:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0153 (0.0136)
[INFO] - 02-27 18:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5897)
[INFO] - 02-27 18:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5505)
[INFO] - 02-27 18:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.2215 (34.1297)
[INFO] - 02-27 18:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 399.5695 (401.5824)
[INFO] - 02-27 18:02:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:02:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7969 (0.8078)
[INFO] - 02-27 18:02:39 - [main.backward:225]: Epoch 25/500 - Iteration 70/95 - Time 0.347 batch, 0.049 data, 0.311 forward
[INFO] - 02-27 18:02:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0146 (0.0132)
[INFO] - 02-27 18:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5909)
[INFO] - 02-27 18:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5474 (-287.5491)
[INFO] - 02-27 18:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9116 (34.1021)
[INFO] - 02-27 18:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 399.6721 (400.4595)
[INFO] - 02-27 18:02:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:02:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.7500 (0.8111)
[INFO] - 02-27 18:02:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:02:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:02:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:02:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:02:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:02:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:02:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:02:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.889
[INFO] - 02-27 18:02:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.891
[INFO] - 02-27 18:02:51 - [main.summary_metrics:168]: Epoch 25/500 - Test Results:
{'auc': 0.7397079477624383,
 'f1': 0.23372053872053872,
 'loss': 0.5937459202897973,
 'ndcg': 0.5183108410410898,
 'precision': 0.3125,
 'recall': 0.1869003851540616}
[INFO] - 02-27 18:02:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[25] Complete. Time taken: 00:00:35.726
[INFO] - 02-27 18:02:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:02:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:02:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:02:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:02:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:02:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2209, 2224, 1]
[INFO] - 02-27 18:02:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:03:00 - [main.backward:225]: Epoch 26/500 - Iteration 25/95 - Time 0.369 batch, 0.069 data, 0.333 forward
[INFO] - 02-27 18:03:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0110 (0.0129)
[INFO] - 02-27 18:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5916 (0.5906)
[INFO] - 02-27 18:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5488)
[INFO] - 02-27 18:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1688 (33.9897)
[INFO] - 02-27 18:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 397.7961 (400.4237)
[INFO] - 02-27 18:03:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.8167)
[INFO] - 02-27 18:03:17 - [main.backward:225]: Epoch 26/500 - Iteration 75/95 - Time 0.349 batch, 0.049 data, 0.311 forward
[INFO] - 02-27 18:03:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0121 (0.0129)
[INFO] - 02-27 18:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5964 (0.5896)
[INFO] - 02-27 18:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5500)
[INFO] - 02-27 18:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0070 (34.1442)
[INFO] - 02-27 18:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 401.7872 (400.2324)
[INFO] - 02-27 18:03:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8438 (0.8217)
[INFO] - 02-27 18:03:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:03:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:03:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:03:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:03:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:03:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:03:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:03:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.877
[INFO] - 02-27 18:03:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.878
[INFO] - 02-27 18:03:26 - [main.summary_metrics:168]: Epoch 26/500 - Test Results:
{'auc': 0.7448862356216996,
 'f1': 0.2762321127946128,
 'loss': 0.5923845690543936,
 'ndcg': 0.5550334304106843,
 'precision': 0.36875,
 'recall': 0.22111782212885153}
[INFO] - 02-27 18:03:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[26] Complete. Time taken: 00:00:35.764
[INFO] - 02-27 18:03:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:03:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:03:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:03:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:03:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:03:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3016, 2202, 2205, 1]
[INFO] - 02-27 18:03:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:03:37 - [main.backward:225]: Epoch 27/500 - Iteration 30/95 - Time 0.358 batch, 0.064 data, 0.321 forward
[INFO] - 02-27 18:03:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:03:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0121 (0.0125)
[INFO] - 02-27 18:03:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5896 (0.5908)
[INFO] - 02-27 18:03:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5465 (-287.5485)
[INFO] - 02-27 18:03:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.8493 (33.9609)
[INFO] - 02-27 18:03:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 400.5628 (402.0866)
[INFO] - 02-27 18:03:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:03:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.8213)
[INFO] - 02-27 18:03:54 - [main.backward:225]: Epoch 27/500 - Iteration 80/95 - Time 0.338 batch, 0.045 data, 0.303 forward
[INFO] - 02-27 18:03:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:03:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0119 (0.0122)
[INFO] - 02-27 18:03:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5946 (0.5911)
[INFO] - 02-27 18:03:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5500 (-287.5477)
[INFO] - 02-27 18:03:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.8646 (33.9643)
[INFO] - 02-27 18:03:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 400.1413 (400.6996)
[INFO] - 02-27 18:03:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:03:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8203 (0.8328)
[INFO] - 02-27 18:03:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:03:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:03:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:03:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:03:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:03:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:03:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:04:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.863
[INFO] - 02-27 18:04:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.863
[INFO] - 02-27 18:04:01 - [main.summary_metrics:168]: Epoch 27/500 - Test Results:
{'auc': 0.7638719177009039,
 'f1': 0.3000915404040404,
 'loss': 0.5799463811738136,
 'ndcg': 0.5751102362088485,
 'precision': 0.39999999999999997,
 'recall': 0.24051120448179272}
[INFO] - 02-27 18:04:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[27] Complete. Time taken: 00:00:34.939
[INFO] - 02-27 18:04:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:04:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:04:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:04:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:04:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:04:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3027, 2207, 2230, 1]
[INFO] - 02-27 18:04:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:04:14 - [main.backward:225]: Epoch 28/500 - Iteration 35/95 - Time 0.356 batch, 0.060 data, 0.320 forward
[INFO] - 02-27 18:04:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:04:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0116 (0.0120)
[INFO] - 02-27 18:04:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5891 (0.5899)
[INFO] - 02-27 18:04:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5495)
[INFO] - 02-27 18:04:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9202 (33.9307)
[INFO] - 02-27 18:04:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 401.2918 (400.9814)
[INFO] - 02-27 18:04:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:04:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8380)
[INFO] - 02-27 18:19:29 - [main.backward:225]: Epoch 28/500 - Iteration 85/95 - Time 10.912 batch, 0.047 data, 10.875 forward
[INFO] - 02-27 18:19:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:19:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0093 (0.0122)
[INFO] - 02-27 18:19:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5911 (0.5905)
[INFO] - 02-27 18:19:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5541 (-287.5487)
[INFO] - 02-27 18:19:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.8958 (33.9978)
[INFO] - 02-27 18:19:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 401.9113 (400.9416)
[INFO] - 02-27 18:19:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:19:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8356)
[INFO] - 02-27 18:19:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:19:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:19:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:19:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:19:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:19:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:19:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:19:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.361
[INFO] - 02-27 18:19:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.361
[INFO] - 02-27 18:19:36 - [main.summary_metrics:168]: Epoch 28/500 - Test Results:
{'auc': 0.7695937259094814,
 'f1': 0.2865951178451179,
 'loss': 0.5639232671611982,
 'ndcg': 0.5889599920265447,
 'precision': 0.38125,
 'recall': 0.23012955182072828}
[INFO] - 02-27 18:19:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[28] Complete. Time taken: 00:15:34.576
[INFO] - 02-27 18:19:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:19:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:19:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:19:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:19:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:19:36 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3036, 2197, 2200, 1]
[INFO] - 02-27 18:19:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:19:51 - [main.backward:225]: Epoch 29/500 - Iteration 40/95 - Time 0.371 batch, 0.055 data, 0.337 forward
[INFO] - 02-27 18:19:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0102 (0.0115)
[INFO] - 02-27 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5890)
[INFO] - 02-27 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5516 (-287.5527)
[INFO] - 02-27 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.8410 (33.8847)
[INFO] - 02-27 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 402.0896 (400.6522)
[INFO] - 02-27 18:19:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:19:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8483)
[INFO] - 02-27 18:20:08 - [main.backward:225]: Epoch 29/500 - Iteration 90/95 - Time 0.358 batch, 0.044 data, 0.324 forward
[INFO] - 02-27 18:20:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0114 (0.0111)
[INFO] - 02-27 18:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5925 (0.5889)
[INFO] - 02-27 18:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5524 (-287.5506)
[INFO] - 02-27 18:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9525 (33.8884)
[INFO] - 02-27 18:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 398.8821 (399.7509)
[INFO] - 02-27 18:20:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:20:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.8562)
[INFO] - 02-27 18:20:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:20:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:20:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:20:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:20:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:20:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:20:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:20:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.843
[INFO] - 02-27 18:20:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.844
[INFO] - 02-27 18:20:13 - [main.summary_metrics:168]: Epoch 29/500 - Test Results:
{'auc': 0.7908447852180087,
 'f1': 0.33731376262626267,
 'loss': 0.556885556240314,
 'ndcg': 0.6187183399773806,
 'precision': 0.45,
 'recall': 0.27016806722689074}
[INFO] - 02-27 18:20:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[29] Complete. Time taken: 00:00:36.941
[INFO] - 02-27 18:20:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:20:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:20:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:20:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:20:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:20:13 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2196, 2211, 1]
[INFO] - 02-27 18:20:14 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:20:31 - [main.backward:225]: Epoch 30/500 - Iteration 45/95 - Time 0.401 batch, 0.071 data, 0.354 forward
[INFO] - 02-27 18:20:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0115 (0.0109)
[INFO] - 02-27 18:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5918 (0.5898)
[INFO] - 02-27 18:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5526 (-287.5508)
[INFO] - 02-27 18:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.8518 (33.8679)
[INFO] - 02-27 18:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 399.5227 (399.3635)
[INFO] - 02-27 18:20:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8359 (0.8552)
[INFO] - 02-27 18:20:49 - [main.backward:225]: Epoch 30/500 - Iteration 0/95 - Time 0.375 batch, 0.057 data, 0.329 forward
[INFO] - 02-27 18:20:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:20:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0124 (0.0104)
[INFO] - 02-27 18:20:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5893 (0.5896)
[INFO] - 02-27 18:20:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5516 (-287.5494)
[INFO] - 02-27 18:20:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9056 (33.8863)
[INFO] - 02-27 18:20:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 400.0603 (399.5442)
[INFO] - 02-27 18:20:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:20:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8047 (0.8694)
[INFO] - 02-27 18:20:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:20:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:20:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:20:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:20:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:20:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:20:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:20:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.049
[INFO] - 02-27 18:20:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.049
[INFO] - 02-27 18:20:52 - [main.summary_metrics:168]: Epoch 30/500 - Test Results:
{'auc': 0.7875918660969289,
 'f1': 0.3232912457912458,
 'loss': 0.5519961886344399,
 'ndcg': 0.6082653722447224,
 'precision': 0.43125,
 'recall': 0.2590204831932773}
[INFO] - 02-27 18:20:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[30] Complete. Time taken: 00:00:38.747
[INFO] - 02-27 18:20:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:20:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:20:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:20:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:20:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:20:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2180, 2208, 1]
[INFO] - 02-27 18:20:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:21:11 - [main.backward:225]: Epoch 31/500 - Iteration 50/95 - Time 0.383 batch, 0.061 data, 0.339 forward
[INFO] - 02-27 18:21:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0106 (0.0105)
[INFO] - 02-27 18:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5878 (0.5889)
[INFO] - 02-27 18:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5494)
[INFO] - 02-27 18:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0584 (33.8624)
[INFO] - 02-27 18:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 397.6745 (398.5858)
[INFO] - 02-27 18:21:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:21:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.8688)
[INFO] - 02-27 18:21:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:21:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:21:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:21:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:21:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:21:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:21:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:21:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.049
[INFO] - 02-27 18:21:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.050
[INFO] - 02-27 18:21:29 - [main.summary_metrics:168]: Epoch 31/500 - Test Results:
{'auc': 0.7921608852487073,
 'f1': 0.33818076599326596,
 'loss': 0.5431902959079393,
 'ndcg': 0.6370080451991355,
 'precision': 0.44999999999999996,
 'recall': 0.2714548319327731}
[INFO] - 02-27 18:21:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[31] Complete. Time taken: 00:00:37.792
[INFO] - 02-27 18:21:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:21:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:21:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:21:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:21:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:21:29 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3072, 2202, 2200, 1]
[INFO] - 02-27 18:21:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:21:32 - [main.backward:225]: Epoch 32/500 - Iteration 5/95 - Time 0.516 batch, 0.208 data, 0.472 forward
[INFO] - 02-27 18:21:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:21:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0105 (0.0095)
[INFO] - 02-27 18:21:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5882 (0.5892)
[INFO] - 02-27 18:21:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5484 (-287.5495)
[INFO] - 02-27 18:21:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7246 (33.8941)
[INFO] - 02-27 18:21:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 399.8470 (398.9096)
[INFO] - 02-27 18:21:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:21:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.8881)
[INFO] - 02-27 18:21:50 - [main.backward:225]: Epoch 32/500 - Iteration 55/95 - Time 0.367 batch, 0.057 data, 0.325 forward
[INFO] - 02-27 18:21:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0105)
[INFO] - 02-27 18:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5933 (0.5910)
[INFO] - 02-27 18:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5531 (-287.5511)
[INFO] - 02-27 18:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.1864 (33.8559)
[INFO] - 02-27 18:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 401.0727 (399.4789)
[INFO] - 02-27 18:21:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.8653)
[INFO] - 02-27 18:22:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:22:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:22:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:22:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:22:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:22:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:22:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:22:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.935
[INFO] - 02-27 18:22:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.936
[INFO] - 02-27 18:22:06 - [main.summary_metrics:168]: Epoch 32/500 - Test Results:
{'auc': 0.8033993818115481,
 'f1': 0.3454913720538721,
 'loss': 0.5487145984565575,
 'ndcg': 0.6368184628890066,
 'precision': 0.4625,
 'recall': 0.27601978291316526}
[INFO] - 02-27 18:22:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[32] Complete. Time taken: 00:00:36.975
[INFO] - 02-27 18:22:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:22:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:22:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:22:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:22:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:22:06 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2202, 2212, 1]
[INFO] - 02-27 18:22:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:22:11 - [main.backward:225]: Epoch 33/500 - Iteration 10/95 - Time 0.468 batch, 0.139 data, 0.427 forward
[INFO] - 02-27 18:22:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0084 (0.0099)
[INFO] - 02-27 18:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5882 (0.5910)
[INFO] - 02-27 18:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5528 (-287.5538)
[INFO] - 02-27 18:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7271 (33.9126)
[INFO] - 02-27 18:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 399.1141 (399.8176)
[INFO] - 02-27 18:22:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:22:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.8781)
[INFO] - 02-27 18:22:29 - [main.backward:225]: Epoch 33/500 - Iteration 60/95 - Time 0.373 batch, 0.053 data, 0.336 forward
[INFO] - 02-27 18:22:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0087 (0.0088)
[INFO] - 02-27 18:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5903)
[INFO] - 02-27 18:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5514 (-287.5529)
[INFO] - 02-27 18:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9418 (33.9245)
[INFO] - 02-27 18:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 397.4012 (398.4126)
[INFO] - 02-27 18:22:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:22:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.8958)
[INFO] - 02-27 18:22:41 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:22:41 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:22:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:22:41 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:22:41 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:22:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:22:41 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:22:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.044
[INFO] - 02-27 18:22:44 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.045
[INFO] - 02-27 18:22:44 - [main.summary_metrics:168]: Epoch 33/500 - Test Results:
{'auc': 0.8086489546186122,
 'f1': 0.376322601010101,
 'loss': 0.5431941733917758,
 'ndcg': 0.6584376054037149,
 'precision': 0.5,
 'recall': 0.30242034313725485}
[INFO] - 02-27 18:22:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[33] Complete. Time taken: 00:00:37.633
[INFO] - 02-27 18:22:44 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:22:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:22:44 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:22:44 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:22:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:22:44 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2204, 2216, 1]
[INFO] - 02-27 18:22:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:22:50 - [main.backward:225]: Epoch 34/500 - Iteration 15/95 - Time 0.414 batch, 0.100 data, 0.368 forward
[INFO] - 02-27 18:22:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:22:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0084 (0.0097)
[INFO] - 02-27 18:22:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5962 (0.5896)
[INFO] - 02-27 18:22:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5518 (-287.5516)
[INFO] - 02-27 18:22:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.2873 (34.0457)
[INFO] - 02-27 18:22:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 396.7281 (397.7365)
[INFO] - 02-27 18:22:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:22:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.8838)
[INFO] - 02-27 18:23:07 - [main.backward:225]: Epoch 34/500 - Iteration 65/95 - Time 0.353 batch, 0.048 data, 0.317 forward
[INFO] - 02-27 18:23:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:23:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0120 (0.0097)
[INFO] - 02-27 18:23:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5959 (0.5906)
[INFO] - 02-27 18:23:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5527 (-287.5548)
[INFO] - 02-27 18:23:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0837 (34.1218)
[INFO] - 02-27 18:23:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 397.4468 (398.1180)
[INFO] - 02-27 18:23:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:23:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8594 (0.8816)
[INFO] - 02-27 18:23:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:23:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:23:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:23:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.840
[INFO] - 02-27 18:23:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.840
[INFO] - 02-27 18:23:20 - [main.summary_metrics:168]: Epoch 34/500 - Test Results:
{'auc': 0.8086178492843217,
 'f1': 0.3532512626262626,
 'loss': 0.5392176376296799,
 'ndcg': 0.6440643165302179,
 'precision': 0.471875,
 'recall': 0.28269432773109243}
[INFO] - 02-27 18:23:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[34] Complete. Time taken: 00:00:36.115
[INFO] - 02-27 18:23:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:23:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:23:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:23:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:23:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:23:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2190, 2212, 1]
[INFO] - 02-27 18:23:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:23:28 - [main.backward:225]: Epoch 35/500 - Iteration 20/95 - Time 0.378 batch, 0.074 data, 0.343 forward
[INFO] - 02-27 18:23:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0073 (0.0093)
[INFO] - 02-27 18:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5920 (0.5920)
[INFO] - 02-27 18:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5538 (-287.5518)
[INFO] - 02-27 18:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0055 (34.0714)
[INFO] - 02-27 18:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 396.8497 (397.9716)
[INFO] - 02-27 18:23:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.8873)
[INFO] - 02-27 18:23:45 - [main.backward:225]: Epoch 35/500 - Iteration 70/95 - Time 0.357 batch, 0.047 data, 0.322 forward
[INFO] - 02-27 18:23:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0080 (0.0089)
[INFO] - 02-27 18:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5988 (0.5913)
[INFO] - 02-27 18:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5550 (-287.5530)
[INFO] - 02-27 18:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.8922 (33.9953)
[INFO] - 02-27 18:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 395.5363 (396.6906)
[INFO] - 02-27 18:23:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.8922)
[INFO] - 02-27 18:23:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:23:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:23:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:23:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:23:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:23:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:23:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:23:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.996
[INFO] - 02-27 18:23:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.998
[INFO] - 02-27 18:23:57 - [main.summary_metrics:168]: Epoch 35/500 - Test Results:
{'auc': 0.8068859825180072,
 'f1': 0.33557659932659933,
 'loss': 0.5402562174158141,
 'ndcg': 0.6348051930251737,
 'precision': 0.446875,
 'recall': 0.26922268907563024}
[INFO] - 02-27 18:23:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[35] Complete. Time taken: 00:00:36.677
[INFO] - 02-27 18:23:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:23:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:23:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:23:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:23:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:23:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3077, 2196, 2213, 1]
[INFO] - 02-27 18:23:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:24:07 - [main.backward:225]: Epoch 36/500 - Iteration 25/95 - Time 0.389 batch, 0.079 data, 0.351 forward
[INFO] - 02-27 18:24:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:24:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0088)
[INFO] - 02-27 18:24:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5906 (0.5906)
[INFO] - 02-27 18:24:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5555 (-287.5525)
[INFO] - 02-27 18:24:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9862 (33.9834)
[INFO] - 02-27 18:24:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 396.9143 (396.4551)
[INFO] - 02-27 18:24:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:24:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.8953)
[INFO] - 02-27 18:24:24 - [main.backward:225]: Epoch 36/500 - Iteration 75/95 - Time 0.360 batch, 0.053 data, 0.321 forward
[INFO] - 02-27 18:24:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:24:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0084)
[INFO] - 02-27 18:24:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5876 (0.5911)
[INFO] - 02-27 18:24:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5534 (-287.5530)
[INFO] - 02-27 18:24:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.8989 (33.9917)
[INFO] - 02-27 18:24:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 395.1524 (396.5888)
[INFO] - 02-27 18:24:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:24:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9045)
[INFO] - 02-27 18:24:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:24:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:24:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:24:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:24:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:24:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:24:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:24:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.891
[INFO] - 02-27 18:24:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.892
[INFO] - 02-27 18:24:33 - [main.summary_metrics:168]: Epoch 36/500 - Test Results:
{'auc': 0.8159314286989305,
 'f1': 0.3637478956228956,
 'loss': 0.5367508598438278,
 'ndcg': 0.6706481614513287,
 'precision': 0.484375,
 'recall': 0.2918242296918767}
[INFO] - 02-27 18:24:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[36] Complete. Time taken: 00:00:36.645
[INFO] - 02-27 18:24:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:24:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:24:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:24:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:24:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:24:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2199, 2192, 1]
[INFO] - 02-27 18:24:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:24:44 - [main.backward:225]: Epoch 37/500 - Iteration 30/95 - Time 0.361 batch, 0.076 data, 0.326 forward
[INFO] - 02-27 18:24:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0083)
[INFO] - 02-27 18:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5929 (0.5913)
[INFO] - 02-27 18:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5519 (-287.5532)
[INFO] - 02-27 18:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0802 (34.0374)
[INFO] - 02-27 18:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 395.9240 (396.4426)
[INFO] - 02-27 18:24:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:24:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9025)
[INFO] - 02-27 18:25:01 - [main.backward:225]: Epoch 37/500 - Iteration 80/95 - Time 0.345 batch, 0.051 data, 0.310 forward
[INFO] - 02-27 18:25:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:25:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0081 (0.0083)
[INFO] - 02-27 18:25:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5907)
[INFO] - 02-27 18:25:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5526 (-287.5542)
[INFO] - 02-27 18:25:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9329 (33.8866)
[INFO] - 02-27 18:25:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 394.9948 (396.0127)
[INFO] - 02-27 18:25:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:25:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.8992)
[INFO] - 02-27 18:25:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:25:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:25:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:25:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:25:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:25:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:25:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:25:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.870
[INFO] - 02-27 18:25:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.870
[INFO] - 02-27 18:25:09 - [main.summary_metrics:168]: Epoch 37/500 - Test Results:
{'auc': 0.8299740292563104,
 'f1': 0.3941593013468013,
 'loss': 0.532511088225325,
 'ndcg': 0.6762427206012662,
 'precision': 0.5249999999999999,
 'recall': 0.3160845588235294}
[INFO] - 02-27 18:25:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[37] Complete. Time taken: 00:00:35.418
[INFO] - 02-27 18:25:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:25:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:25:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:25:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:25:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:25:09 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3085, 2195, 2211, 1]
[INFO] - 02-27 18:25:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:25:22 - [main.backward:225]: Epoch 38/500 - Iteration 35/95 - Time 0.370 batch, 0.062 data, 0.334 forward
[INFO] - 02-27 18:25:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0083)
[INFO] - 02-27 18:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5913 (0.5898)
[INFO] - 02-27 18:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5518 (-287.5529)
[INFO] - 02-27 18:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0473 (33.9093)
[INFO] - 02-27 18:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 396.4085 (396.1250)
[INFO] - 02-27 18:25:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9008)
[INFO] - 02-27 18:25:39 - [main.backward:225]: Epoch 38/500 - Iteration 85/95 - Time 0.349 batch, 0.045 data, 0.314 forward
[INFO] - 02-27 18:25:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0084 (0.0082)
[INFO] - 02-27 18:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5941 (0.5920)
[INFO] - 02-27 18:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5551 (-287.5534)
[INFO] - 02-27 18:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9158 (33.9049)
[INFO] - 02-27 18:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 394.0261 (395.6890)
[INFO] - 02-27 18:25:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9017)
[INFO] - 02-27 18:25:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:25:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:25:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:25:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:25:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:25:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:25:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:25:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.784
[INFO] - 02-27 18:25:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.784
[INFO] - 02-27 18:25:45 - [main.summary_metrics:168]: Epoch 38/500 - Test Results:
{'auc': 0.8275176736748622,
 'f1': 0.3730881734006734,
 'loss': 0.5202389455740708,
 'ndcg': 0.6718865339296368,
 'precision': 0.49687499999999996,
 'recall': 0.2992734593837535}
[INFO] - 02-27 18:25:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[38] Complete. Time taken: 00:00:35.902
[INFO] - 02-27 18:25:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:25:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:25:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:25:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:25:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:25:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3064, 2185, 2219, 1]
[INFO] - 02-27 18:25:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:25:59 - [main.backward:225]: Epoch 39/500 - Iteration 40/95 - Time 0.362 batch, 0.061 data, 0.322 forward
[INFO] - 02-27 18:25:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:25:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0100 (0.0081)
[INFO] - 02-27 18:25:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5843 (0.5914)
[INFO] - 02-27 18:25:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5571 (-287.5549)
[INFO] - 02-27 18:25:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 34.0639 (34.0307)
[INFO] - 02-27 18:25:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 394.9173 (394.7828)
[INFO] - 02-27 18:25:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:25:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9083)
[INFO] - 02-27 18:26:16 - [main.backward:225]: Epoch 39/500 - Iteration 90/95 - Time 0.346 batch, 0.048 data, 0.308 forward
[INFO] - 02-27 18:26:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:26:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0066 (0.0077)
[INFO] - 02-27 18:26:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5876 (0.5905)
[INFO] - 02-27 18:26:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5522 (-287.5548)
[INFO] - 02-27 18:26:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.8488 (33.9108)
[INFO] - 02-27 18:26:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 394.6447 (395.6978)
[INFO] - 02-27 18:26:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:26:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9119)
[INFO] - 02-27 18:26:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:26:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:26:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:26:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:26:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:26:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:26:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:26:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.793
[INFO] - 02-27 18:26:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.794
[INFO] - 02-27 18:26:20 - [main.summary_metrics:168]: Epoch 39/500 - Test Results:
{'auc': 0.8242410312164081,
 'f1': 0.3468329124579125,
 'loss': 0.531713432301274,
 'ndcg': 0.6547630847069181,
 'precision': 0.4625,
 'recall': 0.2779455532212885}
[INFO] - 02-27 18:26:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[39] Complete. Time taken: 00:00:35.733
[INFO] - 02-27 18:26:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:26:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:26:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:26:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:26:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:26:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3024, 2183, 2214, 1]
[INFO] - 02-27 18:26:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:26:36 - [main.backward:225]: Epoch 40/500 - Iteration 45/95 - Time 0.351 batch, 0.051 data, 0.319 forward
[INFO] - 02-27 18:26:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:26:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0082 (0.0081)
[INFO] - 02-27 18:26:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5882 (0.5915)
[INFO] - 02-27 18:26:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5552 (-287.5532)
[INFO] - 02-27 18:26:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.6484 (33.9534)
[INFO] - 02-27 18:26:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 393.9692 (395.0871)
[INFO] - 02-27 18:26:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:26:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9017)
[INFO] - 02-27 18:26:53 - [main.backward:225]: Epoch 40/500 - Iteration 0/95 - Time 0.341 batch, 0.044 data, 0.306 forward
[INFO] - 02-27 18:26:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0057 (0.0085)
[INFO] - 02-27 18:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5904)
[INFO] - 02-27 18:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5542 (-287.5541)
[INFO] - 02-27 18:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9090 (33.9105)
[INFO] - 02-27 18:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 396.1492 (395.2465)
[INFO] - 02-27 18:26:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.8952)
[INFO] - 02-27 18:26:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:26:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:26:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:26:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:26:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:26:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:26:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:26:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.795
[INFO] - 02-27 18:26:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.796
[INFO] - 02-27 18:26:56 - [main.summary_metrics:168]: Epoch 40/500 - Test Results:
{'auc': 0.8352988718158831,
 'f1': 0.3978398569023569,
 'loss': 0.5174699023646032,
 'ndcg': 0.6921489164160769,
 'precision': 0.53125,
 'recall': 0.31848301820728286}
[INFO] - 02-27 18:26:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[40] Complete. Time taken: 00:00:35.260
[INFO] - 02-27 18:26:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:26:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:26:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:26:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:26:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:26:56 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3077, 2206, 2195, 1]
[INFO] - 02-27 18:26:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:27:13 - [main.backward:225]: Epoch 41/500 - Iteration 50/95 - Time 0.347 batch, 0.055 data, 0.310 forward
[INFO] - 02-27 18:27:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0075 (0.0079)
[INFO] - 02-27 18:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5772 (0.5891)
[INFO] - 02-27 18:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5511 (-287.5518)
[INFO] - 02-27 18:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7156 (33.8130)
[INFO] - 02-27 18:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 392.9480 (395.5290)
[INFO] - 02-27 18:27:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9044)
[INFO] - 02-27 18:27:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:27:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:27:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:27:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:27:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:27:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:27:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:27:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.858
[INFO] - 02-27 18:27:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.859
[INFO] - 02-27 18:27:31 - [main.summary_metrics:168]: Epoch 41/500 - Test Results:
{'auc': 0.8255328380126561,
 'f1': 0.3943960437710438,
 'loss': 0.5157978245261299,
 'ndcg': 0.6635707997425323,
 'precision': 0.525,
 'recall': 0.3164565826330532}
[INFO] - 02-27 18:27:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[41] Complete. Time taken: 00:00:35.286
[INFO] - 02-27 18:27:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:27:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:27:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:27:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:27:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:27:31 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2220, 2232, 1]
[INFO] - 02-27 18:27:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:27:34 - [main.backward:225]: Epoch 42/500 - Iteration 5/95 - Time 0.511 batch, 0.207 data, 0.474 forward
[INFO] - 02-27 18:27:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:27:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0082)
[INFO] - 02-27 18:27:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5890)
[INFO] - 02-27 18:27:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5528 (-287.5516)
[INFO] - 02-27 18:27:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7033 (33.7000)
[INFO] - 02-27 18:27:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 393.4961 (394.0780)
[INFO] - 02-27 18:27:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:27:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9023)
[INFO] - 02-27 18:27:51 - [main.backward:225]: Epoch 42/500 - Iteration 55/95 - Time 0.353 batch, 0.051 data, 0.317 forward
[INFO] - 02-27 18:27:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:27:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0079)
[INFO] - 02-27 18:27:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5895)
[INFO] - 02-27 18:27:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5522 (-287.5535)
[INFO] - 02-27 18:27:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9313 (33.7887)
[INFO] - 02-27 18:27:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 392.3489 (394.5847)
[INFO] - 02-27 18:27:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:27:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9069)
[INFO] - 02-27 18:28:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:28:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:28:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:28:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:28:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:28:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:28:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:28:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.874
[INFO] - 02-27 18:28:07 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.875
[INFO] - 02-27 18:28:07 - [main.summary_metrics:168]: Epoch 42/500 - Test Results:
{'auc': 0.8250427422194369,
 'f1': 0.38037352693602694,
 'loss': 0.5142904812770055,
 'ndcg': 0.6680601265553319,
 'precision': 0.50625,
 'recall': 0.3053089985994398}
[INFO] - 02-27 18:28:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[42] Complete. Time taken: 00:00:35.852
[INFO] - 02-27 18:28:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:28:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:28:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:28:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:28:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:28:07 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3052, 2206, 2211, 1]
[INFO] - 02-27 18:28:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:28:11 - [main.backward:225]: Epoch 43/500 - Iteration 10/95 - Time 0.429 batch, 0.126 data, 0.389 forward
[INFO] - 02-27 18:28:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:28:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0064 (0.0075)
[INFO] - 02-27 18:28:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5915 (0.5911)
[INFO] - 02-27 18:28:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5511 (-287.5519)
[INFO] - 02-27 18:28:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.6559 (33.7393)
[INFO] - 02-27 18:28:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 395.1865 (393.6694)
[INFO] - 02-27 18:28:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:28:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9089)
[INFO] - 02-27 18:28:28 - [main.backward:225]: Epoch 43/500 - Iteration 60/95 - Time 0.346 batch, 0.049 data, 0.311 forward
[INFO] - 02-27 18:28:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0083 (0.0078)
[INFO] - 02-27 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5926 (0.5910)
[INFO] - 02-27 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5506)
[INFO] - 02-27 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.6945 (33.7559)
[INFO] - 02-27 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 392.9782 (394.2948)
[INFO] - 02-27 18:28:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:28:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9061)
[INFO] - 02-27 18:28:39 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:28:39 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:28:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:28:39 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:28:39 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:28:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:28:39 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:28:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.769
[INFO] - 02-27 18:28:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.770
[INFO] - 02-27 18:28:42 - [main.summary_metrics:168]: Epoch 43/500 - Test Results:
{'auc': 0.8333096400937827,
 'f1': 0.3908954124579125,
 'loss': 0.5173307949226339,
 'ndcg': 0.6670437176020756,
 'precision': 0.5218750000000001,
 'recall': 0.31296831232492994}
[INFO] - 02-27 18:28:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[43] Complete. Time taken: 00:00:34.959
[INFO] - 02-27 18:28:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:28:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:28:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:28:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:28:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:28:42 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3087, 2193, 2186, 1]
[INFO] - 02-27 18:28:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:28:48 - [main.backward:225]: Epoch 44/500 - Iteration 15/95 - Time 0.391 batch, 0.091 data, 0.356 forward
[INFO] - 02-27 18:28:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:28:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0076)
[INFO] - 02-27 18:28:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5904)
[INFO] - 02-27 18:28:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5498)
[INFO] - 02-27 18:28:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7606 (33.7768)
[INFO] - 02-27 18:28:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 395.5599 (393.3094)
[INFO] - 02-27 18:28:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:28:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9105)
[INFO] - 02-27 18:29:06 - [main.backward:225]: Epoch 44/500 - Iteration 65/95 - Time 0.369 batch, 0.050 data, 0.332 forward
[INFO] - 02-27 18:29:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:29:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0106 (0.0079)
[INFO] - 02-27 18:29:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5884 (0.5907)
[INFO] - 02-27 18:29:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5522 (-287.5497)
[INFO] - 02-27 18:29:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.6951 (33.7002)
[INFO] - 02-27 18:29:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 391.7609 (392.2936)
[INFO] - 02-27 18:29:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:29:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.9017)
[INFO] - 02-27 18:29:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:29:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:29:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:29:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:29:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:29:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:29:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:29:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.320
[INFO] - 02-27 18:29:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.320
[INFO] - 02-27 18:29:20 - [main.summary_metrics:168]: Epoch 44/500 - Test Results:
{'auc': 0.8364849531724454,
 'f1': 0.3713247053872054,
 'loss': 0.4988340009544943,
 'ndcg': 0.6795338168424707,
 'precision': 0.496875,
 'recall': 0.29673056722689073}
[INFO] - 02-27 18:29:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[44] Complete. Time taken: 00:00:38.260
[INFO] - 02-27 18:29:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:29:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:29:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:29:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:29:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:29:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3065, 2187, 2195, 1]
[INFO] - 02-27 18:29:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:29:28 - [main.backward:225]: Epoch 45/500 - Iteration 20/95 - Time 0.406 batch, 0.094 data, 0.363 forward
[INFO] - 02-27 18:29:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:29:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0073 (0.0073)
[INFO] - 02-27 18:29:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5969 (0.5916)
[INFO] - 02-27 18:29:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5525 (-287.5535)
[INFO] - 02-27 18:29:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.4552 (33.4582)
[INFO] - 02-27 18:29:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 393.7309 (392.3873)
[INFO] - 02-27 18:29:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:29:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9105)
[INFO] - 02-27 18:29:46 - [main.backward:225]: Epoch 45/500 - Iteration 70/95 - Time 0.365 batch, 0.052 data, 0.328 forward
[INFO] - 02-27 18:29:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:29:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0074)
[INFO] - 02-27 18:29:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5927 (0.5905)
[INFO] - 02-27 18:29:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5522 (-287.5532)
[INFO] - 02-27 18:29:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.9694 (33.7402)
[INFO] - 02-27 18:29:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 392.5956 (392.4481)
[INFO] - 02-27 18:29:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:29:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9114)
[INFO] - 02-27 18:29:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:29:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:29:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:29:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:29:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:29:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:29:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:29:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.156
[INFO] - 02-27 18:29:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.156
[INFO] - 02-27 18:29:58 - [main.summary_metrics:168]: Epoch 45/500 - Test Results:
{'auc': 0.840925251166643,
 'f1': 0.4165435606060606,
 'loss': 0.5060455346571529,
 'ndcg': 0.6943194437648347,
 'precision': 0.5562499999999999,
 'recall': 0.3334339985994398}
[INFO] - 02-27 18:29:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[45] Complete. Time taken: 00:00:38.369
[INFO] - 02-27 18:29:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:29:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:29:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:29:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:29:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:29:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3074, 2195, 2217, 1]
[INFO] - 02-27 18:30:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:30:08 - [main.backward:225]: Epoch 46/500 - Iteration 25/95 - Time 0.394 batch, 0.084 data, 0.352 forward
[INFO] - 02-27 18:30:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0071)
[INFO] - 02-27 18:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5907 (0.5905)
[INFO] - 02-27 18:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5551 (-287.5530)
[INFO] - 02-27 18:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.7137 (33.6391)
[INFO] - 02-27 18:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 392.7228 (392.6334)
[INFO] - 02-27 18:30:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:30:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9206)
[INFO] - 02-27 18:30:26 - [main.backward:225]: Epoch 46/500 - Iteration 75/95 - Time 0.366 batch, 0.052 data, 0.328 forward
[INFO] - 02-27 18:30:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:30:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0073 (0.0076)
[INFO] - 02-27 18:30:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5947 (0.5905)
[INFO] - 02-27 18:30:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5536 (-287.5544)
[INFO] - 02-27 18:30:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.6522 (33.6848)
[INFO] - 02-27 18:30:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 390.3450 (389.9623)
[INFO] - 02-27 18:30:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:30:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9103)
[INFO] - 02-27 18:30:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:30:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:30:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:30:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:30:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:30:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:30:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:30:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.920
[INFO] - 02-27 18:30:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.921
[INFO] - 02-27 18:30:36 - [main.summary_metrics:168]: Epoch 46/500 - Test Results:
{'auc': 0.8373543583487317,
 'f1': 0.3755071548821549,
 'loss': 0.5101856497013981,
 'ndcg': 0.6771365773499476,
 'precision': 0.5,
 'recall': 0.3012605042016807}
[INFO] - 02-27 18:30:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[46] Complete. Time taken: 00:00:37.399
[INFO] - 02-27 18:30:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:30:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:30:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:30:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:30:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:30:36 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3056, 2191, 2210, 1]
[INFO] - 02-27 18:30:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:30:47 - [main.backward:225]: Epoch 47/500 - Iteration 30/95 - Time 0.359 batch, 0.069 data, 0.323 forward
[INFO] - 02-27 18:30:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:30:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0076)
[INFO] - 02-27 18:30:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5901 (0.5905)
[INFO] - 02-27 18:30:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5530 (-287.5527)
[INFO] - 02-27 18:30:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.3567 (33.4649)
[INFO] - 02-27 18:30:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 389.0185 (390.1308)
[INFO] - 02-27 18:30:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:30:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9083)
[INFO] - 02-27 18:31:04 - [main.backward:225]: Epoch 47/500 - Iteration 80/95 - Time 0.348 batch, 0.047 data, 0.314 forward
[INFO] - 02-27 18:31:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0078)
[INFO] - 02-27 18:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5906)
[INFO] - 02-27 18:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5519 (-287.5526)
[INFO] - 02-27 18:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.5403 (33.5175)
[INFO] - 02-27 18:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 389.4014 (390.0699)
[INFO] - 02-27 18:31:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9069)
[INFO] - 02-27 18:31:09 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:31:09 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:31:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:31:09 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:31:09 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:31:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:31:09 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:31:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.075
[INFO] - 02-27 18:31:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.075
[INFO] - 02-27 18:31:12 - [main.summary_metrics:168]: Epoch 47/500 - Test Results:
{'auc': 0.815692522045583,
 'f1': 0.36017255892255895,
 'loss': 0.5149356867589848,
 'ndcg': 0.6536453483069139,
 'precision': 0.48125,
 'recall': 0.28815651260504205}
[INFO] - 02-27 18:31:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[47] Complete. Time taken: 00:00:36.139
[INFO] - 02-27 18:31:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:31:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:31:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:31:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:31:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:31:12 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2199, 2195, 1]
[INFO] - 02-27 18:31:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:31:25 - [main.backward:225]: Epoch 48/500 - Iteration 35/95 - Time 0.374 batch, 0.061 data, 0.341 forward
[INFO] - 02-27 18:31:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:31:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0077)
[INFO] - 02-27 18:31:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5890)
[INFO] - 02-27 18:31:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5550 (-287.5533)
[INFO] - 02-27 18:31:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.4864 (33.5974)
[INFO] - 02-27 18:31:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 387.6760 (389.1930)
[INFO] - 02-27 18:31:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:31:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9097)
[INFO] - 02-27 18:31:42 - [main.backward:225]: Epoch 48/500 - Iteration 85/95 - Time 0.358 batch, 0.047 data, 0.322 forward
[INFO] - 02-27 18:31:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0068 (0.0073)
[INFO] - 02-27 18:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5915 (0.5892)
[INFO] - 02-27 18:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5514)
[INFO] - 02-27 18:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.5478 (33.5622)
[INFO] - 02-27 18:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 388.9492 (389.9652)
[INFO] - 02-27 18:31:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:31:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9106)
[INFO] - 02-27 18:31:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:31:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:31:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:31:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:31:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:31:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:31:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:31:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.894
[INFO] - 02-27 18:31:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.895
[INFO] - 02-27 18:31:49 - [main.summary_metrics:168]: Epoch 48/500 - Test Results:
{'auc': 0.8350594317383815,
 'f1': 0.38352904040404046,
 'loss': 0.502868191625625,
 'ndcg': 0.6769068573300541,
 'precision': 0.5125,
 'recall': 0.3068364845938375}
[INFO] - 02-27 18:31:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[48] Complete. Time taken: 00:00:36.833
[INFO] - 02-27 18:31:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:31:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:31:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:31:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:31:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:31:49 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2193, 2227, 1]
[INFO] - 02-27 18:31:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:32:04 - [main.backward:225]: Epoch 49/500 - Iteration 40/95 - Time 0.367 batch, 0.056 data, 0.332 forward
[INFO] - 02-27 18:32:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0080 (0.0075)
[INFO] - 02-27 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5896 (0.5893)
[INFO] - 02-27 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5499)
[INFO] - 02-27 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.4808 (33.5384)
[INFO] - 02-27 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 388.2557 (389.2283)
[INFO] - 02-27 18:32:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:32:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8828 (0.9073)
[INFO] - 02-27 18:32:21 - [main.backward:225]: Epoch 49/500 - Iteration 90/95 - Time 0.359 batch, 0.044 data, 0.325 forward
[INFO] - 02-27 18:32:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0073)
[INFO] - 02-27 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5881 (0.5898)
[INFO] - 02-27 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5487 (-287.5487)
[INFO] - 02-27 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.4030 (33.4452)
[INFO] - 02-27 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 389.3663 (389.1280)
[INFO] - 02-27 18:32:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:32:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9106)
[INFO] - 02-27 18:32:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:32:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:32:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:32:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:32:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:32:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:32:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:32:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.969
[INFO] - 02-27 18:32:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.970
[INFO] - 02-27 18:32:26 - [main.summary_metrics:168]: Epoch 49/500 - Test Results:
{'auc': 0.8317291796007619,
 'f1': 0.40033985690235696,
 'loss': 0.5018293443121525,
 'ndcg': 0.6796344726183454,
 'precision': 0.534375,
 'recall': 0.32056635154061625}
[INFO] - 02-27 18:32:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[49] Complete. Time taken: 00:00:37.000
[INFO] - 02-27 18:32:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:32:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:32:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:32:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:32:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:32:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2178, 2221, 1]
[INFO] - 02-27 18:32:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:32:42 - [main.backward:225]: Epoch 50/500 - Iteration 45/95 - Time 0.363 batch, 0.058 data, 0.325 forward
[INFO] - 02-27 18:32:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0096 (0.0071)
[INFO] - 02-27 18:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5909)
[INFO] - 02-27 18:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5483 (-287.5479)
[INFO] - 02-27 18:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.3957 (33.3733)
[INFO] - 02-27 18:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 388.4117 (389.3490)
[INFO] - 02-27 18:32:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:32:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8281 (0.9108)
[INFO] - 02-27 18:32:59 - [main.backward:225]: Epoch 50/500 - Iteration 0/95 - Time 0.348 batch, 0.047 data, 0.311 forward
[INFO] - 02-27 18:32:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:32:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0067 (0.0077)
[INFO] - 02-27 18:32:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5839 (0.5904)
[INFO] - 02-27 18:32:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5520 (-287.5492)
[INFO] - 02-27 18:32:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.3374 (33.3956)
[INFO] - 02-27 18:32:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 388.6162 (389.2257)
[INFO] - 02-27 18:32:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:32:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9033)
[INFO] - 02-27 18:32:59 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:32:59 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:32:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:32:59 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:32:59 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:32:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:32:59 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:33:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.064
[INFO] - 02-27 18:33:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.065
[INFO] - 02-27 18:33:02 - [main.summary_metrics:168]: Epoch 50/500 - Test Results:
{'auc': 0.8426380480501023,
 'f1': 0.40781039562289567,
 'loss': 0.49327870135813934,
 'ndcg': 0.7102199296958858,
 'precision': 0.54375,
 'recall': 0.3268469887955182}
[INFO] - 02-27 18:33:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[50] Complete. Time taken: 00:00:36.203
[INFO] - 02-27 18:33:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:33:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:33:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:33:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:33:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:33:02 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3061, 2211, 2196, 1]
[INFO] - 02-27 18:33:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:33:21 - [main.backward:225]: Epoch 51/500 - Iteration 50/95 - Time 0.369 batch, 0.052 data, 0.335 forward
[INFO] - 02-27 18:33:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0068)
[INFO] - 02-27 18:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5835 (0.5893)
[INFO] - 02-27 18:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5501 (-287.5505)
[INFO] - 02-27 18:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.4042 (33.3264)
[INFO] - 02-27 18:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 386.4767 (388.5033)
[INFO] - 02-27 18:33:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9175)
[INFO] - 02-27 18:33:36 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:33:36 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:33:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:33:36 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:33:36 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:33:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:33:36 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:33:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.800
[INFO] - 02-27 18:33:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.801
[INFO] - 02-27 18:33:39 - [main.summary_metrics:168]: Epoch 51/500 - Test Results:
{'auc': 0.8512961984426124,
 'f1': 0.4182807239057239,
 'loss': 0.49588614624049016,
 'ndcg': 0.7102613043818963,
 'precision': 0.559375,
 'recall': 0.3343793767507003}
[INFO] - 02-27 18:33:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[51] Complete. Time taken: 00:00:36.790
[INFO] - 02-27 18:33:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:33:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:33:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:33:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:33:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:33:39 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3069, 2196, 2205, 1]
[INFO] - 02-27 18:33:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:33:42 - [main.backward:225]: Epoch 52/500 - Iteration 5/95 - Time 0.528 batch, 0.214 data, 0.489 forward
[INFO] - 02-27 18:33:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:33:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0063 (0.0071)
[INFO] - 02-27 18:33:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5891 (0.5886)
[INFO] - 02-27 18:33:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5518 (-287.5497)
[INFO] - 02-27 18:33:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.3476 (33.4721)
[INFO] - 02-27 18:33:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 388.1837 (388.1825)
[INFO] - 02-27 18:33:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:33:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9134)
[INFO] - 02-27 18:33:59 - [main.backward:225]: Epoch 52/500 - Iteration 55/95 - Time 0.364 batch, 0.056 data, 0.324 forward
[INFO] - 02-27 18:33:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0069)
[INFO] - 02-27 18:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5888 (0.5889)
[INFO] - 02-27 18:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5527 (-287.5499)
[INFO] - 02-27 18:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.2152 (33.3706)
[INFO] - 02-27 18:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 387.1082 (388.6761)
[INFO] - 02-27 18:33:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:33:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9144)
[INFO] - 02-27 18:34:13 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:34:13 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:34:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:34:13 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:34:13 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:34:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:34:13 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:34:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.799
[INFO] - 02-27 18:34:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.799
[INFO] - 02-27 18:34:16 - [main.summary_metrics:168]: Epoch 52/500 - Test Results:
{'auc': 0.849746136444774,
 'f1': 0.40907302188552197,
 'loss': 0.48865907738858627,
 'ndcg': 0.7048113654860266,
 'precision': 0.546875,
 'recall': 0.3271533613445378}
[INFO] - 02-27 18:34:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[52] Complete. Time taken: 00:00:36.918
[INFO] - 02-27 18:34:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:34:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:34:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:34:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:34:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:34:16 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3073, 2199, 2211, 1]
[INFO] - 02-27 18:34:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:34:20 - [main.backward:225]: Epoch 53/500 - Iteration 10/95 - Time 0.426 batch, 0.122 data, 0.391 forward
[INFO] - 02-27 18:34:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:34:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0062)
[INFO] - 02-27 18:34:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5892)
[INFO] - 02-27 18:34:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5515 (-287.5515)
[INFO] - 02-27 18:34:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.4063 (33.2507)
[INFO] - 02-27 18:34:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 388.2311 (387.8810)
[INFO] - 02-27 18:34:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:34:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9273)
[INFO] - 02-27 18:34:37 - [main.backward:225]: Epoch 53/500 - Iteration 60/95 - Time 0.352 batch, 0.050 data, 0.316 forward
[INFO] - 02-27 18:34:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:34:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0071)
[INFO] - 02-27 18:34:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5936 (0.5893)
[INFO] - 02-27 18:34:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5469 (-287.5491)
[INFO] - 02-27 18:34:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.1054 (33.3602)
[INFO] - 02-27 18:34:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 385.7911 (387.6082)
[INFO] - 02-27 18:34:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:34:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9100)
[INFO] - 02-27 18:34:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:34:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:34:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:34:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:34:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:34:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:34:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:34:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.892
[INFO] - 02-27 18:34:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.893
[INFO] - 02-27 18:34:51 - [main.summary_metrics:168]: Epoch 53/500 - Test Results:
{'auc': 0.8357610731179727,
 'f1': 0.40010311447811453,
 'loss': 0.496211707020213,
 'ndcg': 0.6929025368992955,
 'precision': 0.5343749999999999,
 'recall': 0.32019432773109247}
[INFO] - 02-27 18:34:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[53] Complete. Time taken: 00:00:35.315
[INFO] - 02-27 18:34:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:34:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:34:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:34:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:34:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:34:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3065, 2216, 2229, 1]
[INFO] - 02-27 18:34:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:34:57 - [main.backward:225]: Epoch 54/500 - Iteration 15/95 - Time 0.400 batch, 0.102 data, 0.360 forward
[INFO] - 02-27 18:34:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:34:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0064)
[INFO] - 02-27 18:34:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5907)
[INFO] - 02-27 18:34:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5470 (-287.5462)
[INFO] - 02-27 18:34:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.1885 (33.2034)
[INFO] - 02-27 18:34:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 388.1016 (387.0464)
[INFO] - 02-27 18:34:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:34:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9225)
[INFO] - 02-27 18:35:14 - [main.backward:225]: Epoch 54/500 - Iteration 65/95 - Time 0.347 batch, 0.052 data, 0.310 forward
[INFO] - 02-27 18:35:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0069)
[INFO] - 02-27 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5881)
[INFO] - 02-27 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5496 (-287.5491)
[INFO] - 02-27 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.0311 (33.1671)
[INFO] - 02-27 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 386.2543 (386.5233)
[INFO] - 02-27 18:35:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:35:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9178)
[INFO] - 02-27 18:35:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:35:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:35:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:35:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:35:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:35:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:35:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:35:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.871
[INFO] - 02-27 18:35:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.871
[INFO] - 02-27 18:35:26 - [main.summary_metrics:168]: Epoch 54/500 - Test Results:
{'auc': 0.8433813283891988,
 'f1': 0.4033659511784512,
 'loss': 0.499359933881614,
 'ndcg': 0.6933290303541135,
 'precision': 0.5375,
 'recall': 0.3234156162464986}
[INFO] - 02-27 18:35:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[54] Complete. Time taken: 00:00:35.324
[INFO] - 02-27 18:35:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:35:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:35:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:35:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:35:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:35:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3039, 2195, 2217, 1]
[INFO] - 02-27 18:35:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:35:34 - [main.backward:225]: Epoch 55/500 - Iteration 20/95 - Time 0.374 batch, 0.075 data, 0.340 forward
[INFO] - 02-27 18:35:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0074 (0.0069)
[INFO] - 02-27 18:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5904 (0.5883)
[INFO] - 02-27 18:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5510 (-287.5506)
[INFO] - 02-27 18:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.3705 (33.2072)
[INFO] - 02-27 18:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 387.0435 (386.3662)
[INFO] - 02-27 18:35:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9184)
[INFO] - 02-27 18:35:51 - [main.backward:225]: Epoch 55/500 - Iteration 70/95 - Time 0.344 batch, 0.045 data, 0.312 forward
[INFO] - 02-27 18:35:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:35:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0071 (0.0067)
[INFO] - 02-27 18:35:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5889)
[INFO] - 02-27 18:35:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5494 (-287.5516)
[INFO] - 02-27 18:35:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.0212 (33.2620)
[INFO] - 02-27 18:35:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 387.6410 (387.3463)
[INFO] - 02-27 18:35:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:35:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9183)
[INFO] - 02-27 18:35:59 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:35:59 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:35:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:35:59 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:35:59 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:35:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:35:59 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:36:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.728
[INFO] - 02-27 18:36:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.730
[INFO] - 02-27 18:36:02 - [main.summary_metrics:168]: Epoch 55/500 - Test Results:
{'auc': 0.8411161149508823,
 'f1': 0.4137026515151515,
 'loss': 0.49058040522644214,
 'ndcg': 0.6994770726530259,
 'precision': 0.553125,
 'recall': 0.3308298319327731}
[INFO] - 02-27 18:36:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[55] Complete. Time taken: 00:00:35.333
[INFO] - 02-27 18:36:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:36:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:36:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:36:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:36:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:36:02 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3094, 2198, 2214, 1]
[INFO] - 02-27 18:36:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:36:11 - [main.backward:225]: Epoch 56/500 - Iteration 25/95 - Time 0.361 batch, 0.070 data, 0.332 forward
[INFO] - 02-27 18:36:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:36:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0087 (0.0064)
[INFO] - 02-27 18:36:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5870 (0.5898)
[INFO] - 02-27 18:36:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5521 (-287.5512)
[INFO] - 02-27 18:36:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.3499 (33.2856)
[INFO] - 02-27 18:36:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 386.3263 (387.0913)
[INFO] - 02-27 18:36:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:36:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8750 (0.9208)
[INFO] - 02-27 18:36:28 - [main.backward:225]: Epoch 56/500 - Iteration 75/95 - Time 0.345 batch, 0.047 data, 0.311 forward
[INFO] - 02-27 18:36:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:36:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0063)
[INFO] - 02-27 18:36:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5882 (0.5887)
[INFO] - 02-27 18:36:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5462 (-287.5497)
[INFO] - 02-27 18:36:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.0864 (33.2671)
[INFO] - 02-27 18:36:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 385.5965 (385.9677)
[INFO] - 02-27 18:36:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:36:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9269)
[INFO] - 02-27 18:36:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:36:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:36:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:36:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:36:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:36:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:36:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:36:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.938
[INFO] - 02-27 18:36:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.939
[INFO] - 02-27 18:36:37 - [main.summary_metrics:168]: Epoch 56/500 - Test Results:
{'auc': 0.8469369587295702,
 'f1': 0.4093623737373738,
 'loss': 0.48708088005115213,
 'ndcg': 0.7078753074881181,
 'precision': 0.546875,
 'recall': 0.327547268907563}
[INFO] - 02-27 18:36:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[56] Complete. Time taken: 00:00:35.539
[INFO] - 02-27 18:36:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:36:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:36:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:36:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:36:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:36:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3075, 2208, 2210, 1]
[INFO] - 02-27 18:36:38 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:36:48 - [main.backward:225]: Epoch 57/500 - Iteration 30/95 - Time 0.360 batch, 0.068 data, 0.325 forward
[INFO] - 02-27 18:36:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0088 (0.0062)
[INFO] - 02-27 18:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5829 (0.5875)
[INFO] - 02-27 18:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5473)
[INFO] - 02-27 18:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.2047 (33.0741)
[INFO] - 02-27 18:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 385.0450 (385.0801)
[INFO] - 02-27 18:36:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:36:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9236)
[INFO] - 02-27 18:37:05 - [main.backward:225]: Epoch 57/500 - Iteration 80/95 - Time 0.343 batch, 0.049 data, 0.306 forward
[INFO] - 02-27 18:37:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0079 (0.0067)
[INFO] - 02-27 18:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5785 (0.5901)
[INFO] - 02-27 18:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5499 (-287.5481)
[INFO] - 02-27 18:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.0395 (33.1483)
[INFO] - 02-27 18:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 384.8314 (385.1288)
[INFO] - 02-27 18:37:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9203)
[INFO] - 02-27 18:37:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:37:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:37:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:37:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:37:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:37:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:37:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:37:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.840
[INFO] - 02-27 18:37:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.840
[INFO] - 02-27 18:37:13 - [main.summary_metrics:168]: Epoch 57/500 - Test Results:
{'auc': 0.8455222547965265,
 'f1': 0.37416561447811447,
 'loss': 0.4882685110506687,
 'ndcg': 0.694150037007721,
 'precision': 0.5,
 'recall': 0.2993347338935574}
[INFO] - 02-27 18:37:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[57] Complete. Time taken: 00:00:35.387
[INFO] - 02-27 18:37:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:37:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:37:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:37:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:37:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:37:13 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2194, 2221, 1]
[INFO] - 02-27 18:37:14 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:37:25 - [main.backward:225]: Epoch 58/500 - Iteration 35/95 - Time 0.360 batch, 0.058 data, 0.324 forward
[INFO] - 02-27 18:37:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0075 (0.0070)
[INFO] - 02-27 18:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5891)
[INFO] - 02-27 18:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5521 (-287.5498)
[INFO] - 02-27 18:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.1472 (33.1883)
[INFO] - 02-27 18:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 387.5610 (385.8476)
[INFO] - 02-27 18:37:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9153)
[INFO] - 02-27 18:37:42 - [main.backward:225]: Epoch 58/500 - Iteration 85/95 - Time 0.343 batch, 0.044 data, 0.309 forward
[INFO] - 02-27 18:37:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:37:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0062)
[INFO] - 02-27 18:37:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5893 (0.5891)
[INFO] - 02-27 18:37:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5505)
[INFO] - 02-27 18:37:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.1908 (33.1341)
[INFO] - 02-27 18:37:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 384.8495 (385.8880)
[INFO] - 02-27 18:37:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:37:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9237)
[INFO] - 02-27 18:37:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:37:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:37:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:37:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:37:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:37:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:37:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:37:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.775
[INFO] - 02-27 18:37:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.776
[INFO] - 02-27 18:37:48 - [main.summary_metrics:168]: Epoch 58/500 - Test Results:
{'auc': 0.8380689735453004,
 'f1': 0.3770065235690236,
 'loss': 0.48395773663052877,
 'ndcg': 0.6784050786192125,
 'precision': 0.503125,
 'recall': 0.3019389005602241}
[INFO] - 02-27 18:37:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[58] Complete. Time taken: 00:00:35.133
[INFO] - 02-27 18:37:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:37:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:37:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:37:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:37:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:37:48 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3068, 2213, 2223, 1]
[INFO] - 02-27 18:37:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:38:02 - [main.backward:225]: Epoch 59/500 - Iteration 40/95 - Time 0.364 batch, 0.060 data, 0.326 forward
[INFO] - 02-27 18:38:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0062 (0.0063)
[INFO] - 02-27 18:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5912 (0.5888)
[INFO] - 02-27 18:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5495 (-287.5495)
[INFO] - 02-27 18:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.2061 (33.1223)
[INFO] - 02-27 18:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 383.6055 (384.7261)
[INFO] - 02-27 18:38:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:38:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9269)
[INFO] - 02-27 18:38:19 - [main.backward:225]: Epoch 59/500 - Iteration 90/95 - Time 0.348 batch, 0.047 data, 0.311 forward
[INFO] - 02-27 18:38:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:38:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0070 (0.0062)
[INFO] - 02-27 18:38:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5880)
[INFO] - 02-27 18:38:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5514 (-287.5509)
[INFO] - 02-27 18:38:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.8198 (33.0974)
[INFO] - 02-27 18:38:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 384.7093 (383.2863)
[INFO] - 02-27 18:38:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:38:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9250)
[INFO] - 02-27 18:38:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:38:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:38:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:38:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:38:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:38:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:38:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:38:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.780
[INFO] - 02-27 18:38:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.780
[INFO] - 02-27 18:38:24 - [main.summary_metrics:168]: Epoch 59/500 - Test Results:
{'auc': 0.8454836329139499,
 'f1': 0.40212857744107744,
 'loss': 0.47933972769358846,
 'ndcg': 0.7044233758023026,
 'precision': 0.5375000000000001,
 'recall': 0.32163865546218484}
[INFO] - 02-27 18:38:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[59] Complete. Time taken: 00:00:35.941
[INFO] - 02-27 18:38:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:38:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:38:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:38:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:38:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:38:24 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3076, 2204, 2215, 1]
[INFO] - 02-27 18:38:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:38:40 - [main.backward:225]: Epoch 60/500 - Iteration 45/95 - Time 0.357 batch, 0.062 data, 0.319 forward
[INFO] - 02-27 18:38:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:38:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0075 (0.0065)
[INFO] - 02-27 18:38:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5875)
[INFO] - 02-27 18:38:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5524 (-287.5523)
[INFO] - 02-27 18:38:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.1244 (33.0006)
[INFO] - 02-27 18:38:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 383.8275 (383.1705)
[INFO] - 02-27 18:38:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:38:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9200)
[INFO] - 02-27 18:38:56 - [main.backward:225]: Epoch 60/500 - Iteration 0/95 - Time 0.342 batch, 0.047 data, 0.306 forward
[INFO] - 02-27 18:38:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:38:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0096 (0.0064)
[INFO] - 02-27 18:38:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5983 (0.5878)
[INFO] - 02-27 18:38:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5477 (-287.5515)
[INFO] - 02-27 18:38:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.0817 (33.0926)
[INFO] - 02-27 18:38:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 383.4301 (384.1673)
[INFO] - 02-27 18:38:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:38:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8516 (0.9233)
[INFO] - 02-27 18:38:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:38:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:38:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:38:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:38:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:38:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:38:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:38:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.825
[INFO] - 02-27 18:38:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.826
[INFO] - 02-27 18:38:59 - [main.summary_metrics:168]: Epoch 60/500 - Test Results:
{'auc': 0.8397601403919411,
 'f1': 0.3984185606060606,
 'loss': 0.4916850835179264,
 'ndcg': 0.6892591071723181,
 'precision': 0.53125,
 'recall': 0.31927083333333334}
[INFO] - 02-27 18:38:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[60] Complete. Time taken: 00:00:35.350
[INFO] - 02-27 18:38:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:38:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:38:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:38:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:38:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:38:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3083, 2193, 2227, 1]
[INFO] - 02-27 18:39:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:39:17 - [main.backward:225]: Epoch 61/500 - Iteration 50/95 - Time 0.353 batch, 0.057 data, 0.313 forward
[INFO] - 02-27 18:39:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:39:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0064)
[INFO] - 02-27 18:39:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5829 (0.5886)
[INFO] - 02-27 18:39:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5515 (-287.5488)
[INFO] - 02-27 18:39:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.9501 (32.9427)
[INFO] - 02-27 18:39:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 383.0938 (383.3015)
[INFO] - 02-27 18:39:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:39:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9220)
[INFO] - 02-27 18:39:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:39:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:39:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:39:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:39:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:39:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:39:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:39:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.736
[INFO] - 02-27 18:39:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.737
[INFO] - 02-27 18:39:34 - [main.summary_metrics:168]: Epoch 61/500 - Test Results:
{'auc': 0.8320253343371662,
 'f1': 0.3986037457912458,
 'loss': 0.48836046034029157,
 'ndcg': 0.6964438589344667,
 'precision': 0.53125,
 'recall': 0.319515931372549}
[INFO] - 02-27 18:39:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[61] Complete. Time taken: 00:00:35.051
[INFO] - 02-27 18:39:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:39:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:39:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:39:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:39:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:39:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3027, 2210, 2216, 1]
[INFO] - 02-27 18:39:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:39:37 - [main.backward:225]: Epoch 62/500 - Iteration 5/95 - Time 0.514 batch, 0.209 data, 0.474 forward
[INFO] - 02-27 18:39:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:39:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0058)
[INFO] - 02-27 18:39:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5920 (0.5891)
[INFO] - 02-27 18:39:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5475 (-287.5504)
[INFO] - 02-27 18:39:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 33.0462 (33.0135)
[INFO] - 02-27 18:39:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 382.9317 (383.8621)
[INFO] - 02-27 18:39:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:39:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9298)
[INFO] - 02-27 18:39:54 - [main.backward:225]: Epoch 62/500 - Iteration 55/95 - Time 0.359 batch, 0.053 data, 0.322 forward
[INFO] - 02-27 18:39:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:39:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0061)
[INFO] - 02-27 18:39:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5971 (0.5892)
[INFO] - 02-27 18:39:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5487 (-287.5467)
[INFO] - 02-27 18:39:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.9855 (32.9621)
[INFO] - 02-27 18:39:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 381.5776 (382.7803)
[INFO] - 02-27 18:39:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:39:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9259)
[INFO] - 02-27 18:40:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:40:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:40:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:40:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:40:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:40:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:40:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:40:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.824
[INFO] - 02-27 18:40:10 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.825
[INFO] - 02-27 18:40:10 - [main.summary_metrics:168]: Epoch 62/500 - Test Results:
{'auc': 0.8370414161375335,
 'f1': 0.386450968013468,
 'loss': 0.49169855897754666,
 'ndcg': 0.6798554590252159,
 'precision': 0.515625,
 'recall': 0.3095369397759104}
[INFO] - 02-27 18:40:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[62] Complete. Time taken: 00:00:35.990
[INFO] - 02-27 18:40:10 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:40:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:40:10 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:40:10 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:40:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:40:10 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3068, 2184, 2207, 1]
[INFO] - 02-27 18:40:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:40:15 - [main.backward:225]: Epoch 63/500 - Iteration 10/95 - Time 0.433 batch, 0.135 data, 0.395 forward
[INFO] - 02-27 18:40:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:40:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0083 (0.0062)
[INFO] - 02-27 18:40:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5872)
[INFO] - 02-27 18:40:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5477 (-287.5461)
[INFO] - 02-27 18:40:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.7568 (32.7770)
[INFO] - 02-27 18:40:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 384.1649 (382.6284)
[INFO] - 02-27 18:40:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:40:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8672 (0.9234)
[INFO] - 02-27 18:40:31 - [main.backward:225]: Epoch 63/500 - Iteration 60/95 - Time 0.351 batch, 0.054 data, 0.313 forward
[INFO] - 02-27 18:40:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:40:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0078 (0.0055)
[INFO] - 02-27 18:40:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5906 (0.5870)
[INFO] - 02-27 18:40:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5396 (-287.5441)
[INFO] - 02-27 18:40:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.8965 (32.8629)
[INFO] - 02-27 18:40:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 383.0352 (383.7480)
[INFO] - 02-27 18:40:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:40:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9364)
[INFO] - 02-27 18:40:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:40:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:40:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:40:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:40:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:40:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:40:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:40:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.856
[INFO] - 02-27 18:40:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.856
[INFO] - 02-27 18:40:45 - [main.summary_metrics:168]: Epoch 63/500 - Test Results:
{'auc': 0.8473904517076438,
 'f1': 0.419726430976431,
 'loss': 0.4815672586163788,
 'ndcg': 0.7221832255838174,
 'precision': 0.559375,
 'recall': 0.33645395658263305}
[INFO] - 02-27 18:40:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[63] Complete. Time taken: 00:00:35.310
[INFO] - 02-27 18:40:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:40:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:40:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:40:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:40:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:40:46 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3071, 2209, 2212, 1]
[INFO] - 02-27 18:40:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:40:51 - [main.backward:225]: Epoch 64/500 - Iteration 15/95 - Time 0.385 batch, 0.087 data, 0.352 forward
[INFO] - 02-27 18:40:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:40:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0054)
[INFO] - 02-27 18:40:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5866)
[INFO] - 02-27 18:40:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5450 (-287.5441)
[INFO] - 02-27 18:40:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.8314 (32.8962)
[INFO] - 02-27 18:40:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 381.0832 (382.5441)
[INFO] - 02-27 18:40:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:40:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9387)
[INFO] - 02-27 18:41:08 - [main.backward:225]: Epoch 64/500 - Iteration 65/95 - Time 0.346 batch, 0.047 data, 0.311 forward
[INFO] - 02-27 18:41:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:41:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0053)
[INFO] - 02-27 18:41:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5812 (0.5879)
[INFO] - 02-27 18:41:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5454 (-287.5463)
[INFO] - 02-27 18:41:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.8823 (32.8601)
[INFO] - 02-27 18:41:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 381.5967 (381.8934)
[INFO] - 02-27 18:41:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:41:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9397)
[INFO] - 02-27 18:41:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:41:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:41:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:41:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:41:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:41:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:41:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:41:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.779
[INFO] - 02-27 18:41:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.781
[INFO] - 02-27 18:41:21 - [main.summary_metrics:168]: Epoch 64/500 - Test Results:
{'auc': 0.8442894519940329,
 'f1': 0.4137026515151515,
 'loss': 0.4635976389342177,
 'ndcg': 0.722138508853421,
 'precision': 0.5531250000000001,
 'recall': 0.3308298319327731}
[INFO] - 02-27 18:41:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[64] Complete. Time taken: 00:00:35.344
[INFO] - 02-27 18:41:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:41:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:41:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:41:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:41:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:41:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3072, 2194, 2202, 1]
[INFO] - 02-27 18:41:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:41:29 - [main.backward:225]: Epoch 65/500 - Iteration 20/95 - Time 0.387 batch, 0.089 data, 0.343 forward
[INFO] - 02-27 18:41:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0073 (0.0053)
[INFO] - 02-27 18:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5875 (0.5891)
[INFO] - 02-27 18:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5441)
[INFO] - 02-27 18:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.6406 (32.7464)
[INFO] - 02-27 18:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 381.2900 (380.9119)
[INFO] - 02-27 18:41:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9386)
[INFO] - 02-27 18:41:45 - [main.backward:225]: Epoch 65/500 - Iteration 70/95 - Time 0.350 batch, 0.050 data, 0.313 forward
[INFO] - 02-27 18:41:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:41:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0058)
[INFO] - 02-27 18:41:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5888 (0.5875)
[INFO] - 02-27 18:41:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5522 (-287.5486)
[INFO] - 02-27 18:41:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.9350 (32.8068)
[INFO] - 02-27 18:41:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 381.4590 (381.5701)
[INFO] - 02-27 18:41:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:41:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9323)
[INFO] - 02-27 18:41:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:41:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:41:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:41:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:41:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:41:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:41:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:41:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.823
[INFO] - 02-27 18:41:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.824
[INFO] - 02-27 18:41:57 - [main.summary_metrics:168]: Epoch 65/500 - Test Results:
{'auc': 0.8440830584071864,
 'f1': 0.3977356902356903,
 'loss': 0.48041960771784087,
 'ndcg': 0.7094571670975075,
 'precision': 0.53125,
 'recall': 0.3183342086834734}
[INFO] - 02-27 18:41:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[65] Complete. Time taken: 00:00:35.799
[INFO] - 02-27 18:41:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:41:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:41:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:41:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:41:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:41:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3058, 2193, 2215, 1]
[INFO] - 02-27 18:41:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:42:06 - [main.backward:225]: Epoch 66/500 - Iteration 25/95 - Time 0.364 batch, 0.069 data, 0.331 forward
[INFO] - 02-27 18:42:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0058)
[INFO] - 02-27 18:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5910 (0.5880)
[INFO] - 02-27 18:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5488 (-287.5524)
[INFO] - 02-27 18:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.9002 (32.8677)
[INFO] - 02-27 18:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 381.8489 (381.2667)
[INFO] - 02-27 18:42:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9270)
[INFO] - 02-27 18:42:23 - [main.backward:225]: Epoch 66/500 - Iteration 75/95 - Time 0.345 batch, 0.048 data, 0.309 forward
[INFO] - 02-27 18:42:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0050)
[INFO] - 02-27 18:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5790 (0.5870)
[INFO] - 02-27 18:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5483 (-287.5499)
[INFO] - 02-27 18:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.6346 (32.7530)
[INFO] - 02-27 18:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 381.3800 (380.8005)
[INFO] - 02-27 18:42:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:42:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9395)
[INFO] - 02-27 18:42:29 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:42:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:42:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:42:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:42:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:42:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:42:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:42:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.776
[INFO] - 02-27 18:42:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.777
[INFO] - 02-27 18:42:32 - [main.summary_metrics:168]: Epoch 66/500 - Test Results:
{'auc': 0.848899089721673,
 'f1': 0.3999694865319866,
 'loss': 0.4695621131970708,
 'ndcg': 0.711936806534015,
 'precision': 0.534375,
 'recall': 0.3200761554621848}
[INFO] - 02-27 18:42:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[66] Complete. Time taken: 00:00:35.553
[INFO] - 02-27 18:42:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:42:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:42:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:42:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:42:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:42:32 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2220, 2202, 1]
[INFO] - 02-27 18:42:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:42:43 - [main.backward:225]: Epoch 67/500 - Iteration 30/95 - Time 0.352 batch, 0.067 data, 0.315 forward
[INFO] - 02-27 18:42:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:42:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0060 (0.0049)
[INFO] - 02-27 18:42:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5874 (0.5865)
[INFO] - 02-27 18:42:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5501 (-287.5462)
[INFO] - 02-27 18:42:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.7456 (32.7020)
[INFO] - 02-27 18:42:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 380.7201 (380.9552)
[INFO] - 02-27 18:42:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:42:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9445)
[INFO] - 02-27 18:43:00 - [main.backward:225]: Epoch 67/500 - Iteration 80/95 - Time 0.344 batch, 0.049 data, 0.306 forward
[INFO] - 02-27 18:43:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0069 (0.0054)
[INFO] - 02-27 18:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5800 (0.5879)
[INFO] - 02-27 18:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5483)
[INFO] - 02-27 18:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.7818 (32.7946)
[INFO] - 02-27 18:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 379.5520 (380.6247)
[INFO] - 02-27 18:43:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9413)
[INFO] - 02-27 18:43:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:43:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:43:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:43:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:43:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:43:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:43:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:43:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.860
[INFO] - 02-27 18:43:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.861
[INFO] - 02-27 18:43:08 - [main.summary_metrics:168]: Epoch 67/500 - Test Results:
{'auc': 0.8450185980029267,
 'f1': 0.40941393097643103,
 'loss': 0.46730296709897257,
 'ndcg': 0.7190503044727323,
 'precision': 0.546875,
 'recall': 0.3276741946778712}
[INFO] - 02-27 18:43:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[67] Complete. Time taken: 00:00:35.463
[INFO] - 02-27 18:43:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:43:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:43:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:43:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:43:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:43:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2191, 2212, 1]
[INFO] - 02-27 18:43:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:43:20 - [main.backward:225]: Epoch 68/500 - Iteration 35/95 - Time 0.363 batch, 0.063 data, 0.326 forward
[INFO] - 02-27 18:43:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0052)
[INFO] - 02-27 18:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5911 (0.5862)
[INFO] - 02-27 18:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5478)
[INFO] - 02-27 18:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.7087 (32.7264)
[INFO] - 02-27 18:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 380.9994 (380.3104)
[INFO] - 02-27 18:43:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:43:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9413)
[INFO] - 02-27 18:43:37 - [main.backward:225]: Epoch 68/500 - Iteration 85/95 - Time 0.349 batch, 0.048 data, 0.312 forward
[INFO] - 02-27 18:43:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:43:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0050)
[INFO] - 02-27 18:43:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5875)
[INFO] - 02-27 18:43:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5448 (-287.5489)
[INFO] - 02-27 18:43:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.6355 (32.6076)
[INFO] - 02-27 18:43:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 380.3055 (380.1827)
[INFO] - 02-27 18:43:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:43:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9452)
[INFO] - 02-27 18:43:41 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:43:41 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:43:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:43:41 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:43:41 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:43:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:43:41 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:43:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.851
[INFO] - 02-27 18:43:44 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.852
[INFO] - 02-27 18:43:44 - [main.summary_metrics:168]: Epoch 68/500 - Test Results:
{'auc': 0.8532884987328264,
 'f1': 0.41143939393939394,
 'loss': 0.46854728264816103,
 'ndcg': 0.7162361627371896,
 'precision': 0.55,
 'recall': 0.3291185224089636}
[INFO] - 02-27 18:43:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[68] Complete. Time taken: 00:00:36.166
[INFO] - 02-27 18:43:44 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:43:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:43:44 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:43:44 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:43:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:43:44 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3031, 2191, 2211, 1]
[INFO] - 02-27 18:43:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:43:58 - [main.backward:225]: Epoch 69/500 - Iteration 40/95 - Time 0.362 batch, 0.059 data, 0.326 forward
[INFO] - 02-27 18:43:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:43:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0049)
[INFO] - 02-27 18:43:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5910 (0.5879)
[INFO] - 02-27 18:43:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5451 (-287.5453)
[INFO] - 02-27 18:43:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.5856 (32.6438)
[INFO] - 02-27 18:43:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 381.3175 (381.1561)
[INFO] - 02-27 18:43:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:43:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9442)
[INFO] - 02-27 18:44:16 - [main.backward:225]: Epoch 69/500 - Iteration 90/95 - Time 0.355 batch, 0.047 data, 0.318 forward
[INFO] - 02-27 18:44:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:44:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0050)
[INFO] - 02-27 18:44:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5876)
[INFO] - 02-27 18:44:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5489 (-287.5451)
[INFO] - 02-27 18:44:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.6653 (32.6269)
[INFO] - 02-27 18:44:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 378.9677 (380.1705)
[INFO] - 02-27 18:44:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:44:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9452)
[INFO] - 02-27 18:44:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:44:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:44:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:44:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:44:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:44:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:44:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:44:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.975
[INFO] - 02-27 18:44:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.976
[INFO] - 02-27 18:44:21 - [main.summary_metrics:168]: Epoch 69/500 - Test Results:
{'auc': 0.8525952889121334,
 'f1': 0.4019949494949495,
 'loss': 0.46203264247164055,
 'ndcg': 0.7125398191770481,
 'precision': 0.5375000000000001,
 'recall': 0.3215204831932773}
[INFO] - 02-27 18:44:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[69] Complete. Time taken: 00:00:37.446
[INFO] - 02-27 18:44:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:44:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:44:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:44:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:44:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:44:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3082, 2190, 2220, 1]
[INFO] - 02-27 18:44:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:44:37 - [main.backward:225]: Epoch 70/500 - Iteration 45/95 - Time 0.348 batch, 0.056 data, 0.311 forward
[INFO] - 02-27 18:44:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0052)
[INFO] - 02-27 18:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5941 (0.5867)
[INFO] - 02-27 18:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5482)
[INFO] - 02-27 18:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.6715 (32.6615)
[INFO] - 02-27 18:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 381.1306 (379.8001)
[INFO] - 02-27 18:44:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9430)
[INFO] - 02-27 18:44:54 - [main.backward:225]: Epoch 70/500 - Iteration 0/95 - Time 0.342 batch, 0.045 data, 0.306 forward
[INFO] - 02-27 18:44:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0053)
[INFO] - 02-27 18:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5869)
[INFO] - 02-27 18:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5457 (-287.5479)
[INFO] - 02-27 18:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.7229 (32.6189)
[INFO] - 02-27 18:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 380.1435 (380.3722)
[INFO] - 02-27 18:44:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9377)
[INFO] - 02-27 18:44:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:44:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:44:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:44:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:44:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:44:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:44:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:44:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.889
[INFO] - 02-27 18:44:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.890
[INFO] - 02-27 18:44:57 - [main.summary_metrics:168]: Epoch 70/500 - Test Results:
{'auc': 0.8491229266829281,
 'f1': 0.4135690235690236,
 'loss': 0.46562840299259345,
 'ndcg': 0.7153068373407424,
 'precision': 0.5531250000000001,
 'recall': 0.3307116596638655}
[INFO] - 02-27 18:44:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[70] Complete. Time taken: 00:00:35.465
[INFO] - 02-27 18:44:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:44:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:44:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:44:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:44:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:44:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2213, 2210, 1]
[INFO] - 02-27 18:44:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:45:15 - [main.backward:225]: Epoch 71/500 - Iteration 50/95 - Time 0.356 batch, 0.052 data, 0.322 forward
[INFO] - 02-27 18:45:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:45:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0053)
[INFO] - 02-27 18:45:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5868 (0.5875)
[INFO] - 02-27 18:45:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5488 (-287.5490)
[INFO] - 02-27 18:45:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.5887 (32.7533)
[INFO] - 02-27 18:45:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 379.5594 (380.5325)
[INFO] - 02-27 18:45:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:45:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9375)
[INFO] - 02-27 18:45:29 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:45:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:45:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:45:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:45:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:45:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:45:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:45:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.803
[INFO] - 02-27 18:45:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.804
[INFO] - 02-27 18:45:32 - [main.summary_metrics:168]: Epoch 71/500 - Test Results:
{'auc': 0.8462816768864408,
 'f1': 0.4235921717171718,
 'loss': 0.4602601608993623,
 'ndcg': 0.7174926169623894,
 'precision': 0.565625,
 'recall': 0.3390975140056023}
[INFO] - 02-27 18:45:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[71] Complete. Time taken: 00:00:35.456
[INFO] - 02-27 18:45:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:45:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:45:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:45:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:45:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:45:32 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3057, 2177, 2221, 1]
[INFO] - 02-27 18:45:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:45:35 - [main.backward:225]: Epoch 72/500 - Iteration 5/95 - Time 0.551 batch, 0.216 data, 0.511 forward
[INFO] - 02-27 18:45:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0048)
[INFO] - 02-27 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5788 (0.5870)
[INFO] - 02-27 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5494 (-287.5502)
[INFO] - 02-27 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.6242 (32.6530)
[INFO] - 02-27 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 379.3767 (379.8916)
[INFO] - 02-27 18:45:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:45:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9402)
[INFO] - 02-27 18:45:52 - [main.backward:225]: Epoch 72/500 - Iteration 55/95 - Time 0.356 batch, 0.053 data, 0.319 forward
[INFO] - 02-27 18:45:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:45:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0053)
[INFO] - 02-27 18:45:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5918 (0.5885)
[INFO] - 02-27 18:45:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5483 (-287.5510)
[INFO] - 02-27 18:45:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.6649 (32.7167)
[INFO] - 02-27 18:45:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 381.1802 (380.0593)
[INFO] - 02-27 18:45:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:45:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9369)
[INFO] - 02-27 18:46:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:46:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:46:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:46:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:46:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:46:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:46:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:46:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.985
[INFO] - 02-27 18:46:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.986
[INFO] - 02-27 18:46:08 - [main.summary_metrics:168]: Epoch 72/500 - Test Results:
{'auc': 0.8487457227989235,
 'f1': 0.4110174663299664,
 'loss': 0.4619183221523025,
 'ndcg': 0.7221026415588762,
 'precision': 0.55,
 'recall': 0.3285014005602241}
[INFO] - 02-27 18:46:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[72] Complete. Time taken: 00:00:35.995
[INFO] - 02-27 18:46:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:46:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:46:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:46:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:46:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:46:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3034, 2199, 2214, 1]
[INFO] - 02-27 18:46:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:46:12 - [main.backward:225]: Epoch 73/500 - Iteration 10/95 - Time 0.422 batch, 0.117 data, 0.387 forward
[INFO] - 02-27 18:46:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:46:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0048)
[INFO] - 02-27 18:46:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5835 (0.5868)
[INFO] - 02-27 18:46:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5518 (-287.5495)
[INFO] - 02-27 18:46:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.6816 (32.6785)
[INFO] - 02-27 18:46:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 378.6926 (379.7999)
[INFO] - 02-27 18:46:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:46:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9456)
[INFO] - 02-27 18:46:30 - [main.backward:225]: Epoch 73/500 - Iteration 60/95 - Time 0.356 batch, 0.050 data, 0.319 forward
[INFO] - 02-27 18:46:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0044)
[INFO] - 02-27 18:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5904 (0.5870)
[INFO] - 02-27 18:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5501 (-287.5494)
[INFO] - 02-27 18:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.6726 (32.6606)
[INFO] - 02-27 18:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 379.5662 (379.6798)
[INFO] - 02-27 18:46:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9497)
[INFO] - 02-27 18:46:41 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:46:41 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:46:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:46:41 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:46:41 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:46:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:46:41 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:46:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.836
[INFO] - 02-27 18:46:44 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.837
[INFO] - 02-27 18:46:44 - [main.summary_metrics:168]: Epoch 73/500 - Test Results:
{'auc': 0.8440984291388124,
 'f1': 0.4047327441077442,
 'loss': 0.46818764819913605,
 'ndcg': 0.7038323930428054,
 'precision': 0.540625,
 'recall': 0.32387079831932775}
[INFO] - 02-27 18:46:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[73] Complete. Time taken: 00:00:35.491
[INFO] - 02-27 18:46:44 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:46:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:46:44 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:46:44 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:46:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:46:44 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2201, 2215, 1]
[INFO] - 02-27 18:46:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:46:50 - [main.backward:225]: Epoch 74/500 - Iteration 15/95 - Time 0.395 batch, 0.096 data, 0.353 forward
[INFO] - 02-27 18:46:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:46:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0052)
[INFO] - 02-27 18:46:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5848 (0.5875)
[INFO] - 02-27 18:46:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5475 (-287.5478)
[INFO] - 02-27 18:46:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.7864 (32.6820)
[INFO] - 02-27 18:46:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 380.4667 (380.4191)
[INFO] - 02-27 18:46:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:46:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9416)
[INFO] - 02-27 18:47:06 - [main.backward:225]: Epoch 74/500 - Iteration 65/95 - Time 0.349 batch, 0.047 data, 0.314 forward
[INFO] - 02-27 18:47:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:47:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0048)
[INFO] - 02-27 18:47:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5804 (0.5870)
[INFO] - 02-27 18:47:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5497 (-287.5462)
[INFO] - 02-27 18:47:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.5429 (32.5798)
[INFO] - 02-27 18:47:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 378.1736 (379.2211)
[INFO] - 02-27 18:47:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:47:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9458)
[INFO] - 02-27 18:47:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:47:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:47:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:47:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:47:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:47:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:47:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:47:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.974
[INFO] - 02-27 18:47:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.975
[INFO] - 02-27 18:47:20 - [main.summary_metrics:168]: Epoch 74/500 - Test Results:
{'auc': 0.8424244418355578,
 'f1': 0.38174031986531987,
 'loss': 0.4648994452520253,
 'ndcg': 0.696839275689732,
 'precision': 0.509375,
 'recall': 0.3057641806722689}
[INFO] - 02-27 18:47:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[74] Complete. Time taken: 00:00:35.838
[INFO] - 02-27 18:47:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:47:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:47:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:47:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:47:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:47:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2196, 2227, 1]
[INFO] - 02-27 18:47:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:47:28 - [main.backward:225]: Epoch 75/500 - Iteration 20/95 - Time 0.408 batch, 0.086 data, 0.368 forward
[INFO] - 02-27 18:47:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:47:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0047)
[INFO] - 02-27 18:47:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5840 (0.5852)
[INFO] - 02-27 18:47:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5430 (-287.5457)
[INFO] - 02-27 18:47:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.5843 (32.6457)
[INFO] - 02-27 18:47:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 379.2323 (379.0816)
[INFO] - 02-27 18:47:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:47:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9439)
[INFO] - 02-27 18:47:45 - [main.backward:225]: Epoch 75/500 - Iteration 70/95 - Time 0.369 batch, 0.051 data, 0.331 forward
[INFO] - 02-27 18:47:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0048)
[INFO] - 02-27 18:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5834 (0.5860)
[INFO] - 02-27 18:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5443)
[INFO] - 02-27 18:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.5975 (32.5629)
[INFO] - 02-27 18:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 379.0690 (379.1910)
[INFO] - 02-27 18:47:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:47:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9453)
[INFO] - 02-27 18:47:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:47:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:47:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:47:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.005
[INFO] - 02-27 18:47:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.006
[INFO] - 02-27 18:47:57 - [main.summary_metrics:168]: Epoch 75/500 - Test Results:
{'auc': 0.8446242682121868,
 'f1': 0.39991792929292935,
 'loss': 0.45777102008138393,
 'ndcg': 0.6957568417562134,
 'precision': 0.534375,
 'recall': 0.3199492296918768}
[INFO] - 02-27 18:47:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[75] Complete. Time taken: 00:00:37.655
[INFO] - 02-27 18:47:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:47:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:47:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:47:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:47:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:47:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3095, 2199, 2202, 1]
[INFO] - 02-27 18:47:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:48:07 - [main.backward:225]: Epoch 76/500 - Iteration 25/95 - Time 0.394 batch, 0.086 data, 0.353 forward
[INFO] - 02-27 18:48:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:48:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0046)
[INFO] - 02-27 18:48:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5916 (0.5871)
[INFO] - 02-27 18:48:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5461 (-287.5444)
[INFO] - 02-27 18:48:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.5355 (32.5277)
[INFO] - 02-27 18:48:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 379.0541 (379.9757)
[INFO] - 02-27 18:48:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:48:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9516)
[INFO] - 02-27 18:48:24 - [main.backward:225]: Epoch 76/500 - Iteration 75/95 - Time 0.364 batch, 0.053 data, 0.325 forward
[INFO] - 02-27 18:48:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:48:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0051)
[INFO] - 02-27 18:48:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5905 (0.5870)
[INFO] - 02-27 18:48:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5530 (-287.5483)
[INFO] - 02-27 18:48:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.4442 (32.5657)
[INFO] - 02-27 18:48:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 378.5336 (379.8306)
[INFO] - 02-27 18:48:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:48:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9408)
[INFO] - 02-27 18:48:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:48:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:48:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:48:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:48:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:48:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:48:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:48:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.758
[INFO] - 02-27 18:48:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.759
[INFO] - 02-27 18:48:34 - [main.summary_metrics:168]: Epoch 76/500 - Test Results:
{'auc': 0.8498433134283125,
 'f1': 0.41843644781144784,
 'loss': 0.46564373785098284,
 'ndcg': 0.700144797530585,
 'precision': 0.559375,
 'recall': 0.3346551120448179}
[INFO] - 02-27 18:48:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[76] Complete. Time taken: 00:00:36.893
[INFO] - 02-27 18:48:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:48:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:48:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:48:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:48:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:48:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3084, 2206, 2216, 1]
[INFO] - 02-27 18:48:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:48:45 - [main.backward:225]: Epoch 77/500 - Iteration 30/95 - Time 0.361 batch, 0.059 data, 0.327 forward
[INFO] - 02-27 18:48:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0047)
[INFO] - 02-27 18:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5898 (0.5864)
[INFO] - 02-27 18:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5524 (-287.5485)
[INFO] - 02-27 18:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.5510 (32.3867)
[INFO] - 02-27 18:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 379.5172 (378.7663)
[INFO] - 02-27 18:48:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:48:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9467)
[INFO] - 02-27 18:49:02 - [main.backward:225]: Epoch 77/500 - Iteration 80/95 - Time 0.348 batch, 0.045 data, 0.312 forward
[INFO] - 02-27 18:49:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:49:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0047)
[INFO] - 02-27 18:49:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5899 (0.5854)
[INFO] - 02-27 18:49:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5485)
[INFO] - 02-27 18:49:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.6083 (32.5691)
[INFO] - 02-27 18:49:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 379.1626 (377.8823)
[INFO] - 02-27 18:49:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:49:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9441)
[INFO] - 02-27 18:49:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:49:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:49:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:49:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:49:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:49:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:49:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:49:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.900
[INFO] - 02-27 18:49:10 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.901
[INFO] - 02-27 18:49:10 - [main.summary_metrics:168]: Epoch 77/500 - Test Results:
{'auc': 0.8499601088597203,
 'f1': 0.40888783670033674,
 'loss': 0.4653096935154827,
 'ndcg': 0.6975014601505604,
 'precision': 0.546875,
 'recall': 0.32690826330532213}
[INFO] - 02-27 18:49:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[77] Complete. Time taken: 00:00:35.916
[INFO] - 02-27 18:49:10 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:49:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:49:10 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:49:10 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:49:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:49:10 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3027, 2201, 2202, 1]
[INFO] - 02-27 18:49:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:49:23 - [main.backward:225]: Epoch 78/500 - Iteration 35/95 - Time 0.374 batch, 0.065 data, 0.333 forward
[INFO] - 02-27 18:49:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0046)
[INFO] - 02-27 18:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5862)
[INFO] - 02-27 18:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5451 (-287.5466)
[INFO] - 02-27 18:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.4766 (32.5300)
[INFO] - 02-27 18:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 378.9975 (378.8678)
[INFO] - 02-27 18:49:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:49:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9489)
[INFO] - 02-27 18:49:41 - [main.backward:225]: Epoch 78/500 - Iteration 85/95 - Time 0.364 batch, 0.050 data, 0.324 forward
[INFO] - 02-27 18:49:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0049)
[INFO] - 02-27 18:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5839 (0.5872)
[INFO] - 02-27 18:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5428 (-287.5431)
[INFO] - 02-27 18:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.4225 (32.4164)
[INFO] - 02-27 18:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 378.1698 (378.6314)
[INFO] - 02-27 18:49:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8906 (0.9395)
[INFO] - 02-27 18:49:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:49:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:49:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:49:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:49:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:49:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:49:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:49:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.992
[INFO] - 02-27 18:49:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.993
[INFO] - 02-27 18:49:47 - [main.summary_metrics:168]: Epoch 78/500 - Test Results:
{'auc': 0.8460330187221947,
 'f1': 0.4004955808080808,
 'loss': 0.4661919278561284,
 'ndcg': 0.7124092555803319,
 'precision': 0.534375,
 'recall': 0.32084208683473386}
[INFO] - 02-27 18:49:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[78] Complete. Time taken: 00:00:37.321
[INFO] - 02-27 18:49:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:49:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:49:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:49:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:49:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:49:47 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3072, 2203, 2230, 1]
[INFO] - 02-27 18:49:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:50:02 - [main.backward:225]: Epoch 79/500 - Iteration 40/95 - Time 0.372 batch, 0.061 data, 0.333 forward
[INFO] - 02-27 18:50:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:50:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0045)
[INFO] - 02-27 18:50:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5883)
[INFO] - 02-27 18:50:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5459 (-287.5456)
[INFO] - 02-27 18:50:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.3673 (32.4243)
[INFO] - 02-27 18:50:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 377.3725 (378.2054)
[INFO] - 02-27 18:50:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:50:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9458)
[INFO] - 02-27 18:50:20 - [main.backward:225]: Epoch 79/500 - Iteration 90/95 - Time 0.359 batch, 0.047 data, 0.321 forward
[INFO] - 02-27 18:50:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0045)
[INFO] - 02-27 18:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5931 (0.5888)
[INFO] - 02-27 18:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5457 (-287.5473)
[INFO] - 02-27 18:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.4290 (32.3888)
[INFO] - 02-27 18:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 378.2580 (376.7977)
[INFO] - 02-27 18:50:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:50:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9509)
[INFO] - 02-27 18:50:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:50:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:50:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:50:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:50:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:50:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:50:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:50:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.136
[INFO] - 02-27 18:50:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.137
[INFO] - 02-27 18:50:24 - [main.summary_metrics:168]: Epoch 79/500 - Test Results:
{'auc': 0.8533229180765444,
 'f1': 0.42803661616161615,
 'loss': 0.4610795212089882,
 'ndcg': 0.7224595024489693,
 'precision': 0.5718749999999999,
 'recall': 0.3425288865546218}
[INFO] - 02-27 18:50:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[79] Complete. Time taken: 00:00:37.198
[INFO] - 02-27 18:50:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:50:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:50:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:50:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:50:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:50:25 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2210, 2215, 1]
[INFO] - 02-27 18:50:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:50:41 - [main.backward:225]: Epoch 80/500 - Iteration 45/95 - Time 0.357 batch, 0.059 data, 0.319 forward
[INFO] - 02-27 18:50:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0048)
[INFO] - 02-27 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5814 (0.5878)
[INFO] - 02-27 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5506 (-287.5465)
[INFO] - 02-27 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.3461 (32.3611)
[INFO] - 02-27 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 377.9426 (377.7879)
[INFO] - 02-27 18:50:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:50:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9441)
[INFO] - 02-27 18:50:58 - [main.backward:225]: Epoch 80/500 - Iteration 0/95 - Time 0.350 batch, 0.045 data, 0.315 forward
[INFO] - 02-27 18:50:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:50:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0048)
[INFO] - 02-27 18:50:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5886)
[INFO] - 02-27 18:50:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5502 (-287.5504)
[INFO] - 02-27 18:50:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.5642 (32.4134)
[INFO] - 02-27 18:50:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 377.9691 (378.3980)
[INFO] - 02-27 18:50:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:50:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9450)
[INFO] - 02-27 18:50:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:50:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:50:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:50:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:50:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:50:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:50:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:51:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.892
[INFO] - 02-27 18:51:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.894
[INFO] - 02-27 18:51:01 - [main.summary_metrics:168]: Epoch 80/500 - Test Results:
{'auc': 0.8354865584101288,
 'f1': 0.40680976430976434,
 'loss': 0.4618400395830464,
 'ndcg': 0.6876524590975606,
 'precision': 0.54375,
 'recall': 0.3254420518207283}
[INFO] - 02-27 18:51:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[80] Complete. Time taken: 00:00:36.116
[INFO] - 02-27 18:51:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:51:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:51:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:51:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:51:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:51:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2203, 2201, 1]
[INFO] - 02-27 18:51:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:51:19 - [main.backward:225]: Epoch 81/500 - Iteration 50/95 - Time 0.362 batch, 0.053 data, 0.326 forward
[INFO] - 02-27 18:51:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0044)
[INFO] - 02-27 18:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5824 (0.5881)
[INFO] - 02-27 18:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5465 (-287.5464)
[INFO] - 02-27 18:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.5216 (32.4849)
[INFO] - 02-27 18:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 378.0769 (377.6886)
[INFO] - 02-27 18:51:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9528)
[INFO] - 02-27 18:51:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:51:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:51:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:51:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:51:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:51:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:51:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:51:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.014
[INFO] - 02-27 18:51:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.014
[INFO] - 02-27 18:51:37 - [main.summary_metrics:168]: Epoch 81/500 - Test Results:
{'auc': 0.8458344655264067,
 'f1': 0.432851430976431,
 'loss': 0.45884525438594526,
 'ndcg': 0.7375621427595651,
 'precision': 0.578125,
 'recall': 0.34645045518207285}
[INFO] - 02-27 18:51:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[81] Complete. Time taken: 00:00:36.614
[INFO] - 02-27 18:51:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:51:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:51:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:51:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:51:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:51:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2193, 2196, 1]
[INFO] - 02-27 18:51:38 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:51:40 - [main.backward:225]: Epoch 82/500 - Iteration 5/95 - Time 0.546 batch, 0.245 data, 0.514 forward
[INFO] - 02-27 18:51:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0045)
[INFO] - 02-27 18:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5899 (0.5869)
[INFO] - 02-27 18:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5478 (-287.5472)
[INFO] - 02-27 18:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2700 (32.3700)
[INFO] - 02-27 18:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.9480 (377.5597)
[INFO] - 02-27 18:51:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9497)
[INFO] - 02-27 18:51:58 - [main.backward:225]: Epoch 82/500 - Iteration 55/95 - Time 0.372 batch, 0.054 data, 0.337 forward
[INFO] - 02-27 18:51:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0045)
[INFO] - 02-27 18:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5857 (0.5867)
[INFO] - 02-27 18:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5477)
[INFO] - 02-27 18:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.3368 (32.3441)
[INFO] - 02-27 18:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 377.3158 (377.5184)
[INFO] - 02-27 18:51:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9478)
[INFO] - 02-27 18:52:12 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:52:12 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:52:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:52:12 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:52:12 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:52:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:52:12 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:52:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.978
[INFO] - 02-27 18:52:15 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.978
[INFO] - 02-27 18:52:15 - [main.summary_metrics:168]: Epoch 82/500 - Test Results:
{'auc': 0.846029728925884,
 'f1': 0.4043623737373737,
 'loss': 0.46011793592197675,
 'ndcg': 0.7080713745545687,
 'precision': 0.5406249999999999,
 'recall': 0.3233806022408964}
[INFO] - 02-27 18:52:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[82] Complete. Time taken: 00:00:37.581
[INFO] - 02-27 18:52:15 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:52:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:52:15 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:52:15 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:52:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:52:15 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3086, 2197, 2206, 1]
[INFO] - 02-27 18:52:16 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:52:19 - [main.backward:225]: Epoch 83/500 - Iteration 10/95 - Time 0.444 batch, 0.124 data, 0.402 forward
[INFO] - 02-27 18:52:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:52:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0045)
[INFO] - 02-27 18:52:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5895 (0.5868)
[INFO] - 02-27 18:52:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5482)
[INFO] - 02-27 18:52:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1858 (32.2455)
[INFO] - 02-27 18:52:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 377.2448 (377.1190)
[INFO] - 02-27 18:52:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:52:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9453)
[INFO] - 02-27 18:52:37 - [main.backward:225]: Epoch 83/500 - Iteration 60/95 - Time 0.365 batch, 0.054 data, 0.325 forward
[INFO] - 02-27 18:52:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0045)
[INFO] - 02-27 18:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5868)
[INFO] - 02-27 18:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5483)
[INFO] - 02-27 18:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2554 (32.2667)
[INFO] - 02-27 18:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.2267 (376.7599)
[INFO] - 02-27 18:52:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:52:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9497)
[INFO] - 02-27 18:52:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:52:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:52:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:52:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:52:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:52:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:52:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:52:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.943
[INFO] - 02-27 18:52:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.943
[INFO] - 02-27 18:52:52 - [main.summary_metrics:168]: Epoch 83/500 - Test Results:
{'auc': 0.8404397939935777,
 'f1': 0.4184880050505051,
 'loss': 0.45724948525061554,
 'ndcg': 0.7082237518389131,
 'precision': 0.559375,
 'recall': 0.33478203781512605}
[INFO] - 02-27 18:52:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[83] Complete. Time taken: 00:00:36.851
[INFO] - 02-27 18:52:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:52:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:52:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:52:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:52:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:52:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2196, 2214, 1]
[INFO] - 02-27 18:52:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:52:58 - [main.backward:225]: Epoch 84/500 - Iteration 15/95 - Time 0.418 batch, 0.102 data, 0.377 forward
[INFO] - 02-27 18:52:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0043)
[INFO] - 02-27 18:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5797 (0.5862)
[INFO] - 02-27 18:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5457 (-287.5480)
[INFO] - 02-27 18:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2947 (32.2435)
[INFO] - 02-27 18:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.7557 (376.5272)
[INFO] - 02-27 18:52:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9542)
[INFO] - 02-27 18:53:15 - [main.backward:225]: Epoch 84/500 - Iteration 65/95 - Time 0.364 batch, 0.050 data, 0.328 forward
[INFO] - 02-27 18:53:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0045)
[INFO] - 02-27 18:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5985 (0.5868)
[INFO] - 02-27 18:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5475 (-287.5474)
[INFO] - 02-27 18:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2219 (32.2941)
[INFO] - 02-27 18:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.0852 (376.4865)
[INFO] - 02-27 18:53:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9464)
[INFO] - 02-27 18:53:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:53:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:53:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:53:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:53:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:53:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:53:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:53:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.975
[INFO] - 02-27 18:53:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.975
[INFO] - 02-27 18:53:29 - [main.summary_metrics:168]: Epoch 84/500 - Test Results:
{'auc': 0.8487576758031644,
 'f1': 0.40970328282828283,
 'loss': 0.44848479168247957,
 'ndcg': 0.723539636718814,
 'precision': 0.546875,
 'recall': 0.3280681022408964}
[INFO] - 02-27 18:53:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[84] Complete. Time taken: 00:00:37.116
[INFO] - 02-27 18:53:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:53:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:53:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:53:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:53:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:53:29 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3069, 2206, 2213, 1]
[INFO] - 02-27 18:53:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:53:37 - [main.backward:225]: Epoch 85/500 - Iteration 20/95 - Time 0.404 batch, 0.093 data, 0.358 forward
[INFO] - 02-27 18:53:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:53:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0042)
[INFO] - 02-27 18:53:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5861)
[INFO] - 02-27 18:53:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5488 (-287.5461)
[INFO] - 02-27 18:53:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2523 (32.2423)
[INFO] - 02-27 18:53:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.5794 (376.6466)
[INFO] - 02-27 18:53:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:53:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9520)
[INFO] - 02-27 18:53:54 - [main.backward:225]: Epoch 85/500 - Iteration 70/95 - Time 0.358 batch, 0.051 data, 0.320 forward
[INFO] - 02-27 18:53:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:53:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0043)
[INFO] - 02-27 18:53:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5862)
[INFO] - 02-27 18:53:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5475)
[INFO] - 02-27 18:53:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.4141 (32.2800)
[INFO] - 02-27 18:53:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 377.6094 (376.8865)
[INFO] - 02-27 18:53:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:53:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9508)
[INFO] - 02-27 18:54:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:54:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:54:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:54:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:54:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:54:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:54:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:54:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.878
[INFO] - 02-27 18:54:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.879
[INFO] - 02-27 18:54:05 - [main.summary_metrics:168]: Epoch 85/500 - Test Results:
{'auc': 0.8455729859345699,
 'f1': 0.4079145622895623,
 'loss': 0.4561118668060471,
 'ndcg': 0.7087921242557753,
 'precision': 0.54375,
 'recall': 0.3269957983193278}
[INFO] - 02-27 18:54:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[85] Complete. Time taken: 00:00:36.532
[INFO] - 02-27 18:54:05 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:54:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:54:05 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:54:05 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:54:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:54:05 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2185, 2203, 1]
[INFO] - 02-27 18:54:06 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:54:15 - [main.backward:225]: Epoch 86/500 - Iteration 25/95 - Time 0.379 batch, 0.078 data, 0.340 forward
[INFO] - 02-27 18:54:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0040)
[INFO] - 02-27 18:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5869)
[INFO] - 02-27 18:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5499 (-287.5494)
[INFO] - 02-27 18:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2156 (32.3213)
[INFO] - 02-27 18:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 377.3046 (376.8422)
[INFO] - 02-27 18:54:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9542)
[INFO] - 02-27 18:54:32 - [main.backward:225]: Epoch 86/500 - Iteration 75/95 - Time 0.349 batch, 0.048 data, 0.314 forward
[INFO] - 02-27 18:54:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:54:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0040)
[INFO] - 02-27 18:54:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5976 (0.5859)
[INFO] - 02-27 18:54:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5493 (-287.5487)
[INFO] - 02-27 18:54:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.3279 (32.2770)
[INFO] - 02-27 18:54:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.9644 (376.1216)
[INFO] - 02-27 18:54:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:54:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9564)
[INFO] - 02-27 18:54:39 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:54:39 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:54:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:54:39 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:54:39 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:54:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:54:39 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:54:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.883
[INFO] - 02-27 18:54:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.884
[INFO] - 02-27 18:54:42 - [main.summary_metrics:168]: Epoch 86/500 - Test Results:
{'auc': 0.8484492853513954,
 'f1': 0.41375420875420876,
 'loss': 0.4515498558525996,
 'ndcg': 0.7257745000935266,
 'precision': 0.5531250000000001,
 'recall': 0.3309567577030812}
[INFO] - 02-27 18:54:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[86] Complete. Time taken: 00:00:36.461
[INFO] - 02-27 18:54:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:54:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:54:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:54:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:54:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:54:42 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3042, 2190, 2201, 1]
[INFO] - 02-27 18:54:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:54:54 - [main.backward:225]: Epoch 87/500 - Iteration 30/95 - Time 0.407 batch, 0.072 data, 0.366 forward
[INFO] - 02-27 18:54:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0041)
[INFO] - 02-27 18:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5840 (0.5867)
[INFO] - 02-27 18:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5496)
[INFO] - 02-27 18:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.3070 (32.2751)
[INFO] - 02-27 18:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.7556 (375.6725)
[INFO] - 02-27 18:54:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:54:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9528)
[INFO] - 02-27 18:55:12 - [main.backward:225]: Epoch 87/500 - Iteration 80/95 - Time 0.377 batch, 0.050 data, 0.338 forward
[INFO] - 02-27 18:55:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0044)
[INFO] - 02-27 18:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5927 (0.5876)
[INFO] - 02-27 18:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5480 (-287.5471)
[INFO] - 02-27 18:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1837 (32.2520)
[INFO] - 02-27 18:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.3411 (376.0599)
[INFO] - 02-27 18:55:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9486)
[INFO] - 02-27 18:55:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:55:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:55:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:55:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:55:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:55:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:55:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:55:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.964
[INFO] - 02-27 18:55:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.964
[INFO] - 02-27 18:55:20 - [main.summary_metrics:168]: Epoch 87/500 - Test Results:
{'auc': 0.8468455645738688,
 'f1': 0.4025210437710438,
 'loss': 0.45123112952928535,
 'ndcg': 0.72065769610714,
 'precision': 0.5375,
 'recall': 0.32228641456582635}
[INFO] - 02-27 18:55:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[87] Complete. Time taken: 00:00:38.388
[INFO] - 02-27 18:55:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:55:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:55:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:55:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:55:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:55:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3041, 2190, 2200, 1]
[INFO] - 02-27 18:55:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:55:33 - [main.backward:225]: Epoch 88/500 - Iteration 35/95 - Time 0.372 batch, 0.061 data, 0.338 forward
[INFO] - 02-27 18:55:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0044)
[INFO] - 02-27 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5876)
[INFO] - 02-27 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5377 (-287.5422)
[INFO] - 02-27 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1619 (32.1945)
[INFO] - 02-27 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.6129 (376.0360)
[INFO] - 02-27 18:55:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:55:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9487)
[INFO] - 02-27 18:55:50 - [main.backward:225]: Epoch 88/500 - Iteration 85/95 - Time 0.348 batch, 0.045 data, 0.314 forward
[INFO] - 02-27 18:55:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0045)
[INFO] - 02-27 18:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5866)
[INFO] - 02-27 18:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5451 (-287.5435)
[INFO] - 02-27 18:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2203 (32.2250)
[INFO] - 02-27 18:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 378.0233 (376.3975)
[INFO] - 02-27 18:55:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:55:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9500)
[INFO] - 02-27 18:55:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:55:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:55:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:55:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:55:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:55:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:55:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:55:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.849
[INFO] - 02-27 18:55:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.850
[INFO] - 02-27 18:55:56 - [main.summary_metrics:168]: Epoch 88/500 - Test Results:
{'auc': 0.8504973778114187,
 'f1': 0.41888152356902353,
 'loss': 0.45667935549551847,
 'ndcg': 0.7237385454263838,
 'precision': 0.559375,
 'recall': 0.3353247549019608}
[INFO] - 02-27 18:55:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[88] Complete. Time taken: 00:00:36.459
[INFO] - 02-27 18:55:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:55:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:55:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:55:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:55:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:55:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3056, 2205, 2197, 1]
[INFO] - 02-27 18:55:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:56:11 - [main.backward:225]: Epoch 89/500 - Iteration 40/95 - Time 0.364 batch, 0.057 data, 0.331 forward
[INFO] - 02-27 18:56:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0040)
[INFO] - 02-27 18:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5864)
[INFO] - 02-27 18:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5426 (-287.5428)
[INFO] - 02-27 18:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2851 (32.2083)
[INFO] - 02-27 18:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.1754 (375.9635)
[INFO] - 02-27 18:56:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9527)
[INFO] - 02-27 18:56:29 - [main.backward:225]: Epoch 89/500 - Iteration 90/95 - Time 0.356 batch, 0.045 data, 0.321 forward
[INFO] - 02-27 18:56:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:56:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0039)
[INFO] - 02-27 18:56:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5813 (0.5848)
[INFO] - 02-27 18:56:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5447 (-287.5443)
[INFO] - 02-27 18:56:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1575 (32.2271)
[INFO] - 02-27 18:56:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.8376 (375.8102)
[INFO] - 02-27 18:56:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:56:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9573)
[INFO] - 02-27 18:56:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:56:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:56:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:56:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:56:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:56:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:56:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:56:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.916
[INFO] - 02-27 18:56:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.917
[INFO] - 02-27 18:56:33 - [main.summary_metrics:168]: Epoch 89/500 - Test Results:
{'auc': 0.8516988438144866,
 'f1': 0.4212773569023569,
 'loss': 0.44191247763575475,
 'ndcg': 0.7167389590062627,
 'precision': 0.5625,
 'recall': 0.3372592787114846}
[INFO] - 02-27 18:56:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[89] Complete. Time taken: 00:00:36.889
[INFO] - 02-27 18:56:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:56:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:56:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:56:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:56:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:56:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3058, 2207, 2209, 1]
[INFO] - 02-27 18:56:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:56:50 - [main.backward:225]: Epoch 90/500 - Iteration 45/95 - Time 0.359 batch, 0.057 data, 0.320 forward
[INFO] - 02-27 18:56:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0041)
[INFO] - 02-27 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5825 (0.5861)
[INFO] - 02-27 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5429 (-287.5424)
[INFO] - 02-27 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2303 (32.2130)
[INFO] - 02-27 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 377.0721 (376.2839)
[INFO] - 02-27 18:56:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:56:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9539)
[INFO] - 02-27 18:57:06 - [main.backward:225]: Epoch 90/500 - Iteration 0/95 - Time 0.347 batch, 0.047 data, 0.309 forward
[INFO] - 02-27 18:57:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:57:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0039)
[INFO] - 02-27 18:57:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5901 (0.5860)
[INFO] - 02-27 18:57:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5479 (-287.5460)
[INFO] - 02-27 18:57:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1870 (32.1721)
[INFO] - 02-27 18:57:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.6698 (376.1809)
[INFO] - 02-27 18:57:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:57:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9548)
[INFO] - 02-27 18:57:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:57:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:57:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:57:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:57:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:57:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:57:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:57:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.868
[INFO] - 02-27 18:57:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.868
[INFO] - 02-27 18:57:09 - [main.summary_metrics:168]: Epoch 90/500 - Test Results:
{'auc': 0.8439681732987312,
 'f1': 0.39736531986531987,
 'loss': 0.45182393674905685,
 'ndcg': 0.6973438734058783,
 'precision': 0.53125,
 'recall': 0.317844012605042}
[INFO] - 02-27 18:57:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[90] Complete. Time taken: 00:00:35.808
[INFO] - 02-27 18:57:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:57:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:57:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:57:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:57:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:57:09 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2194, 2214, 1]
[INFO] - 02-27 18:57:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:57:27 - [main.backward:225]: Epoch 91/500 - Iteration 50/95 - Time 0.358 batch, 0.055 data, 0.321 forward
[INFO] - 02-27 18:57:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:57:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0041)
[INFO] - 02-27 18:57:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5796 (0.5861)
[INFO] - 02-27 18:57:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5479)
[INFO] - 02-27 18:57:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1786 (32.1786)
[INFO] - 02-27 18:57:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.6112 (375.9708)
[INFO] - 02-27 18:57:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:57:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9539)
[INFO] - 02-27 18:57:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:57:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:57:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:57:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:57:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:57:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:57:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:57:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.122
[INFO] - 02-27 18:57:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.123
[INFO] - 02-27 18:57:46 - [main.summary_metrics:168]: Epoch 91/500 - Test Results:
{'auc': 0.8458981483524781,
 'f1': 0.40257365319865324,
 'loss': 0.44916012188062493,
 'ndcg': 0.7075473806656947,
 'precision': 0.5375000000000001,
 'recall': 0.3223082983193277}
[INFO] - 02-27 18:57:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[91] Complete. Time taken: 00:00:36.445
[INFO] - 02-27 18:57:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:57:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:57:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:57:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:57:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:57:46 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2202, 2204, 1]
[INFO] - 02-27 18:57:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:57:48 - [main.backward:225]: Epoch 92/500 - Iteration 5/95 - Time 0.517 batch, 0.224 data, 0.489 forward
[INFO] - 02-27 18:57:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:57:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0061 (0.0043)
[INFO] - 02-27 18:57:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5865)
[INFO] - 02-27 18:57:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5495)
[INFO] - 02-27 18:57:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2090 (32.2168)
[INFO] - 02-27 18:57:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.9980 (375.8950)
[INFO] - 02-27 18:57:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:57:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9480)
[INFO] - 02-27 18:58:06 - [main.backward:225]: Epoch 92/500 - Iteration 55/95 - Time 0.363 batch, 0.053 data, 0.329 forward
[INFO] - 02-27 18:58:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0040)
[INFO] - 02-27 18:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5829 (0.5872)
[INFO] - 02-27 18:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5445 (-287.5452)
[INFO] - 02-27 18:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1053 (32.2320)
[INFO] - 02-27 18:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.3247 (375.3646)
[INFO] - 02-27 18:58:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:58:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9553)
[INFO] - 02-27 18:58:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:58:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:58:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:58:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:58:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:58:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:58:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:58:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.970
[INFO] - 02-27 18:58:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.971
[INFO] - 02-27 18:58:23 - [main.summary_metrics:168]: Epoch 92/500 - Test Results:
{'auc': 0.8456558668810662,
 'f1': 0.404888468013468,
 'loss': 0.45031915303648357,
 'ndcg': 0.7205639991888848,
 'precision': 0.540625,
 'recall': 0.32414653361344536}
[INFO] - 02-27 18:58:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[92] Complete. Time taken: 00:00:36.961
[INFO] - 02-27 18:58:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:58:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:58:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:58:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:58:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:58:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3029, 2203, 2199, 1]
[INFO] - 02-27 18:58:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:58:27 - [main.backward:225]: Epoch 93/500 - Iteration 10/95 - Time 0.436 batch, 0.126 data, 0.396 forward
[INFO] - 02-27 18:58:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0042)
[INFO] - 02-27 18:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5932 (0.5877)
[INFO] - 02-27 18:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5385 (-287.5414)
[INFO] - 02-27 18:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2310 (32.1858)
[INFO] - 02-27 18:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.6425 (375.5639)
[INFO] - 02-27 18:58:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:58:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9492)
[INFO] - 02-27 18:58:44 - [main.backward:225]: Epoch 93/500 - Iteration 60/95 - Time 0.359 batch, 0.053 data, 0.321 forward
[INFO] - 02-27 18:58:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0042)
[INFO] - 02-27 18:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5882 (0.5877)
[INFO] - 02-27 18:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5413 (-287.5432)
[INFO] - 02-27 18:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2595 (32.2572)
[INFO] - 02-27 18:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.8459 (375.1839)
[INFO] - 02-27 18:58:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:58:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9530)
[INFO] - 02-27 18:58:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:58:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:58:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:58:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:58:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:58:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:58:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:58:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.954
[INFO] - 02-27 18:58:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.955
[INFO] - 02-27 18:58:59 - [main.summary_metrics:168]: Epoch 93/500 - Test Results:
{'auc': 0.850979069630303,
 'f1': 0.4282218013468013,
 'loss': 0.4498321815088381,
 'ndcg': 0.7211341161723109,
 'precision': 0.5718749999999999,
 'recall': 0.3427739845938375}
[INFO] - 02-27 18:58:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[93] Complete. Time taken: 00:00:36.696
[INFO] - 02-27 18:58:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:58:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:58:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:58:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:58:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:58:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3027, 2189, 2209, 1]
[INFO] - 02-27 18:59:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:59:06 - [main.backward:225]: Epoch 94/500 - Iteration 15/95 - Time 0.405 batch, 0.098 data, 0.364 forward
[INFO] - 02-27 18:59:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:59:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0041)
[INFO] - 02-27 18:59:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5874)
[INFO] - 02-27 18:59:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5442 (-287.5411)
[INFO] - 02-27 18:59:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.2231 (32.2243)
[INFO] - 02-27 18:59:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.9559 (375.4165)
[INFO] - 02-27 18:59:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:59:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9533)
[INFO] - 02-27 18:59:23 - [main.backward:225]: Epoch 94/500 - Iteration 65/95 - Time 0.358 batch, 0.051 data, 0.320 forward
[INFO] - 02-27 18:59:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:59:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0042)
[INFO] - 02-27 18:59:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5867)
[INFO] - 02-27 18:59:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5447)
[INFO] - 02-27 18:59:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1609 (32.1989)
[INFO] - 02-27 18:59:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.2496 (375.3473)
[INFO] - 02-27 18:59:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:59:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9536)
[INFO] - 02-27 18:59:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 18:59:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:59:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:59:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 18:59:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:59:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 18:59:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 18:59:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.998
[INFO] - 02-27 18:59:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.999
[INFO] - 02-27 18:59:36 - [main.summary_metrics:168]: Epoch 94/500 - Test Results:
{'auc': 0.8477498028623214,
 'f1': 0.41333228114478116,
 'loss': 0.4505242992199656,
 'ndcg': 0.7254697056434065,
 'precision': 0.553125,
 'recall': 0.33033963585434173}
[INFO] - 02-27 18:59:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[94] Complete. Time taken: 00:00:36.672
[INFO] - 02-27 18:59:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 18:59:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 18:59:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 18:59:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 18:59:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 18:59:36 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3078, 2185, 2209, 1]
[INFO] - 02-27 18:59:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 18:59:44 - [main.backward:225]: Epoch 95/500 - Iteration 20/95 - Time 0.382 batch, 0.079 data, 0.344 forward
[INFO] - 02-27 18:59:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 18:59:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0043)
[INFO] - 02-27 18:59:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5867)
[INFO] - 02-27 18:59:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5461)
[INFO] - 02-27 18:59:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1715 (32.2200)
[INFO] - 02-27 18:59:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.9448 (375.3810)
[INFO] - 02-27 18:59:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 18:59:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9503)
[INFO] - 02-27 19:00:00 - [main.backward:225]: Epoch 95/500 - Iteration 70/95 - Time 0.348 batch, 0.046 data, 0.313 forward
[INFO] - 02-27 19:00:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:00:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0043)
[INFO] - 02-27 19:00:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5873)
[INFO] - 02-27 19:00:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5439)
[INFO] - 02-27 19:00:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1635 (32.1477)
[INFO] - 02-27 19:00:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.7345 (375.3777)
[INFO] - 02-27 19:00:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:00:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9511)
[INFO] - 02-27 19:00:09 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:00:09 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:00:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:00:09 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:00:09 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:00:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:00:09 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:00:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.237
[INFO] - 02-27 19:00:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.237
[INFO] - 02-27 19:00:12 - [main.summary_metrics:168]: Epoch 95/500 - Test Results:
{'auc': 0.8476839970669641,
 'f1': 0.404888468013468,
 'loss': 0.45254579225746433,
 'ndcg': 0.7024615521603496,
 'precision': 0.5406249999999999,
 'recall': 0.32414653361344536}
[INFO] - 02-27 19:00:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[95] Complete. Time taken: 00:00:36.116
[INFO] - 02-27 19:00:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:00:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:00:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:00:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:00:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:00:12 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2199, 2217, 1]
[INFO] - 02-27 19:00:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:00:22 - [main.backward:225]: Epoch 96/500 - Iteration 25/95 - Time 0.379 batch, 0.080 data, 0.341 forward
[INFO] - 02-27 19:00:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0040)
[INFO] - 02-27 19:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5874)
[INFO] - 02-27 19:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5458 (-287.5465)
[INFO] - 02-27 19:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0869 (32.1711)
[INFO] - 02-27 19:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.8540 (374.8058)
[INFO] - 02-27 19:00:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9564)
[INFO] - 02-27 19:00:38 - [main.backward:225]: Epoch 96/500 - Iteration 75/95 - Time 0.347 batch, 0.048 data, 0.313 forward
[INFO] - 02-27 19:00:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:00:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0038)
[INFO] - 02-27 19:00:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5820 (0.5876)
[INFO] - 02-27 19:00:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5502 (-287.5488)
[INFO] - 02-27 19:00:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1891 (32.1382)
[INFO] - 02-27 19:00:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.8054 (374.8547)
[INFO] - 02-27 19:00:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:00:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9617)
[INFO] - 02-27 19:00:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:00:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:00:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:00:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:00:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:00:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:00:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:00:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.577
[INFO] - 02-27 19:00:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.580
[INFO] - 02-27 19:00:47 - [main.summary_metrics:168]: Epoch 96/500 - Test Results:
{'auc': 0.8508315167978957,
 'f1': 0.40246948653198655,
 'loss': 0.45265086999067955,
 'ndcg': 0.7090746082965382,
 'precision': 0.5375000000000001,
 'recall': 0.3221594887955182}
[INFO] - 02-27 19:00:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[96] Complete. Time taken: 00:00:35.155
[INFO] - 02-27 19:00:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:00:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:00:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:00:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:00:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:00:47 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3023, 2214, 2230, 1]
[INFO] - 02-27 19:00:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:00:59 - [main.backward:225]: Epoch 97/500 - Iteration 30/95 - Time 0.372 batch, 0.067 data, 0.338 forward
[INFO] - 02-27 19:00:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:00:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0043)
[INFO] - 02-27 19:00:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5874)
[INFO] - 02-27 19:00:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5493 (-287.5487)
[INFO] - 02-27 19:00:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1067 (32.1581)
[INFO] - 02-27 19:00:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.9572 (374.5970)
[INFO] - 02-27 19:00:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:00:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9523)
[INFO] - 02-27 19:01:15 - [main.backward:225]: Epoch 97/500 - Iteration 80/95 - Time 0.349 batch, 0.046 data, 0.315 forward
[INFO] - 02-27 19:01:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:01:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0039)
[INFO] - 02-27 19:01:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5886 (0.5872)
[INFO] - 02-27 19:01:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5533 (-287.5492)
[INFO] - 02-27 19:01:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1636 (32.0742)
[INFO] - 02-27 19:01:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.0432 (375.2039)
[INFO] - 02-27 19:01:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:01:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9550)
[INFO] - 02-27 19:01:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:01:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:01:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:01:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:01:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:01:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:01:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:01:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.760
[INFO] - 02-27 19:01:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.761
[INFO] - 02-27 19:01:23 - [main.summary_metrics:168]: Epoch 97/500 - Test Results:
{'auc': 0.8474647888567192,
 'f1': 0.4004440235690236,
 'loss': 0.44576731737048225,
 'ndcg': 0.7104192369785635,
 'precision': 0.534375,
 'recall': 0.32071516106442577}
[INFO] - 02-27 19:01:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[97] Complete. Time taken: 00:00:35.570
[INFO] - 02-27 19:01:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:01:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:01:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:01:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:01:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:01:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3091, 2192, 2214, 1]
[INFO] - 02-27 19:01:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:01:36 - [main.backward:225]: Epoch 98/500 - Iteration 35/95 - Time 0.362 batch, 0.061 data, 0.326 forward
[INFO] - 02-27 19:01:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0043)
[INFO] - 02-27 19:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5913 (0.5879)
[INFO] - 02-27 19:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5463 (-287.5474)
[INFO] - 02-27 19:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1816 (32.1286)
[INFO] - 02-27 19:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.5768 (374.9381)
[INFO] - 02-27 19:01:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:01:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9466)
[INFO] - 02-27 19:01:53 - [main.backward:225]: Epoch 98/500 - Iteration 85/95 - Time 0.348 batch, 0.045 data, 0.313 forward
[INFO] - 02-27 19:01:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0039)
[INFO] - 02-27 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5901 (0.5869)
[INFO] - 02-27 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5430 (-287.5460)
[INFO] - 02-27 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1382 (32.1518)
[INFO] - 02-27 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.7723 (374.5950)
[INFO] - 02-27 19:01:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:01:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9569)
[INFO] - 02-27 19:01:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:01:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:01:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:01:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:01:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:01:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:01:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:01:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.907
[INFO] - 02-27 19:01:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.907
[INFO] - 02-27 19:01:59 - [main.summary_metrics:168]: Epoch 98/500 - Test Results:
{'auc': 0.8468659613968137,
 'f1': 0.40459911616161615,
 'loss': 0.44802883071849803,
 'ndcg': 0.7164608662797656,
 'precision': 0.540625,
 'recall': 0.3237526260504202}
[INFO] - 02-27 19:01:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[98] Complete. Time taken: 00:00:35.896
[INFO] - 02-27 19:01:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:01:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:01:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:01:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:01:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:01:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3070, 2191, 2203, 1]
[INFO] - 02-27 19:02:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:02:13 - [main.backward:225]: Epoch 99/500 - Iteration 40/95 - Time 0.357 batch, 0.060 data, 0.319 forward
[INFO] - 02-27 19:02:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:02:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0039)
[INFO] - 02-27 19:02:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5876 (0.5866)
[INFO] - 02-27 19:02:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5465)
[INFO] - 02-27 19:02:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1159 (32.1564)
[INFO] - 02-27 19:02:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.2577 (375.4834)
[INFO] - 02-27 19:02:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:02:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9561)
[INFO] - 02-27 19:02:30 - [main.backward:225]: Epoch 99/500 - Iteration 90/95 - Time 0.344 batch, 0.046 data, 0.307 forward
[INFO] - 02-27 19:02:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:02:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0041)
[INFO] - 02-27 19:02:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5868)
[INFO] - 02-27 19:02:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5463 (-287.5477)
[INFO] - 02-27 19:02:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0280 (32.1123)
[INFO] - 02-27 19:02:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.7928 (375.2664)
[INFO] - 02-27 19:02:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:02:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9520)
[INFO] - 02-27 19:02:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:02:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:02:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:02:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:02:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:02:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:02:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:02:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.722
[INFO] - 02-27 19:02:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.723
[INFO] - 02-27 19:02:34 - [main.summary_metrics:168]: Epoch 99/500 - Test Results:
{'auc': 0.8427175817630974,
 'f1': 0.404888468013468,
 'loss': 0.45012683401645875,
 'ndcg': 0.7099107777879927,
 'precision': 0.540625,
 'recall': 0.32414653361344536}
[INFO] - 02-27 19:02:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[99] Complete. Time taken: 00:00:35.390
[INFO] - 02-27 19:02:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:02:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:02:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:02:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:02:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:02:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3064, 2171, 2217, 1]
[INFO] - 02-27 19:02:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:02:50 - [main.backward:225]: Epoch 100/500 - Iteration 45/95 - Time 0.346 batch, 0.057 data, 0.309 forward
[INFO] - 02-27 19:02:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0039)
[INFO] - 02-27 19:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5866 (0.5866)
[INFO] - 02-27 19:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5479)
[INFO] - 02-27 19:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1126 (32.1003)
[INFO] - 02-27 19:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 376.2114 (375.0306)
[INFO] - 02-27 19:02:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9577)
[INFO] - 02-27 19:03:07 - [main.backward:225]: Epoch 100/500 - Iteration 0/95 - Time 0.340 batch, 0.045 data, 0.304 forward
[INFO] - 02-27 19:03:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0037)
[INFO] - 02-27 19:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5897 (0.5858)
[INFO] - 02-27 19:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5491)
[INFO] - 02-27 19:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0945 (32.0965)
[INFO] - 02-27 19:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.4285 (375.3463)
[INFO] - 02-27 19:03:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:03:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9578)
[INFO] - 02-27 19:03:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:03:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:03:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:03:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:03:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:03:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:03:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:03:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.892
[INFO] - 02-27 19:03:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.892
[INFO] - 02-27 19:03:09 - [main.summary_metrics:168]: Epoch 100/500 - Test Results:
{'auc': 0.8427448034973792,
 'f1': 0.4022327441077441,
 'loss': 0.4527302772637297,
 'ndcg': 0.7130107885888624,
 'precision': 0.5375,
 'recall': 0.3217874649859944}
[INFO] - 02-27 19:03:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[100] Complete. Time taken: 00:00:35.190
[INFO] - 02-27 19:03:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:03:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:03:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:03:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:03:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:03:09 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3022, 2192, 2204, 1]
[INFO] - 02-27 19:03:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:03:27 - [main.backward:225]: Epoch 101/500 - Iteration 50/95 - Time 0.360 batch, 0.060 data, 0.317 forward
[INFO] - 02-27 19:03:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0039)
[INFO] - 02-27 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5873)
[INFO] - 02-27 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5478 (-287.5484)
[INFO] - 02-27 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1280 (32.1520)
[INFO] - 02-27 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.6586 (374.8220)
[INFO] - 02-27 19:03:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:03:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9567)
[INFO] - 02-27 19:03:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:03:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:03:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:03:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:03:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:03:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:03:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:03:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.853
[INFO] - 02-27 19:03:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.854
[INFO] - 02-27 19:03:45 - [main.summary_metrics:168]: Epoch 101/500 - Test Results:
{'auc': 0.8484912027310925,
 'f1': 0.4110174663299664,
 'loss': 0.4502056309988377,
 'ndcg': 0.7135664873692902,
 'precision': 0.55,
 'recall': 0.3285014005602241}
[INFO] - 02-27 19:03:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[101] Complete. Time taken: 00:00:35.881
[INFO] - 02-27 19:03:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:03:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:03:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:03:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:03:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:03:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3030, 2190, 2217, 1]
[INFO] - 02-27 19:03:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:03:48 - [main.backward:225]: Epoch 102/500 - Iteration 5/95 - Time 0.507 batch, 0.203 data, 0.474 forward
[INFO] - 02-27 19:03:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:03:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0040)
[INFO] - 02-27 19:03:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5810 (0.5868)
[INFO] - 02-27 19:03:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5499 (-287.5484)
[INFO] - 02-27 19:03:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9796 (32.0384)
[INFO] - 02-27 19:03:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.8671 (374.5468)
[INFO] - 02-27 19:03:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:03:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9527)
[INFO] - 02-27 19:04:05 - [main.backward:225]: Epoch 102/500 - Iteration 55/95 - Time 0.351 batch, 0.049 data, 0.318 forward
[INFO] - 02-27 19:04:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0036)
[INFO] - 02-27 19:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5844 (0.5869)
[INFO] - 02-27 19:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5460)
[INFO] - 02-27 19:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0601 (32.0466)
[INFO] - 02-27 19:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.5387 (374.2508)
[INFO] - 02-27 19:04:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:04:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9600)
[INFO] - 02-27 19:04:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:04:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:04:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:04:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:04:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:04:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:04:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:04:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.763
[INFO] - 02-27 19:04:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.764
[INFO] - 02-27 19:04:21 - [main.summary_metrics:168]: Epoch 102/500 - Test Results:
{'auc': 0.847645926507858,
 'f1': 0.4202767255892256,
 'loss': 0.4479389476058785,
 'ndcg': 0.7259959416951132,
 'precision': 0.5625,
 'recall': 0.3358543417366947}
[INFO] - 02-27 19:04:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[102] Complete. Time taken: 00:00:35.798
[INFO] - 02-27 19:04:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:04:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:04:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:04:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:04:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:04:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2210, 2215, 1]
[INFO] - 02-27 19:04:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:04:25 - [main.backward:225]: Epoch 103/500 - Iteration 10/95 - Time 0.420 batch, 0.123 data, 0.381 forward
[INFO] - 02-27 19:04:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:04:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0039)
[INFO] - 02-27 19:04:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5855)
[INFO] - 02-27 19:04:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5414 (-287.5453)
[INFO] - 02-27 19:04:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0551 (32.0835)
[INFO] - 02-27 19:04:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.1740 (374.3664)
[INFO] - 02-27 19:04:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:04:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9536)
[INFO] - 02-27 19:04:42 - [main.backward:225]: Epoch 103/500 - Iteration 60/95 - Time 0.342 batch, 0.051 data, 0.305 forward
[INFO] - 02-27 19:04:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:04:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0038)
[INFO] - 02-27 19:04:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5854 (0.5862)
[INFO] - 02-27 19:04:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5429)
[INFO] - 02-27 19:04:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1868 (32.1236)
[INFO] - 02-27 19:04:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.7335 (374.4279)
[INFO] - 02-27 19:04:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:04:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9528)
[INFO] - 02-27 19:04:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:04:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:04:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:04:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:04:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:04:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:04:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:04:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.860
[INFO] - 02-27 19:04:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.861
[INFO] - 02-27 19:04:56 - [main.summary_metrics:168]: Epoch 103/500 - Test Results:
{'auc': 0.8505314408851776,
 'f1': 0.4018623737373737,
 'loss': 0.45324702560495983,
 'ndcg': 0.7120110888160442,
 'precision': 0.5375000000000001,
 'recall': 0.32129726890756305}
[INFO] - 02-27 19:04:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[103] Complete. Time taken: 00:00:34.927
[INFO] - 02-27 19:04:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:04:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:04:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:04:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:04:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:04:56 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3076, 2184, 2196, 1]
[INFO] - 02-27 19:04:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:05:02 - [main.backward:225]: Epoch 104/500 - Iteration 15/95 - Time 0.401 batch, 0.098 data, 0.366 forward
[INFO] - 02-27 19:05:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:05:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0040)
[INFO] - 02-27 19:05:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5861)
[INFO] - 02-27 19:05:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5425 (-287.5445)
[INFO] - 02-27 19:05:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0814 (32.1035)
[INFO] - 02-27 19:05:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.2097 (374.1524)
[INFO] - 02-27 19:05:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:05:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9555)
[INFO] - 02-27 19:05:19 - [main.backward:225]: Epoch 104/500 - Iteration 65/95 - Time 0.355 batch, 0.051 data, 0.319 forward
[INFO] - 02-27 19:05:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:05:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0038)
[INFO] - 02-27 19:05:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5802 (0.5858)
[INFO] - 02-27 19:05:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5400 (-287.5442)
[INFO] - 02-27 19:05:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0857 (32.0598)
[INFO] - 02-27 19:05:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.3373 (374.1514)
[INFO] - 02-27 19:05:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:05:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9555)
[INFO] - 02-27 19:05:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:05:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:05:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:05:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:05:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:05:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:05:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:05:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.751
[INFO] - 02-27 19:05:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.752
[INFO] - 02-27 19:05:32 - [main.summary_metrics:168]: Epoch 104/500 - Test Results:
{'auc': 0.8508951644996234,
 'f1': 0.41333228114478116,
 'loss': 0.4466586222133505,
 'ndcg': 0.7231861213898354,
 'precision': 0.553125,
 'recall': 0.33033963585434173}
[INFO] - 02-27 19:05:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[104] Complete. Time taken: 00:00:36.338
[INFO] - 02-27 19:05:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:05:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:05:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:05:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:05:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:05:32 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3027, 2191, 2216, 1]
[INFO] - 02-27 19:05:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:05:40 - [main.backward:225]: Epoch 105/500 - Iteration 20/95 - Time 0.383 batch, 0.082 data, 0.345 forward
[INFO] - 02-27 19:05:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:05:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0038)
[INFO] - 02-27 19:05:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5907 (0.5869)
[INFO] - 02-27 19:05:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5428 (-287.5422)
[INFO] - 02-27 19:05:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9868 (32.0388)
[INFO] - 02-27 19:05:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.2206 (374.0338)
[INFO] - 02-27 19:05:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:05:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9600)
[INFO] - 02-27 19:05:57 - [main.backward:225]: Epoch 105/500 - Iteration 70/95 - Time 0.350 batch, 0.048 data, 0.315 forward
[INFO] - 02-27 19:05:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:05:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0036)
[INFO] - 02-27 19:05:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5863)
[INFO] - 02-27 19:05:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5447 (-287.5445)
[INFO] - 02-27 19:05:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0457 (32.0150)
[INFO] - 02-27 19:05:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.7084 (374.0102)
[INFO] - 02-27 19:05:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:05:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9587)
[INFO] - 02-27 19:06:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:06:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:06:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:06:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:06:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:06:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:06:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:06:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.809
[INFO] - 02-27 19:06:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.811
[INFO] - 02-27 19:06:08 - [main.summary_metrics:168]: Epoch 105/500 - Test Results:
{'auc': 0.8447913718796342,
 'f1': 0.392684132996633,
 'loss': 0.44752248366627767,
 'ndcg': 0.7091511648224355,
 'precision': 0.525,
 'recall': 0.3140406162464986}
[INFO] - 02-27 19:06:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[105] Complete. Time taken: 00:00:35.779
[INFO] - 02-27 19:06:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:06:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:06:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:06:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:06:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:06:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3043, 2189, 2232, 1]
[INFO] - 02-27 19:06:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:06:18 - [main.backward:225]: Epoch 106/500 - Iteration 25/95 - Time 0.382 batch, 0.076 data, 0.343 forward
[INFO] - 02-27 19:06:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:06:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0037)
[INFO] - 02-27 19:06:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5863)
[INFO] - 02-27 19:06:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5480 (-287.5464)
[INFO] - 02-27 19:06:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0183 (31.9878)
[INFO] - 02-27 19:06:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.9284 (373.9030)
[INFO] - 02-27 19:06:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:06:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9605)
[INFO] - 02-27 19:06:35 - [main.backward:225]: Epoch 106/500 - Iteration 75/95 - Time 0.355 batch, 0.050 data, 0.317 forward
[INFO] - 02-27 19:06:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0038)
[INFO] - 02-27 19:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5806 (0.5858)
[INFO] - 02-27 19:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5436)
[INFO] - 02-27 19:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9254 (32.0073)
[INFO] - 02-27 19:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.1191 (373.9562)
[INFO] - 02-27 19:06:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:06:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9561)
[INFO] - 02-27 19:06:41 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:06:41 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:06:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:06:41 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:06:41 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:06:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:06:41 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:06:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.880
[INFO] - 02-27 19:06:44 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.880
[INFO] - 02-27 19:06:44 - [main.summary_metrics:168]: Epoch 106/500 - Test Results:
{'auc': 0.8461967034975755,
 'f1': 0.4068623737373738,
 'loss': 0.44568503120786235,
 'ndcg': 0.7145702535729177,
 'precision': 0.54375,
 'recall': 0.3254639355742297}
[INFO] - 02-27 19:06:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[106] Complete. Time taken: 00:00:35.938
[INFO] - 02-27 19:06:44 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:06:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:06:44 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:06:44 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:06:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:06:44 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2213, 2221, 1]
[INFO] - 02-27 19:06:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:06:55 - [main.backward:225]: Epoch 107/500 - Iteration 30/95 - Time 0.369 batch, 0.068 data, 0.333 forward
[INFO] - 02-27 19:06:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0037)
[INFO] - 02-27 19:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5897 (0.5855)
[INFO] - 02-27 19:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5421)
[INFO] - 02-27 19:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9455 (32.0038)
[INFO] - 02-27 19:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.4231 (374.1376)
[INFO] - 02-27 19:06:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:06:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9566)
[INFO] - 02-27 19:07:12 - [main.backward:225]: Epoch 107/500 - Iteration 80/95 - Time 0.354 batch, 0.048 data, 0.318 forward
[INFO] - 02-27 19:07:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:07:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0037)
[INFO] - 02-27 19:07:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5826 (0.5859)
[INFO] - 02-27 19:07:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5423 (-287.5442)
[INFO] - 02-27 19:07:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1081 (32.0337)
[INFO] - 02-27 19:07:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.9430 (374.2131)
[INFO] - 02-27 19:07:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:07:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9591)
[INFO] - 02-27 19:07:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:07:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:07:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:07:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:07:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:07:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:07:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:07:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.129
[INFO] - 02-27 19:07:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.130
[INFO] - 02-27 19:07:21 - [main.summary_metrics:168]: Epoch 107/500 - Test Results:
{'auc': 0.8482968677667144,
 'f1': 0.41333228114478116,
 'loss': 0.4435803224138741,
 'ndcg': 0.7231253843308602,
 'precision': 0.553125,
 'recall': 0.33033963585434173}
[INFO] - 02-27 19:07:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[107] Complete. Time taken: 00:00:36.647
[INFO] - 02-27 19:07:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:07:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:07:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:07:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:07:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:07:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2182, 2209, 1]
[INFO] - 02-27 19:07:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:07:34 - [main.backward:225]: Epoch 108/500 - Iteration 35/95 - Time 0.391 batch, 0.068 data, 0.351 forward
[INFO] - 02-27 19:07:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:07:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0035)
[INFO] - 02-27 19:07:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5832 (0.5863)
[INFO] - 02-27 19:07:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5431 (-287.5439)
[INFO] - 02-27 19:07:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0291 (32.0258)
[INFO] - 02-27 19:07:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.4300 (373.7446)
[INFO] - 02-27 19:07:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:07:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9609)
[INFO] - 02-27 19:07:52 - [main.backward:225]: Epoch 108/500 - Iteration 85/95 - Time 0.367 batch, 0.049 data, 0.329 forward
[INFO] - 02-27 19:07:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:07:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0035)
[INFO] - 02-27 19:07:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5861)
[INFO] - 02-27 19:07:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5433)
[INFO] - 02-27 19:07:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9453 (31.9824)
[INFO] - 02-27 19:07:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.0136 (373.6689)
[INFO] - 02-27 19:07:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:07:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9608)
[INFO] - 02-27 19:07:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:07:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:07:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:07:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:07:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:07:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:07:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:07:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.799
[INFO] - 02-27 19:07:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.801
[INFO] - 02-27 19:07:58 - [main.summary_metrics:168]: Epoch 108/500 - Test Results:
{'auc': 0.8505291981375883,
 'f1': 0.4274063552188552,
 'loss': 0.44042966296233227,
 'ndcg': 0.7299887583962372,
 'precision': 0.571875,
 'recall': 0.3416141456582633}
[INFO] - 02-27 19:07:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[108] Complete. Time taken: 00:00:37.350
[INFO] - 02-27 19:07:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:07:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:07:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:07:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:07:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:07:58 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3084, 2209, 2219, 1]
[INFO] - 02-27 19:07:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:08:12 - [main.backward:225]: Epoch 109/500 - Iteration 40/95 - Time 0.351 batch, 0.060 data, 0.315 forward
[INFO] - 02-27 19:08:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:08:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0036)
[INFO] - 02-27 19:08:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5916 (0.5864)
[INFO] - 02-27 19:08:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5472)
[INFO] - 02-27 19:08:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0596 (31.9866)
[INFO] - 02-27 19:08:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.2090 (373.7519)
[INFO] - 02-27 19:08:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:08:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9575)
[INFO] - 02-27 19:08:27 - [main.backward:225]: Epoch 109/500 - Iteration 90/95 - Time 0.316 batch, 0.044 data, 0.282 forward
[INFO] - 02-27 19:08:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:08:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0057 (0.0034)
[INFO] - 02-27 19:08:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5934 (0.5865)
[INFO] - 02-27 19:08:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5417 (-287.5428)
[INFO] - 02-27 19:08:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1154 (31.9850)
[INFO] - 02-27 19:08:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 375.0567 (373.7306)
[INFO] - 02-27 19:08:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:08:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9655)
[INFO] - 02-27 19:08:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:08:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:08:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:08:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:08:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:08:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:08:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:08:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.581
[INFO] - 02-27 19:08:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.582
[INFO] - 02-27 19:08:31 - [main.summary_metrics:168]: Epoch 109/500 - Test Results:
{'auc': 0.8463344503855463,
 'f1': 0.40899200336700336,
 'loss': 0.441292325049255,
 'ndcg': 0.7206123777350655,
 'precision': 0.546875,
 'recall': 0.32705707282913166}
[INFO] - 02-27 19:08:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[109] Complete. Time taken: 00:00:32.502
[INFO] - 02-27 19:08:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:08:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:08:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:08:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:08:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:08:31 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3097, 2202, 2209, 1]
[INFO] - 02-27 19:08:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:08:44 - [main.backward:225]: Epoch 110/500 - Iteration 45/95 - Time 0.303 batch, 0.048 data, 0.273 forward
[INFO] - 02-27 19:08:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:08:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0037)
[INFO] - 02-27 19:08:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5867)
[INFO] - 02-27 19:08:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5434)
[INFO] - 02-27 19:08:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9663 (32.0212)
[INFO] - 02-27 19:08:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.1899 (373.6685)
[INFO] - 02-27 19:08:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:08:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9583)
[INFO] - 02-27 19:08:58 - [main.backward:225]: Epoch 110/500 - Iteration 0/95 - Time 0.292 batch, 0.039 data, 0.262 forward
[INFO] - 02-27 19:08:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:08:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0038)
[INFO] - 02-27 19:08:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5867)
[INFO] - 02-27 19:08:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5451 (-287.5415)
[INFO] - 02-27 19:08:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8968 (32.0362)
[INFO] - 02-27 19:08:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.7210 (373.5024)
[INFO] - 02-27 19:08:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:08:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9578)
[INFO] - 02-27 19:08:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:08:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:08:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:08:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:08:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:08:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:08:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:09:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.433
[INFO] - 02-27 19:09:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.434
[INFO] - 02-27 19:09:01 - [main.summary_metrics:168]: Epoch 110/500 - Test Results:
{'auc': 0.8490186834537737,
 'f1': 0.40691393097643097,
 'loss': 0.4413465782143273,
 'ndcg': 0.7248097986770581,
 'precision': 0.54375,
 'recall': 0.32559086134453785}
[INFO] - 02-27 19:09:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[110] Complete. Time taken: 00:00:30.178
[INFO] - 02-27 19:09:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:09:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:09:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:09:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:09:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:09:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3039, 2186, 2223, 1]
[INFO] - 02-27 19:09:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:09:16 - [main.backward:225]: Epoch 111/500 - Iteration 50/95 - Time 0.311 batch, 0.050 data, 0.278 forward
[INFO] - 02-27 19:09:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:09:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0035)
[INFO] - 02-27 19:09:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5873 (0.5850)
[INFO] - 02-27 19:09:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5440 (-287.5426)
[INFO] - 02-27 19:09:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0664 (32.0294)
[INFO] - 02-27 19:09:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.8978 (373.5954)
[INFO] - 02-27 19:09:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:09:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9627)
[INFO] - 02-27 19:09:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:09:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:09:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:09:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:09:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:09:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:09:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:09:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.636
[INFO] - 02-27 19:09:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.638
[INFO] - 02-27 19:09:32 - [main.summary_metrics:168]: Epoch 111/500 - Test Results:
{'auc': 0.8504089196953291,
 'f1': 0.4204619107744108,
 'loss': 0.4394269069282406,
 'ndcg': 0.717734184367312,
 'precision': 0.5625,
 'recall': 0.3360994397759104}
[INFO] - 02-27 19:09:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[111] Complete. Time taken: 00:00:31.353
[INFO] - 02-27 19:09:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:09:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:09:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:09:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:09:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:09:32 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3024, 2190, 2202, 1]
[INFO] - 02-27 19:09:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:09:34 - [main.backward:225]: Epoch 112/500 - Iteration 5/95 - Time 0.428 batch, 0.184 data, 0.392 forward
[INFO] - 02-27 19:09:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:09:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0034)
[INFO] - 02-27 19:09:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5930 (0.5865)
[INFO] - 02-27 19:09:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5387 (-287.5420)
[INFO] - 02-27 19:09:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0287 (32.0359)
[INFO] - 02-27 19:09:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.1162 (373.3802)
[INFO] - 02-27 19:09:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:09:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9650)
[INFO] - 02-27 19:09:49 - [main.backward:225]: Epoch 112/500 - Iteration 55/95 - Time 0.301 batch, 0.045 data, 0.270 forward
[INFO] - 02-27 19:09:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:09:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0040)
[INFO] - 02-27 19:09:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5857)
[INFO] - 02-27 19:09:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5383 (-287.5402)
[INFO] - 02-27 19:09:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1095 (32.0852)
[INFO] - 02-27 19:09:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.1834 (373.3742)
[INFO] - 02-27 19:09:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:09:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9544)
[INFO] - 02-27 19:10:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:10:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:10:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:10:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:10:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:10:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:10:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:10:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.683
[INFO] - 02-27 19:10:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.684
[INFO] - 02-27 19:10:04 - [main.summary_metrics:168]: Epoch 112/500 - Test Results:
{'auc': 0.85005893227389,
 'f1': 0.42075126262626267,
 'loss': 0.44650234811755285,
 'ndcg': 0.7208811420116645,
 'precision': 0.5625,
 'recall': 0.3364933473389356}
[INFO] - 02-27 19:10:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[112] Complete. Time taken: 00:00:31.377
[INFO] - 02-27 19:10:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:10:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:10:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:10:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:10:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:10:04 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2193, 2199, 1]
[INFO] - 02-27 19:10:04 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:10:07 - [main.backward:225]: Epoch 113/500 - Iteration 10/95 - Time 0.368 batch, 0.112 data, 0.330 forward
[INFO] - 02-27 19:10:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0037)
[INFO] - 02-27 19:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5926 (0.5855)
[INFO] - 02-27 19:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5415 (-287.5401)
[INFO] - 02-27 19:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1039 (32.0756)
[INFO] - 02-27 19:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.9794 (373.3572)
[INFO] - 02-27 19:10:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:10:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9589)
[INFO] - 02-27 19:10:22 - [main.backward:225]: Epoch 113/500 - Iteration 60/95 - Time 0.303 batch, 0.047 data, 0.268 forward
[INFO] - 02-27 19:10:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:10:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0038)
[INFO] - 02-27 19:10:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5823 (0.5856)
[INFO] - 02-27 19:10:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5376 (-287.5401)
[INFO] - 02-27 19:10:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0702 (32.0584)
[INFO] - 02-27 19:10:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.1480 (373.5711)
[INFO] - 02-27 19:10:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:10:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9580)
[INFO] - 02-27 19:10:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:10:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:10:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:10:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:10:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:10:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:10:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:10:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.716
[INFO] - 02-27 19:10:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.716
[INFO] - 02-27 19:10:35 - [main.summary_metrics:168]: Epoch 113/500 - Test Results:
{'auc': 0.8482684282659141,
 'f1': 0.41101746632996633,
 'loss': 0.4452252045975774,
 'ndcg': 0.7260737483464645,
 'precision': 0.55,
 'recall': 0.3285014005602241}
[INFO] - 02-27 19:10:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[113] Complete. Time taken: 00:00:31.535
[INFO] - 02-27 19:10:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:10:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:10:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:10:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:10:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:10:35 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2200, 2244, 1]
[INFO] - 02-27 19:10:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:10:41 - [main.backward:225]: Epoch 114/500 - Iteration 15/95 - Time 0.380 batch, 0.092 data, 0.343 forward
[INFO] - 02-27 19:10:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:10:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0037)
[INFO] - 02-27 19:10:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5828 (0.5866)
[INFO] - 02-27 19:10:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5420 (-287.5408)
[INFO] - 02-27 19:10:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0125 (32.0305)
[INFO] - 02-27 19:10:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.0768 (373.5431)
[INFO] - 02-27 19:10:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:10:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9597)
[INFO] - 02-27 19:10:56 - [main.backward:225]: Epoch 114/500 - Iteration 65/95 - Time 0.330 batch, 0.049 data, 0.294 forward
[INFO] - 02-27 19:10:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0035)
[INFO] - 02-27 19:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5901 (0.5871)
[INFO] - 02-27 19:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5402 (-287.5419)
[INFO] - 02-27 19:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.1293 (32.0582)
[INFO] - 02-27 19:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.7073 (373.5569)
[INFO] - 02-27 19:10:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:10:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9608)
[INFO] - 02-27 19:11:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:11:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:11:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:11:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:11:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:11:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:11:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:11:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.715
[INFO] - 02-27 19:11:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.715
[INFO] - 02-27 19:11:09 - [main.summary_metrics:168]: Epoch 114/500 - Test Results:
{'auc': 0.8494261099660452,
 'f1': 0.3976546717171717,
 'loss': 0.44090688625482477,
 'ndcg': 0.7107210808581803,
 'precision': 0.53125,
 'recall': 0.3182379201680672}
[INFO] - 02-27 19:11:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[114] Complete. Time taken: 00:00:33.627
[INFO] - 02-27 19:11:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:11:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:11:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:11:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:11:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:11:09 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3072, 2200, 2211, 1]
[INFO] - 02-27 19:11:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:11:16 - [main.backward:225]: Epoch 115/500 - Iteration 20/95 - Time 0.356 batch, 0.080 data, 0.317 forward
[INFO] - 02-27 19:11:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0034)
[INFO] - 02-27 19:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5869)
[INFO] - 02-27 19:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5433 (-287.5425)
[INFO] - 02-27 19:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0618 (32.0276)
[INFO] - 02-27 19:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.8293 (373.4909)
[INFO] - 02-27 19:11:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9614)
[INFO] - 02-27 19:11:31 - [main.backward:225]: Epoch 115/500 - Iteration 70/95 - Time 0.315 batch, 0.046 data, 0.281 forward
[INFO] - 02-27 19:11:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:11:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0035)
[INFO] - 02-27 19:11:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5809 (0.5863)
[INFO] - 02-27 19:11:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5488 (-287.5453)
[INFO] - 02-27 19:11:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9013 (31.9992)
[INFO] - 02-27 19:11:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.1642 (373.4071)
[INFO] - 02-27 19:11:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:11:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9602)
[INFO] - 02-27 19:11:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:11:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:11:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:11:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:11:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:11:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:11:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:11:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.535
[INFO] - 02-27 19:11:41 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.537
[INFO] - 02-27 19:11:41 - [main.summary_metrics:168]: Epoch 115/500 - Test Results:
{'auc': 0.8419599002591233,
 'f1': 0.39331439393939394,
 'loss': 0.4455851301008629,
 'ndcg': 0.7142918223746392,
 'precision': 0.525,
 'recall': 0.31495535714285716}
[INFO] - 02-27 19:11:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[115] Complete. Time taken: 00:00:32.181
[INFO] - 02-27 19:11:41 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:11:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:11:41 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:11:41 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:11:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:11:41 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3030, 2185, 2178, 1]
[INFO] - 02-27 19:11:42 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:11:49 - [main.backward:225]: Epoch 116/500 - Iteration 25/95 - Time 0.329 batch, 0.068 data, 0.291 forward
[INFO] - 02-27 19:11:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:11:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0034)
[INFO] - 02-27 19:11:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5860)
[INFO] - 02-27 19:11:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5484)
[INFO] - 02-27 19:11:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9502 (31.9805)
[INFO] - 02-27 19:11:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9061 (372.8669)
[INFO] - 02-27 19:11:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:11:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9611)
[INFO] - 02-27 19:12:04 - [main.backward:225]: Epoch 116/500 - Iteration 75/95 - Time 0.307 batch, 0.044 data, 0.273 forward
[INFO] - 02-27 19:12:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0035)
[INFO] - 02-27 19:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5850 (0.5856)
[INFO] - 02-27 19:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5444)
[INFO] - 02-27 19:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9817 (32.0237)
[INFO] - 02-27 19:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2187 (373.0840)
[INFO] - 02-27 19:12:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9592)
[INFO] - 02-27 19:12:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:12:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:12:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:12:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:12:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:12:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:12:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:12:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.550
[INFO] - 02-27 19:12:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.551
[INFO] - 02-27 19:12:12 - [main.summary_metrics:168]: Epoch 116/500 - Test Results:
{'auc': 0.8485585048970569,
 'f1': 0.40970328282828283,
 'loss': 0.44097899217148173,
 'ndcg': 0.7197315898150488,
 'precision': 0.546875,
 'recall': 0.3280681022408964}
[INFO] - 02-27 19:12:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[116] Complete. Time taken: 00:00:31.298
[INFO] - 02-27 19:12:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:12:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:12:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:12:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:12:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:12:12 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2180, 2216, 1]
[INFO] - 02-27 19:12:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:12:22 - [main.backward:225]: Epoch 117/500 - Iteration 30/95 - Time 0.318 batch, 0.057 data, 0.285 forward
[INFO] - 02-27 19:12:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:12:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0034)
[INFO] - 02-27 19:12:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5858)
[INFO] - 02-27 19:12:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5434 (-287.5458)
[INFO] - 02-27 19:12:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0965 (32.0240)
[INFO] - 02-27 19:12:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 374.0696 (373.0955)
[INFO] - 02-27 19:12:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:12:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9650)
[INFO] - 02-27 19:12:37 - [main.backward:225]: Epoch 117/500 - Iteration 80/95 - Time 0.308 batch, 0.043 data, 0.275 forward
[INFO] - 02-27 19:12:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:12:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0034)
[INFO] - 02-27 19:12:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5828 (0.5866)
[INFO] - 02-27 19:12:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5462 (-287.5461)
[INFO] - 02-27 19:12:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9907 (32.0213)
[INFO] - 02-27 19:12:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2713 (372.9521)
[INFO] - 02-27 19:12:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:12:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9644)
[INFO] - 02-27 19:12:41 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:12:41 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:12:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:12:41 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:12:41 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:12:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:12:41 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:12:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.801
[INFO] - 02-27 19:12:44 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.802
[INFO] - 02-27 19:12:44 - [main.summary_metrics:168]: Epoch 117/500 - Test Results:
{'auc': 0.8446770589976187,
 'f1': 0.40959911616161615,
 'loss': 0.4465959082617081,
 'ndcg': 0.7210300791618925,
 'precision': 0.546875,
 'recall': 0.32791929271708686}
[INFO] - 02-27 19:12:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[117] Complete. Time taken: 00:00:32.033
[INFO] - 02-27 19:12:44 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:12:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:12:44 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:12:44 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:12:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:12:44 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3023, 2212, 2199, 1]
[INFO] - 02-27 19:12:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:12:56 - [main.backward:225]: Epoch 118/500 - Iteration 35/95 - Time 0.324 batch, 0.056 data, 0.291 forward
[INFO] - 02-27 19:12:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:12:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0068 (0.0035)
[INFO] - 02-27 19:12:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5868 (0.5861)
[INFO] - 02-27 19:12:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5466)
[INFO] - 02-27 19:12:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0012 (31.9976)
[INFO] - 02-27 19:12:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.2139 (372.9026)
[INFO] - 02-27 19:12:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:12:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9595)
[INFO] - 02-27 19:13:10 - [main.backward:225]: Epoch 118/500 - Iteration 85/95 - Time 0.306 batch, 0.042 data, 0.273 forward
[INFO] - 02-27 19:13:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0033)
[INFO] - 02-27 19:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5857)
[INFO] - 02-27 19:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5472 (-287.5470)
[INFO] - 02-27 19:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9566 (31.9623)
[INFO] - 02-27 19:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.5656 (372.9624)
[INFO] - 02-27 19:13:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9639)
[INFO] - 02-27 19:13:13 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:13:13 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:13:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:13:13 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:13:13 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:13:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:13:13 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:13:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.700
[INFO] - 02-27 19:13:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.702
[INFO] - 02-27 19:13:16 - [main.summary_metrics:168]: Epoch 118/500 - Test Results:
{'auc': 0.8481538881483967,
 'f1': 0.4088878367003367,
 'loss': 0.442012204110795,
 'ndcg': 0.7196389051095187,
 'precision': 0.546875,
 'recall': 0.3269082633053222}
[INFO] - 02-27 19:13:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[118] Complete. Time taken: 00:00:31.757
[INFO] - 02-27 19:13:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:13:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:13:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:13:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:13:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:13:16 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2192, 2208, 1]
[INFO] - 02-27 19:13:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:13:29 - [main.backward:225]: Epoch 119/500 - Iteration 40/95 - Time 0.321 batch, 0.056 data, 0.290 forward
[INFO] - 02-27 19:13:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:13:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0033)
[INFO] - 02-27 19:13:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5860)
[INFO] - 02-27 19:13:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5389 (-287.5432)
[INFO] - 02-27 19:13:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0326 (31.9599)
[INFO] - 02-27 19:13:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.2687 (372.8144)
[INFO] - 02-27 19:13:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:13:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9636)
[INFO] - 02-27 19:13:44 - [main.backward:225]: Epoch 119/500 - Iteration 90/95 - Time 0.312 batch, 0.045 data, 0.278 forward
[INFO] - 02-27 19:13:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0034)
[INFO] - 02-27 19:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5853)
[INFO] - 02-27 19:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5431 (-287.5412)
[INFO] - 02-27 19:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9338 (31.9474)
[INFO] - 02-27 19:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.8122 (372.9914)
[INFO] - 02-27 19:13:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:13:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9620)
[INFO] - 02-27 19:13:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:13:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:13:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:13:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:13:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:13:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:13:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:13:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.745
[INFO] - 02-27 19:13:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.746
[INFO] - 02-27 19:13:48 - [main.summary_metrics:168]: Epoch 119/500 - Test Results:
{'auc': 0.8452302420355398,
 'f1': 0.41554292929292935,
 'loss': 0.4462978892302111,
 'ndcg': 0.7139261122236253,
 'precision': 0.55625,
 'recall': 0.33202906162464985}
[INFO] - 02-27 19:13:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[119] Complete. Time taken: 00:00:32.425
[INFO] - 02-27 19:13:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:13:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:13:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:13:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:13:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:13:48 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3056, 2201, 2219, 1]
[INFO] - 02-27 19:13:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:14:03 - [main.backward:225]: Epoch 120/500 - Iteration 45/95 - Time 0.316 batch, 0.049 data, 0.280 forward
[INFO] - 02-27 19:14:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:14:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0034)
[INFO] - 02-27 19:14:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5857)
[INFO] - 02-27 19:14:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5462 (-287.5454)
[INFO] - 02-27 19:14:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9343 (31.9851)
[INFO] - 02-27 19:14:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4683 (372.8726)
[INFO] - 02-27 19:14:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:14:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9641)
[INFO] - 02-27 19:14:17 - [main.backward:225]: Epoch 120/500 - Iteration 0/95 - Time 0.305 batch, 0.041 data, 0.271 forward
[INFO] - 02-27 19:14:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:14:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0034)
[INFO] - 02-27 19:14:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5860)
[INFO] - 02-27 19:14:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5443)
[INFO] - 02-27 19:14:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9698 (31.9783)
[INFO] - 02-27 19:14:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.5830 (373.0553)
[INFO] - 02-27 19:14:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:14:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9644)
[INFO] - 02-27 19:14:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:14:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:14:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:14:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:14:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:14:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:14:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:14:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.551
[INFO] - 02-27 19:14:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.552
[INFO] - 02-27 19:14:20 - [main.summary_metrics:168]: Epoch 120/500 - Test Results:
{'auc': 0.8421750434242323,
 'f1': 0.4107281144781145,
 'loss': 0.44710653745173556,
 'ndcg': 0.7161597902267367,
 'precision': 0.5499999999999999,
 'recall': 0.3281074929971989}
[INFO] - 02-27 19:14:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[120] Complete. Time taken: 00:00:31.572
[INFO] - 02-27 19:14:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:14:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:14:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:14:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:14:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:14:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3085, 2202, 2214, 1]
[INFO] - 02-27 19:14:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:14:35 - [main.backward:225]: Epoch 121/500 - Iteration 50/95 - Time 0.303 batch, 0.046 data, 0.273 forward
[INFO] - 02-27 19:14:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:14:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0034)
[INFO] - 02-27 19:14:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5910 (0.5855)
[INFO] - 02-27 19:14:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5457)
[INFO] - 02-27 19:14:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9520 (31.9953)
[INFO] - 02-27 19:14:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.8763 (373.1204)
[INFO] - 02-27 19:14:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:14:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9630)
[INFO] - 02-27 19:14:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:14:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:14:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:14:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:14:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:14:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:14:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:14:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.662
[INFO] - 02-27 19:14:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.663
[INFO] - 02-27 19:14:51 - [main.summary_metrics:168]: Epoch 121/500 - Test Results:
{'auc': 0.8475867509381203,
 'f1': 0.406913930976431,
 'loss': 0.4438487832891883,
 'ndcg': 0.7214796667347688,
 'precision': 0.54375,
 'recall': 0.32559086134453785}
[INFO] - 02-27 19:14:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[121] Complete. Time taken: 00:00:30.978
[INFO] - 02-27 19:14:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:14:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:14:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:14:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:14:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:14:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2196, 2223, 1]
[INFO] - 02-27 19:14:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:14:53 - [main.backward:225]: Epoch 122/500 - Iteration 5/95 - Time 0.438 batch, 0.178 data, 0.411 forward
[INFO] - 02-27 19:14:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:14:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0036)
[INFO] - 02-27 19:14:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5840 (0.5848)
[INFO] - 02-27 19:14:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5473 (-287.5473)
[INFO] - 02-27 19:14:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9991 (31.9863)
[INFO] - 02-27 19:14:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6138 (372.5691)
[INFO] - 02-27 19:14:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:14:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9600)
[INFO] - 02-27 19:15:08 - [main.backward:225]: Epoch 122/500 - Iteration 55/95 - Time 0.307 batch, 0.048 data, 0.274 forward
[INFO] - 02-27 19:15:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 19:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5846 (0.5863)
[INFO] - 02-27 19:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5494 (-287.5477)
[INFO] - 02-27 19:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8223 (31.9723)
[INFO] - 02-27 19:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2350 (372.5812)
[INFO] - 02-27 19:15:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:15:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9647)
[INFO] - 02-27 19:15:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:15:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:15:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:15:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:15:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:15:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:15:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:15:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.599
[INFO] - 02-27 19:15:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.600
[INFO] - 02-27 19:15:22 - [main.summary_metrics:168]: Epoch 122/500 - Test Results:
{'auc': 0.8479510711760194,
 'f1': 0.4163583754208754,
 'loss': 0.4398254004571548,
 'ndcg': 0.7291742589369923,
 'precision': 0.5562499999999999,
 'recall': 0.3331889005602241}
[INFO] - 02-27 19:15:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[122] Complete. Time taken: 00:00:31.508
[INFO] - 02-27 19:15:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:15:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:15:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:15:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:15:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:15:22 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2214, 2194, 1]
[INFO] - 02-27 19:15:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:15:26 - [main.backward:225]: Epoch 123/500 - Iteration 10/95 - Time 0.370 batch, 0.109 data, 0.335 forward
[INFO] - 02-27 19:15:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:15:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0034)
[INFO] - 02-27 19:15:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5866)
[INFO] - 02-27 19:15:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5452)
[INFO] - 02-27 19:15:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9457 (31.9257)
[INFO] - 02-27 19:15:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.3036 (372.2912)
[INFO] - 02-27 19:15:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:15:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9616)
[INFO] - 02-27 19:15:41 - [main.backward:225]: Epoch 123/500 - Iteration 60/95 - Time 0.304 batch, 0.044 data, 0.273 forward
[INFO] - 02-27 19:15:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0033)
[INFO] - 02-27 19:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5872)
[INFO] - 02-27 19:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5477 (-287.5448)
[INFO] - 02-27 19:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9217 (31.9025)
[INFO] - 02-27 19:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9484 (372.3768)
[INFO] - 02-27 19:15:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:15:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9625)
[INFO] - 02-27 19:15:51 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:15:51 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:15:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:15:51 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:15:51 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:15:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:15:51 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:15:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.515
[INFO] - 02-27 19:15:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.515
[INFO] - 02-27 19:15:53 - [main.summary_metrics:168]: Epoch 123/500 - Test Results:
{'auc': 0.8474280479961592,
 'f1': 0.409413930976431,
 'loss': 0.44745190284023734,
 'ndcg': 0.7195508790501818,
 'precision': 0.546875,
 'recall': 0.3276741946778712}
[INFO] - 02-27 19:15:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[123] Complete. Time taken: 00:00:30.861
[INFO] - 02-27 19:15:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:15:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:15:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:15:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:15:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:15:53 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2202, 2193, 1]
[INFO] - 02-27 19:15:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:15:58 - [main.backward:225]: Epoch 124/500 - Iteration 15/95 - Time 0.338 batch, 0.089 data, 0.302 forward
[INFO] - 02-27 19:15:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0037)
[INFO] - 02-27 19:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5939 (0.5867)
[INFO] - 02-27 19:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5487)
[INFO] - 02-27 19:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9202 (31.9162)
[INFO] - 02-27 19:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.1665 (372.2872)
[INFO] - 02-27 19:15:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:15:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9567)
[INFO] - 02-27 19:16:13 - [main.backward:225]: Epoch 124/500 - Iteration 65/95 - Time 0.298 batch, 0.046 data, 0.265 forward
[INFO] - 02-27 19:16:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0036)
[INFO] - 02-27 19:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5831 (0.5869)
[INFO] - 02-27 19:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5423 (-287.5453)
[INFO] - 02-27 19:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0149 (31.9002)
[INFO] - 02-27 19:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.5746 (372.3871)
[INFO] - 02-27 19:16:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:16:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9627)
[INFO] - 02-27 19:16:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:16:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:16:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:16:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:16:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:16:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:16:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:16:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.525
[INFO] - 02-27 19:16:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.526
[INFO] - 02-27 19:16:24 - [main.summary_metrics:168]: Epoch 124/500 - Test Results:
{'auc': 0.8454856098076486,
 'f1': 0.3970244107744108,
 'loss': 0.44481969216105066,
 'ndcg': 0.7136839480248431,
 'precision': 0.53125,
 'recall': 0.31732317927170867}
[INFO] - 02-27 19:16:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[124] Complete. Time taken: 00:00:30.567
[INFO] - 02-27 19:16:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:16:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:16:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:16:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:16:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:16:24 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3078, 2205, 2223, 1]
[INFO] - 02-27 19:16:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:16:30 - [main.backward:225]: Epoch 125/500 - Iteration 20/95 - Time 0.328 batch, 0.069 data, 0.294 forward
[INFO] - 02-27 19:16:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0037)
[INFO] - 02-27 19:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5823 (0.5855)
[INFO] - 02-27 19:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5392 (-287.5405)
[INFO] - 02-27 19:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9122 (31.9326)
[INFO] - 02-27 19:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0740 (372.7599)
[INFO] - 02-27 19:16:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9573)
[INFO] - 02-27 19:16:45 - [main.backward:225]: Epoch 125/500 - Iteration 70/95 - Time 0.296 batch, 0.043 data, 0.263 forward
[INFO] - 02-27 19:16:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:16:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0037)
[INFO] - 02-27 19:16:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5854)
[INFO] - 02-27 19:16:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5429)
[INFO] - 02-27 19:16:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9239 (31.9208)
[INFO] - 02-27 19:16:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3240 (372.5699)
[INFO] - 02-27 19:16:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:16:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9578)
[INFO] - 02-27 19:16:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:16:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:16:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:16:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:16:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:16:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:16:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:16:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.575
[INFO] - 02-27 19:16:54 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.575
[INFO] - 02-27 19:16:54 - [main.summary_metrics:168]: Epoch 125/500 - Test Results:
{'auc': 0.8459556852152627,
 'f1': 0.39915404040404046,
 'loss': 0.4452501582679094,
 'ndcg': 0.7189002867935181,
 'precision': 0.534375,
 'recall': 0.3189163165266107}
[INFO] - 02-27 19:16:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[125] Complete. Time taken: 00:00:30.342
[INFO] - 02-27 19:16:54 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:16:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:16:54 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:16:54 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:16:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:16:54 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3069, 2189, 2217, 1]
[INFO] - 02-27 19:16:55 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:17:02 - [main.backward:225]: Epoch 126/500 - Iteration 25/95 - Time 0.318 batch, 0.065 data, 0.285 forward
[INFO] - 02-27 19:17:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:17:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0035)
[INFO] - 02-27 19:17:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5850)
[INFO] - 02-27 19:17:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5447)
[INFO] - 02-27 19:17:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9533 (31.9307)
[INFO] - 02-27 19:17:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.2751 (372.3952)
[INFO] - 02-27 19:17:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:17:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9602)
[INFO] - 02-27 19:17:16 - [main.backward:225]: Epoch 126/500 - Iteration 75/95 - Time 0.294 batch, 0.043 data, 0.261 forward
[INFO] - 02-27 19:17:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:17:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0037)
[INFO] - 02-27 19:17:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5861)
[INFO] - 02-27 19:17:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5442)
[INFO] - 02-27 19:17:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9750 (31.9365)
[INFO] - 02-27 19:17:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.1066 (372.6075)
[INFO] - 02-27 19:17:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:17:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9577)
[INFO] - 02-27 19:17:22 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:17:22 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:17:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:17:22 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:17:22 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:17:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:17:22 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:17:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.449
[INFO] - 02-27 19:17:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.451
[INFO] - 02-27 19:17:25 - [main.summary_metrics:168]: Epoch 126/500 - Test Results:
{'auc': 0.843474739221669,
 'f1': 0.42306607744107744,
 'loss': 0.4464854107664076,
 'ndcg': 0.726131662728168,
 'precision': 0.565625,
 'recall': 0.3383315826330532}
[INFO] - 02-27 19:17:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[126] Complete. Time taken: 00:00:30.513
[INFO] - 02-27 19:17:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:17:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:17:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:17:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:17:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:17:25 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3065, 2198, 2235, 1]
[INFO] - 02-27 19:17:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:17:34 - [main.backward:225]: Epoch 127/500 - Iteration 30/95 - Time 0.304 batch, 0.053 data, 0.278 forward
[INFO] - 02-27 19:17:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:17:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0036)
[INFO] - 02-27 19:17:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5874 (0.5853)
[INFO] - 02-27 19:17:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5516 (-287.5486)
[INFO] - 02-27 19:17:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9923 (31.9617)
[INFO] - 02-27 19:17:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.2943 (372.7874)
[INFO] - 02-27 19:17:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:17:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9606)
[INFO] - 02-27 19:17:48 - [main.backward:225]: Epoch 127/500 - Iteration 80/95 - Time 0.292 batch, 0.039 data, 0.263 forward
[INFO] - 02-27 19:17:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:17:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0034)
[INFO] - 02-27 19:17:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5840 (0.5845)
[INFO] - 02-27 19:17:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5490 (-287.5488)
[INFO] - 02-27 19:17:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9304 (31.9626)
[INFO] - 02-27 19:17:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.6164 (372.6024)
[INFO] - 02-27 19:17:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:17:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9617)
[INFO] - 02-27 19:17:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:17:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:17:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:17:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:17:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:17:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:17:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:17:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.512
[INFO] - 02-27 19:17:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.514
[INFO] - 02-27 19:17:55 - [main.summary_metrics:168]: Epoch 127/500 - Test Results:
{'auc': 0.8465072438289041,
 'f1': 0.4091245791245791,
 'loss': 0.4395566164079699,
 'ndcg': 0.7203075020647406,
 'precision': 0.546875,
 'recall': 0.32728028711484597}
[INFO] - 02-27 19:17:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[127] Complete. Time taken: 00:00:30.158
[INFO] - 02-27 19:17:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:17:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:17:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:17:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:17:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:17:55 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2187, 2207, 1]
[INFO] - 02-27 19:17:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:18:06 - [main.backward:225]: Epoch 128/500 - Iteration 35/95 - Time 0.306 batch, 0.057 data, 0.271 forward
[INFO] - 02-27 19:18:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:18:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0036)
[INFO] - 02-27 19:18:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5941 (0.5860)
[INFO] - 02-27 19:18:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5423 (-287.5472)
[INFO] - 02-27 19:18:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9050 (31.9214)
[INFO] - 02-27 19:18:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7261 (372.4510)
[INFO] - 02-27 19:18:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:18:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9570)
[INFO] - 02-27 19:18:20 - [main.backward:225]: Epoch 128/500 - Iteration 85/95 - Time 0.291 batch, 0.040 data, 0.261 forward
[INFO] - 02-27 19:18:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:18:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0036)
[INFO] - 02-27 19:18:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5912 (0.5851)
[INFO] - 02-27 19:18:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5503 (-287.5477)
[INFO] - 02-27 19:18:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 32.0032 (31.9604)
[INFO] - 02-27 19:18:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4266 (372.5010)
[INFO] - 02-27 19:18:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:18:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9628)
[INFO] - 02-27 19:18:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:18:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:18:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:18:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:18:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:18:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:18:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:18:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.488
[INFO] - 02-27 19:18:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.489
[INFO] - 02-27 19:18:25 - [main.summary_metrics:168]: Epoch 128/500 - Test Results:
{'auc': 0.8476166606348421,
 'f1': 0.4140435606060606,
 'loss': 0.44209895767191065,
 'ndcg': 0.7183085820131783,
 'precision': 0.553125,
 'recall': 0.33135066526610646}
[INFO] - 02-27 19:18:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[128] Complete. Time taken: 00:00:30.228
[INFO] - 02-27 19:18:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:18:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:18:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:18:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:18:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:18:25 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3027, 2200, 2223, 1]
[INFO] - 02-27 19:18:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:18:37 - [main.backward:225]: Epoch 129/500 - Iteration 40/95 - Time 0.301 batch, 0.048 data, 0.271 forward
[INFO] - 02-27 19:18:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0013 (0.0034)
[INFO] - 02-27 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5861)
[INFO] - 02-27 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5473)
[INFO] - 02-27 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8894 (31.9264)
[INFO] - 02-27 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.3866 (372.4371)
[INFO] - 02-27 19:18:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:18:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9608)
[INFO] - 02-27 19:18:51 - [main.backward:225]: Epoch 129/500 - Iteration 90/95 - Time 0.292 batch, 0.039 data, 0.261 forward
[INFO] - 02-27 19:18:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:18:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0034)
[INFO] - 02-27 19:18:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5759 (0.5869)
[INFO] - 02-27 19:18:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5450 (-287.5446)
[INFO] - 02-27 19:18:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8894 (31.9106)
[INFO] - 02-27 19:18:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0790 (372.3576)
[INFO] - 02-27 19:18:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:18:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9627)
[INFO] - 02-27 19:18:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:18:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:18:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:18:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:18:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:18:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:18:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:18:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.090
[INFO] - 02-27 19:18:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.091
[INFO] - 02-27 19:18:55 - [main.summary_metrics:168]: Epoch 129/500 - Test Results:
{'auc': 0.8479313780046331,
 'f1': 0.4204619107744108,
 'loss': 0.44190782337945084,
 'ndcg': 0.7227464167847845,
 'precision': 0.5625,
 'recall': 0.3360994397759104}
[INFO] - 02-27 19:18:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[129] Complete. Time taken: 00:00:29.874
[INFO] - 02-27 19:18:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:18:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:18:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:18:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:18:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:18:55 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2185, 2221, 1]
[INFO] - 02-27 19:18:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:19:09 - [main.backward:225]: Epoch 130/500 - Iteration 45/95 - Time 0.304 batch, 0.050 data, 0.269 forward
[INFO] - 02-27 19:19:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0037)
[INFO] - 02-27 19:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5861)
[INFO] - 02-27 19:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5441 (-287.5441)
[INFO] - 02-27 19:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8757 (31.9237)
[INFO] - 02-27 19:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.0341 (372.5930)
[INFO] - 02-27 19:19:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:19:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9563)
[INFO] - 02-27 19:19:23 - [main.backward:225]: Epoch 130/500 - Iteration 0/95 - Time 0.296 batch, 0.041 data, 0.263 forward
[INFO] - 02-27 19:19:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:19:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0034)
[INFO] - 02-27 19:19:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5813 (0.5857)
[INFO] - 02-27 19:19:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5440 (-287.5439)
[INFO] - 02-27 19:19:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9626 (31.9235)
[INFO] - 02-27 19:19:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9604 (372.4128)
[INFO] - 02-27 19:19:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:19:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9637)
[INFO] - 02-27 19:19:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:19:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:19:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:19:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:19:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:19:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:19:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:19:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.476
[INFO] - 02-27 19:19:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.477
[INFO] - 02-27 19:19:26 - [main.summary_metrics:168]: Epoch 130/500 - Test Results:
{'auc': 0.847136663550224,
 'f1': 0.4186731902356903,
 'loss': 0.43799343898357357,
 'ndcg': 0.7239844899628108,
 'precision': 0.559375,
 'recall': 0.33502713585434174}
[INFO] - 02-27 19:19:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[130] Complete. Time taken: 00:00:30.582
[INFO] - 02-27 19:19:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:19:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:19:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:19:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:19:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:19:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3024, 2200, 2204, 1]
[INFO] - 02-27 19:19:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:19:41 - [main.backward:225]: Epoch 131/500 - Iteration 50/95 - Time 0.301 batch, 0.044 data, 0.272 forward
[INFO] - 02-27 19:19:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:19:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0033)
[INFO] - 02-27 19:19:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5809 (0.5848)
[INFO] - 02-27 19:19:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5423)
[INFO] - 02-27 19:19:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9822 (31.9021)
[INFO] - 02-27 19:19:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.6217 (372.4511)
[INFO] - 02-27 19:19:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:19:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9625)
[INFO] - 02-27 19:19:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:19:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:19:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:19:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:19:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:19:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:19:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:19:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.467
[INFO] - 02-27 19:19:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.467
[INFO] - 02-27 19:19:56 - [main.summary_metrics:168]: Epoch 131/500 - Test Results:
{'auc': 0.8464306493430707,
 'f1': 0.41635837542087545,
 'loss': 0.43959029127153715,
 'ndcg': 0.721781612066825,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 19:19:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[131] Complete. Time taken: 00:00:30.413
[INFO] - 02-27 19:19:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:19:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:19:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:19:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:19:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:19:56 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3041, 2206, 2192, 1]
[INFO] - 02-27 19:19:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:19:58 - [main.backward:225]: Epoch 132/500 - Iteration 5/95 - Time 0.437 batch, 0.184 data, 0.398 forward
[INFO] - 02-27 19:19:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:19:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0031)
[INFO] - 02-27 19:19:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5860)
[INFO] - 02-27 19:19:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5385 (-287.5422)
[INFO] - 02-27 19:19:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8656 (31.8721)
[INFO] - 02-27 19:19:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7721 (372.2336)
[INFO] - 02-27 19:19:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:19:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9661)
[INFO] - 02-27 19:20:12 - [main.backward:225]: Epoch 132/500 - Iteration 55/95 - Time 0.299 batch, 0.046 data, 0.266 forward
[INFO] - 02-27 19:20:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:20:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0033)
[INFO] - 02-27 19:20:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5852)
[INFO] - 02-27 19:20:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5440)
[INFO] - 02-27 19:20:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8842 (31.9195)
[INFO] - 02-27 19:20:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4715 (372.1150)
[INFO] - 02-27 19:20:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:20:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9619)
[INFO] - 02-27 19:20:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:20:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:20:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:20:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:20:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:20:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:20:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:20:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.573
[INFO] - 02-27 19:20:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.573
[INFO] - 02-27 19:20:26 - [main.summary_metrics:168]: Epoch 132/500 - Test Results:
{'auc': 0.8451319804269748,
 'f1': 0.40454755892255895,
 'loss': 0.44194740279202804,
 'ndcg': 0.7256944394445902,
 'precision': 0.540625,
 'recall': 0.32362570028011206}
[INFO] - 02-27 19:20:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[132] Complete. Time taken: 00:00:30.105
[INFO] - 02-27 19:20:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:20:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:20:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:20:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:20:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:20:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2194, 2216, 1]
[INFO] - 02-27 19:20:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:20:30 - [main.backward:225]: Epoch 133/500 - Iteration 10/95 - Time 0.382 batch, 0.122 data, 0.345 forward
[INFO] - 02-27 19:20:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0032)
[INFO] - 02-27 19:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5848)
[INFO] - 02-27 19:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5451)
[INFO] - 02-27 19:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9885 (31.8999)
[INFO] - 02-27 19:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.9272 (371.8254)
[INFO] - 02-27 19:20:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:20:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9642)
[INFO] - 02-27 19:20:45 - [main.backward:225]: Epoch 133/500 - Iteration 60/95 - Time 0.319 batch, 0.051 data, 0.283 forward
[INFO] - 02-27 19:20:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0033)
[INFO] - 02-27 19:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5816 (0.5850)
[INFO] - 02-27 19:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5440)
[INFO] - 02-27 19:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9260 (31.8963)
[INFO] - 02-27 19:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8882 (371.7980)
[INFO] - 02-27 19:20:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:20:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9627)
[INFO] - 02-27 19:20:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:20:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:20:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:20:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:20:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:20:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:20:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:20:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.493
[INFO] - 02-27 19:20:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.494
[INFO] - 02-27 19:20:58 - [main.summary_metrics:168]: Epoch 133/500 - Test Results:
{'auc': 0.8461741821728691,
 'f1': 0.41896254208754213,
 'loss': 0.4412489041891802,
 'ndcg': 0.7161472184438571,
 'precision': 0.5593750000000001,
 'recall': 0.33542104341736695}
[INFO] - 02-27 19:20:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[133] Complete. Time taken: 00:00:32.220
[INFO] - 02-27 19:20:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:20:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:20:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:20:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:20:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:20:58 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2205, 2202, 1]
[INFO] - 02-27 19:20:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:21:03 - [main.backward:225]: Epoch 134/500 - Iteration 15/95 - Time 0.335 batch, 0.082 data, 0.299 forward
[INFO] - 02-27 19:21:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:21:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0035)
[INFO] - 02-27 19:21:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5907 (0.5853)
[INFO] - 02-27 19:21:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5403 (-287.5442)
[INFO] - 02-27 19:21:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9026 (31.9058)
[INFO] - 02-27 19:21:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2769 (371.9930)
[INFO] - 02-27 19:21:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:21:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9589)
[INFO] - 02-27 19:21:18 - [main.backward:225]: Epoch 134/500 - Iteration 65/95 - Time 0.298 batch, 0.042 data, 0.267 forward
[INFO] - 02-27 19:21:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:21:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0036)
[INFO] - 02-27 19:21:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5860)
[INFO] - 02-27 19:21:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5366 (-287.5361)
[INFO] - 02-27 19:21:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9549 (31.9344)
[INFO] - 02-27 19:21:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0370 (371.9368)
[INFO] - 02-27 19:21:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:21:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9587)
[INFO] - 02-27 19:21:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:21:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:21:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:21:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:21:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:21:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:21:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:21:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.455
[INFO] - 02-27 19:21:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.455
[INFO] - 02-27 19:21:29 - [main.summary_metrics:168]: Epoch 134/500 - Test Results:
{'auc': 0.8458539621731045,
 'f1': 0.41393939393939394,
 'loss': 0.44269419666824894,
 'ndcg': 0.7227653884926541,
 'precision': 0.553125,
 'recall': 0.3312018557422969}
[INFO] - 02-27 19:21:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[134] Complete. Time taken: 00:00:30.414
[INFO] - 02-27 19:21:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:21:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:21:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:21:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:21:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:21:29 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3030, 2201, 2219, 1]
[INFO] - 02-27 19:21:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:21:35 - [main.backward:225]: Epoch 135/500 - Iteration 20/95 - Time 0.317 batch, 0.065 data, 0.288 forward
[INFO] - 02-27 19:21:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0035)
[INFO] - 02-27 19:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5862)
[INFO] - 02-27 19:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5408 (-287.5410)
[INFO] - 02-27 19:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9102 (31.9373)
[INFO] - 02-27 19:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4261 (371.9810)
[INFO] - 02-27 19:21:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9598)
[INFO] - 02-27 19:21:50 - [main.backward:225]: Epoch 135/500 - Iteration 70/95 - Time 0.300 batch, 0.040 data, 0.271 forward
[INFO] - 02-27 19:21:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0033)
[INFO] - 02-27 19:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5849)
[INFO] - 02-27 19:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5478 (-287.5445)
[INFO] - 02-27 19:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8897 (31.9000)
[INFO] - 02-27 19:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3139 (372.0860)
[INFO] - 02-27 19:21:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:21:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9642)
[INFO] - 02-27 19:21:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:21:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:21:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:21:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:21:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:21:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:21:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:21:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.580
[INFO] - 02-27 19:21:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.581
[INFO] - 02-27 19:21:59 - [main.summary_metrics:168]: Epoch 135/500 - Test Results:
{'auc': 0.845454002311709,
 'f1': 0.4027588383838384,
 'loss': 0.4407876690418656,
 'ndcg': 0.713315536290689,
 'precision': 0.5375000000000001,
 'recall': 0.3225533963585434}
[INFO] - 02-27 19:21:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[135] Complete. Time taken: 00:00:30.660
[INFO] - 02-27 19:21:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:21:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:21:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:21:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:21:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:21:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2205, 2223, 1]
[INFO] - 02-27 19:22:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:22:08 - [main.backward:225]: Epoch 136/500 - Iteration 25/95 - Time 0.337 batch, 0.068 data, 0.301 forward
[INFO] - 02-27 19:22:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:22:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0033)
[INFO] - 02-27 19:22:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5791 (0.5855)
[INFO] - 02-27 19:22:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5450 (-287.5476)
[INFO] - 02-27 19:22:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9058 (31.8743)
[INFO] - 02-27 19:22:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.5633 (372.1315)
[INFO] - 02-27 19:22:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:22:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9664)
[INFO] - 02-27 19:22:22 - [main.backward:225]: Epoch 136/500 - Iteration 75/95 - Time 0.306 batch, 0.043 data, 0.273 forward
[INFO] - 02-27 19:22:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:22:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0034)
[INFO] - 02-27 19:22:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5876 (0.5862)
[INFO] - 02-27 19:22:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5400 (-287.5427)
[INFO] - 02-27 19:22:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8548 (31.8825)
[INFO] - 02-27 19:22:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4315 (372.0093)
[INFO] - 02-27 19:22:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:22:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9609)
[INFO] - 02-27 19:22:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:22:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:22:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:22:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:22:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:22:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:22:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:22:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.659
[INFO] - 02-27 19:22:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.661
[INFO] - 02-27 19:22:31 - [main.summary_metrics:168]: Epoch 136/500 - Test Results:
{'auc': 0.8426715338096022,
 'f1': 0.4097032828282829,
 'loss': 0.4443474311343578,
 'ndcg': 0.7087594280680554,
 'precision': 0.546875,
 'recall': 0.32806810224089633}
[INFO] - 02-27 19:22:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[136] Complete. Time taken: 00:00:31.345
[INFO] - 02-27 19:22:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:22:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:22:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:22:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:22:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:22:31 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2204, 2198, 1]
[INFO] - 02-27 19:22:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:22:40 - [main.backward:225]: Epoch 137/500 - Iteration 30/95 - Time 0.309 batch, 0.059 data, 0.274 forward
[INFO] - 02-27 19:22:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:22:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0032)
[INFO] - 02-27 19:22:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5811 (0.5863)
[INFO] - 02-27 19:22:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5441 (-287.5445)
[INFO] - 02-27 19:22:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8424 (31.8795)
[INFO] - 02-27 19:22:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2295 (372.1487)
[INFO] - 02-27 19:22:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:22:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9631)
[INFO] - 02-27 19:22:54 - [main.backward:225]: Epoch 137/500 - Iteration 80/95 - Time 0.291 batch, 0.041 data, 0.259 forward
[INFO] - 02-27 19:22:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0033)
[INFO] - 02-27 19:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5900 (0.5869)
[INFO] - 02-27 19:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5419 (-287.5461)
[INFO] - 02-27 19:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8114 (31.8494)
[INFO] - 02-27 19:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7019 (372.2475)
[INFO] - 02-27 19:22:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9611)
[INFO] - 02-27 19:22:59 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:22:59 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:22:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:22:59 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:22:59 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:22:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:22:59 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:23:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.875
[INFO] - 02-27 19:23:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.876
[INFO] - 02-27 19:23:02 - [main.summary_metrics:168]: Epoch 137/500 - Test Results:
{'auc': 0.8456328544285361,
 'f1': 0.42075126262626267,
 'loss': 0.4427331077652397,
 'ndcg': 0.7223370054866685,
 'precision': 0.5625,
 'recall': 0.33649334733893554}
[INFO] - 02-27 19:23:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[137] Complete. Time taken: 00:00:30.852
[INFO] - 02-27 19:23:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:23:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:23:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:23:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:23:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:23:02 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3071, 2222, 2239, 1]
[INFO] - 02-27 19:23:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:23:13 - [main.backward:225]: Epoch 138/500 - Iteration 35/95 - Time 0.314 batch, 0.051 data, 0.284 forward
[INFO] - 02-27 19:23:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:23:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0033)
[INFO] - 02-27 19:23:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5863)
[INFO] - 02-27 19:23:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5434)
[INFO] - 02-27 19:23:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8031 (31.8317)
[INFO] - 02-27 19:23:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0096 (372.0125)
[INFO] - 02-27 19:23:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:23:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9641)
[INFO] - 02-27 19:23:27 - [main.backward:225]: Epoch 138/500 - Iteration 85/95 - Time 0.300 batch, 0.040 data, 0.268 forward
[INFO] - 02-27 19:23:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:23:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0032)
[INFO] - 02-27 19:23:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5865 (0.5860)
[INFO] - 02-27 19:23:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5428 (-287.5438)
[INFO] - 02-27 19:23:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8266 (31.8122)
[INFO] - 02-27 19:23:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3722 (371.9315)
[INFO] - 02-27 19:23:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:23:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9656)
[INFO] - 02-27 19:23:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:23:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:23:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:23:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:23:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:23:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:23:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:23:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.755
[INFO] - 02-27 19:23:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.756
[INFO] - 02-27 19:23:33 - [main.summary_metrics:168]: Epoch 138/500 - Test Results:
{'auc': 0.8439490568899128,
 'f1': 0.41664772727272725,
 'loss': 0.44355723598808927,
 'ndcg': 0.718447662035966,
 'precision': 0.55625,
 'recall': 0.3335828081232493}
[INFO] - 02-27 19:23:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[138] Complete. Time taken: 00:00:31.365
[INFO] - 02-27 19:23:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:23:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:23:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:23:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:23:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:23:33 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3073, 2188, 2197, 1]
[INFO] - 02-27 19:23:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:23:45 - [main.backward:225]: Epoch 139/500 - Iteration 40/95 - Time 0.308 batch, 0.051 data, 0.275 forward
[INFO] - 02-27 19:23:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0030)
[INFO] - 02-27 19:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5918 (0.5870)
[INFO] - 02-27 19:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5411)
[INFO] - 02-27 19:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7739 (31.8347)
[INFO] - 02-27 19:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.8262 (372.2021)
[INFO] - 02-27 19:23:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:23:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9673)
[INFO] - 02-27 19:24:00 - [main.backward:225]: Epoch 139/500 - Iteration 90/95 - Time 0.303 batch, 0.040 data, 0.271 forward
[INFO] - 02-27 19:24:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:24:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0032)
[INFO] - 02-27 19:24:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5829 (0.5854)
[INFO] - 02-27 19:24:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5438 (-287.5413)
[INFO] - 02-27 19:24:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8077 (31.8476)
[INFO] - 02-27 19:24:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2847 (371.9619)
[INFO] - 02-27 19:24:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:24:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9655)
[INFO] - 02-27 19:24:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:24:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:24:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:24:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:24:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:24:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:24:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:24:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.375
[INFO] - 02-27 19:24:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.376
[INFO] - 02-27 19:24:04 - [main.summary_metrics:168]: Epoch 139/500 - Test Results:
{'auc': 0.8462450002059647,
 'f1': 0.4163583754208754,
 'loss': 0.4407066050729652,
 'ndcg': 0.7225937376375707,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 19:24:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[139] Complete. Time taken: 00:00:30.931
[INFO] - 02-27 19:24:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:24:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:24:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:24:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:24:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:24:04 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2195, 2223, 1]
[INFO] - 02-27 19:24:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:24:17 - [main.backward:225]: Epoch 140/500 - Iteration 45/95 - Time 0.293 batch, 0.042 data, 0.266 forward
[INFO] - 02-27 19:24:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0033)
[INFO] - 02-27 19:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5798 (0.5851)
[INFO] - 02-27 19:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5487 (-287.5463)
[INFO] - 02-27 19:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8747 (31.8504)
[INFO] - 02-27 19:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1338 (372.0767)
[INFO] - 02-27 19:24:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9650)
[INFO] - 02-27 19:24:32 - [main.backward:225]: Epoch 140/500 - Iteration 0/95 - Time 0.293 batch, 0.037 data, 0.264 forward
[INFO] - 02-27 19:24:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:24:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0034)
[INFO] - 02-27 19:24:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5816 (0.5845)
[INFO] - 02-27 19:24:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5463)
[INFO] - 02-27 19:24:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9098 (31.8670)
[INFO] - 02-27 19:24:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6129 (372.2138)
[INFO] - 02-27 19:24:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:24:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9630)
[INFO] - 02-27 19:24:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:24:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:24:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:24:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:24:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:24:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:24:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:24:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.585
[INFO] - 02-27 19:24:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.585
[INFO] - 02-27 19:24:34 - [main.summary_metrics:168]: Epoch 140/500 - Test Results:
{'auc': 0.8440423670693767,
 'f1': 0.4204619107744108,
 'loss': 0.4447596436786998,
 'ndcg': 0.7110023195811147,
 'precision': 0.5625,
 'recall': 0.3360994397759104}
[INFO] - 02-27 19:24:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[140] Complete. Time taken: 00:00:30.465
[INFO] - 02-27 19:24:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:24:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:24:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:24:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:24:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:24:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3014, 2197, 2214, 1]
[INFO] - 02-27 19:24:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:24:49 - [main.backward:225]: Epoch 141/500 - Iteration 50/95 - Time 0.296 batch, 0.046 data, 0.266 forward
[INFO] - 02-27 19:24:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0033)
[INFO] - 02-27 19:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5857 (0.5859)
[INFO] - 02-27 19:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5518 (-287.5480)
[INFO] - 02-27 19:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8856 (31.8574)
[INFO] - 02-27 19:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7511 (371.7213)
[INFO] - 02-27 19:24:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:24:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9639)
[INFO] - 02-27 19:25:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:25:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:25:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:25:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:25:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:25:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:25:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:25:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.428
[INFO] - 02-27 19:25:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.428
[INFO] - 02-27 19:25:04 - [main.summary_metrics:168]: Epoch 141/500 - Test Results:
{'auc': 0.8450243501199499,
 'f1': 0.4158322811447811,
 'loss': 0.4432548863505472,
 'ndcg': 0.7146653652345598,
 'precision': 0.55625,
 'recall': 0.3324229691876751}
[INFO] - 02-27 19:25:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[141] Complete. Time taken: 00:00:30.098
[INFO] - 02-27 19:25:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:25:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:25:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:25:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:25:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:25:04 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2205, 2213, 1]
[INFO] - 02-27 19:25:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:25:07 - [main.backward:225]: Epoch 142/500 - Iteration 5/95 - Time 0.438 batch, 0.178 data, 0.401 forward
[INFO] - 02-27 19:25:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0034)
[INFO] - 02-27 19:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5867)
[INFO] - 02-27 19:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5511 (-287.5474)
[INFO] - 02-27 19:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8918 (31.8855)
[INFO] - 02-27 19:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0499 (371.6840)
[INFO] - 02-27 19:25:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:25:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9617)
[INFO] - 02-27 19:25:21 - [main.backward:225]: Epoch 142/500 - Iteration 55/95 - Time 0.298 batch, 0.045 data, 0.266 forward
[INFO] - 02-27 19:25:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:25:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0033)
[INFO] - 02-27 19:25:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5787 (0.5865)
[INFO] - 02-27 19:25:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5393 (-287.5439)
[INFO] - 02-27 19:25:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8395 (31.8536)
[INFO] - 02-27 19:25:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8975 (372.2081)
[INFO] - 02-27 19:25:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:25:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9633)
[INFO] - 02-27 19:25:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:25:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:25:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:25:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:25:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:25:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:25:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:25:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.449
[INFO] - 02-27 19:25:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.450
[INFO] - 02-27 19:25:35 - [main.summary_metrics:168]: Epoch 142/500 - Test Results:
{'auc': 0.8477961753328782,
 'f1': 0.42330281986531987,
 'loss': 0.4412697916793829,
 'ndcg': 0.7191766231498906,
 'precision': 0.565625,
 'recall': 0.338703606442577}
[INFO] - 02-27 19:25:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[142] Complete. Time taken: 00:00:30.955
[INFO] - 02-27 19:25:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:25:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:25:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:25:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:25:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:25:35 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3086, 2193, 2205, 1]
[INFO] - 02-27 19:25:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:25:39 - [main.backward:225]: Epoch 143/500 - Iteration 10/95 - Time 0.371 batch, 0.110 data, 0.336 forward
[INFO] - 02-27 19:25:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0034)
[INFO] - 02-27 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5869)
[INFO] - 02-27 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5395 (-287.5411)
[INFO] - 02-27 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7898 (31.8365)
[INFO] - 02-27 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3271 (372.0179)
[INFO] - 02-27 19:25:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:25:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9627)
[INFO] - 02-27 19:25:53 - [main.backward:225]: Epoch 143/500 - Iteration 60/95 - Time 0.295 batch, 0.041 data, 0.266 forward
[INFO] - 02-27 19:25:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:25:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0033)
[INFO] - 02-27 19:25:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5860)
[INFO] - 02-27 19:25:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5450 (-287.5448)
[INFO] - 02-27 19:25:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8788 (31.8403)
[INFO] - 02-27 19:25:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.8728 (371.8052)
[INFO] - 02-27 19:25:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:25:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9617)
[INFO] - 02-27 19:26:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:26:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:26:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:26:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:26:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:26:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:26:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:26:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.361
[INFO] - 02-27 19:26:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.362
[INFO] - 02-27 19:26:05 - [main.summary_metrics:168]: Epoch 143/500 - Test Results:
{'auc': 0.84620367319722,
 'f1': 0.40628367003367005,
 'loss': 0.4419645751367963,
 'ndcg': 0.7140538492598235,
 'precision': 0.54375,
 'recall': 0.3246761204481793}
[INFO] - 02-27 19:26:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[143] Complete. Time taken: 00:00:29.918
[INFO] - 02-27 19:26:05 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:26:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:26:05 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:26:05 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:26:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:26:05 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2177, 2230, 1]
[INFO] - 02-27 19:26:06 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:26:10 - [main.backward:225]: Epoch 144/500 - Iteration 15/95 - Time 0.334 batch, 0.079 data, 0.302 forward
[INFO] - 02-27 19:26:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0034)
[INFO] - 02-27 19:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5871)
[INFO] - 02-27 19:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5414 (-287.5442)
[INFO] - 02-27 19:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8445 (31.8589)
[INFO] - 02-27 19:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1024 (372.2359)
[INFO] - 02-27 19:26:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:26:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9631)
[INFO] - 02-27 19:26:25 - [main.backward:225]: Epoch 144/500 - Iteration 65/95 - Time 0.297 batch, 0.042 data, 0.265 forward
[INFO] - 02-27 19:26:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:26:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0034)
[INFO] - 02-27 19:26:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5859)
[INFO] - 02-27 19:26:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5388 (-287.5392)
[INFO] - 02-27 19:26:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7728 (31.8596)
[INFO] - 02-27 19:26:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2951 (372.0650)
[INFO] - 02-27 19:26:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:26:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9623)
[INFO] - 02-27 19:26:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:26:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:26:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:26:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:26:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:26:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:26:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:26:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.725
[INFO] - 02-27 19:26:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.725
[INFO] - 02-27 19:26:37 - [main.summary_metrics:168]: Epoch 144/500 - Test Results:
{'auc': 0.8470222544900312,
 'f1': 0.4091245791245791,
 'loss': 0.44149044824717143,
 'ndcg': 0.7226928969046494,
 'precision': 0.546875,
 'recall': 0.3272802871148459}
[INFO] - 02-27 19:26:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[144] Complete. Time taken: 00:00:31.389
[INFO] - 02-27 19:26:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:26:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:26:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:26:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:26:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:26:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3031, 2191, 2193, 1]
[INFO] - 02-27 19:26:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:26:44 - [main.backward:225]: Epoch 145/500 - Iteration 20/95 - Time 0.347 batch, 0.063 data, 0.320 forward
[INFO] - 02-27 19:26:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0034)
[INFO] - 02-27 19:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5883 (0.5857)
[INFO] - 02-27 19:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5420 (-287.5379)
[INFO] - 02-27 19:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9376 (31.8722)
[INFO] - 02-27 19:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4365 (371.8157)
[INFO] - 02-27 19:26:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:26:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9625)
[INFO] - 02-27 19:27:01 - [main.backward:225]: Epoch 145/500 - Iteration 70/95 - Time 0.344 batch, 0.044 data, 0.310 forward
[INFO] - 02-27 19:27:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:27:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0036)
[INFO] - 02-27 19:27:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5917 (0.5849)
[INFO] - 02-27 19:27:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5435)
[INFO] - 02-27 19:27:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9507 (31.8586)
[INFO] - 02-27 19:27:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.9852 (371.9174)
[INFO] - 02-27 19:27:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:27:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9587)
[INFO] - 02-27 19:27:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:27:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:27:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:27:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:27:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:27:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:27:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:27:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.153
[INFO] - 02-27 19:27:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.153
[INFO] - 02-27 19:27:13 - [main.summary_metrics:168]: Epoch 145/500 - Test Results:
{'auc': 0.8492516494342834,
 'f1': 0.42080281986531987,
 'loss': 0.4388225732226429,
 'ndcg': 0.7192329870618381,
 'precision': 0.5625,
 'recall': 0.3366202731092437}
[INFO] - 02-27 19:27:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[145] Complete. Time taken: 00:00:36.668
[INFO] - 02-27 19:27:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:27:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:27:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:27:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:27:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:27:13 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2187, 2216, 1]
[INFO] - 02-27 19:27:14 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:27:24 - [main.backward:225]: Epoch 146/500 - Iteration 25/95 - Time 0.412 batch, 0.081 data, 0.369 forward
[INFO] - 02-27 19:27:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:27:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0032)
[INFO] - 02-27 19:27:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5855)
[INFO] - 02-27 19:27:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5458 (-287.5470)
[INFO] - 02-27 19:27:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9236 (31.8674)
[INFO] - 02-27 19:27:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3674 (371.9099)
[INFO] - 02-27 19:27:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:27:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9648)
[INFO] - 02-27 19:27:41 - [main.backward:225]: Epoch 146/500 - Iteration 75/95 - Time 0.374 batch, 0.055 data, 0.332 forward
[INFO] - 02-27 19:27:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:27:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0033)
[INFO] - 02-27 19:27:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5830 (0.5874)
[INFO] - 02-27 19:27:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5463)
[INFO] - 02-27 19:27:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8934 (31.8596)
[INFO] - 02-27 19:27:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.3771 (372.1017)
[INFO] - 02-27 19:27:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:27:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9620)
[INFO] - 02-27 19:27:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:27:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:27:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:27:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:27:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:27:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:27:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:27:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.063
[INFO] - 02-27 19:27:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.063
[INFO] - 02-27 19:27:52 - [main.summary_metrics:168]: Epoch 146/500 - Test Results:
{'auc': 0.8463488361030687,
 'f1': 0.4112026515151515,
 'loss': 0.44216102451016875,
 'ndcg': 0.7253131149885295,
 'precision': 0.55,
 'recall': 0.32874649859943983}
[INFO] - 02-27 19:27:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[146] Complete. Time taken: 00:00:38.449
[INFO] - 02-27 19:27:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:27:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:27:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:27:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:27:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:27:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2194, 2213, 1]
[INFO] - 02-27 19:27:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:28:03 - [main.backward:225]: Epoch 147/500 - Iteration 30/95 - Time 0.373 batch, 0.069 data, 0.336 forward
[INFO] - 02-27 19:28:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0032)
[INFO] - 02-27 19:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5905 (0.5859)
[INFO] - 02-27 19:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5447)
[INFO] - 02-27 19:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8832 (31.8541)
[INFO] - 02-27 19:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8120 (372.1788)
[INFO] - 02-27 19:28:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:28:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9652)
[INFO] - 02-27 19:28:21 - [main.backward:225]: Epoch 147/500 - Iteration 80/95 - Time 0.366 batch, 0.051 data, 0.327 forward
[INFO] - 02-27 19:28:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:28:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 19:28:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5856)
[INFO] - 02-27 19:28:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5421 (-287.5435)
[INFO] - 02-27 19:28:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8819 (31.8539)
[INFO] - 02-27 19:28:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6114 (372.1454)
[INFO] - 02-27 19:28:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:28:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9659)
[INFO] - 02-27 19:28:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:28:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:28:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:28:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:28:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:28:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:28:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:28:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.145
[INFO] - 02-27 19:28:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.146
[INFO] - 02-27 19:28:30 - [main.summary_metrics:168]: Epoch 147/500 - Test Results:
{'auc': 0.8473011701616922,
 'f1': 0.4065730218855219,
 'loss': 0.43851035693536067,
 'ndcg': 0.7210062978087253,
 'precision': 0.54375,
 'recall': 0.3250700280112045}
[INFO] - 02-27 19:28:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[147] Complete. Time taken: 00:00:37.799
[INFO] - 02-27 19:28:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:28:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:28:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:28:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:28:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:28:30 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2210, 2207, 1]
[INFO] - 02-27 19:28:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:28:43 - [main.backward:225]: Epoch 148/500 - Iteration 35/95 - Time 0.389 batch, 0.066 data, 0.351 forward
[INFO] - 02-27 19:28:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:28:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0031)
[INFO] - 02-27 19:28:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5868)
[INFO] - 02-27 19:28:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5437 (-287.5423)
[INFO] - 02-27 19:28:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7976 (31.8615)
[INFO] - 02-27 19:28:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3726 (371.9312)
[INFO] - 02-27 19:28:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:28:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9659)
[INFO] - 02-27 19:29:01 - [main.backward:225]: Epoch 148/500 - Iteration 85/95 - Time 0.375 batch, 0.050 data, 0.337 forward
[INFO] - 02-27 19:29:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0033)
[INFO] - 02-27 19:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5830 (0.5860)
[INFO] - 02-27 19:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5446 (-287.5431)
[INFO] - 02-27 19:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8513 (31.8491)
[INFO] - 02-27 19:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9969 (371.7726)
[INFO] - 02-27 19:29:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9627)
[INFO] - 02-27 19:29:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:29:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:29:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:29:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:29:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:29:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:29:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:29:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.006
[INFO] - 02-27 19:29:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.008
[INFO] - 02-27 19:29:08 - [main.summary_metrics:168]: Epoch 148/500 - Test Results:
{'auc': 0.8480286668589004,
 'f1': 0.41120265151515156,
 'loss': 0.4383658808610084,
 'ndcg': 0.7271690891419245,
 'precision': 0.55,
 'recall': 0.32874649859943983}
[INFO] - 02-27 19:29:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[148] Complete. Time taken: 00:00:38.457
[INFO] - 02-27 19:29:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:29:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:29:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:29:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:29:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:29:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3067, 2176, 2213, 1]
[INFO] - 02-27 19:29:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:29:23 - [main.backward:225]: Epoch 149/500 - Iteration 40/95 - Time 0.381 batch, 0.065 data, 0.338 forward
[INFO] - 02-27 19:29:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:29:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0017 (0.0033)
[INFO] - 02-27 19:29:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5851)
[INFO] - 02-27 19:29:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5490 (-287.5458)
[INFO] - 02-27 19:29:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8153 (31.8315)
[INFO] - 02-27 19:29:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3331 (371.7175)
[INFO] - 02-27 19:29:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:29:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9617)
[INFO] - 02-27 19:29:41 - [main.backward:225]: Epoch 149/500 - Iteration 90/95 - Time 0.362 batch, 0.051 data, 0.321 forward
[INFO] - 02-27 19:29:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 19:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5845 (0.5865)
[INFO] - 02-27 19:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5401 (-287.5472)
[INFO] - 02-27 19:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8051 (31.8216)
[INFO] - 02-27 19:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0758 (371.7647)
[INFO] - 02-27 19:29:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:29:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9664)
[INFO] - 02-27 19:29:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:29:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:29:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:29:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:29:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:29:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:29:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:29:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.874
[INFO] - 02-27 19:29:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.875
[INFO] - 02-27 19:29:45 - [main.summary_metrics:168]: Epoch 149/500 - Test Results:
{'auc': 0.8459084766259446,
 'f1': 0.4186731902356903,
 'loss': 0.44010777040014987,
 'ndcg': 0.7235889062747742,
 'precision': 0.559375,
 'recall': 0.33502713585434174}
[INFO] - 02-27 19:29:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[149] Complete. Time taken: 00:00:37.278
[INFO] - 02-27 19:29:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:29:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:29:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:29:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:29:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:29:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3038, 2203, 2218, 1]
[INFO] - 02-27 19:29:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:30:03 - [main.backward:225]: Epoch 150/500 - Iteration 45/95 - Time 0.387 batch, 0.060 data, 0.346 forward
[INFO] - 02-27 19:30:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:30:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0033)
[INFO] - 02-27 19:30:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5823 (0.5877)
[INFO] - 02-27 19:30:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5402 (-287.5386)
[INFO] - 02-27 19:30:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8355 (31.8094)
[INFO] - 02-27 19:30:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1827 (371.7144)
[INFO] - 02-27 19:30:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:30:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9644)
[INFO] - 02-27 19:30:21 - [main.backward:225]: Epoch 150/500 - Iteration 0/95 - Time 0.371 batch, 0.048 data, 0.332 forward
[INFO] - 02-27 19:30:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:30:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0035)
[INFO] - 02-27 19:30:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5824 (0.5862)
[INFO] - 02-27 19:30:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5407 (-287.5421)
[INFO] - 02-27 19:30:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7422 (31.8384)
[INFO] - 02-27 19:30:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3030 (371.7125)
[INFO] - 02-27 19:30:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:30:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9619)
[INFO] - 02-27 19:30:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:30:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:30:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:30:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:30:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:30:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:30:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:30:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.948
[INFO] - 02-27 19:30:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.949
[INFO] - 02-27 19:30:24 - [main.summary_metrics:168]: Epoch 150/500 - Test Results:
{'auc': 0.8452128642510925,
 'f1': 0.42359217171717173,
 'loss': 0.4407655112761393,
 'ndcg': 0.7234043943563965,
 'precision': 0.565625,
 'recall': 0.3390975140056023}
[INFO] - 02-27 19:30:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[150] Complete. Time taken: 00:00:38.232
[INFO] - 02-27 19:30:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:30:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:30:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:30:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:30:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:30:24 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3105, 2205, 2215, 1]
[INFO] - 02-27 19:30:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:30:42 - [main.backward:225]: Epoch 151/500 - Iteration 50/95 - Time 0.372 batch, 0.058 data, 0.333 forward
[INFO] - 02-27 19:30:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:30:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0034)
[INFO] - 02-27 19:30:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5868)
[INFO] - 02-27 19:30:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5413 (-287.5432)
[INFO] - 02-27 19:30:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8189 (31.8113)
[INFO] - 02-27 19:30:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.8401 (371.7304)
[INFO] - 02-27 19:30:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:30:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9631)
[INFO] - 02-27 19:30:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:30:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:30:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:30:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:30:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:30:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:30:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:31:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.156
[INFO] - 02-27 19:31:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.157
[INFO] - 02-27 19:31:02 - [main.summary_metrics:168]: Epoch 151/500 - Test Results:
{'auc': 0.8471065444560177,
 'f1': 0.4206176346801347,
 'loss': 0.4394297031896145,
 'ndcg': 0.7200498083768635,
 'precision': 0.5625,
 'recall': 0.336375175070028}
[INFO] - 02-27 19:31:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[151] Complete. Time taken: 00:00:38.059
[INFO] - 02-27 19:31:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:31:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:31:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:31:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:31:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:31:02 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3041, 2207, 2223, 1]
[INFO] - 02-27 19:31:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:31:04 - [main.backward:225]: Epoch 152/500 - Iteration 5/95 - Time 0.549 batch, 0.227 data, 0.509 forward
[INFO] - 02-27 19:31:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0031)
[INFO] - 02-27 19:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5836 (0.5865)
[INFO] - 02-27 19:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5433 (-287.5429)
[INFO] - 02-27 19:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9060 (31.8171)
[INFO] - 02-27 19:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6201 (371.6786)
[INFO] - 02-27 19:31:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:31:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9645)
[INFO] - 02-27 19:31:23 - [main.backward:225]: Epoch 152/500 - Iteration 55/95 - Time 0.383 batch, 0.058 data, 0.341 forward
[INFO] - 02-27 19:31:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:31:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0032)
[INFO] - 02-27 19:31:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5913 (0.5858)
[INFO] - 02-27 19:31:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5437)
[INFO] - 02-27 19:31:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9019 (31.8426)
[INFO] - 02-27 19:31:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.1534 (371.5665)
[INFO] - 02-27 19:31:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:31:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9630)
[INFO] - 02-27 19:31:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:31:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:31:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:31:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:31:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:31:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:31:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:31:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.238
[INFO] - 02-27 19:31:41 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.240
[INFO] - 02-27 19:31:41 - [main.summary_metrics:168]: Epoch 152/500 - Test Results:
{'auc': 0.8484528365267676,
 'f1': 0.4133838383838384,
 'loss': 0.4395259477887296,
 'ndcg': 0.723620467120428,
 'precision': 0.553125,
 'recall': 0.3304665616246498}
[INFO] - 02-27 19:31:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[152] Complete. Time taken: 00:00:38.854
[INFO] - 02-27 19:31:41 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:31:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:31:41 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:31:41 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:31:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:31:41 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3061, 2188, 2207, 1]
[INFO] - 02-27 19:31:41 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:31:45 - [main.backward:225]: Epoch 153/500 - Iteration 10/95 - Time 0.423 batch, 0.139 data, 0.381 forward
[INFO] - 02-27 19:31:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:31:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0033)
[INFO] - 02-27 19:31:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5930 (0.5858)
[INFO] - 02-27 19:31:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5426 (-287.5428)
[INFO] - 02-27 19:31:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9380 (31.8426)
[INFO] - 02-27 19:31:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.2340 (371.6392)
[INFO] - 02-27 19:31:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:31:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9641)
[INFO] - 02-27 19:32:03 - [main.backward:225]: Epoch 153/500 - Iteration 60/95 - Time 0.372 batch, 0.058 data, 0.330 forward
[INFO] - 02-27 19:32:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:32:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0033)
[INFO] - 02-27 19:32:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5855 (0.5878)
[INFO] - 02-27 19:32:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5431 (-287.5434)
[INFO] - 02-27 19:32:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8715 (31.8567)
[INFO] - 02-27 19:32:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.9439 (371.7684)
[INFO] - 02-27 19:32:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:32:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9650)
[INFO] - 02-27 19:32:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:32:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:32:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:32:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:32:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:32:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:32:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:32:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.205
[INFO] - 02-27 19:32:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.206
[INFO] - 02-27 19:32:19 - [main.summary_metrics:168]: Epoch 153/500 - Test Results:
{'auc': 0.8482902494331066,
 'f1': 0.420513468013468,
 'loss': 0.43767682743809566,
 'ndcg': 0.7229615165999983,
 'precision': 0.5625,
 'recall': 0.3362263655462185}
[INFO] - 02-27 19:32:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[153] Complete. Time taken: 00:00:38.398
[INFO] - 02-27 19:32:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:32:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:32:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:32:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:32:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:32:19 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3040, 2202, 2208, 1]
[INFO] - 02-27 19:32:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:32:25 - [main.backward:225]: Epoch 154/500 - Iteration 15/95 - Time 0.427 batch, 0.107 data, 0.386 forward
[INFO] - 02-27 19:32:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0030)
[INFO] - 02-27 19:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5810 (0.5855)
[INFO] - 02-27 19:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5422 (-287.5410)
[INFO] - 02-27 19:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8633 (31.8340)
[INFO] - 02-27 19:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6807 (371.6061)
[INFO] - 02-27 19:32:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:32:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9675)
[INFO] - 02-27 19:32:43 - [main.backward:225]: Epoch 154/500 - Iteration 65/95 - Time 0.375 batch, 0.054 data, 0.336 forward
[INFO] - 02-27 19:32:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:32:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0031)
[INFO] - 02-27 19:32:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5854)
[INFO] - 02-27 19:32:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5470 (-287.5459)
[INFO] - 02-27 19:32:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7754 (31.8440)
[INFO] - 02-27 19:32:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3385 (371.7415)
[INFO] - 02-27 19:32:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:32:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9669)
[INFO] - 02-27 19:32:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:32:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:32:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:32:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:32:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:32:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:32:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:32:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.080
[INFO] - 02-27 19:32:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.082
[INFO] - 02-27 19:32:57 - [main.summary_metrics:168]: Epoch 154/500 - Test Results:
{'auc': 0.848258748107086,
 'f1': 0.41106902356902353,
 'loss': 0.4385580541415881,
 'ndcg': 0.7213602094445073,
 'precision': 0.55,
 'recall': 0.3286283263305322}
[INFO] - 02-27 19:32:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[154] Complete. Time taken: 00:00:38.417
[INFO] - 02-27 19:32:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:32:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:32:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:32:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:32:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:32:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3022, 2194, 2200, 1]
[INFO] - 02-27 19:32:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:33:06 - [main.backward:225]: Epoch 155/500 - Iteration 20/95 - Time 0.413 batch, 0.090 data, 0.372 forward
[INFO] - 02-27 19:33:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:33:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0032)
[INFO] - 02-27 19:33:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5855)
[INFO] - 02-27 19:33:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5463)
[INFO] - 02-27 19:33:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8503 (31.8445)
[INFO] - 02-27 19:33:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1399 (371.8174)
[INFO] - 02-27 19:33:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:33:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9658)
[INFO] - 02-27 19:33:24 - [main.backward:225]: Epoch 155/500 - Iteration 70/95 - Time 0.376 batch, 0.054 data, 0.336 forward
[INFO] - 02-27 19:33:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:33:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 19:33:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5855 (0.5857)
[INFO] - 02-27 19:33:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5448)
[INFO] - 02-27 19:33:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8127 (31.8332)
[INFO] - 02-27 19:33:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9742 (371.8607)
[INFO] - 02-27 19:33:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:33:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9644)
[INFO] - 02-27 19:33:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:33:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:33:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:33:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:33:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:33:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:33:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:33:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.068
[INFO] - 02-27 19:33:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.068
[INFO] - 02-27 19:33:35 - [main.summary_metrics:168]: Epoch 155/500 - Test Results:
{'auc': 0.8485122852449802,
 'f1': 0.41819865319865324,
 'loss': 0.4374628448067591,
 'ndcg': 0.7257869488666432,
 'precision': 0.559375,
 'recall': 0.33438813025210085}
[INFO] - 02-27 19:33:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[155] Complete. Time taken: 00:00:38.176
[INFO] - 02-27 19:33:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:33:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:33:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:33:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:33:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:33:36 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3052, 2208, 2219, 1]
[INFO] - 02-27 19:33:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:33:45 - [main.backward:225]: Epoch 156/500 - Iteration 25/95 - Time 0.396 batch, 0.078 data, 0.355 forward
[INFO] - 02-27 19:33:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:33:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0030)
[INFO] - 02-27 19:33:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5917 (0.5874)
[INFO] - 02-27 19:33:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5461 (-287.5454)
[INFO] - 02-27 19:33:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8629 (31.8360)
[INFO] - 02-27 19:33:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7211 (371.6835)
[INFO] - 02-27 19:33:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:33:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9711)
[INFO] - 02-27 19:34:03 - [main.backward:225]: Epoch 156/500 - Iteration 75/95 - Time 0.362 batch, 0.051 data, 0.323 forward
[INFO] - 02-27 19:34:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:34:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0032)
[INFO] - 02-27 19:34:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5835 (0.5862)
[INFO] - 02-27 19:34:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5450)
[INFO] - 02-27 19:34:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8815 (31.8457)
[INFO] - 02-27 19:34:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4008 (371.6572)
[INFO] - 02-27 19:34:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:34:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9648)
[INFO] - 02-27 19:34:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:34:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:34:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:34:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:34:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:34:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:34:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:34:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.977
[INFO] - 02-27 19:34:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.978
[INFO] - 02-27 19:34:13 - [main.summary_metrics:168]: Epoch 156/500 - Test Results:
{'auc': 0.8461140782293309,
 'f1': 0.41367319023569027,
 'loss': 0.43657073013566006,
 'ndcg': 0.714390640502858,
 'precision': 0.5531250000000001,
 'recall': 0.3308604691876751}
[INFO] - 02-27 19:34:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[156] Complete. Time taken: 00:00:37.100
[INFO] - 02-27 19:34:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:34:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:34:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:34:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:34:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:34:13 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2203, 2233, 1]
[INFO] - 02-27 19:34:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:34:24 - [main.backward:225]: Epoch 157/500 - Iteration 30/95 - Time 0.392 batch, 0.068 data, 0.351 forward
[INFO] - 02-27 19:34:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:34:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 19:34:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5855)
[INFO] - 02-27 19:34:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5392 (-287.5419)
[INFO] - 02-27 19:34:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7510 (31.8176)
[INFO] - 02-27 19:34:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0203 (371.5115)
[INFO] - 02-27 19:34:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:34:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9655)
[INFO] - 02-27 19:34:42 - [main.backward:225]: Epoch 157/500 - Iteration 80/95 - Time 0.371 batch, 0.049 data, 0.332 forward
[INFO] - 02-27 19:34:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:34:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0033)
[INFO] - 02-27 19:34:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5888 (0.5860)
[INFO] - 02-27 19:34:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5459 (-287.5419)
[INFO] - 02-27 19:34:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7809 (31.8024)
[INFO] - 02-27 19:34:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9958 (371.2564)
[INFO] - 02-27 19:34:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:34:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9652)
[INFO] - 02-27 19:34:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:34:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:34:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:34:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:34:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:34:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:34:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:34:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.114
[INFO] - 02-27 19:34:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.114
[INFO] - 02-27 19:34:51 - [main.summary_metrics:168]: Epoch 157/500 - Test Results:
{'auc': 0.849172302192936,
 'f1': 0.42793244949494946,
 'loss': 0.43698320283865755,
 'ndcg': 0.7286857289901948,
 'precision': 0.571875,
 'recall': 0.3423800770308123}
[INFO] - 02-27 19:34:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[157] Complete. Time taken: 00:00:38.156
[INFO] - 02-27 19:34:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:34:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:34:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:34:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:34:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:34:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3064, 2201, 2194, 1]
[INFO] - 02-27 19:34:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:35:05 - [main.backward:225]: Epoch 158/500 - Iteration 35/95 - Time 0.396 batch, 0.072 data, 0.353 forward
[INFO] - 02-27 19:35:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:35:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 19:35:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5911 (0.5857)
[INFO] - 02-27 19:35:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5461)
[INFO] - 02-27 19:35:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7676 (31.8212)
[INFO] - 02-27 19:35:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0882 (371.5257)
[INFO] - 02-27 19:35:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:35:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9669)
[INFO] - 02-27 19:35:23 - [main.backward:225]: Epoch 158/500 - Iteration 85/95 - Time 0.376 batch, 0.053 data, 0.335 forward
[INFO] - 02-27 19:35:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0032)
[INFO] - 02-27 19:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5874 (0.5853)
[INFO] - 02-27 19:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5418 (-287.5442)
[INFO] - 02-27 19:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8010 (31.8290)
[INFO] - 02-27 19:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7693 (371.6094)
[INFO] - 02-27 19:35:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9655)
[INFO] - 02-27 19:35:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:35:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:35:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:35:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:35:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:35:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:35:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:35:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.084
[INFO] - 02-27 19:35:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.085
[INFO] - 02-27 19:35:29 - [main.summary_metrics:168]: Epoch 158/500 - Test Results:
{'auc': 0.8475722117278284,
 'f1': 0.41385837542087545,
 'loss': 0.43853953828727765,
 'ndcg': 0.7192589145824384,
 'precision': 0.553125,
 'recall': 0.3311055672268908}
[INFO] - 02-27 19:35:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[158] Complete. Time taken: 00:00:38.619
[INFO] - 02-27 19:35:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:35:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:35:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:35:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:35:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:35:29 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2198, 2213, 1]
[INFO] - 02-27 19:35:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:35:45 - [main.backward:225]: Epoch 159/500 - Iteration 40/95 - Time 0.379 batch, 0.060 data, 0.342 forward
[INFO] - 02-27 19:35:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:35:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0033)
[INFO] - 02-27 19:35:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5906 (0.5859)
[INFO] - 02-27 19:35:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5480 (-287.5453)
[INFO] - 02-27 19:35:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7782 (31.8207)
[INFO] - 02-27 19:35:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3660 (371.6559)
[INFO] - 02-27 19:35:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:35:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9636)
[INFO] - 02-27 19:36:02 - [main.backward:225]: Epoch 159/500 - Iteration 90/95 - Time 0.366 batch, 0.050 data, 0.326 forward
[INFO] - 02-27 19:36:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0034)
[INFO] - 02-27 19:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5848 (0.5859)
[INFO] - 02-27 19:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5458)
[INFO] - 02-27 19:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8969 (31.8251)
[INFO] - 02-27 19:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.8713 (371.4457)
[INFO] - 02-27 19:36:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:36:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9620)
[INFO] - 02-27 19:36:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:36:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:36:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:36:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:36:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:36:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:36:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:36:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.901
[INFO] - 02-27 19:36:07 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.903
[INFO] - 02-27 19:36:07 - [main.summary_metrics:168]: Epoch 159/500 - Test Results:
{'auc': 0.847265441715902,
 'f1': 0.4299579124579125,
 'loss': 0.4397214333323091,
 'ndcg': 0.7224015264062618,
 'precision': 0.575,
 'recall': 0.3438244047619048}
[INFO] - 02-27 19:36:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[159] Complete. Time taken: 00:00:37.723
[INFO] - 02-27 19:36:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:36:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:36:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:36:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:36:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:36:07 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3057, 2192, 2216, 1]
[INFO] - 02-27 19:36:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:36:24 - [main.backward:225]: Epoch 160/500 - Iteration 45/95 - Time 0.386 batch, 0.063 data, 0.345 forward
[INFO] - 02-27 19:36:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:36:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0031)
[INFO] - 02-27 19:36:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5868)
[INFO] - 02-27 19:36:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5446 (-287.5450)
[INFO] - 02-27 19:36:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8433 (31.8181)
[INFO] - 02-27 19:36:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7729 (371.5387)
[INFO] - 02-27 19:36:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:36:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9656)
[INFO] - 02-27 19:36:43 - [main.backward:225]: Epoch 160/500 - Iteration 0/95 - Time 0.375 batch, 0.050 data, 0.335 forward
[INFO] - 02-27 19:36:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:36:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 19:36:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5858)
[INFO] - 02-27 19:36:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5462 (-287.5438)
[INFO] - 02-27 19:36:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8457 (31.8059)
[INFO] - 02-27 19:36:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.2130 (371.4601)
[INFO] - 02-27 19:36:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:36:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9645)
[INFO] - 02-27 19:36:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:36:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:36:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:36:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:36:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:36:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:36:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:36:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.128
[INFO] - 02-27 19:36:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.129
[INFO] - 02-27 19:36:46 - [main.summary_metrics:168]: Epoch 160/500 - Test Results:
{'auc': 0.845654697540781,
 'f1': 0.41664772727272725,
 'loss': 0.4397806395650081,
 'ndcg': 0.7127324500123862,
 'precision': 0.5562499999999999,
 'recall': 0.3335828081232493}
[INFO] - 02-27 19:36:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[160] Complete. Time taken: 00:00:38.780
[INFO] - 02-27 19:36:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:36:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:36:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:36:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:36:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:36:46 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3074, 2192, 2216, 1]
[INFO] - 02-27 19:36:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:37:05 - [main.backward:225]: Epoch 161/500 - Iteration 50/95 - Time 0.381 batch, 0.059 data, 0.340 forward
[INFO] - 02-27 19:37:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0035)
[INFO] - 02-27 19:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5845 (0.5865)
[INFO] - 02-27 19:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5461 (-287.5465)
[INFO] - 02-27 19:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8925 (31.8199)
[INFO] - 02-27 19:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.0533 (371.3670)
[INFO] - 02-27 19:37:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:37:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9589)
[INFO] - 02-27 19:37:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:37:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:37:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:37:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:37:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:37:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:37:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:37:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.994
[INFO] - 02-27 19:37:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.995
[INFO] - 02-27 19:37:24 - [main.summary_metrics:168]: Epoch 161/500 - Test Results:
{'auc': 0.8474950314684697,
 'f1': 0.4092287457912458,
 'loss': 0.4394775130721493,
 'ndcg': 0.7236703301704,
 'precision': 0.546875,
 'recall': 0.3274290966386555}
[INFO] - 02-27 19:37:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[161] Complete. Time taken: 00:00:38.457
[INFO] - 02-27 19:37:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:37:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:37:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:37:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:37:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:37:24 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2207, 2205, 1]
[INFO] - 02-27 19:37:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:37:27 - [main.backward:225]: Epoch 162/500 - Iteration 5/95 - Time 0.519 batch, 0.213 data, 0.485 forward
[INFO] - 02-27 19:37:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:37:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0032)
[INFO] - 02-27 19:37:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5858)
[INFO] - 02-27 19:37:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5444)
[INFO] - 02-27 19:37:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8903 (31.8493)
[INFO] - 02-27 19:37:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2294 (371.8185)
[INFO] - 02-27 19:37:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:37:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9663)
[INFO] - 02-27 19:37:45 - [main.backward:225]: Epoch 162/500 - Iteration 55/95 - Time 0.370 batch, 0.053 data, 0.333 forward
[INFO] - 02-27 19:37:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:37:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0033)
[INFO] - 02-27 19:37:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5904 (0.5861)
[INFO] - 02-27 19:37:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5449 (-287.5431)
[INFO] - 02-27 19:37:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8200 (31.8366)
[INFO] - 02-27 19:37:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9706 (371.6319)
[INFO] - 02-27 19:37:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:37:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9634)
[INFO] - 02-27 19:37:59 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:37:59 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:37:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:37:59 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:37:59 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:37:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:37:59 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:38:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.079
[INFO] - 02-27 19:38:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.081
[INFO] - 02-27 19:38:02 - [main.summary_metrics:168]: Epoch 162/500 - Test Results:
{'auc': 0.847781893823706,
 'f1': 0.4282218013468013,
 'loss': 0.43785695828036275,
 'ndcg': 0.723308503329972,
 'precision': 0.571875,
 'recall': 0.3427739845938375}
[INFO] - 02-27 19:38:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[162] Complete. Time taken: 00:00:38.045
[INFO] - 02-27 19:38:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:38:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:38:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:38:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:38:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:38:02 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2192, 2198, 1]
[INFO] - 02-27 19:38:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:38:07 - [main.backward:225]: Epoch 163/500 - Iteration 10/95 - Time 0.417 batch, 0.128 data, 0.382 forward
[INFO] - 02-27 19:38:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0032)
[INFO] - 02-27 19:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5858)
[INFO] - 02-27 19:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5456 (-287.5461)
[INFO] - 02-27 19:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7772 (31.8347)
[INFO] - 02-27 19:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9121 (371.9353)
[INFO] - 02-27 19:38:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:38:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9642)
[INFO] - 02-27 19:38:24 - [main.backward:225]: Epoch 163/500 - Iteration 60/95 - Time 0.364 batch, 0.053 data, 0.326 forward
[INFO] - 02-27 19:38:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0032)
[INFO] - 02-27 19:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5854 (0.5837)
[INFO] - 02-27 19:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5454 (-287.5467)
[INFO] - 02-27 19:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8470 (31.8239)
[INFO] - 02-27 19:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3398 (371.7371)
[INFO] - 02-27 19:38:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9653)
[INFO] - 02-27 19:38:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:38:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:38:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:38:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:38:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:38:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:38:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:38:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.234
[INFO] - 02-27 19:38:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.236
[INFO] - 02-27 19:38:40 - [main.summary_metrics:168]: Epoch 163/500 - Test Results:
{'auc': 0.8468691182968284,
 'f1': 0.4143329124579125,
 'loss': 0.4400526452766774,
 'ndcg': 0.7230441167852636,
 'precision': 0.5531250000000001,
 'recall': 0.33174457282913167}
[INFO] - 02-27 19:38:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[163] Complete. Time taken: 00:00:37.765
[INFO] - 02-27 19:38:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:38:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:38:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:38:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:38:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:38:40 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3068, 2196, 2235, 1]
[INFO] - 02-27 19:38:41 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:38:47 - [main.backward:225]: Epoch 164/500 - Iteration 15/95 - Time 0.438 batch, 0.105 data, 0.395 forward
[INFO] - 02-27 19:38:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:38:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0031)
[INFO] - 02-27 19:38:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5833 (0.5853)
[INFO] - 02-27 19:38:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5490 (-287.5480)
[INFO] - 02-27 19:38:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8501 (31.8378)
[INFO] - 02-27 19:38:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3981 (371.7811)
[INFO] - 02-27 19:38:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:38:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9661)
[INFO] - 02-27 19:39:04 - [main.backward:225]: Epoch 164/500 - Iteration 65/95 - Time 0.374 batch, 0.053 data, 0.335 forward
[INFO] - 02-27 19:39:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0031)
[INFO] - 02-27 19:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5888 (0.5867)
[INFO] - 02-27 19:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5466 (-287.5477)
[INFO] - 02-27 19:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7288 (31.8385)
[INFO] - 02-27 19:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.7488 (371.7092)
[INFO] - 02-27 19:39:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:39:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9667)
[INFO] - 02-27 19:39:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:39:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:39:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:39:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:39:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:39:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:39:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:39:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.094
[INFO] - 02-27 19:39:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.095
[INFO] - 02-27 19:39:18 - [main.summary_metrics:168]: Epoch 164/500 - Test Results:
{'auc': 0.8448413009198779,
 'f1': 0.41598800505050504,
 'loss': 0.44274084183718354,
 'ndcg': 0.7145909086609521,
 'precision': 0.5562499999999999,
 'recall': 0.33269870448179273}
[INFO] - 02-27 19:39:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[164] Complete. Time taken: 00:00:38.102
[INFO] - 02-27 19:39:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:39:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:39:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:39:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:39:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:39:18 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3042, 2194, 2232, 1]
[INFO] - 02-27 19:39:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:39:26 - [main.backward:225]: Epoch 165/500 - Iteration 20/95 - Time 0.394 batch, 0.078 data, 0.360 forward
[INFO] - 02-27 19:39:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:39:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0032)
[INFO] - 02-27 19:39:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5832 (0.5864)
[INFO] - 02-27 19:39:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5454 (-287.5451)
[INFO] - 02-27 19:39:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7759 (31.8318)
[INFO] - 02-27 19:39:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9891 (371.7640)
[INFO] - 02-27 19:39:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:39:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9664)
[INFO] - 02-27 19:39:44 - [main.backward:225]: Epoch 165/500 - Iteration 70/95 - Time 0.361 batch, 0.048 data, 0.325 forward
[INFO] - 02-27 19:39:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:39:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0034)
[INFO] - 02-27 19:39:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5852)
[INFO] - 02-27 19:39:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5439)
[INFO] - 02-27 19:39:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8525 (31.8135)
[INFO] - 02-27 19:39:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6118 (371.6564)
[INFO] - 02-27 19:39:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:39:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9625)
[INFO] - 02-27 19:39:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:39:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:39:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:39:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:39:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:39:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:39:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:39:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.201
[INFO] - 02-27 19:39:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.202
[INFO] - 02-27 19:39:56 - [main.summary_metrics:168]: Epoch 165/500 - Test Results:
{'auc': 0.845310939081515,
 'f1': 0.4107281144781145,
 'loss': 0.44124170012053865,
 'ndcg': 0.7146425987585379,
 'precision': 0.55,
 'recall': 0.3281074929971989}
[INFO] - 02-27 19:39:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[165] Complete. Time taken: 00:00:37.336
[INFO] - 02-27 19:39:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:39:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:39:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:39:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:39:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:39:56 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2202, 2217, 1]
[INFO] - 02-27 19:39:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:40:06 - [main.backward:225]: Epoch 166/500 - Iteration 25/95 - Time 0.407 batch, 0.080 data, 0.365 forward
[INFO] - 02-27 19:40:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0034)
[INFO] - 02-27 19:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5781 (0.5862)
[INFO] - 02-27 19:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5478 (-287.5463)
[INFO] - 02-27 19:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8043 (31.8124)
[INFO] - 02-27 19:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2896 (371.6156)
[INFO] - 02-27 19:40:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9613)
[INFO] - 02-27 19:40:24 - [main.backward:225]: Epoch 166/500 - Iteration 75/95 - Time 0.374 batch, 0.052 data, 0.334 forward
[INFO] - 02-27 19:40:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 19:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5856)
[INFO] - 02-27 19:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5428 (-287.5453)
[INFO] - 02-27 19:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9034 (31.8039)
[INFO] - 02-27 19:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.5932 (371.5552)
[INFO] - 02-27 19:40:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:40:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9661)
[INFO] - 02-27 19:40:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:40:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:40:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:40:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:40:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:40:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:40:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:40:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.112
[INFO] - 02-27 19:40:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.113
[INFO] - 02-27 19:40:34 - [main.summary_metrics:168]: Epoch 166/500 - Test Results:
{'auc': 0.8457669058432196,
 'f1': 0.4118329124579125,
 'loss': 0.44248817998984,
 'ndcg': 0.720559684006248,
 'precision': 0.55,
 'recall': 0.32966123949579834}
[INFO] - 02-27 19:40:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[166] Complete. Time taken: 00:00:38.426
[INFO] - 02-27 19:40:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:40:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:40:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:40:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:40:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:40:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3061, 2195, 2205, 1]
[INFO] - 02-27 19:40:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:40:46 - [main.backward:225]: Epoch 167/500 - Iteration 30/95 - Time 0.388 batch, 0.069 data, 0.352 forward
[INFO] - 02-27 19:40:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:40:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0031)
[INFO] - 02-27 19:40:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5862)
[INFO] - 02-27 19:40:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5489 (-287.5449)
[INFO] - 02-27 19:40:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8685 (31.8176)
[INFO] - 02-27 19:40:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2767 (371.5694)
[INFO] - 02-27 19:40:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:40:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9663)
[INFO] - 02-27 19:41:03 - [main.backward:225]: Epoch 167/500 - Iteration 80/95 - Time 0.366 batch, 0.051 data, 0.327 forward
[INFO] - 02-27 19:41:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0033)
[INFO] - 02-27 19:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5883 (0.5871)
[INFO] - 02-27 19:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5445 (-287.5440)
[INFO] - 02-27 19:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8213 (31.8273)
[INFO] - 02-27 19:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6140 (371.5667)
[INFO] - 02-27 19:41:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9633)
[INFO] - 02-27 19:41:09 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:41:09 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:41:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:41:09 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:41:09 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:41:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:41:09 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:41:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.101
[INFO] - 02-27 19:41:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.102
[INFO] - 02-27 19:41:12 - [main.summary_metrics:168]: Epoch 167/500 - Test Results:
{'auc': 0.8441779878618114,
 'f1': 0.4166477272727273,
 'loss': 0.4413501173223473,
 'ndcg': 0.717433528363705,
 'precision': 0.55625,
 'recall': 0.3335828081232493}
[INFO] - 02-27 19:41:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[167] Complete. Time taken: 00:00:37.828
[INFO] - 02-27 19:41:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:41:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:41:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:41:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:41:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:41:12 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3038, 2210, 2212, 1]
[INFO] - 02-27 19:41:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:41:26 - [main.backward:225]: Epoch 168/500 - Iteration 35/95 - Time 0.393 batch, 0.068 data, 0.352 forward
[INFO] - 02-27 19:41:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:41:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0030)
[INFO] - 02-27 19:41:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5857)
[INFO] - 02-27 19:41:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5438)
[INFO] - 02-27 19:41:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7660 (31.8444)
[INFO] - 02-27 19:41:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9621 (371.5100)
[INFO] - 02-27 19:41:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:41:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9678)
[INFO] - 02-27 19:41:44 - [main.backward:225]: Epoch 168/500 - Iteration 85/95 - Time 0.376 batch, 0.052 data, 0.335 forward
[INFO] - 02-27 19:41:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 19:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5924 (0.5863)
[INFO] - 02-27 19:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5412 (-287.5452)
[INFO] - 02-27 19:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8218 (31.8360)
[INFO] - 02-27 19:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.9678 (371.5447)
[INFO] - 02-27 19:41:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9661)
[INFO] - 02-27 19:41:47 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:41:47 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:41:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:41:47 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:41:47 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:41:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:41:47 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:41:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.094
[INFO] - 02-27 19:41:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.095
[INFO] - 02-27 19:41:51 - [main.summary_metrics:168]: Epoch 168/500 - Test Results:
{'auc': 0.846414260618463,
 'f1': 0.4118329124579125,
 'loss': 0.43959591634614237,
 'ndcg': 0.7211725913559666,
 'precision': 0.55,
 'recall': 0.3296612394957983}
[INFO] - 02-27 19:41:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[168] Complete. Time taken: 00:00:38.671
[INFO] - 02-27 19:41:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:41:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:41:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:41:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:41:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:41:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3075, 2192, 2204, 1]
[INFO] - 02-27 19:41:51 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:42:06 - [main.backward:225]: Epoch 169/500 - Iteration 40/95 - Time 0.384 batch, 0.062 data, 0.344 forward
[INFO] - 02-27 19:42:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0035)
[INFO] - 02-27 19:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5867)
[INFO] - 02-27 19:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5449)
[INFO] - 02-27 19:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8425 (31.8337)
[INFO] - 02-27 19:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9209 (371.6702)
[INFO] - 02-27 19:42:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:42:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9605)
[INFO] - 02-27 19:42:24 - [main.backward:225]: Epoch 169/500 - Iteration 90/95 - Time 0.369 batch, 0.052 data, 0.327 forward
[INFO] - 02-27 19:42:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:42:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 19:42:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5834 (0.5854)
[INFO] - 02-27 19:42:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5465 (-287.5454)
[INFO] - 02-27 19:42:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8024 (31.8298)
[INFO] - 02-27 19:42:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3660 (371.4905)
[INFO] - 02-27 19:42:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:42:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9683)
[INFO] - 02-27 19:42:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:42:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:42:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:42:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:42:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:42:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:42:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:42:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.083
[INFO] - 02-27 19:42:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.083
[INFO] - 02-27 19:42:29 - [main.summary_metrics:168]: Epoch 169/500 - Test Results:
{'auc': 0.845926471936814,
 'f1': 0.4210921717171717,
 'loss': 0.4380443810665092,
 'ndcg': 0.7226870420731963,
 'precision': 0.5625,
 'recall': 0.3370141806722689}
[INFO] - 02-27 19:42:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[169] Complete. Time taken: 00:00:38.047
[INFO] - 02-27 19:42:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:42:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:42:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:42:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:42:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:42:29 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2207, 2211, 1]
[INFO] - 02-27 19:42:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:42:46 - [main.backward:225]: Epoch 170/500 - Iteration 45/95 - Time 0.387 batch, 0.063 data, 0.347 forward
[INFO] - 02-27 19:42:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:42:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 19:42:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5811 (0.5861)
[INFO] - 02-27 19:42:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5448 (-287.5472)
[INFO] - 02-27 19:42:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8882 (31.8181)
[INFO] - 02-27 19:42:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.7247 (371.6599)
[INFO] - 02-27 19:42:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:42:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9683)
[INFO] - 02-27 19:43:04 - [main.backward:225]: Epoch 170/500 - Iteration 0/95 - Time 0.377 batch, 0.052 data, 0.336 forward
[INFO] - 02-27 19:43:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:43:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0030)
[INFO] - 02-27 19:43:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5901 (0.5871)
[INFO] - 02-27 19:43:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5488)
[INFO] - 02-27 19:43:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7481 (31.8067)
[INFO] - 02-27 19:43:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.0496 (371.5554)
[INFO] - 02-27 19:43:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:43:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9684)
[INFO] - 02-27 19:43:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:43:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:43:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:43:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:43:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:43:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:43:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:43:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.196
[INFO] - 02-27 19:43:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.197
[INFO] - 02-27 19:43:08 - [main.summary_metrics:168]: Epoch 170/500 - Test Results:
{'auc': 0.8448799333458874,
 'f1': 0.42330281986531987,
 'loss': 0.4406393190481681,
 'ndcg': 0.7216317305047346,
 'precision': 0.5656249999999999,
 'recall': 0.3387036064425771}
[INFO] - 02-27 19:43:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[170] Complete. Time taken: 00:00:39.019
[INFO] - 02-27 19:43:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:43:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:43:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:43:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:43:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:43:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2208, 2219, 1]
[INFO] - 02-27 19:43:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:43:27 - [main.backward:225]: Epoch 171/500 - Iteration 50/95 - Time 0.395 batch, 0.077 data, 0.354 forward
[INFO] - 02-27 19:43:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0029)
[INFO] - 02-27 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5812 (0.5853)
[INFO] - 02-27 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5464)
[INFO] - 02-27 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8035 (31.8258)
[INFO] - 02-27 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7076 (371.5238)
[INFO] - 02-27 19:43:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:43:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9670)
[INFO] - 02-27 19:43:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:43:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:43:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:43:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:43:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:43:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:43:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:43:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.550
[INFO] - 02-27 19:43:44 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.551
[INFO] - 02-27 19:43:44 - [main.summary_metrics:168]: Epoch 171/500 - Test Results:
{'auc': 0.8451657799762061,
 'f1': 0.4085984848484848,
 'loss': 0.44003790332468706,
 'ndcg': 0.7212022233192633,
 'precision': 0.546875,
 'recall': 0.3265143557422969}
[INFO] - 02-27 19:43:44 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[171] Complete. Time taken: 00:00:36.499
[INFO] - 02-27 19:43:44 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:43:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:43:44 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:43:44 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:43:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:43:44 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3032, 2203, 2209, 1]
[INFO] - 02-27 19:43:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:43:46 - [main.backward:225]: Epoch 172/500 - Iteration 5/95 - Time 0.442 batch, 0.180 data, 0.408 forward
[INFO] - 02-27 19:43:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:43:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0014 (0.0033)
[INFO] - 02-27 19:43:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5860)
[INFO] - 02-27 19:43:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5472 (-287.5460)
[INFO] - 02-27 19:43:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8005 (31.8227)
[INFO] - 02-27 19:43:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6664 (371.7023)
[INFO] - 02-27 19:43:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:43:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9666)
[INFO] - 02-27 19:44:01 - [main.backward:225]: Epoch 172/500 - Iteration 55/95 - Time 0.313 batch, 0.048 data, 0.278 forward
[INFO] - 02-27 19:44:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0028)
[INFO] - 02-27 19:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5812 (0.5862)
[INFO] - 02-27 19:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5463)
[INFO] - 02-27 19:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8079 (31.8181)
[INFO] - 02-27 19:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5642 (371.6322)
[INFO] - 02-27 19:44:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:44:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9698)
[INFO] - 02-27 19:44:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:44:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:44:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:44:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:44:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:44:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:44:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:44:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.961
[INFO] - 02-27 19:44:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.962
[INFO] - 02-27 19:44:17 - [main.summary_metrics:168]: Epoch 172/500 - Test Results:
{'auc': 0.8443572603673823,
 'f1': 0.392209595959596,
 'loss': 0.43991667969290493,
 'ndcg': 0.7139531245590681,
 'precision': 0.525,
 'recall': 0.3134016106442577}
[INFO] - 02-27 19:44:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[172] Complete. Time taken: 00:00:32.666
[INFO] - 02-27 19:44:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:44:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:44:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:44:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:44:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:44:17 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3036, 2218, 2239, 1]
[INFO] - 02-27 19:44:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:44:21 - [main.backward:225]: Epoch 173/500 - Iteration 10/95 - Time 0.394 batch, 0.121 data, 0.357 forward
[INFO] - 02-27 19:44:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0033)
[INFO] - 02-27 19:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5836 (0.5861)
[INFO] - 02-27 19:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5484 (-287.5488)
[INFO] - 02-27 19:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7654 (31.8155)
[INFO] - 02-27 19:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5934 (371.6518)
[INFO] - 02-27 19:44:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:44:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9625)
[INFO] - 02-27 19:44:35 - [main.backward:225]: Epoch 173/500 - Iteration 60/95 - Time 0.311 batch, 0.049 data, 0.275 forward
[INFO] - 02-27 19:44:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0034)
[INFO] - 02-27 19:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5844 (0.5874)
[INFO] - 02-27 19:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5431 (-287.5470)
[INFO] - 02-27 19:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7978 (31.7981)
[INFO] - 02-27 19:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9521 (371.4258)
[INFO] - 02-27 19:44:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:44:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9587)
[INFO] - 02-27 19:44:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:44:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:44:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:44:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:44:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:44:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:44:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:44:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.632
[INFO] - 02-27 19:44:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.633
[INFO] - 02-27 19:44:49 - [main.summary_metrics:168]: Epoch 173/500 - Test Results:
{'auc': 0.8444138711857292,
 'f1': 0.4093329124579125,
 'loss': 0.4411306293410162,
 'ndcg': 0.7229993532284823,
 'precision': 0.546875,
 'recall': 0.32757790616246496}
[INFO] - 02-27 19:44:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[173] Complete. Time taken: 00:00:31.967
[INFO] - 02-27 19:44:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:44:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:44:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:44:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:44:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:44:49 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3018, 2192, 2185, 1]
[INFO] - 02-27 19:44:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:44:54 - [main.backward:225]: Epoch 174/500 - Iteration 15/95 - Time 0.368 batch, 0.088 data, 0.328 forward
[INFO] - 02-27 19:44:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0032)
[INFO] - 02-27 19:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5868)
[INFO] - 02-27 19:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5392 (-287.5430)
[INFO] - 02-27 19:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8242 (31.8095)
[INFO] - 02-27 19:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6322 (371.7110)
[INFO] - 02-27 19:44:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:44:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9650)
[INFO] - 02-27 19:45:10 - [main.backward:225]: Epoch 174/500 - Iteration 65/95 - Time 0.325 batch, 0.050 data, 0.285 forward
[INFO] - 02-27 19:45:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:45:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0032)
[INFO] - 02-27 19:45:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5855 (0.5859)
[INFO] - 02-27 19:45:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5428 (-287.5419)
[INFO] - 02-27 19:45:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8623 (31.8022)
[INFO] - 02-27 19:45:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1614 (371.6480)
[INFO] - 02-27 19:45:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:45:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9642)
[INFO] - 02-27 19:45:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:45:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:45:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:45:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:45:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:45:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:45:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:45:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.541
[INFO] - 02-27 19:45:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.541
[INFO] - 02-27 19:45:21 - [main.summary_metrics:168]: Epoch 174/500 - Test Results:
{'auc': 0.843194262079832,
 'f1': 0.4092287457912458,
 'loss': 0.4406369758009062,
 'ndcg': 0.7165407496829683,
 'precision': 0.546875,
 'recall': 0.32742909663865544}
[INFO] - 02-27 19:45:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[174] Complete. Time taken: 00:00:32.391
[INFO] - 02-27 19:45:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:45:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:45:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:45:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:45:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:45:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3057, 2198, 2214, 1]
[INFO] - 02-27 19:45:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:45:27 - [main.backward:225]: Epoch 175/500 - Iteration 20/95 - Time 0.316 batch, 0.066 data, 0.285 forward
[INFO] - 02-27 19:45:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0034)
[INFO] - 02-27 19:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5855)
[INFO] - 02-27 19:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5431 (-287.5429)
[INFO] - 02-27 19:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8105 (31.8039)
[INFO] - 02-27 19:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9211 (371.5258)
[INFO] - 02-27 19:45:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:45:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9628)
[INFO] - 02-27 19:45:42 - [main.backward:225]: Epoch 175/500 - Iteration 70/95 - Time 0.293 batch, 0.042 data, 0.262 forward
[INFO] - 02-27 19:45:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:45:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0032)
[INFO] - 02-27 19:45:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5910 (0.5851)
[INFO] - 02-27 19:45:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5437 (-287.5435)
[INFO] - 02-27 19:45:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7683 (31.8026)
[INFO] - 02-27 19:45:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0542 (371.6281)
[INFO] - 02-27 19:45:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:45:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9669)
[INFO] - 02-27 19:45:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:45:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:45:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:45:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:45:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:45:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:45:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:45:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.502
[INFO] - 02-27 19:45:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.503
[INFO] - 02-27 19:45:51 - [main.summary_metrics:168]: Epoch 175/500 - Test Results:
{'auc': 0.8456369769721614,
 'f1': 0.4158838383838384,
 'loss': 0.43988969801421246,
 'ndcg': 0.7203673963300327,
 'precision': 0.55625,
 'recall': 0.3325498949579832}
[INFO] - 02-27 19:45:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[175] Complete. Time taken: 00:00:29.939
[INFO] - 02-27 19:45:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:45:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:45:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:45:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:45:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:45:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2214, 2197, 1]
[INFO] - 02-27 19:45:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:46:00 - [main.backward:225]: Epoch 176/500 - Iteration 25/95 - Time 0.338 batch, 0.060 data, 0.305 forward
[INFO] - 02-27 19:46:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:46:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0029)
[INFO] - 02-27 19:46:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5886 (0.5863)
[INFO] - 02-27 19:46:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5460 (-287.5446)
[INFO] - 02-27 19:46:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8732 (31.8015)
[INFO] - 02-27 19:46:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0732 (371.6786)
[INFO] - 02-27 19:46:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:46:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9706)
[INFO] - 02-27 19:46:15 - [main.backward:225]: Epoch 176/500 - Iteration 75/95 - Time 0.316 batch, 0.043 data, 0.282 forward
[INFO] - 02-27 19:46:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:46:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0032)
[INFO] - 02-27 19:46:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5863)
[INFO] - 02-27 19:46:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5426 (-287.5427)
[INFO] - 02-27 19:46:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8422 (31.7975)
[INFO] - 02-27 19:46:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0781 (371.5691)
[INFO] - 02-27 19:46:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:46:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9673)
[INFO] - 02-27 19:46:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:46:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:46:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:46:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:46:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:46:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:46:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:46:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.641
[INFO] - 02-27 19:46:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.642
[INFO] - 02-27 19:46:23 - [main.summary_metrics:168]: Epoch 176/500 - Test Results:
{'auc': 0.8462603044894428,
 'f1': 0.4189625420875421,
 'loss': 0.4390620192601544,
 'ndcg': 0.7203409693836554,
 'precision': 0.559375,
 'recall': 0.335421043417367}
[INFO] - 02-27 19:46:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[176] Complete. Time taken: 00:00:32.301
[INFO] - 02-27 19:46:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:46:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:46:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:46:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:46:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:46:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2198, 2219, 1]
[INFO] - 02-27 19:46:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:46:33 - [main.backward:225]: Epoch 177/500 - Iteration 30/95 - Time 0.330 batch, 0.062 data, 0.297 forward
[INFO] - 02-27 19:46:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:46:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0032)
[INFO] - 02-27 19:46:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5834 (0.5856)
[INFO] - 02-27 19:46:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5381 (-287.5423)
[INFO] - 02-27 19:46:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8380 (31.7964)
[INFO] - 02-27 19:46:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.7477 (371.5690)
[INFO] - 02-27 19:46:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:46:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9655)
[INFO] - 02-27 19:46:48 - [main.backward:225]: Epoch 177/500 - Iteration 80/95 - Time 0.310 batch, 0.044 data, 0.276 forward
[INFO] - 02-27 19:46:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:46:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0030)
[INFO] - 02-27 19:46:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5838 (0.5854)
[INFO] - 02-27 19:46:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5440 (-287.5410)
[INFO] - 02-27 19:46:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7788 (31.7836)
[INFO] - 02-27 19:46:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3423 (371.2733)
[INFO] - 02-27 19:46:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:46:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9663)
[INFO] - 02-27 19:46:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:46:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:46:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:46:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:46:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:46:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:46:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:46:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.832
[INFO] - 02-27 19:46:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.833
[INFO] - 02-27 19:46:55 - [main.summary_metrics:168]: Epoch 177/500 - Test Results:
{'auc': 0.8458358829438638,
 'f1': 0.4305366161616162,
 'loss': 0.43882343830918014,
 'ndcg': 0.7214283646185402,
 'precision': 0.575,
 'recall': 0.3446122198879552}
[INFO] - 02-27 19:46:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[177] Complete. Time taken: 00:00:32.049
[INFO] - 02-27 19:46:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:46:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:46:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:46:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:46:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:46:55 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3076, 2202, 2199, 1]
[INFO] - 02-27 19:46:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:47:07 - [main.backward:225]: Epoch 178/500 - Iteration 35/95 - Time 0.332 batch, 0.058 data, 0.294 forward
[INFO] - 02-27 19:47:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:47:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0030)
[INFO] - 02-27 19:47:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5899 (0.5848)
[INFO] - 02-27 19:47:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5434 (-287.5442)
[INFO] - 02-27 19:47:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7914 (31.8005)
[INFO] - 02-27 19:47:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4858 (371.5537)
[INFO] - 02-27 19:47:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:47:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9689)
[INFO] - 02-27 19:47:22 - [main.backward:225]: Epoch 178/500 - Iteration 85/95 - Time 0.317 batch, 0.045 data, 0.281 forward
[INFO] - 02-27 19:47:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 19:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5848 (0.5860)
[INFO] - 02-27 19:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5437 (-287.5452)
[INFO] - 02-27 19:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7548 (31.7860)
[INFO] - 02-27 19:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9995 (371.6051)
[INFO] - 02-27 19:47:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:47:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9655)
[INFO] - 02-27 19:47:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:47:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:47:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:47:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.634
[INFO] - 02-27 19:47:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.635
[INFO] - 02-27 19:47:28 - [main.summary_metrics:168]: Epoch 178/500 - Test Results:
{'auc': 0.84613139967997,
 'f1': 0.4143329124579125,
 'loss': 0.43734287085388457,
 'ndcg': 0.7209018786406832,
 'precision': 0.553125,
 'recall': 0.3317445728291316}
[INFO] - 02-27 19:47:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[178] Complete. Time taken: 00:00:32.579
[INFO] - 02-27 19:47:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:47:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:47:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:47:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:47:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:47:28 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2204, 2213, 1]
[INFO] - 02-27 19:47:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:47:41 - [main.backward:225]: Epoch 179/500 - Iteration 40/95 - Time 0.326 batch, 0.054 data, 0.290 forward
[INFO] - 02-27 19:47:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:47:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0034)
[INFO] - 02-27 19:47:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5754 (0.5852)
[INFO] - 02-27 19:47:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5434 (-287.5444)
[INFO] - 02-27 19:47:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7695 (31.8056)
[INFO] - 02-27 19:47:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6585 (371.6433)
[INFO] - 02-27 19:47:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:47:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9616)
[INFO] - 02-27 19:47:56 - [main.backward:225]: Epoch 179/500 - Iteration 90/95 - Time 0.314 batch, 0.043 data, 0.279 forward
[INFO] - 02-27 19:47:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:47:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0032)
[INFO] - 02-27 19:47:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5857)
[INFO] - 02-27 19:47:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5408 (-287.5436)
[INFO] - 02-27 19:47:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7337 (31.8035)
[INFO] - 02-27 19:47:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5177 (371.4588)
[INFO] - 02-27 19:47:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:47:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9633)
[INFO] - 02-27 19:47:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:47:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:47:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:47:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:47:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:47:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:47:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:48:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.709
[INFO] - 02-27 19:48:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.710
[INFO] - 02-27 19:48:01 - [main.summary_metrics:168]: Epoch 179/500 - Test Results:
{'auc': 0.8459208316905193,
 'f1': 0.4019949494949495,
 'loss': 0.4391774577891624,
 'ndcg': 0.720474392647785,
 'precision': 0.5375,
 'recall': 0.3215204831932773}
[INFO] - 02-27 19:48:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[179] Complete. Time taken: 00:00:32.570
[INFO] - 02-27 19:48:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:48:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:48:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:48:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:48:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:48:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3028, 2204, 2224, 1]
[INFO] - 02-27 19:48:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:48:15 - [main.backward:225]: Epoch 180/500 - Iteration 45/95 - Time 0.324 batch, 0.052 data, 0.290 forward
[INFO] - 02-27 19:48:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0029)
[INFO] - 02-27 19:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5807 (0.5876)
[INFO] - 02-27 19:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5480 (-287.5458)
[INFO] - 02-27 19:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8213 (31.7811)
[INFO] - 02-27 19:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0619 (371.3048)
[INFO] - 02-27 19:48:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:48:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9691)
[INFO] - 02-27 19:48:30 - [main.backward:225]: Epoch 180/500 - Iteration 0/95 - Time 0.311 batch, 0.042 data, 0.277 forward
[INFO] - 02-27 19:48:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:48:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0032)
[INFO] - 02-27 19:48:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5922 (0.5862)
[INFO] - 02-27 19:48:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5445)
[INFO] - 02-27 19:48:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7888 (31.8018)
[INFO] - 02-27 19:48:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9169 (371.5054)
[INFO] - 02-27 19:48:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:48:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9631)
[INFO] - 02-27 19:48:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:48:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:48:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:48:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:48:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:48:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:48:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:48:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.625
[INFO] - 02-27 19:48:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.626
[INFO] - 02-27 19:48:33 - [main.summary_metrics:168]: Epoch 180/500 - Test Results:
{'auc': 0.8454724033608542,
 'f1': 0.4212773569023569,
 'loss': 0.43833982797307625,
 'ndcg': 0.7189275138720875,
 'precision': 0.5625,
 'recall': 0.33725927871148464}
[INFO] - 02-27 19:48:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[180] Complete. Time taken: 00:00:32.180
[INFO] - 02-27 19:48:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:48:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:48:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:48:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:48:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:48:33 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2207, 2221, 1]
[INFO] - 02-27 19:48:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:48:49 - [main.backward:225]: Epoch 181/500 - Iteration 50/95 - Time 0.316 batch, 0.051 data, 0.280 forward
[INFO] - 02-27 19:48:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:48:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0032)
[INFO] - 02-27 19:48:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5855)
[INFO] - 02-27 19:48:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5437 (-287.5442)
[INFO] - 02-27 19:48:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7666 (31.7843)
[INFO] - 02-27 19:48:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3057 (371.4104)
[INFO] - 02-27 19:48:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:48:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9680)
[INFO] - 02-27 19:49:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:49:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:49:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:49:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:49:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:49:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:49:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:49:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.649
[INFO] - 02-27 19:49:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.649
[INFO] - 02-27 19:49:05 - [main.summary_metrics:168]: Epoch 181/500 - Test Results:
{'auc': 0.847723847136894,
 'f1': 0.4184880050505051,
 'loss': 0.4363780578002715,
 'ndcg': 0.7261297988777142,
 'precision': 0.559375,
 'recall': 0.33478203781512605}
[INFO] - 02-27 19:49:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[181] Complete. Time taken: 00:00:31.980
[INFO] - 02-27 19:49:05 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:49:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:49:05 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:49:05 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:49:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:49:05 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2183, 2198, 1]
[INFO] - 02-27 19:49:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:49:07 - [main.backward:225]: Epoch 182/500 - Iteration 5/95 - Time 0.468 batch, 0.193 data, 0.432 forward
[INFO] - 02-27 19:49:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0030)
[INFO] - 02-27 19:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5859)
[INFO] - 02-27 19:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5492 (-287.5450)
[INFO] - 02-27 19:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8139 (31.7923)
[INFO] - 02-27 19:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6253 (371.5383)
[INFO] - 02-27 19:49:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:49:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9677)
[INFO] - 02-27 19:49:22 - [main.backward:225]: Epoch 182/500 - Iteration 55/95 - Time 0.319 batch, 0.046 data, 0.287 forward
[INFO] - 02-27 19:49:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:49:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0032)
[INFO] - 02-27 19:49:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5908 (0.5865)
[INFO] - 02-27 19:49:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5471)
[INFO] - 02-27 19:49:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8946 (31.8137)
[INFO] - 02-27 19:49:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5917 (371.5698)
[INFO] - 02-27 19:49:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:49:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9661)
[INFO] - 02-27 19:49:35 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:49:35 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:49:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:49:35 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:49:35 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:49:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:49:35 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:49:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.610
[INFO] - 02-27 19:49:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.611
[INFO] - 02-27 19:49:37 - [main.summary_metrics:168]: Epoch 182/500 - Test Results:
{'auc': 0.8464469195153552,
 'f1': 0.4140435606060606,
 'loss': 0.43761945637811883,
 'ndcg': 0.7197552252487494,
 'precision': 0.553125,
 'recall': 0.33135066526610646}
[INFO] - 02-27 19:49:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[182] Complete. Time taken: 00:00:32.513
[INFO] - 02-27 19:49:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:49:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:49:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:49:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:49:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:49:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2172, 2225, 1]
[INFO] - 02-27 19:49:38 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:49:41 - [main.backward:225]: Epoch 183/500 - Iteration 10/95 - Time 0.380 batch, 0.109 data, 0.351 forward
[INFO] - 02-27 19:49:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0033)
[INFO] - 02-27 19:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5843 (0.5856)
[INFO] - 02-27 19:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5454 (-287.5440)
[INFO] - 02-27 19:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7891 (31.8216)
[INFO] - 02-27 19:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3176 (371.5394)
[INFO] - 02-27 19:49:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:49:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9602)
[INFO] - 02-27 19:49:56 - [main.backward:225]: Epoch 183/500 - Iteration 60/95 - Time 0.311 batch, 0.045 data, 0.279 forward
[INFO] - 02-27 19:49:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:49:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0031)
[INFO] - 02-27 19:49:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5847)
[INFO] - 02-27 19:49:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5438 (-287.5450)
[INFO] - 02-27 19:49:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7491 (31.8120)
[INFO] - 02-27 19:49:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3860 (371.3597)
[INFO] - 02-27 19:49:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:49:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9653)
[INFO] - 02-27 19:50:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:50:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:50:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:50:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:50:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:50:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:50:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:50:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.608
[INFO] - 02-27 19:50:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.609
[INFO] - 02-27 19:50:09 - [main.summary_metrics:168]: Epoch 183/500 - Test Results:
{'auc': 0.8466591281733281,
 'f1': 0.4186731902356903,
 'loss': 0.43620206955816787,
 'ndcg': 0.7201646017098744,
 'precision': 0.5593750000000001,
 'recall': 0.33502713585434174}
[INFO] - 02-27 19:50:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[183] Complete. Time taken: 00:00:32.008
[INFO] - 02-27 19:50:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:50:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:50:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:50:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:50:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:50:09 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3024, 2195, 2201, 1]
[INFO] - 02-27 19:50:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:50:14 - [main.backward:225]: Epoch 184/500 - Iteration 15/95 - Time 0.334 batch, 0.071 data, 0.308 forward
[INFO] - 02-27 19:50:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:50:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0029)
[INFO] - 02-27 19:50:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5804 (0.5851)
[INFO] - 02-27 19:50:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5394 (-287.5396)
[INFO] - 02-27 19:50:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8192 (31.8198)
[INFO] - 02-27 19:50:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9234 (371.5408)
[INFO] - 02-27 19:50:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:50:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9680)
[INFO] - 02-27 19:50:29 - [main.backward:225]: Epoch 184/500 - Iteration 65/95 - Time 0.306 batch, 0.041 data, 0.275 forward
[INFO] - 02-27 19:50:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 19:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5851)
[INFO] - 02-27 19:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5421 (-287.5409)
[INFO] - 02-27 19:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8269 (31.8041)
[INFO] - 02-27 19:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7822 (371.3520)
[INFO] - 02-27 19:50:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:50:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9666)
[INFO] - 02-27 19:50:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:50:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:50:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:50:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:50:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:50:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:50:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:50:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.442
[INFO] - 02-27 19:50:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.445
[INFO] - 02-27 19:50:40 - [main.summary_metrics:168]: Epoch 184/500 - Test Results:
{'auc': 0.8463582258270955,
 'f1': 0.409413930976431,
 'loss': 0.4373637017202201,
 'ndcg': 0.7190293737574178,
 'precision': 0.546875,
 'recall': 0.3276741946778712}
[INFO] - 02-27 19:50:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[184] Complete. Time taken: 00:00:31.059
[INFO] - 02-27 19:50:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:50:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:50:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:50:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:50:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:50:40 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3025, 2196, 2219, 1]
[INFO] - 02-27 19:50:41 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:50:47 - [main.backward:225]: Epoch 185/500 - Iteration 20/95 - Time 0.324 batch, 0.070 data, 0.293 forward
[INFO] - 02-27 19:50:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0032)
[INFO] - 02-27 19:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5857)
[INFO] - 02-27 19:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5487 (-287.5445)
[INFO] - 02-27 19:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8306 (31.8114)
[INFO] - 02-27 19:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2681 (371.5327)
[INFO] - 02-27 19:50:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:50:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9630)
[INFO] - 02-27 19:51:01 - [main.backward:225]: Epoch 185/500 - Iteration 70/95 - Time 0.298 batch, 0.042 data, 0.267 forward
[INFO] - 02-27 19:51:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0030)
[INFO] - 02-27 19:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5954 (0.5861)
[INFO] - 02-27 19:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5484)
[INFO] - 02-27 19:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7506 (31.8184)
[INFO] - 02-27 19:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.0255 (371.4065)
[INFO] - 02-27 19:51:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:51:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9675)
[INFO] - 02-27 19:51:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:51:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:51:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:51:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:51:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:51:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:51:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:51:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.620
[INFO] - 02-27 19:51:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.620
[INFO] - 02-27 19:51:11 - [main.summary_metrics:168]: Epoch 185/500 - Test Results:
{'auc': 0.8475581504660687,
 'f1': 0.4189625420875421,
 'loss': 0.43783749503691416,
 'ndcg': 0.7228894288655028,
 'precision': 0.559375,
 'recall': 0.33542104341736695}
[INFO] - 02-27 19:51:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[185] Complete. Time taken: 00:00:30.688
[INFO] - 02-27 19:51:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:51:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:51:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:51:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:51:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:51:11 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2200, 2228, 1]
[INFO] - 02-27 19:51:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:51:19 - [main.backward:225]: Epoch 186/500 - Iteration 25/95 - Time 0.321 batch, 0.064 data, 0.287 forward
[INFO] - 02-27 19:51:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0033)
[INFO] - 02-27 19:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5858)
[INFO] - 02-27 19:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5501 (-287.5477)
[INFO] - 02-27 19:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7717 (31.8041)
[INFO] - 02-27 19:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2359 (371.3664)
[INFO] - 02-27 19:51:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:51:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9611)
[INFO] - 02-27 19:51:34 - [main.backward:225]: Epoch 186/500 - Iteration 75/95 - Time 0.302 batch, 0.044 data, 0.267 forward
[INFO] - 02-27 19:51:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:51:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0031)
[INFO] - 02-27 19:51:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5908 (0.5863)
[INFO] - 02-27 19:51:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5471)
[INFO] - 02-27 19:51:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8049 (31.8009)
[INFO] - 02-27 19:51:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3707 (371.5048)
[INFO] - 02-27 19:51:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:51:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9652)
[INFO] - 02-27 19:51:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:51:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:51:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:51:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:51:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:51:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:51:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:51:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.678
[INFO] - 02-27 19:51:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.679
[INFO] - 02-27 19:51:42 - [main.summary_metrics:168]: Epoch 186/500 - Test Results:
{'auc': 0.8465461182021827,
 'f1': 0.41848800505050504,
 'loss': 0.4388511880242443,
 'ndcg': 0.7207580248238601,
 'precision': 0.559375,
 'recall': 0.33478203781512605}
[INFO] - 02-27 19:51:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[186] Complete. Time taken: 00:00:31.332
[INFO] - 02-27 19:51:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:51:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:51:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:51:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:51:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:51:42 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2193, 2202, 1]
[INFO] - 02-27 19:51:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:51:52 - [main.backward:225]: Epoch 187/500 - Iteration 30/95 - Time 0.334 batch, 0.059 data, 0.300 forward
[INFO] - 02-27 19:51:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:51:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0031)
[INFO] - 02-27 19:51:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5863)
[INFO] - 02-27 19:51:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5421 (-287.5437)
[INFO] - 02-27 19:51:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7530 (31.7937)
[INFO] - 02-27 19:51:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8594 (371.4604)
[INFO] - 02-27 19:51:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:51:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9644)
[INFO] - 02-27 19:52:07 - [main.backward:225]: Epoch 187/500 - Iteration 80/95 - Time 0.307 batch, 0.042 data, 0.274 forward
[INFO] - 02-27 19:52:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:52:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0029)
[INFO] - 02-27 19:52:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5860)
[INFO] - 02-27 19:52:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5427)
[INFO] - 02-27 19:52:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8069 (31.7958)
[INFO] - 02-27 19:52:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9035 (371.5656)
[INFO] - 02-27 19:52:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:52:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9711)
[INFO] - 02-27 19:52:11 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:52:11 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:52:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:52:11 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:52:11 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:52:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:52:11 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:52:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.609
[INFO] - 02-27 19:52:14 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.610
[INFO] - 02-27 19:52:14 - [main.summary_metrics:168]: Epoch 187/500 - Test Results:
{'auc': 0.8454711950343863,
 'f1': 0.41404356060606057,
 'loss': 0.4376662753760267,
 'ndcg': 0.7238282214186347,
 'precision': 0.5531250000000001,
 'recall': 0.33135066526610646}
[INFO] - 02-27 19:52:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[187] Complete. Time taken: 00:00:31.564
[INFO] - 02-27 19:52:14 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:52:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:52:14 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:52:14 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:52:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:52:14 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2187, 2222, 1]
[INFO] - 02-27 19:52:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:52:25 - [main.backward:225]: Epoch 188/500 - Iteration 35/95 - Time 0.306 batch, 0.052 data, 0.275 forward
[INFO] - 02-27 19:52:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:52:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0031)
[INFO] - 02-27 19:52:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5795 (0.5849)
[INFO] - 02-27 19:52:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5437)
[INFO] - 02-27 19:52:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8329 (31.8013)
[INFO] - 02-27 19:52:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5330 (371.3608)
[INFO] - 02-27 19:52:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:52:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9672)
[INFO] - 02-27 19:52:39 - [main.backward:225]: Epoch 188/500 - Iteration 85/95 - Time 0.294 batch, 0.040 data, 0.263 forward
[INFO] - 02-27 19:52:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:52:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0030)
[INFO] - 02-27 19:52:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5896 (0.5843)
[INFO] - 02-27 19:52:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5444 (-287.5446)
[INFO] - 02-27 19:52:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8433 (31.8038)
[INFO] - 02-27 19:52:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8892 (371.3976)
[INFO] - 02-27 19:52:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:52:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9691)
[INFO] - 02-27 19:52:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:52:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:52:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:52:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:52:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:52:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:52:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:52:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.613
[INFO] - 02-27 19:52:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.614
[INFO] - 02-27 19:52:45 - [main.summary_metrics:168]: Epoch 188/500 - Test Results:
{'auc': 0.8461395450949988,
 'f1': 0.406913930976431,
 'loss': 0.43812799217870274,
 'ndcg': 0.7202331099349222,
 'precision': 0.54375,
 'recall': 0.32559086134453785}
[INFO] - 02-27 19:52:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[188] Complete. Time taken: 00:00:30.620
[INFO] - 02-27 19:52:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:52:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:52:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:52:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:52:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:52:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2212, 2213, 1]
[INFO] - 02-27 19:52:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:52:58 - [main.backward:225]: Epoch 189/500 - Iteration 40/95 - Time 0.342 batch, 0.058 data, 0.303 forward
[INFO] - 02-27 19:52:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 19:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5883 (0.5850)
[INFO] - 02-27 19:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5419 (-287.5420)
[INFO] - 02-27 19:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7598 (31.8139)
[INFO] - 02-27 19:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8216 (371.3219)
[INFO] - 02-27 19:52:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:52:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9669)
[INFO] - 02-27 19:53:15 - [main.backward:225]: Epoch 189/500 - Iteration 90/95 - Time 0.333 batch, 0.048 data, 0.294 forward
[INFO] - 02-27 19:53:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0032)
[INFO] - 02-27 19:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5860 (0.5853)
[INFO] - 02-27 19:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5419)
[INFO] - 02-27 19:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8273 (31.8013)
[INFO] - 02-27 19:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9033 (371.3614)
[INFO] - 02-27 19:53:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:53:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9658)
[INFO] - 02-27 19:53:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:53:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:53:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:53:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:53:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:53:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:53:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:53:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.510
[INFO] - 02-27 19:53:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.512
[INFO] - 02-27 19:53:18 - [main.summary_metrics:168]: Epoch 189/500 - Test Results:
{'auc': 0.8470335417255137,
 'f1': 0.41191393097643103,
 'loss': 0.4376477421512759,
 'ndcg': 0.7186668649481521,
 'precision': 0.55,
 'recall': 0.3297575280112045}
[INFO] - 02-27 19:53:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[189] Complete. Time taken: 00:00:33.891
[INFO] - 02-27 19:53:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:53:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:53:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:53:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:53:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:53:18 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3040, 2207, 2209, 1]
[INFO] - 02-27 19:53:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:53:32 - [main.backward:225]: Epoch 190/500 - Iteration 45/95 - Time 0.293 batch, 0.044 data, 0.265 forward
[INFO] - 02-27 19:53:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0033)
[INFO] - 02-27 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5845 (0.5838)
[INFO] - 02-27 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5467)
[INFO] - 02-27 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7923 (31.8014)
[INFO] - 02-27 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2518 (371.5371)
[INFO] - 02-27 19:53:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:53:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9644)
[INFO] - 02-27 19:53:46 - [main.backward:225]: Epoch 190/500 - Iteration 0/95 - Time 0.286 batch, 0.037 data, 0.256 forward
[INFO] - 02-27 19:53:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:53:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0031)
[INFO] - 02-27 19:53:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5873 (0.5860)
[INFO] - 02-27 19:53:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5379 (-287.5428)
[INFO] - 02-27 19:53:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8533 (31.8076)
[INFO] - 02-27 19:53:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2816 (371.6960)
[INFO] - 02-27 19:53:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:53:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9623)
[INFO] - 02-27 19:53:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:53:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:53:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:53:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:53:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:53:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:53:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:53:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.438
[INFO] - 02-27 19:53:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.439
[INFO] - 02-27 19:53:48 - [main.summary_metrics:168]: Epoch 190/500 - Test Results:
{'auc': 0.8452763273814428,
 'f1': 0.40691393097643097,
 'loss': 0.43979422562884224,
 'ndcg': 0.7167994747227678,
 'precision': 0.54375,
 'recall': 0.32559086134453785}
[INFO] - 02-27 19:53:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[190] Complete. Time taken: 00:00:29.584
[INFO] - 02-27 19:53:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:53:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:53:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:53:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:53:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:53:48 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3024, 2202, 2215, 1]
[INFO] - 02-27 19:53:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:54:04 - [main.backward:225]: Epoch 191/500 - Iteration 50/95 - Time 0.318 batch, 0.048 data, 0.285 forward
[INFO] - 02-27 19:54:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:54:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0033)
[INFO] - 02-27 19:54:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5864)
[INFO] - 02-27 19:54:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5448 (-287.5436)
[INFO] - 02-27 19:54:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8037 (31.8111)
[INFO] - 02-27 19:54:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6885 (371.5797)
[INFO] - 02-27 19:54:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:54:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9647)
[INFO] - 02-27 19:54:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:54:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:54:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:54:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:54:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:54:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:54:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:54:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.431
[INFO] - 02-27 19:54:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.432
[INFO] - 02-27 19:54:20 - [main.summary_metrics:168]: Epoch 191/500 - Test Results:
{'auc': 0.8463300157072633,
 'f1': 0.4209880050505051,
 'loss': 0.4395193299322244,
 'ndcg': 0.7205220594057111,
 'precision': 0.5625,
 'recall': 0.3368653711484594}
[INFO] - 02-27 19:54:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[191] Complete. Time taken: 00:00:32.169
[INFO] - 02-27 19:54:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:54:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:54:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:54:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:54:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:54:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3042, 2210, 2212, 1]
[INFO] - 02-27 19:54:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:54:23 - [main.backward:225]: Epoch 192/500 - Iteration 5/95 - Time 0.492 batch, 0.217 data, 0.459 forward
[INFO] - 02-27 19:54:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 19:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5881 (0.5863)
[INFO] - 02-27 19:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5422 (-287.5424)
[INFO] - 02-27 19:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7043 (31.8071)
[INFO] - 02-27 19:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3277 (371.3932)
[INFO] - 02-27 19:54:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:54:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9644)
[INFO] - 02-27 19:54:38 - [main.backward:225]: Epoch 192/500 - Iteration 55/95 - Time 0.320 batch, 0.050 data, 0.287 forward
[INFO] - 02-27 19:54:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:54:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0031)
[INFO] - 02-27 19:54:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5805 (0.5859)
[INFO] - 02-27 19:54:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5392 (-287.5400)
[INFO] - 02-27 19:54:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8310 (31.8031)
[INFO] - 02-27 19:54:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2299 (371.5908)
[INFO] - 02-27 19:54:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:54:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9664)
[INFO] - 02-27 19:54:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:54:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:54:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:54:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:54:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:54:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:54:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:54:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.731
[INFO] - 02-27 19:54:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.732
[INFO] - 02-27 19:54:52 - [main.summary_metrics:168]: Epoch 192/500 - Test Results:
{'auc': 0.845384844378928,
 'f1': 0.4164625420875421,
 'loss': 0.43990526019730625,
 'ndcg': 0.7216378813049897,
 'precision': 0.55625,
 'recall': 0.3333377100840336}
[INFO] - 02-27 19:54:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[192] Complete. Time taken: 00:00:32.281
[INFO] - 02-27 19:54:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:54:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:54:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:54:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:54:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:54:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3041, 2200, 2218, 1]
[INFO] - 02-27 19:54:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:54:56 - [main.backward:225]: Epoch 193/500 - Iteration 10/95 - Time 0.396 batch, 0.117 data, 0.359 forward
[INFO] - 02-27 19:54:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:54:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0032)
[INFO] - 02-27 19:54:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5823 (0.5851)
[INFO] - 02-27 19:54:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5441 (-287.5454)
[INFO] - 02-27 19:54:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7215 (31.8007)
[INFO] - 02-27 19:54:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4890 (371.3818)
[INFO] - 02-27 19:54:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:54:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9669)
[INFO] - 02-27 19:55:12 - [main.backward:225]: Epoch 193/500 - Iteration 60/95 - Time 0.320 batch, 0.047 data, 0.287 forward
[INFO] - 02-27 19:55:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0032)
[INFO] - 02-27 19:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5848)
[INFO] - 02-27 19:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5405 (-287.5444)
[INFO] - 02-27 19:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8228 (31.8069)
[INFO] - 02-27 19:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2708 (371.5998)
[INFO] - 02-27 19:55:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:55:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9645)
[INFO] - 02-27 19:55:22 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:55:22 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:55:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:55:22 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:55:22 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:55:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:55:22 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:55:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.526
[INFO] - 02-27 19:55:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.526
[INFO] - 02-27 19:55:25 - [main.summary_metrics:168]: Epoch 193/500 - Test Results:
{'auc': 0.8454018585988317,
 'f1': 0.4113583754208754,
 'loss': 0.4393794957459408,
 'ndcg': 0.7229510001693733,
 'precision': 0.55,
 'recall': 0.32902223389355745}
[INFO] - 02-27 19:55:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[193] Complete. Time taken: 00:00:32.222
[INFO] - 02-27 19:55:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:55:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:55:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:55:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:55:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:55:25 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3077, 2179, 2224, 1]
[INFO] - 02-27 19:55:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:55:30 - [main.backward:225]: Epoch 194/500 - Iteration 15/95 - Time 0.388 batch, 0.090 data, 0.348 forward
[INFO] - 02-27 19:55:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0030)
[INFO] - 02-27 19:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5808 (0.5860)
[INFO] - 02-27 19:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5428 (-287.5434)
[INFO] - 02-27 19:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7656 (31.8048)
[INFO] - 02-27 19:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6122 (371.6592)
[INFO] - 02-27 19:55:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9678)
[INFO] - 02-27 19:55:46 - [main.backward:225]: Epoch 194/500 - Iteration 65/95 - Time 0.326 batch, 0.048 data, 0.290 forward
[INFO] - 02-27 19:55:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:55:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 19:55:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5859)
[INFO] - 02-27 19:55:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5455)
[INFO] - 02-27 19:55:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7191 (31.8067)
[INFO] - 02-27 19:55:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6064 (371.5715)
[INFO] - 02-27 19:55:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:55:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9666)
[INFO] - 02-27 19:55:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:55:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:55:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:55:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:55:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:55:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:55:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:55:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.646
[INFO] - 02-27 19:55:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.647
[INFO] - 02-27 19:55:57 - [main.summary_metrics:168]: Epoch 194/500 - Test Results:
{'auc': 0.8475385882907085,
 'f1': 0.42472117003367005,
 'loss': 0.4380874098836653,
 'ndcg': 0.7227524996330514,
 'precision': 0.5687500000000001,
 'recall': 0.3392857142857143}
[INFO] - 02-27 19:55:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[194] Complete. Time taken: 00:00:32.781
[INFO] - 02-27 19:55:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:55:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:55:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:55:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:55:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:55:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2178, 2235, 1]
[INFO] - 02-27 19:55:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:56:05 - [main.backward:225]: Epoch 195/500 - Iteration 20/95 - Time 0.385 batch, 0.085 data, 0.342 forward
[INFO] - 02-27 19:56:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:56:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0032)
[INFO] - 02-27 19:56:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5864)
[INFO] - 02-27 19:56:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5418 (-287.5430)
[INFO] - 02-27 19:56:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8676 (31.7971)
[INFO] - 02-27 19:56:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.8042 (371.3050)
[INFO] - 02-27 19:56:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:56:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9630)
[INFO] - 02-27 19:56:20 - [main.backward:225]: Epoch 195/500 - Iteration 70/95 - Time 0.328 batch, 0.050 data, 0.290 forward
[INFO] - 02-27 19:56:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:56:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0030)
[INFO] - 02-27 19:56:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5827 (0.5859)
[INFO] - 02-27 19:56:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5422)
[INFO] - 02-27 19:56:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7411 (31.8000)
[INFO] - 02-27 19:56:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4574 (371.3572)
[INFO] - 02-27 19:56:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:56:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9669)
[INFO] - 02-27 19:56:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:56:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:56:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:56:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:56:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:56:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:56:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:56:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.550
[INFO] - 02-27 19:56:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.550
[INFO] - 02-27 19:56:31 - [main.summary_metrics:168]: Epoch 195/500 - Test Results:
{'auc': 0.8477059913426155,
 'f1': 0.4161731902356902,
 'loss': 0.43828091115187695,
 'ndcg': 0.7201034888227562,
 'precision': 0.55625,
 'recall': 0.3329438025210084}
[INFO] - 02-27 19:56:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[195] Complete. Time taken: 00:00:33.216
[INFO] - 02-27 19:56:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:56:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:56:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:56:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:56:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:56:31 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3059, 2213, 2224, 1]
[INFO] - 02-27 19:56:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:56:39 - [main.backward:225]: Epoch 196/500 - Iteration 25/95 - Time 0.330 batch, 0.065 data, 0.295 forward
[INFO] - 02-27 19:56:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0030)
[INFO] - 02-27 19:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5935 (0.5861)
[INFO] - 02-27 19:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5416 (-287.5425)
[INFO] - 02-27 19:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8665 (31.8201)
[INFO] - 02-27 19:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6235 (371.5245)
[INFO] - 02-27 19:56:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:56:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9670)
[INFO] - 02-27 19:56:55 - [main.backward:225]: Epoch 196/500 - Iteration 75/95 - Time 0.319 batch, 0.045 data, 0.285 forward
[INFO] - 02-27 19:56:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0030)
[INFO] - 02-27 19:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5857)
[INFO] - 02-27 19:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5431 (-287.5411)
[INFO] - 02-27 19:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8068 (31.8048)
[INFO] - 02-27 19:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5245 (371.3082)
[INFO] - 02-27 19:56:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:56:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9658)
[INFO] - 02-27 19:57:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:57:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:57:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:57:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:57:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:57:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:57:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:57:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.471
[INFO] - 02-27 19:57:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.471
[INFO] - 02-27 19:57:03 - [main.summary_metrics:168]: Epoch 196/500 - Test Results:
{'auc': 0.8460326427139483,
 'f1': 0.4163583754208754,
 'loss': 0.43923156841936617,
 'ndcg': 0.720964633664628,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 19:57:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[196] Complete. Time taken: 00:00:32.812
[INFO] - 02-27 19:57:03 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:57:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:57:03 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:57:03 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:57:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:57:03 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2201, 2217, 1]
[INFO] - 02-27 19:57:04 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:57:13 - [main.backward:225]: Epoch 197/500 - Iteration 30/95 - Time 0.317 batch, 0.057 data, 0.286 forward
[INFO] - 02-27 19:57:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:57:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0030)
[INFO] - 02-27 19:57:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5782 (0.5856)
[INFO] - 02-27 19:57:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5422)
[INFO] - 02-27 19:57:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7589 (31.8141)
[INFO] - 02-27 19:57:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9537 (371.4741)
[INFO] - 02-27 19:57:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:57:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9691)
[INFO] - 02-27 19:57:28 - [main.backward:225]: Epoch 197/500 - Iteration 80/95 - Time 0.309 batch, 0.043 data, 0.276 forward
[INFO] - 02-27 19:57:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:57:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0032)
[INFO] - 02-27 19:57:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5855)
[INFO] - 02-27 19:57:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5417 (-287.5443)
[INFO] - 02-27 19:57:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8325 (31.7968)
[INFO] - 02-27 19:57:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6411 (371.5920)
[INFO] - 02-27 19:57:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:57:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9652)
[INFO] - 02-27 19:57:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:57:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:57:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:57:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:57:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:57:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:57:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:57:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.802
[INFO] - 02-27 19:57:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.803
[INFO] - 02-27 19:57:36 - [main.summary_metrics:168]: Epoch 197/500 - Test Results:
{'auc': 0.8459658363958329,
 'f1': 0.4045991161616162,
 'loss': 0.4383070566978229,
 'ndcg': 0.7212922458209539,
 'precision': 0.540625,
 'recall': 0.3237526260504202}
[INFO] - 02-27 19:57:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[197] Complete. Time taken: 00:00:32.176
[INFO] - 02-27 19:57:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:57:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:57:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:57:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:57:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:57:36 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2192, 2217, 1]
[INFO] - 02-27 19:57:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:57:47 - [main.backward:225]: Epoch 198/500 - Iteration 35/95 - Time 0.317 batch, 0.053 data, 0.283 forward
[INFO] - 02-27 19:57:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:57:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0032)
[INFO] - 02-27 19:57:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5863)
[INFO] - 02-27 19:57:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5415)
[INFO] - 02-27 19:57:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8233 (31.8198)
[INFO] - 02-27 19:57:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2094 (371.2410)
[INFO] - 02-27 19:57:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:57:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9637)
[INFO] - 02-27 19:58:02 - [main.backward:225]: Epoch 198/500 - Iteration 85/95 - Time 0.307 batch, 0.042 data, 0.272 forward
[INFO] - 02-27 19:58:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:58:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0031)
[INFO] - 02-27 19:58:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5855)
[INFO] - 02-27 19:58:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5400 (-287.5417)
[INFO] - 02-27 19:58:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8505 (31.8288)
[INFO] - 02-27 19:58:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6930 (371.5171)
[INFO] - 02-27 19:58:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:58:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9650)
[INFO] - 02-27 19:58:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:58:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:58:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:58:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:58:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:58:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:58:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:58:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.581
[INFO] - 02-27 19:58:07 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.581
[INFO] - 02-27 19:58:07 - [main.summary_metrics:168]: Epoch 198/500 - Test Results:
{'auc': 0.8470933008620114,
 'f1': 0.4092287457912458,
 'loss': 0.4376622669397814,
 'ndcg': 0.7143035649000405,
 'precision': 0.546875,
 'recall': 0.3274290966386555}
[INFO] - 02-27 19:58:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[198] Complete. Time taken: 00:00:31.571
[INFO] - 02-27 19:58:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:58:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:58:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:58:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:58:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:58:07 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2195, 2207, 1]
[INFO] - 02-27 19:58:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:58:20 - [main.backward:225]: Epoch 199/500 - Iteration 40/95 - Time 0.318 batch, 0.055 data, 0.285 forward
[INFO] - 02-27 19:58:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:58:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0031)
[INFO] - 02-27 19:58:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5917 (0.5858)
[INFO] - 02-27 19:58:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5392 (-287.5423)
[INFO] - 02-27 19:58:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8899 (31.8245)
[INFO] - 02-27 19:58:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3593 (371.2917)
[INFO] - 02-27 19:58:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:58:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9664)
[INFO] - 02-27 19:58:34 - [main.backward:225]: Epoch 199/500 - Iteration 90/95 - Time 0.302 batch, 0.042 data, 0.269 forward
[INFO] - 02-27 19:58:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:58:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0035)
[INFO] - 02-27 19:58:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5863)
[INFO] - 02-27 19:58:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5365 (-287.5399)
[INFO] - 02-27 19:58:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8213 (31.8110)
[INFO] - 02-27 19:58:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2478 (371.2265)
[INFO] - 02-27 19:58:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:58:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9583)
[INFO] - 02-27 19:58:36 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:58:36 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:58:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:58:36 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:58:36 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:58:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:58:36 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:58:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.737
[INFO] - 02-27 19:58:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.738
[INFO] - 02-27 19:58:39 - [main.summary_metrics:168]: Epoch 199/500 - Test Results:
{'auc': 0.8471626473506069,
 'f1': 0.4228282828282829,
 'loss': 0.4378695750500429,
 'ndcg': 0.7181878225129019,
 'precision': 0.565625,
 'recall': 0.3380646008403361}
[INFO] - 02-27 19:58:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[199] Complete. Time taken: 00:00:31.465
[INFO] - 02-27 19:58:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:58:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:58:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:58:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:58:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:58:39 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2170, 2198, 1]
[INFO] - 02-27 19:58:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:58:53 - [main.backward:225]: Epoch 200/500 - Iteration 45/95 - Time 0.318 batch, 0.055 data, 0.281 forward
[INFO] - 02-27 19:58:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:58:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0030)
[INFO] - 02-27 19:58:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5860)
[INFO] - 02-27 19:58:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5408 (-287.5403)
[INFO] - 02-27 19:58:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6718 (31.8146)
[INFO] - 02-27 19:58:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3816 (371.4362)
[INFO] - 02-27 19:58:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:58:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9678)
[INFO] - 02-27 19:59:08 - [main.backward:225]: Epoch 200/500 - Iteration 0/95 - Time 0.311 batch, 0.042 data, 0.277 forward
[INFO] - 02-27 19:59:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:59:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 19:59:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5765 (0.5861)
[INFO] - 02-27 19:59:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5425 (-287.5423)
[INFO] - 02-27 19:59:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7704 (31.8059)
[INFO] - 02-27 19:59:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8233 (371.4322)
[INFO] - 02-27 19:59:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:59:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9684)
[INFO] - 02-27 19:59:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:59:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:59:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:59:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:59:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:59:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:59:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:59:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.641
[INFO] - 02-27 19:59:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.642
[INFO] - 02-27 19:59:11 - [main.summary_metrics:168]: Epoch 200/500 - Test Results:
{'auc': 0.847157235810991,
 'f1': 0.4183838383838384,
 'loss': 0.4371787728296753,
 'ndcg': 0.7184906930790526,
 'precision': 0.559375,
 'recall': 0.33463322829131653}
[INFO] - 02-27 19:59:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[200] Complete. Time taken: 00:00:32.161
[INFO] - 02-27 19:59:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:59:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:59:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:59:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:59:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:59:11 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3069, 2174, 2219, 1]
[INFO] - 02-27 19:59:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:59:27 - [main.backward:225]: Epoch 201/500 - Iteration 50/95 - Time 0.333 batch, 0.052 data, 0.295 forward
[INFO] - 02-27 19:59:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0032)
[INFO] - 02-27 19:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5816 (0.5848)
[INFO] - 02-27 19:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5465 (-287.5439)
[INFO] - 02-27 19:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8066 (31.7997)
[INFO] - 02-27 19:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6174 (371.2835)
[INFO] - 02-27 19:59:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:59:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9670)
[INFO] - 02-27 19:59:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 19:59:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:59:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:59:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 19:59:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:59:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 19:59:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 19:59:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.913
[INFO] - 02-27 19:59:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.913
[INFO] - 02-27 19:59:45 - [main.summary_metrics:168]: Epoch 201/500 - Test Results:
{'auc': 0.8460102665453436,
 'f1': 0.41588383838383836,
 'loss': 0.43787216182176686,
 'ndcg': 0.7162533324273479,
 'precision': 0.55625,
 'recall': 0.33254989495798315}
[INFO] - 02-27 19:59:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[201] Complete. Time taken: 00:00:33.866
[INFO] - 02-27 19:59:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 19:59:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 19:59:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 19:59:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 19:59:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 19:59:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3052, 2188, 2229, 1]
[INFO] - 02-27 19:59:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 19:59:47 - [main.backward:225]: Epoch 202/500 - Iteration 5/95 - Time 0.456 batch, 0.190 data, 0.419 forward
[INFO] - 02-27 19:59:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 19:59:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0030)
[INFO] - 02-27 19:59:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5859)
[INFO] - 02-27 19:59:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5470 (-287.5450)
[INFO] - 02-27 19:59:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6886 (31.7895)
[INFO] - 02-27 19:59:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9028 (371.3644)
[INFO] - 02-27 19:59:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 19:59:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9686)
[INFO] - 02-27 20:00:02 - [main.backward:225]: Epoch 202/500 - Iteration 55/95 - Time 0.322 batch, 0.052 data, 0.284 forward
[INFO] - 02-27 20:00:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:00:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0030)
[INFO] - 02-27 20:00:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5806 (0.5849)
[INFO] - 02-27 20:00:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5420 (-287.5440)
[INFO] - 02-27 20:00:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7560 (31.7752)
[INFO] - 02-27 20:00:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0967 (371.3591)
[INFO] - 02-27 20:00:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:00:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9672)
[INFO] - 02-27 20:00:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:00:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:00:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:00:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:00:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:00:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:00:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:00:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.798
[INFO] - 02-27 20:00:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.799
[INFO] - 02-27 20:00:18 - [main.summary_metrics:168]: Epoch 202/500 - Test Results:
{'auc': 0.8464183606653445,
 'f1': 0.4206986531986532,
 'loss': 0.4374020234708772,
 'ndcg': 0.7215967160339025,
 'precision': 0.5625,
 'recall': 0.3364714635854342}
[INFO] - 02-27 20:00:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[202] Complete. Time taken: 00:00:33.185
[INFO] - 02-27 20:00:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:00:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:00:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:00:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:00:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:00:18 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3034, 2180, 2207, 1]
[INFO] - 02-27 20:00:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:00:22 - [main.backward:225]: Epoch 203/500 - Iteration 10/95 - Time 0.390 batch, 0.117 data, 0.352 forward
[INFO] - 02-27 20:00:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0030)
[INFO] - 02-27 20:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5853)
[INFO] - 02-27 20:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5436)
[INFO] - 02-27 20:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7599 (31.7907)
[INFO] - 02-27 20:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.0568 (371.5054)
[INFO] - 02-27 20:00:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:00:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9680)
[INFO] - 02-27 20:00:37 - [main.backward:225]: Epoch 203/500 - Iteration 60/95 - Time 0.317 batch, 0.049 data, 0.281 forward
[INFO] - 02-27 20:00:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0031)
[INFO] - 02-27 20:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5853)
[INFO] - 02-27 20:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5433 (-287.5418)
[INFO] - 02-27 20:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7930 (31.7786)
[INFO] - 02-27 20:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9479 (371.5509)
[INFO] - 02-27 20:00:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9650)
[INFO] - 02-27 20:00:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:00:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:00:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:00:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:00:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:00:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:00:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:00:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.724
[INFO] - 02-27 20:00:50 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.724
[INFO] - 02-27 20:00:50 - [main.summary_metrics:168]: Epoch 203/500 - Test Results:
{'auc': 0.8468840750148099,
 'f1': 0.41375420875420876,
 'loss': 0.4372516487358846,
 'ndcg': 0.7255998532684793,
 'precision': 0.553125,
 'recall': 0.33095675770308125}
[INFO] - 02-27 20:00:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[203] Complete. Time taken: 00:00:32.509
[INFO] - 02-27 20:00:50 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:00:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:00:50 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:00:50 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:00:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:00:50 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3046, 2196, 2217, 1]
[INFO] - 02-27 20:00:51 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:00:55 - [main.backward:225]: Epoch 204/500 - Iteration 15/95 - Time 0.332 batch, 0.082 data, 0.302 forward
[INFO] - 02-27 20:00:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0031)
[INFO] - 02-27 20:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5937 (0.5857)
[INFO] - 02-27 20:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5456 (-287.5444)
[INFO] - 02-27 20:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7946 (31.7940)
[INFO] - 02-27 20:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2675 (371.4650)
[INFO] - 02-27 20:00:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:00:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9672)
[INFO] - 02-27 20:01:10 - [main.backward:225]: Epoch 204/500 - Iteration 65/95 - Time 0.302 batch, 0.044 data, 0.270 forward
[INFO] - 02-27 20:01:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0032)
[INFO] - 02-27 20:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5852)
[INFO] - 02-27 20:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5441)
[INFO] - 02-27 20:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7183 (31.8036)
[INFO] - 02-27 20:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.8439 (371.3538)
[INFO] - 02-27 20:01:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:01:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9672)
[INFO] - 02-27 20:01:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:01:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:01:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:01:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:01:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:01:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:01:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:01:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.656
[INFO] - 02-27 20:01:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.656
[INFO] - 02-27 20:01:22 - [main.summary_metrics:168]: Epoch 204/500 - Test Results:
{'auc': 0.8450196164250015,
 'f1': 0.4117287457912458,
 'loss': 0.43894568661909594,
 'ndcg': 0.7194536819394493,
 'precision': 0.55,
 'recall': 0.3295124299719888}
[INFO] - 02-27 20:01:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[204] Complete. Time taken: 00:00:31.259
[INFO] - 02-27 20:01:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:01:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:01:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:01:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:01:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:01:22 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2197, 2194, 1]
[INFO] - 02-27 20:01:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:01:28 - [main.backward:225]: Epoch 205/500 - Iteration 20/95 - Time 0.330 batch, 0.071 data, 0.295 forward
[INFO] - 02-27 20:01:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:01:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0031)
[INFO] - 02-27 20:01:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5829 (0.5857)
[INFO] - 02-27 20:01:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5448 (-287.5452)
[INFO] - 02-27 20:01:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7596 (31.7918)
[INFO] - 02-27 20:01:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1915 (371.3544)
[INFO] - 02-27 20:01:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:01:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9647)
[INFO] - 02-27 20:01:44 - [main.backward:225]: Epoch 205/500 - Iteration 70/95 - Time 0.315 batch, 0.043 data, 0.283 forward
[INFO] - 02-27 20:01:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:01:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0029)
[INFO] - 02-27 20:01:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5817 (0.5853)
[INFO] - 02-27 20:01:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5456)
[INFO] - 02-27 20:01:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7946 (31.7861)
[INFO] - 02-27 20:01:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7764 (371.3791)
[INFO] - 02-27 20:01:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:01:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9716)
[INFO] - 02-27 20:01:51 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:01:51 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:01:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:01:51 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:01:51 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:01:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:01:51 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:01:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.618
[INFO] - 02-27 20:01:54 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.619
[INFO] - 02-27 20:01:54 - [main.summary_metrics:168]: Epoch 205/500 - Test Results:
{'auc': 0.8462212636892992,
 'f1': 0.4014688552188552,
 'loss': 0.4375462038092668,
 'ndcg': 0.7221774883212337,
 'precision': 0.5375,
 'recall': 0.3207545518207283}
[INFO] - 02-27 20:01:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[205] Complete. Time taken: 00:00:32.142
[INFO] - 02-27 20:01:54 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:01:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:01:54 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:01:54 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:01:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:01:54 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2205, 2216, 1]
[INFO] - 02-27 20:01:55 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:02:02 - [main.backward:225]: Epoch 206/500 - Iteration 25/95 - Time 0.347 batch, 0.072 data, 0.312 forward
[INFO] - 02-27 20:02:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0031)
[INFO] - 02-27 20:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5834 (0.5855)
[INFO] - 02-27 20:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5418 (-287.5438)
[INFO] - 02-27 20:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8092 (31.7931)
[INFO] - 02-27 20:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5328 (371.2452)
[INFO] - 02-27 20:02:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9677)
[INFO] - 02-27 20:02:17 - [main.backward:225]: Epoch 206/500 - Iteration 75/95 - Time 0.312 batch, 0.046 data, 0.279 forward
[INFO] - 02-27 20:02:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:02:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 20:02:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5815 (0.5841)
[INFO] - 02-27 20:02:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5388 (-287.5416)
[INFO] - 02-27 20:02:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8009 (31.8082)
[INFO] - 02-27 20:02:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3751 (371.3037)
[INFO] - 02-27 20:02:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:02:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9664)
[INFO] - 02-27 20:02:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:02:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:02:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:02:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:02:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:02:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:02:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:02:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.571
[INFO] - 02-27 20:02:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.571
[INFO] - 02-27 20:02:26 - [main.summary_metrics:168]: Epoch 206/500 - Test Results:
{'auc': 0.8459191487256666,
 'f1': 0.40841329966329964,
 'loss': 0.437348321027341,
 'ndcg': 0.7176112136865318,
 'precision': 0.546875,
 'recall': 0.32626925770308124}
[INFO] - 02-27 20:02:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[206] Complete. Time taken: 00:00:31.829
[INFO] - 02-27 20:02:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:02:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:02:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:02:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:02:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:02:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2182, 2184, 1]
[INFO] - 02-27 20:02:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:02:35 - [main.backward:225]: Epoch 207/500 - Iteration 30/95 - Time 0.323 batch, 0.060 data, 0.294 forward
[INFO] - 02-27 20:02:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:02:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 20:02:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5844)
[INFO] - 02-27 20:02:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5472 (-287.5428)
[INFO] - 02-27 20:02:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8056 (31.8005)
[INFO] - 02-27 20:02:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7498 (371.2816)
[INFO] - 02-27 20:02:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:02:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9648)
[INFO] - 02-27 20:02:50 - [main.backward:225]: Epoch 207/500 - Iteration 80/95 - Time 0.311 batch, 0.044 data, 0.278 forward
[INFO] - 02-27 20:02:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 20:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5819 (0.5841)
[INFO] - 02-27 20:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5415 (-287.5454)
[INFO] - 02-27 20:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8083 (31.7945)
[INFO] - 02-27 20:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8121 (371.2112)
[INFO] - 02-27 20:02:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:02:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9667)
[INFO] - 02-27 20:02:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:02:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:02:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:02:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:02:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:02:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:02:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:02:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.711
[INFO] - 02-27 20:02:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.712
[INFO] - 02-27 20:02:57 - [main.summary_metrics:168]: Epoch 207/500 - Test Results:
{'auc': 0.8473770224388775,
 'f1': 0.418013468013468,
 'loss': 0.437116786407206,
 'ndcg': 0.712401403399586,
 'precision': 0.559375,
 'recall': 0.3341430322128851}
[INFO] - 02-27 20:02:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[207] Complete. Time taken: 00:00:31.826
[INFO] - 02-27 20:02:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:02:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:02:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:02:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:02:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:02:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3070, 2197, 2187, 1]
[INFO] - 02-27 20:02:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:03:09 - [main.backward:225]: Epoch 208/500 - Iteration 35/95 - Time 0.317 batch, 0.054 data, 0.286 forward
[INFO] - 02-27 20:03:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:03:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0032)
[INFO] - 02-27 20:03:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5848)
[INFO] - 02-27 20:03:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5435)
[INFO] - 02-27 20:03:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7962 (31.7973)
[INFO] - 02-27 20:03:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8456 (371.2731)
[INFO] - 02-27 20:03:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:03:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9655)
[INFO] - 02-27 20:03:23 - [main.backward:225]: Epoch 208/500 - Iteration 85/95 - Time 0.305 batch, 0.043 data, 0.272 forward
[INFO] - 02-27 20:03:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0030)
[INFO] - 02-27 20:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5805 (0.5849)
[INFO] - 02-27 20:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5402 (-287.5430)
[INFO] - 02-27 20:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8867 (31.8250)
[INFO] - 02-27 20:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0043 (371.4018)
[INFO] - 02-27 20:03:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9706)
[INFO] - 02-27 20:03:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:03:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:03:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:03:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:03:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:03:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:03:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:03:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.850
[INFO] - 02-27 20:03:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.850
[INFO] - 02-27 20:03:30 - [main.summary_metrics:168]: Epoch 208/500 - Test Results:
{'auc': 0.8453973651960784,
 'f1': 0.42098800505050504,
 'loss': 0.4380744094682552,
 'ndcg': 0.7196461205201674,
 'precision': 0.5625,
 'recall': 0.3368653711484594}
[INFO] - 02-27 20:03:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[208] Complete. Time taken: 00:00:32.110
[INFO] - 02-27 20:03:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:03:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:03:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:03:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:03:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:03:30 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2184, 2209, 1]
[INFO] - 02-27 20:03:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:03:43 - [main.backward:225]: Epoch 209/500 - Iteration 40/95 - Time 0.325 batch, 0.054 data, 0.292 forward
[INFO] - 02-27 20:03:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:03:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0028)
[INFO] - 02-27 20:03:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5866 (0.5852)
[INFO] - 02-27 20:03:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5456 (-287.5427)
[INFO] - 02-27 20:03:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8418 (31.8026)
[INFO] - 02-27 20:03:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1121 (371.4377)
[INFO] - 02-27 20:03:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:03:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9698)
[INFO] - 02-27 20:03:58 - [main.backward:225]: Epoch 209/500 - Iteration 90/95 - Time 0.317 batch, 0.045 data, 0.281 forward
[INFO] - 02-27 20:03:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 20:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5855)
[INFO] - 02-27 20:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5474 (-287.5456)
[INFO] - 02-27 20:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8316 (31.8077)
[INFO] - 02-27 20:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7377 (371.4563)
[INFO] - 02-27 20:03:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9670)
[INFO] - 02-27 20:04:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:04:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:04:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:04:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:04:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:04:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:04:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:04:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.958
[INFO] - 02-27 20:04:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.958
[INFO] - 02-27 20:04:03 - [main.summary_metrics:168]: Epoch 209/500 - Test Results:
{'auc': 0.8450965438871627,
 'f1': 0.41583228114478116,
 'loss': 0.438950868511072,
 'ndcg': 0.7158248234688906,
 'precision': 0.5562499999999999,
 'recall': 0.3324229691876751}
[INFO] - 02-27 20:04:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[209] Complete. Time taken: 00:00:33.003
[INFO] - 02-27 20:04:03 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:04:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:04:03 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:04:03 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:04:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:04:03 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2195, 2229, 1]
[INFO] - 02-27 20:04:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:04:18 - [main.backward:225]: Epoch 210/500 - Iteration 45/95 - Time 0.339 batch, 0.054 data, 0.302 forward
[INFO] - 02-27 20:04:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:04:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0029)
[INFO] - 02-27 20:04:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5850)
[INFO] - 02-27 20:04:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5504 (-287.5476)
[INFO] - 02-27 20:04:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9325 (31.8127)
[INFO] - 02-27 20:04:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3389 (371.0939)
[INFO] - 02-27 20:04:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:04:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9683)
[INFO] - 02-27 20:04:34 - [main.backward:225]: Epoch 210/500 - Iteration 0/95 - Time 0.330 batch, 0.047 data, 0.292 forward
[INFO] - 02-27 20:04:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0029)
[INFO] - 02-27 20:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5786 (0.5842)
[INFO] - 02-27 20:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5486)
[INFO] - 02-27 20:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8496 (31.8112)
[INFO] - 02-27 20:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5248 (371.0779)
[INFO] - 02-27 20:04:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9681)
[INFO] - 02-27 20:04:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:04:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:04:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:04:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:04:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:04:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:04:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:04:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.897
[INFO] - 02-27 20:04:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.898
[INFO] - 02-27 20:04:37 - [main.summary_metrics:168]: Epoch 210/500 - Test Results:
{'auc': 0.8466027349665357,
 'f1': 0.41554292929292935,
 'loss': 0.4375074800837143,
 'ndcg': 0.7211032696840685,
 'precision': 0.55625,
 'recall': 0.33202906162464985}
[INFO] - 02-27 20:04:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[210] Complete. Time taken: 00:00:34.271
[INFO] - 02-27 20:04:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:04:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:04:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:04:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:04:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:04:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3076, 2209, 2208, 1]
[INFO] - 02-27 20:04:38 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:04:54 - [main.backward:225]: Epoch 211/500 - Iteration 50/95 - Time 0.335 batch, 0.054 data, 0.296 forward
[INFO] - 02-27 20:04:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:04:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0030)
[INFO] - 02-27 20:04:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5863)
[INFO] - 02-27 20:04:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5473 (-287.5446)
[INFO] - 02-27 20:04:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8504 (31.8125)
[INFO] - 02-27 20:04:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2006 (371.4866)
[INFO] - 02-27 20:04:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:04:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9653)
[INFO] - 02-27 20:05:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:05:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:05:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:05:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:05:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:05:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:05:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:05:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.862
[INFO] - 02-27 20:05:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.864
[INFO] - 02-27 20:05:11 - [main.summary_metrics:168]: Epoch 211/500 - Test Results:
{'auc': 0.8478883271445834,
 'f1': 0.41135837542087544,
 'loss': 0.43748554406432727,
 'ndcg': 0.7223030268566244,
 'precision': 0.55,
 'recall': 0.32902223389355745}
[INFO] - 02-27 20:05:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[211] Complete. Time taken: 00:00:33.981
[INFO] - 02-27 20:05:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:05:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:05:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:05:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:05:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:05:11 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3067, 2202, 2220, 1]
[INFO] - 02-27 20:05:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:05:13 - [main.backward:225]: Epoch 212/500 - Iteration 5/95 - Time 0.500 batch, 0.209 data, 0.451 forward
[INFO] - 02-27 20:05:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:05:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0035)
[INFO] - 02-27 20:05:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5866)
[INFO] - 02-27 20:05:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5490 (-287.5468)
[INFO] - 02-27 20:05:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8297 (31.8067)
[INFO] - 02-27 20:05:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3190 (371.4134)
[INFO] - 02-27 20:05:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:05:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9602)
[INFO] - 02-27 20:05:30 - [main.backward:225]: Epoch 212/500 - Iteration 55/95 - Time 0.345 batch, 0.055 data, 0.305 forward
[INFO] - 02-27 20:05:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:05:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0033)
[INFO] - 02-27 20:05:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5858)
[INFO] - 02-27 20:05:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5457)
[INFO] - 02-27 20:05:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7842 (31.7945)
[INFO] - 02-27 20:05:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9393 (371.2996)
[INFO] - 02-27 20:05:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:05:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9647)
[INFO] - 02-27 20:05:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:05:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:05:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:05:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:05:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:05:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:05:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:05:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.660
[INFO] - 02-27 20:05:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.661
[INFO] - 02-27 20:05:45 - [main.summary_metrics:168]: Epoch 212/500 - Test Results:
{'auc': 0.8478898320357555,
 'f1': 0.42090698653198655,
 'loss': 0.43628465062641875,
 'ndcg': 0.7269488609579202,
 'precision': 0.5625,
 'recall': 0.33676908263305316}
[INFO] - 02-27 20:05:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[212] Complete. Time taken: 00:00:33.938
[INFO] - 02-27 20:05:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:05:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:05:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:05:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:05:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:05:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2209, 2213, 1]
[INFO] - 02-27 20:05:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:05:49 - [main.backward:225]: Epoch 213/500 - Iteration 10/95 - Time 0.386 batch, 0.117 data, 0.349 forward
[INFO] - 02-27 20:05:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:05:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0031)
[INFO] - 02-27 20:05:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5866)
[INFO] - 02-27 20:05:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5441 (-287.5461)
[INFO] - 02-27 20:05:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8292 (31.8041)
[INFO] - 02-27 20:05:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.9297 (371.4761)
[INFO] - 02-27 20:05:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:05:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9639)
[INFO] - 02-27 20:06:04 - [main.backward:225]: Epoch 213/500 - Iteration 60/95 - Time 0.318 batch, 0.049 data, 0.282 forward
[INFO] - 02-27 20:06:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0028)
[INFO] - 02-27 20:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5825 (0.5859)
[INFO] - 02-27 20:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5435)
[INFO] - 02-27 20:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8085 (31.8130)
[INFO] - 02-27 20:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0390 (371.2187)
[INFO] - 02-27 20:06:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9683)
[INFO] - 02-27 20:06:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:06:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:06:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:06:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:06:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:06:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:06:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:06:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.635
[INFO] - 02-27 20:06:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.636
[INFO] - 02-27 20:06:17 - [main.summary_metrics:168]: Epoch 213/500 - Test Results:
{'auc': 0.8481831412099154,
 'f1': 0.4189625420875421,
 'loss': 0.437180639693457,
 'ndcg': 0.7270951600105462,
 'precision': 0.559375,
 'recall': 0.33542104341736695}
[INFO] - 02-27 20:06:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[213] Complete. Time taken: 00:00:32.157
[INFO] - 02-27 20:06:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:06:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:06:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:06:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:06:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:06:17 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2201, 2209, 1]
[INFO] - 02-27 20:06:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:06:22 - [main.backward:225]: Epoch 214/500 - Iteration 15/95 - Time 0.364 batch, 0.092 data, 0.331 forward
[INFO] - 02-27 20:06:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:06:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0033)
[INFO] - 02-27 20:06:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5826 (0.5862)
[INFO] - 02-27 20:06:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5447 (-287.5439)
[INFO] - 02-27 20:06:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8019 (31.8007)
[INFO] - 02-27 20:06:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6108 (371.2633)
[INFO] - 02-27 20:06:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:06:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9636)
[INFO] - 02-27 20:06:37 - [main.backward:225]: Epoch 214/500 - Iteration 65/95 - Time 0.315 batch, 0.048 data, 0.280 forward
[INFO] - 02-27 20:06:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:06:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0030)
[INFO] - 02-27 20:06:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5863)
[INFO] - 02-27 20:06:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5429 (-287.5438)
[INFO] - 02-27 20:06:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8237 (31.8065)
[INFO] - 02-27 20:06:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1953 (371.3567)
[INFO] - 02-27 20:06:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:06:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9702)
[INFO] - 02-27 20:06:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:06:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:06:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:06:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:06:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:06:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:06:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:06:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.552
[INFO] - 02-27 20:06:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.553
[INFO] - 02-27 20:06:49 - [main.summary_metrics:168]: Epoch 214/500 - Test Results:
{'auc': 0.8477770388792771,
 'f1': 0.4235921717171718,
 'loss': 0.43702480465515636,
 'ndcg': 0.7280203753225665,
 'precision': 0.565625,
 'recall': 0.33909751400560223}
[INFO] - 02-27 20:06:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[214] Complete. Time taken: 00:00:31.931
[INFO] - 02-27 20:06:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:06:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:06:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:06:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:06:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:06:49 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3091, 2199, 2206, 1]
[INFO] - 02-27 20:06:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:06:56 - [main.backward:225]: Epoch 215/500 - Iteration 20/95 - Time 0.343 batch, 0.072 data, 0.307 forward
[INFO] - 02-27 20:06:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0031)
[INFO] - 02-27 20:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5888 (0.5862)
[INFO] - 02-27 20:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5487 (-287.5445)
[INFO] - 02-27 20:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8382 (31.8001)
[INFO] - 02-27 20:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6216 (371.3996)
[INFO] - 02-27 20:06:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:06:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9689)
[INFO] - 02-27 20:07:11 - [main.backward:225]: Epoch 215/500 - Iteration 70/95 - Time 0.310 batch, 0.042 data, 0.278 forward
[INFO] - 02-27 20:07:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:07:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0030)
[INFO] - 02-27 20:07:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5860 (0.5857)
[INFO] - 02-27 20:07:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5491 (-287.5487)
[INFO] - 02-27 20:07:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7513 (31.8056)
[INFO] - 02-27 20:07:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3296 (371.2763)
[INFO] - 02-27 20:07:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:07:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9677)
[INFO] - 02-27 20:07:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:07:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:07:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:07:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:07:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:07:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:07:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:07:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.546
[INFO] - 02-27 20:07:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.546
[INFO] - 02-27 20:07:20 - [main.summary_metrics:168]: Epoch 215/500 - Test Results:
{'auc': 0.8469842168485041,
 'f1': 0.4157512626262626,
 'loss': 0.43697184499522734,
 'ndcg': 0.7180121196856062,
 'precision': 0.5562499999999999,
 'recall': 0.3323266806722689}
[INFO] - 02-27 20:07:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[215] Complete. Time taken: 00:00:31.489
[INFO] - 02-27 20:07:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:07:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:07:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:07:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:07:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:07:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3029, 2208, 2215, 1]
[INFO] - 02-27 20:07:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:07:29 - [main.backward:225]: Epoch 216/500 - Iteration 25/95 - Time 0.328 batch, 0.066 data, 0.293 forward
[INFO] - 02-27 20:07:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:07:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 20:07:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5864)
[INFO] - 02-27 20:07:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5465)
[INFO] - 02-27 20:07:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8831 (31.8007)
[INFO] - 02-27 20:07:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4884 (371.2766)
[INFO] - 02-27 20:07:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:07:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9659)
[INFO] - 02-27 20:07:43 - [main.backward:225]: Epoch 216/500 - Iteration 75/95 - Time 0.297 batch, 0.042 data, 0.266 forward
[INFO] - 02-27 20:07:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:07:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0030)
[INFO] - 02-27 20:07:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5882 (0.5858)
[INFO] - 02-27 20:07:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5505 (-287.5470)
[INFO] - 02-27 20:07:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8078 (31.7945)
[INFO] - 02-27 20:07:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0584 (371.3177)
[INFO] - 02-27 20:07:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:07:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9678)
[INFO] - 02-27 20:07:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:07:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:07:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:07:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:07:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:07:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:07:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:07:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.506
[INFO] - 02-27 20:07:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.506
[INFO] - 02-27 20:07:51 - [main.summary_metrics:168]: Epoch 216/500 - Test Results:
{'auc': 0.8471614047579816,
 'f1': 0.4184880050505051,
 'loss': 0.43792355255099297,
 'ndcg': 0.7214942189979399,
 'precision': 0.559375,
 'recall': 0.33478203781512605}
[INFO] - 02-27 20:07:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[216] Complete. Time taken: 00:00:30.552
[INFO] - 02-27 20:07:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:07:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:07:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:07:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:07:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:07:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2203, 2210, 1]
[INFO] - 02-27 20:07:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:08:01 - [main.backward:225]: Epoch 217/500 - Iteration 30/95 - Time 0.327 batch, 0.063 data, 0.289 forward
[INFO] - 02-27 20:08:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:08:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0032)
[INFO] - 02-27 20:08:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5908 (0.5862)
[INFO] - 02-27 20:08:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5437)
[INFO] - 02-27 20:08:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8834 (31.8086)
[INFO] - 02-27 20:08:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1417 (371.1504)
[INFO] - 02-27 20:08:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:08:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9653)
[INFO] - 02-27 20:08:16 - [main.backward:225]: Epoch 217/500 - Iteration 80/95 - Time 0.308 batch, 0.044 data, 0.273 forward
[INFO] - 02-27 20:08:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:08:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0030)
[INFO] - 02-27 20:08:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5815 (0.5854)
[INFO] - 02-27 20:08:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5409 (-287.5437)
[INFO] - 02-27 20:08:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8042 (31.8214)
[INFO] - 02-27 20:08:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5699 (371.4295)
[INFO] - 02-27 20:08:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:08:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9648)
[INFO] - 02-27 20:08:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:08:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:08:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:08:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:08:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:08:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:08:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:08:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.522
[INFO] - 02-27 20:08:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.523
[INFO] - 02-27 20:08:23 - [main.summary_metrics:168]: Epoch 217/500 - Test Results:
{'auc': 0.846408727584171,
 'f1': 0.42311763468013464,
 'loss': 0.43729471142641524,
 'ndcg': 0.7231882307867776,
 'precision': 0.565625,
 'recall': 0.33845850840336134}
[INFO] - 02-27 20:08:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[217] Complete. Time taken: 00:00:31.676
[INFO] - 02-27 20:08:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:08:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:08:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:08:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:08:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:08:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2207, 2197, 1]
[INFO] - 02-27 20:08:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:08:34 - [main.backward:225]: Epoch 218/500 - Iteration 35/95 - Time 0.314 batch, 0.055 data, 0.280 forward
[INFO] - 02-27 20:08:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0033)
[INFO] - 02-27 20:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5928 (0.5863)
[INFO] - 02-27 20:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5440 (-287.5433)
[INFO] - 02-27 20:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7872 (31.8181)
[INFO] - 02-27 20:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4316 (371.3466)
[INFO] - 02-27 20:08:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9605)
[INFO] - 02-27 20:08:48 - [main.backward:225]: Epoch 218/500 - Iteration 85/95 - Time 0.302 batch, 0.044 data, 0.268 forward
[INFO] - 02-27 20:08:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0031)
[INFO] - 02-27 20:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5865 (0.5858)
[INFO] - 02-27 20:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5460)
[INFO] - 02-27 20:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9223 (31.7970)
[INFO] - 02-27 20:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4399 (371.2632)
[INFO] - 02-27 20:08:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:08:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9634)
[INFO] - 02-27 20:08:51 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:08:51 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:08:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:08:51 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:08:51 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:08:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:08:51 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:08:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.585
[INFO] - 02-27 20:08:54 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.585
[INFO] - 02-27 20:08:54 - [main.summary_metrics:168]: Epoch 218/500 - Test Results:
{'auc': 0.8473660362429285,
 'f1': 0.41385837542087545,
 'loss': 0.4357402061199188,
 'ndcg': 0.724347724697628,
 'precision': 0.5531250000000001,
 'recall': 0.3311055672268908}
[INFO] - 02-27 20:08:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[218] Complete. Time taken: 00:00:31.175
[INFO] - 02-27 20:08:54 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:08:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:08:54 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:08:54 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:08:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:08:54 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2216, 2217, 1]
[INFO] - 02-27 20:08:55 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:09:06 - [main.backward:225]: Epoch 219/500 - Iteration 40/95 - Time 0.304 batch, 0.054 data, 0.269 forward
[INFO] - 02-27 20:09:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0032)
[INFO] - 02-27 20:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5854)
[INFO] - 02-27 20:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5489 (-287.5474)
[INFO] - 02-27 20:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6222 (31.8101)
[INFO] - 02-27 20:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4930 (371.6025)
[INFO] - 02-27 20:09:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9644)
[INFO] - 02-27 20:09:20 - [main.backward:225]: Epoch 219/500 - Iteration 90/95 - Time 0.296 batch, 0.044 data, 0.261 forward
[INFO] - 02-27 20:09:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 20:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5865 (0.5856)
[INFO] - 02-27 20:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5391 (-287.5450)
[INFO] - 02-27 20:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7816 (31.7969)
[INFO] - 02-27 20:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6579 (371.1532)
[INFO] - 02-27 20:09:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9642)
[INFO] - 02-27 20:09:22 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:09:22 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:09:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:09:22 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:09:22 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:09:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:09:22 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:09:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.711
[INFO] - 02-27 20:09:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.713
[INFO] - 02-27 20:09:25 - [main.summary_metrics:168]: Epoch 219/500 - Test Results:
{'auc': 0.8469251630186387,
 'f1': 0.41848800505050504,
 'loss': 0.43725023937202145,
 'ndcg': 0.7216193679068182,
 'precision': 0.5593750000000001,
 'recall': 0.33478203781512605}
[INFO] - 02-27 20:09:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[219] Complete. Time taken: 00:00:30.930
[INFO] - 02-27 20:09:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:09:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:09:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:09:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:09:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:09:25 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3027, 2180, 2195, 1]
[INFO] - 02-27 20:09:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:09:38 - [main.backward:225]: Epoch 220/500 - Iteration 45/95 - Time 0.305 batch, 0.049 data, 0.272 forward
[INFO] - 02-27 20:09:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0031)
[INFO] - 02-27 20:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5782 (0.5863)
[INFO] - 02-27 20:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5433)
[INFO] - 02-27 20:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8682 (31.8063)
[INFO] - 02-27 20:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2399 (371.2541)
[INFO] - 02-27 20:09:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9670)
[INFO] - 02-27 20:09:53 - [main.backward:225]: Epoch 220/500 - Iteration 0/95 - Time 0.299 batch, 0.042 data, 0.265 forward
[INFO] - 02-27 20:09:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0030)
[INFO] - 02-27 20:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5831 (0.5858)
[INFO] - 02-27 20:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5391 (-287.5444)
[INFO] - 02-27 20:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7927 (31.8138)
[INFO] - 02-27 20:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0872 (371.2136)
[INFO] - 02-27 20:09:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:09:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9680)
[INFO] - 02-27 20:09:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:09:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:09:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:09:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:09:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:09:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:09:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:09:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.567
[INFO] - 02-27 20:09:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.568
[INFO] - 02-27 20:09:56 - [main.summary_metrics:168]: Epoch 220/500 - Test Results:
{'auc': 0.8465980833509874,
 'f1': 0.42090698653198655,
 'loss': 0.43764445832605714,
 'ndcg': 0.7200573919590652,
 'precision': 0.5625,
 'recall': 0.3367690826330532}
[INFO] - 02-27 20:09:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[220] Complete. Time taken: 00:00:30.996
[INFO] - 02-27 20:09:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:09:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:09:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:09:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:09:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:09:56 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2187, 2217, 1]
[INFO] - 02-27 20:09:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:10:12 - [main.backward:225]: Epoch 221/500 - Iteration 50/95 - Time 0.325 batch, 0.066 data, 0.295 forward
[INFO] - 02-27 20:10:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:10:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0030)
[INFO] - 02-27 20:10:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5921 (0.5864)
[INFO] - 02-27 20:10:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5461 (-287.5429)
[INFO] - 02-27 20:10:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8482 (31.8021)
[INFO] - 02-27 20:10:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2524 (371.2849)
[INFO] - 02-27 20:10:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:10:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9677)
[INFO] - 02-27 20:10:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:10:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:10:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:10:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:10:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:10:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:10:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:10:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.604
[INFO] - 02-27 20:10:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.605
[INFO] - 02-27 20:10:28 - [main.summary_metrics:168]: Epoch 221/500 - Test Results:
{'auc': 0.8454350861055207,
 'f1': 0.41172874579124585,
 'loss': 0.43829573960239876,
 'ndcg': 0.7208063182662469,
 'precision': 0.55,
 'recall': 0.3295124299719888}
[INFO] - 02-27 20:10:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[221] Complete. Time taken: 00:00:31.987
[INFO] - 02-27 20:10:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:10:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:10:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:10:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:10:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:10:28 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3040, 2194, 2215, 1]
[INFO] - 02-27 20:10:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:10:30 - [main.backward:225]: Epoch 222/500 - Iteration 5/95 - Time 0.443 batch, 0.180 data, 0.409 forward
[INFO] - 02-27 20:10:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:10:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0031)
[INFO] - 02-27 20:10:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5847)
[INFO] - 02-27 20:10:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5461 (-287.5450)
[INFO] - 02-27 20:10:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8249 (31.7991)
[INFO] - 02-27 20:10:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4961 (371.2796)
[INFO] - 02-27 20:10:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:10:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9669)
[INFO] - 02-27 20:10:44 - [main.backward:225]: Epoch 222/500 - Iteration 55/95 - Time 0.303 batch, 0.047 data, 0.270 forward
[INFO] - 02-27 20:10:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:10:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0030)
[INFO] - 02-27 20:10:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5829 (0.5855)
[INFO] - 02-27 20:10:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5454)
[INFO] - 02-27 20:10:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7605 (31.8058)
[INFO] - 02-27 20:10:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2350 (371.4392)
[INFO] - 02-27 20:10:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:10:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9661)
[INFO] - 02-27 20:10:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:10:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:10:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:10:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:10:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:10:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:10:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:10:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.638
[INFO] - 02-27 20:10:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.638
[INFO] - 02-27 20:10:58 - [main.summary_metrics:168]: Epoch 222/500 - Test Results:
{'auc': 0.8450828127206764,
 'f1': 0.4189625420875421,
 'loss': 0.4386710044783296,
 'ndcg': 0.7196811533358912,
 'precision': 0.559375,
 'recall': 0.335421043417367}
[INFO] - 02-27 20:10:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[222] Complete. Time taken: 00:00:30.727
[INFO] - 02-27 20:10:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:10:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:10:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:10:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:10:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:10:58 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3057, 2198, 2216, 1]
[INFO] - 02-27 20:10:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:11:02 - [main.backward:225]: Epoch 223/500 - Iteration 10/95 - Time 0.356 batch, 0.100 data, 0.330 forward
[INFO] - 02-27 20:11:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:11:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0030)
[INFO] - 02-27 20:11:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5910 (0.5862)
[INFO] - 02-27 20:11:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5460 (-287.5443)
[INFO] - 02-27 20:11:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8995 (31.7951)
[INFO] - 02-27 20:11:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8962 (371.1250)
[INFO] - 02-27 20:11:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:11:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9681)
[INFO] - 02-27 20:11:16 - [main.backward:225]: Epoch 223/500 - Iteration 60/95 - Time 0.298 batch, 0.041 data, 0.269 forward
[INFO] - 02-27 20:11:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0029)
[INFO] - 02-27 20:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5860)
[INFO] - 02-27 20:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5508 (-287.5477)
[INFO] - 02-27 20:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8620 (31.8306)
[INFO] - 02-27 20:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6767 (371.2633)
[INFO] - 02-27 20:11:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:11:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9700)
[INFO] - 02-27 20:11:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:11:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:11:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:11:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:11:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:11:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:11:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:11:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.525
[INFO] - 02-27 20:11:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.525
[INFO] - 02-27 20:11:29 - [main.summary_metrics:168]: Epoch 223/500 - Test Results:
{'auc': 0.8444950390082504,
 'f1': 0.4140435606060606,
 'loss': 0.4393748509597608,
 'ndcg': 0.714462204595312,
 'precision': 0.553125,
 'recall': 0.33135066526610646}
[INFO] - 02-27 20:11:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[223] Complete. Time taken: 00:00:30.503
[INFO] - 02-27 20:11:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:11:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:11:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:11:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:11:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:11:29 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2195, 2202, 1]
[INFO] - 02-27 20:11:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:11:34 - [main.backward:225]: Epoch 224/500 - Iteration 15/95 - Time 0.338 batch, 0.084 data, 0.304 forward
[INFO] - 02-27 20:11:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:11:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0030)
[INFO] - 02-27 20:11:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5860 (0.5859)
[INFO] - 02-27 20:11:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5494 (-287.5475)
[INFO] - 02-27 20:11:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7514 (31.8132)
[INFO] - 02-27 20:11:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6402 (371.2001)
[INFO] - 02-27 20:11:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:11:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9678)
[INFO] - 02-27 20:11:48 - [main.backward:225]: Epoch 224/500 - Iteration 65/95 - Time 0.301 batch, 0.045 data, 0.268 forward
[INFO] - 02-27 20:11:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 20:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5778 (0.5861)
[INFO] - 02-27 20:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5459 (-287.5467)
[INFO] - 02-27 20:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8147 (31.8051)
[INFO] - 02-27 20:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7093 (371.3614)
[INFO] - 02-27 20:11:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9669)
[INFO] - 02-27 20:11:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:11:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:11:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:11:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:11:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:11:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:11:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:11:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.461
[INFO] - 02-27 20:11:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.462
[INFO] - 02-27 20:11:59 - [main.summary_metrics:168]: Epoch 224/500 - Test Results:
{'auc': 0.8464579012364749,
 'f1': 0.409413930976431,
 'loss': 0.4379076535528357,
 'ndcg': 0.7169162394856343,
 'precision': 0.546875,
 'recall': 0.3276741946778712}
[INFO] - 02-27 20:11:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[224] Complete. Time taken: 00:00:30.445
[INFO] - 02-27 20:11:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:11:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:11:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:11:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:11:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:11:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3070, 2189, 2203, 1]
[INFO] - 02-27 20:12:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:12:06 - [main.backward:225]: Epoch 225/500 - Iteration 20/95 - Time 0.334 batch, 0.073 data, 0.297 forward
[INFO] - 02-27 20:12:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:12:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0032)
[INFO] - 02-27 20:12:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5861)
[INFO] - 02-27 20:12:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5488 (-287.5456)
[INFO] - 02-27 20:12:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7972 (31.8078)
[INFO] - 02-27 20:12:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1172 (371.3927)
[INFO] - 02-27 20:12:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:12:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9644)
[INFO] - 02-27 20:12:21 - [main.backward:225]: Epoch 225/500 - Iteration 70/95 - Time 0.306 batch, 0.046 data, 0.271 forward
[INFO] - 02-27 20:12:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:12:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0031)
[INFO] - 02-27 20:12:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5836 (0.5857)
[INFO] - 02-27 20:12:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5369 (-287.5445)
[INFO] - 02-27 20:12:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8179 (31.8096)
[INFO] - 02-27 20:12:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8081 (371.1782)
[INFO] - 02-27 20:12:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:12:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9673)
[INFO] - 02-27 20:12:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:12:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:12:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:12:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:12:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:12:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:12:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:12:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.585
[INFO] - 02-27 20:12:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.585
[INFO] - 02-27 20:12:30 - [main.summary_metrics:168]: Epoch 225/500 - Test Results:
{'auc': 0.8463818026597894,
 'f1': 0.4070991161616162,
 'loss': 0.4375048214578136,
 'ndcg': 0.7194158477980286,
 'precision': 0.54375,
 'recall': 0.32583595938375354}
[INFO] - 02-27 20:12:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[225] Complete. Time taken: 00:00:31.051
[INFO] - 02-27 20:12:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:12:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:12:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:12:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:12:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:12:30 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3061, 2203, 2202, 1]
[INFO] - 02-27 20:12:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:12:38 - [main.backward:225]: Epoch 226/500 - Iteration 25/95 - Time 0.317 batch, 0.061 data, 0.284 forward
[INFO] - 02-27 20:12:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:12:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0029)
[INFO] - 02-27 20:12:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5896 (0.5866)
[INFO] - 02-27 20:12:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5438 (-287.5412)
[INFO] - 02-27 20:12:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6796 (31.8049)
[INFO] - 02-27 20:12:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8952 (371.3182)
[INFO] - 02-27 20:12:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:12:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9692)
[INFO] - 02-27 20:12:53 - [main.backward:225]: Epoch 226/500 - Iteration 75/95 - Time 0.300 batch, 0.043 data, 0.265 forward
[INFO] - 02-27 20:12:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:12:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0032)
[INFO] - 02-27 20:12:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5855 (0.5859)
[INFO] - 02-27 20:12:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5462 (-287.5449)
[INFO] - 02-27 20:12:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7878 (31.7999)
[INFO] - 02-27 20:12:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8629 (371.2428)
[INFO] - 02-27 20:12:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:12:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9634)
[INFO] - 02-27 20:12:59 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:12:59 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:12:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:12:59 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:12:59 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:12:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:12:59 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:13:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.538
[INFO] - 02-27 20:13:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.539
[INFO] - 02-27 20:13:01 - [main.summary_metrics:168]: Epoch 226/500 - Test Results:
{'auc': 0.8469382217960714,
 'f1': 0.42330281986531987,
 'loss': 0.4366046115252429,
 'ndcg': 0.7190935604139383,
 'precision': 0.565625,
 'recall': 0.338703606442577}
[INFO] - 02-27 20:13:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[226] Complete. Time taken: 00:00:30.733
[INFO] - 02-27 20:13:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:13:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:13:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:13:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:13:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:13:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2202, 2205, 1]
[INFO] - 02-27 20:13:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:13:10 - [main.backward:225]: Epoch 227/500 - Iteration 30/95 - Time 0.307 batch, 0.049 data, 0.281 forward
[INFO] - 02-27 20:13:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0029)
[INFO] - 02-27 20:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5817 (0.5851)
[INFO] - 02-27 20:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5503 (-287.5478)
[INFO] - 02-27 20:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7724 (31.8193)
[INFO] - 02-27 20:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7152 (371.4561)
[INFO] - 02-27 20:13:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:13:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9700)
[INFO] - 02-27 20:13:24 - [main.backward:225]: Epoch 227/500 - Iteration 80/95 - Time 0.291 batch, 0.038 data, 0.262 forward
[INFO] - 02-27 20:13:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:13:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0030)
[INFO] - 02-27 20:13:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5764 (0.5843)
[INFO] - 02-27 20:13:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5484 (-287.5481)
[INFO] - 02-27 20:13:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8342 (31.8103)
[INFO] - 02-27 20:13:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8837 (371.3283)
[INFO] - 02-27 20:13:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:13:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9686)
[INFO] - 02-27 20:13:29 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:13:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:13:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:13:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:13:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:13:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:13:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:13:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.580
[INFO] - 02-27 20:13:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.581
[INFO] - 02-27 20:13:31 - [main.summary_metrics:168]: Epoch 227/500 - Test Results:
{'auc': 0.8458441494244756,
 'f1': 0.4160690235690236,
 'loss': 0.4383282473029525,
 'ndcg': 0.719776942713453,
 'precision': 0.55625,
 'recall': 0.3327949929971989}
[INFO] - 02-27 20:13:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[227] Complete. Time taken: 00:00:30.153
[INFO] - 02-27 20:13:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:13:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:13:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:13:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:13:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:13:31 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3069, 2196, 2217, 1]
[INFO] - 02-27 20:13:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:13:42 - [main.backward:225]: Epoch 228/500 - Iteration 35/95 - Time 0.309 batch, 0.056 data, 0.275 forward
[INFO] - 02-27 20:13:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0030)
[INFO] - 02-27 20:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5858)
[INFO] - 02-27 20:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5480)
[INFO] - 02-27 20:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7536 (31.8001)
[INFO] - 02-27 20:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3826 (371.2624)
[INFO] - 02-27 20:13:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9691)
[INFO] - 02-27 20:13:57 - [main.backward:225]: Epoch 228/500 - Iteration 85/95 - Time 0.297 batch, 0.042 data, 0.264 forward
[INFO] - 02-27 20:13:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:13:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0032)
[INFO] - 02-27 20:13:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5861)
[INFO] - 02-27 20:13:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5499 (-287.5461)
[INFO] - 02-27 20:13:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8092 (31.7983)
[INFO] - 02-27 20:13:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.5446 (371.2550)
[INFO] - 02-27 20:13:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:13:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9677)
[INFO] - 02-27 20:14:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:14:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:14:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:14:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:14:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:14:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:14:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:14:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.583
[INFO] - 02-27 20:14:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.584
[INFO] - 02-27 20:14:02 - [main.summary_metrics:168]: Epoch 228/500 - Test Results:
{'auc': 0.8468776056991424,
 'f1': 0.40893939393939394,
 'loss': 0.43719764938737166,
 'ndcg': 0.7175904424617073,
 'precision': 0.546875,
 'recall': 0.32703518907563023}
[INFO] - 02-27 20:14:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[228] Complete. Time taken: 00:00:30.846
[INFO] - 02-27 20:14:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:14:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:14:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:14:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:14:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:14:02 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3079, 2195, 2212, 1]
[INFO] - 02-27 20:14:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:14:15 - [main.backward:225]: Epoch 229/500 - Iteration 40/95 - Time 0.321 batch, 0.057 data, 0.284 forward
[INFO] - 02-27 20:14:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:14:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 20:14:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5850 (0.5844)
[INFO] - 02-27 20:14:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5416 (-287.5466)
[INFO] - 02-27 20:14:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7390 (31.7978)
[INFO] - 02-27 20:14:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1508 (371.4162)
[INFO] - 02-27 20:14:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:14:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9664)
[INFO] - 02-27 20:14:30 - [main.backward:225]: Epoch 229/500 - Iteration 90/95 - Time 0.309 batch, 0.044 data, 0.274 forward
[INFO] - 02-27 20:14:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:14:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0030)
[INFO] - 02-27 20:14:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5784 (0.5845)
[INFO] - 02-27 20:14:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5338 (-287.5385)
[INFO] - 02-27 20:14:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8812 (31.7985)
[INFO] - 02-27 20:14:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8534 (371.2778)
[INFO] - 02-27 20:14:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:14:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9681)
[INFO] - 02-27 20:14:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:14:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:14:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:14:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:14:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:14:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:14:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:14:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.708
[INFO] - 02-27 20:14:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.709
[INFO] - 02-27 20:14:34 - [main.summary_metrics:168]: Epoch 229/500 - Test Results:
{'auc': 0.8464698779021412,
 'f1': 0.4092287457912458,
 'loss': 0.4375348503044041,
 'ndcg': 0.716321535735736,
 'precision': 0.546875,
 'recall': 0.3274290966386555}
[INFO] - 02-27 20:14:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[229] Complete. Time taken: 00:00:32.062
[INFO] - 02-27 20:14:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:14:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:14:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:14:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:14:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:14:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3073, 2196, 2202, 1]
[INFO] - 02-27 20:14:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:14:49 - [main.backward:225]: Epoch 230/500 - Iteration 45/95 - Time 0.329 batch, 0.054 data, 0.292 forward
[INFO] - 02-27 20:14:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:14:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0032)
[INFO] - 02-27 20:14:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5853)
[INFO] - 02-27 20:14:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5394 (-287.5364)
[INFO] - 02-27 20:14:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7307 (31.8035)
[INFO] - 02-27 20:14:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3101 (371.2747)
[INFO] - 02-27 20:14:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:14:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9659)
[INFO] - 02-27 20:15:05 - [main.backward:225]: Epoch 230/500 - Iteration 0/95 - Time 0.322 batch, 0.045 data, 0.286 forward
[INFO] - 02-27 20:15:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:15:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0032)
[INFO] - 02-27 20:15:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5980 (0.5867)
[INFO] - 02-27 20:15:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5403 (-287.5400)
[INFO] - 02-27 20:15:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8874 (31.8000)
[INFO] - 02-27 20:15:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2299 (371.2125)
[INFO] - 02-27 20:15:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:15:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9659)
[INFO] - 02-27 20:15:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:15:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:15:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:15:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:15:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:15:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:15:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:15:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.713
[INFO] - 02-27 20:15:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.714
[INFO] - 02-27 20:15:08 - [main.summary_metrics:168]: Epoch 230/500 - Test Results:
{'auc': 0.8466958317640781,
 'f1': 0.41843644781144784,
 'loss': 0.4373935117699109,
 'ndcg': 0.7201791297460883,
 'precision': 0.559375,
 'recall': 0.3346551120448179}
[INFO] - 02-27 20:15:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[230] Complete. Time taken: 00:00:33.347
[INFO] - 02-27 20:15:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:15:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:15:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:15:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:15:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:15:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2189, 2192, 1]
[INFO] - 02-27 20:15:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:15:24 - [main.backward:225]: Epoch 231/500 - Iteration 50/95 - Time 0.322 batch, 0.053 data, 0.285 forward
[INFO] - 02-27 20:15:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:15:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0032)
[INFO] - 02-27 20:15:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5855)
[INFO] - 02-27 20:15:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5388 (-287.5417)
[INFO] - 02-27 20:15:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8418 (31.7918)
[INFO] - 02-27 20:15:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6844 (371.2289)
[INFO] - 02-27 20:15:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:15:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9641)
[INFO] - 02-27 20:15:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:15:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:15:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:15:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.653
[INFO] - 02-27 20:15:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.655
[INFO] - 02-27 20:15:40 - [main.summary_metrics:168]: Epoch 231/500 - Test Results:
{'auc': 0.8462164318546045,
 'f1': 0.41333228114478116,
 'loss': 0.437411773012477,
 'ndcg': 0.7216305204835851,
 'precision': 0.553125,
 'recall': 0.3303396358543418}
[INFO] - 02-27 20:15:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[231] Complete. Time taken: 00:00:32.217
[INFO] - 02-27 20:15:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:15:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:15:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:15:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:15:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:15:40 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3068, 2164, 2199, 1]
[INFO] - 02-27 20:15:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:15:42 - [main.backward:225]: Epoch 232/500 - Iteration 5/95 - Time 0.464 batch, 0.191 data, 0.423 forward
[INFO] - 02-27 20:15:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:15:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0030)
[INFO] - 02-27 20:15:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5850)
[INFO] - 02-27 20:15:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5412 (-287.5419)
[INFO] - 02-27 20:15:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7376 (31.7906)
[INFO] - 02-27 20:15:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2744 (371.2527)
[INFO] - 02-27 20:15:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:15:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9677)
[INFO] - 02-27 20:15:57 - [main.backward:225]: Epoch 232/500 - Iteration 55/95 - Time 0.319 batch, 0.047 data, 0.285 forward
[INFO] - 02-27 20:15:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:15:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0029)
[INFO] - 02-27 20:15:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5908 (0.5864)
[INFO] - 02-27 20:15:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5414 (-287.5421)
[INFO] - 02-27 20:15:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7740 (31.8012)
[INFO] - 02-27 20:15:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5466 (371.1466)
[INFO] - 02-27 20:15:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:15:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9691)
[INFO] - 02-27 20:16:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:16:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:16:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:16:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:16:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:16:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:16:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:16:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.846
[INFO] - 02-27 20:16:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.850
[INFO] - 02-27 20:16:13 - [main.summary_metrics:168]: Epoch 232/500 - Test Results:
{'auc': 0.8469237913915566,
 'f1': 0.4164625420875421,
 'loss': 0.4371381888978446,
 'ndcg': 0.7249886097670662,
 'precision': 0.5562499999999999,
 'recall': 0.3333377100840336}
[INFO] - 02-27 20:16:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[232] Complete. Time taken: 00:00:33.027
[INFO] - 02-27 20:16:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:16:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:16:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:16:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:16:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:16:13 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3082, 2192, 2222, 1]
[INFO] - 02-27 20:16:14 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:16:17 - [main.backward:225]: Epoch 233/500 - Iteration 10/95 - Time 0.403 batch, 0.121 data, 0.371 forward
[INFO] - 02-27 20:16:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0030)
[INFO] - 02-27 20:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5945 (0.5858)
[INFO] - 02-27 20:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5448 (-287.5439)
[INFO] - 02-27 20:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8544 (31.8129)
[INFO] - 02-27 20:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0347 (371.3047)
[INFO] - 02-27 20:16:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9686)
[INFO] - 02-27 20:16:32 - [main.backward:225]: Epoch 233/500 - Iteration 60/95 - Time 0.329 batch, 0.049 data, 0.294 forward
[INFO] - 02-27 20:16:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:16:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0030)
[INFO] - 02-27 20:16:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5897 (0.5858)
[INFO] - 02-27 20:16:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5456 (-287.5478)
[INFO] - 02-27 20:16:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8028 (31.8057)
[INFO] - 02-27 20:16:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9375 (371.2910)
[INFO] - 02-27 20:16:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:16:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9681)
[INFO] - 02-27 20:16:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:16:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:16:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:16:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:16:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:16:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:16:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:16:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.650
[INFO] - 02-27 20:16:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.652
[INFO] - 02-27 20:16:46 - [main.summary_metrics:168]: Epoch 233/500 - Test Results:
{'auc': 0.8470863244194736,
 'f1': 0.42340698653198655,
 'loss': 0.4370587254880195,
 'ndcg': 0.7273287652619669,
 'precision': 0.565625,
 'recall': 0.33885241596638654}
[INFO] - 02-27 20:16:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[233] Complete. Time taken: 00:00:33.446
[INFO] - 02-27 20:16:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:16:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:16:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:16:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:16:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:16:46 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3057, 2203, 2222, 1]
[INFO] - 02-27 20:16:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:16:52 - [main.backward:225]: Epoch 234/500 - Iteration 15/95 - Time 0.374 batch, 0.095 data, 0.336 forward
[INFO] - 02-27 20:16:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0032)
[INFO] - 02-27 20:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5826 (0.5861)
[INFO] - 02-27 20:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5479 (-287.5477)
[INFO] - 02-27 20:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8052 (31.7938)
[INFO] - 02-27 20:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8388 (371.1499)
[INFO] - 02-27 20:16:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:16:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9663)
[INFO] - 02-27 20:17:07 - [main.backward:225]: Epoch 234/500 - Iteration 65/95 - Time 0.322 batch, 0.047 data, 0.288 forward
[INFO] - 02-27 20:17:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:17:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 20:17:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5884 (0.5857)
[INFO] - 02-27 20:17:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5442 (-287.5474)
[INFO] - 02-27 20:17:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8580 (31.8045)
[INFO] - 02-27 20:17:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8615 (371.0863)
[INFO] - 02-27 20:17:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:17:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9659)
[INFO] - 02-27 20:17:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:17:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:17:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:17:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:17:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:17:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:17:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:17:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.747
[INFO] - 02-27 20:17:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.749
[INFO] - 02-27 20:17:20 - [main.summary_metrics:168]: Epoch 234/500 - Test Results:
{'auc': 0.8476287179700311,
 'f1': 0.4282218013468013,
 'loss': 0.43716479268893516,
 'ndcg': 0.7244790520401638,
 'precision': 0.571875,
 'recall': 0.34277398459383757}
[INFO] - 02-27 20:17:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[234] Complete. Time taken: 00:00:33.737
[INFO] - 02-27 20:17:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:17:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:17:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:17:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:17:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:17:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3043, 2185, 2201, 1]
[INFO] - 02-27 20:17:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:17:27 - [main.backward:225]: Epoch 235/500 - Iteration 20/95 - Time 0.360 batch, 0.083 data, 0.322 forward
[INFO] - 02-27 20:17:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:17:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0030)
[INFO] - 02-27 20:17:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5855)
[INFO] - 02-27 20:17:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5399 (-287.5441)
[INFO] - 02-27 20:17:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8131 (31.8079)
[INFO] - 02-27 20:17:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1094 (371.3436)
[INFO] - 02-27 20:17:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:17:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9688)
[INFO] - 02-27 20:17:42 - [main.backward:225]: Epoch 235/500 - Iteration 70/95 - Time 0.321 batch, 0.049 data, 0.284 forward
[INFO] - 02-27 20:17:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:17:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0032)
[INFO] - 02-27 20:17:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5860)
[INFO] - 02-27 20:17:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5472 (-287.5434)
[INFO] - 02-27 20:17:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7314 (31.7946)
[INFO] - 02-27 20:17:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7762 (371.0977)
[INFO] - 02-27 20:17:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:17:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9648)
[INFO] - 02-27 20:17:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:17:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:17:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:17:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:17:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:17:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:17:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:17:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.641
[INFO] - 02-27 20:17:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.643
[INFO] - 02-27 20:17:53 - [main.summary_metrics:168]: Epoch 235/500 - Test Results:
{'auc': 0.8461028871107267,
 'f1': 0.4233028198653199,
 'loss': 0.4381006279552908,
 'ndcg': 0.7264558212808632,
 'precision': 0.565625,
 'recall': 0.338703606442577}
[INFO] - 02-27 20:17:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[235] Complete. Time taken: 00:00:32.736
[INFO] - 02-27 20:17:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:17:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:17:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:17:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:17:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:17:53 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2183, 2210, 1]
[INFO] - 02-27 20:17:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:18:01 - [main.backward:225]: Epoch 236/500 - Iteration 25/95 - Time 0.330 batch, 0.062 data, 0.302 forward
[INFO] - 02-27 20:18:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0031)
[INFO] - 02-27 20:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5875 (0.5862)
[INFO] - 02-27 20:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5482)
[INFO] - 02-27 20:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8029 (31.8072)
[INFO] - 02-27 20:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6699 (371.4534)
[INFO] - 02-27 20:18:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9677)
[INFO] - 02-27 20:18:16 - [main.backward:225]: Epoch 236/500 - Iteration 75/95 - Time 0.310 batch, 0.042 data, 0.279 forward
[INFO] - 02-27 20:18:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0028)
[INFO] - 02-27 20:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5790 (0.5851)
[INFO] - 02-27 20:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5413 (-287.5447)
[INFO] - 02-27 20:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6322 (31.7981)
[INFO] - 02-27 20:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.2411 (371.2667)
[INFO] - 02-27 20:18:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:18:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9716)
[INFO] - 02-27 20:18:22 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:18:22 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:18:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:18:22 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:18:22 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:18:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:18:22 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:18:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.679
[INFO] - 02-27 20:18:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.680
[INFO] - 02-27 20:18:25 - [main.summary_metrics:168]: Epoch 236/500 - Test Results:
{'auc': 0.8471859811939482,
 'f1': 0.432851430976431,
 'loss': 0.43617506121194694,
 'ndcg': 0.7251438009268039,
 'precision': 0.578125,
 'recall': 0.34645045518207285}
[INFO] - 02-27 20:18:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[236] Complete. Time taken: 00:00:32.000
[INFO] - 02-27 20:18:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:18:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:18:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:18:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:18:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:18:25 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2197, 2219, 1]
[INFO] - 02-27 20:18:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:18:34 - [main.backward:225]: Epoch 237/500 - Iteration 30/95 - Time 0.326 batch, 0.060 data, 0.291 forward
[INFO] - 02-27 20:18:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0065 (0.0032)
[INFO] - 02-27 20:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5841)
[INFO] - 02-27 20:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5444)
[INFO] - 02-27 20:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7839 (31.7941)
[INFO] - 02-27 20:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6862 (371.2720)
[INFO] - 02-27 20:18:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9636)
[INFO] - 02-27 20:18:50 - [main.backward:225]: Epoch 237/500 - Iteration 80/95 - Time 0.312 batch, 0.044 data, 0.278 forward
[INFO] - 02-27 20:18:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 20:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5824 (0.5860)
[INFO] - 02-27 20:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5440 (-287.5446)
[INFO] - 02-27 20:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7760 (31.7831)
[INFO] - 02-27 20:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5473 (371.3691)
[INFO] - 02-27 20:18:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:18:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9691)
[INFO] - 02-27 20:18:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:18:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:18:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:18:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:18:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:18:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:18:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:18:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.535
[INFO] - 02-27 20:18:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.535
[INFO] - 02-27 20:18:57 - [main.summary_metrics:168]: Epoch 237/500 - Test Results:
{'auc': 0.8460905640442451,
 'f1': 0.42340698653198655,
 'loss': 0.4385226709737231,
 'ndcg': 0.7207350989510799,
 'precision': 0.565625,
 'recall': 0.3388524159663866}
[INFO] - 02-27 20:18:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[237] Complete. Time taken: 00:00:32.142
[INFO] - 02-27 20:18:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:18:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:18:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:18:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:18:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:18:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3034, 2201, 2213, 1]
[INFO] - 02-27 20:18:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:19:08 - [main.backward:225]: Epoch 238/500 - Iteration 35/95 - Time 0.325 batch, 0.054 data, 0.291 forward
[INFO] - 02-27 20:19:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:19:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0033)
[INFO] - 02-27 20:19:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5859)
[INFO] - 02-27 20:19:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5428)
[INFO] - 02-27 20:19:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8601 (31.7953)
[INFO] - 02-27 20:19:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7630 (371.0735)
[INFO] - 02-27 20:19:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:19:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9655)
[INFO] - 02-27 20:19:24 - [main.backward:225]: Epoch 238/500 - Iteration 85/95 - Time 0.322 batch, 0.044 data, 0.287 forward
[INFO] - 02-27 20:19:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 20:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5845 (0.5854)
[INFO] - 02-27 20:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5392 (-287.5423)
[INFO] - 02-27 20:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7384 (31.8187)
[INFO] - 02-27 20:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1750 (371.2154)
[INFO] - 02-27 20:19:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:19:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9688)
[INFO] - 02-27 20:19:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:19:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:19:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:19:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:19:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:19:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:19:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:19:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.769
[INFO] - 02-27 20:19:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.770
[INFO] - 02-27 20:19:30 - [main.summary_metrics:168]: Epoch 238/500 - Test Results:
{'auc': 0.8463085512391231,
 'f1': 0.4143329124579125,
 'loss': 0.43843474162303875,
 'ndcg': 0.7185853045487554,
 'precision': 0.5531250000000001,
 'recall': 0.33174457282913167}
[INFO] - 02-27 20:19:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[238] Complete. Time taken: 00:00:33.625
[INFO] - 02-27 20:19:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:19:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:19:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:19:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:19:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:19:30 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2195, 2204, 1]
[INFO] - 02-27 20:19:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:19:44 - [main.backward:225]: Epoch 239/500 - Iteration 40/95 - Time 0.330 batch, 0.056 data, 0.293 forward
[INFO] - 02-27 20:19:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 20:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5866)
[INFO] - 02-27 20:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5406)
[INFO] - 02-27 20:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8156 (31.8191)
[INFO] - 02-27 20:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5278 (371.2986)
[INFO] - 02-27 20:19:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:19:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9619)
[INFO] - 02-27 20:19:59 - [main.backward:225]: Epoch 239/500 - Iteration 90/95 - Time 0.314 batch, 0.043 data, 0.279 forward
[INFO] - 02-27 20:19:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:19:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0032)
[INFO] - 02-27 20:19:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5858)
[INFO] - 02-27 20:19:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5424)
[INFO] - 02-27 20:19:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8359 (31.8074)
[INFO] - 02-27 20:19:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1964 (371.2460)
[INFO] - 02-27 20:19:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:19:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9658)
[INFO] - 02-27 20:20:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:20:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:20:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:20:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:20:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:20:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:20:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:20:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.638
[INFO] - 02-27 20:20:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.639
[INFO] - 02-27 20:20:03 - [main.summary_metrics:168]: Epoch 239/500 - Test Results:
{'auc': 0.8459026955757794,
 'f1': 0.40959911616161615,
 'loss': 0.43871646778156764,
 'ndcg': 0.7173545182346299,
 'precision': 0.546875,
 'recall': 0.32791929271708686}
[INFO] - 02-27 20:20:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[239] Complete. Time taken: 00:00:32.372
[INFO] - 02-27 20:20:03 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:20:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:20:03 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:20:03 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:20:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:20:03 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3059, 2183, 2216, 1]
[INFO] - 02-27 20:20:04 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:20:17 - [main.backward:225]: Epoch 240/500 - Iteration 45/95 - Time 0.314 batch, 0.049 data, 0.281 forward
[INFO] - 02-27 20:20:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0031)
[INFO] - 02-27 20:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5868)
[INFO] - 02-27 20:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5444 (-287.5447)
[INFO] - 02-27 20:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7824 (31.7891)
[INFO] - 02-27 20:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3076 (371.2422)
[INFO] - 02-27 20:20:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9686)
[INFO] - 02-27 20:20:32 - [main.backward:225]: Epoch 240/500 - Iteration 0/95 - Time 0.309 batch, 0.040 data, 0.276 forward
[INFO] - 02-27 20:20:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:20:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0032)
[INFO] - 02-27 20:20:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5809 (0.5863)
[INFO] - 02-27 20:20:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5448 (-287.5428)
[INFO] - 02-27 20:20:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7289 (31.8023)
[INFO] - 02-27 20:20:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2566 (371.2052)
[INFO] - 02-27 20:20:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:20:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9642)
[INFO] - 02-27 20:20:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:20:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:20:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:20:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:20:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:20:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:20:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:20:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.727
[INFO] - 02-27 20:20:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.728
[INFO] - 02-27 20:20:35 - [main.summary_metrics:168]: Epoch 240/500 - Test Results:
{'auc': 0.8464603183185039,
 'f1': 0.4043097643097643,
 'loss': 0.43852780531338487,
 'ndcg': 0.7187077406359297,
 'precision': 0.5406249999999999,
 'recall': 0.32335871848739495}
[INFO] - 02-27 20:20:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[240] Complete. Time taken: 00:00:32.079
[INFO] - 02-27 20:20:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:20:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:20:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:20:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:20:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:20:35 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3036, 2202, 2198, 1]
[INFO] - 02-27 20:20:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:20:51 - [main.backward:225]: Epoch 241/500 - Iteration 50/95 - Time 0.331 batch, 0.053 data, 0.295 forward
[INFO] - 02-27 20:20:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0028)
[INFO] - 02-27 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5963 (0.5862)
[INFO] - 02-27 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5421 (-287.5431)
[INFO] - 02-27 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7995 (31.7857)
[INFO] - 02-27 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5858 (371.1535)
[INFO] - 02-27 20:20:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:20:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9706)
[INFO] - 02-27 20:21:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:21:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:21:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:21:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:21:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:21:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:21:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:21:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.588
[INFO] - 02-27 20:21:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.589
[INFO] - 02-27 20:21:08 - [main.summary_metrics:168]: Epoch 241/500 - Test Results:
{'auc': 0.8451732076408995,
 'f1': 0.40875420875420876,
 'loss': 0.43845282322409995,
 'ndcg': 0.7222814613090344,
 'precision': 0.546875,
 'recall': 0.32679009103641454}
[INFO] - 02-27 20:21:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[241] Complete. Time taken: 00:00:32.845
[INFO] - 02-27 20:21:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:21:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:21:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:21:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:21:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:21:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3061, 2205, 2208, 1]
[INFO] - 02-27 20:21:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:21:10 - [main.backward:225]: Epoch 242/500 - Iteration 5/95 - Time 0.453 batch, 0.191 data, 0.421 forward
[INFO] - 02-27 20:21:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:21:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0032)
[INFO] - 02-27 20:21:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5852)
[INFO] - 02-27 20:21:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5466 (-287.5434)
[INFO] - 02-27 20:21:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9005 (31.7871)
[INFO] - 02-27 20:21:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1114 (371.2870)
[INFO] - 02-27 20:21:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:21:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9587)
[INFO] - 02-27 20:21:26 - [main.backward:225]: Epoch 242/500 - Iteration 55/95 - Time 0.324 batch, 0.051 data, 0.287 forward
[INFO] - 02-27 20:21:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0031)
[INFO] - 02-27 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5839 (0.5868)
[INFO] - 02-27 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5456 (-287.5453)
[INFO] - 02-27 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8724 (31.8035)
[INFO] - 02-27 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0941 (371.1620)
[INFO] - 02-27 20:21:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9669)
[INFO] - 02-27 20:21:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:21:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:21:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:21:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:21:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:21:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:21:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:21:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.771
[INFO] - 02-27 20:21:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.772
[INFO] - 02-27 20:21:40 - [main.summary_metrics:168]: Epoch 242/500 - Test Results:
{'auc': 0.8446891906272312,
 'f1': 0.40672874579124585,
 'loss': 0.4388366201367668,
 'ndcg': 0.7192596551711775,
 'precision': 0.54375,
 'recall': 0.32534576330532217}
[INFO] - 02-27 20:21:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[242] Complete. Time taken: 00:00:32.638
[INFO] - 02-27 20:21:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:21:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:21:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:21:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:21:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:21:40 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2193, 2212, 1]
[INFO] - 02-27 20:21:41 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:21:44 - [main.backward:225]: Epoch 243/500 - Iteration 10/95 - Time 0.402 batch, 0.130 data, 0.366 forward
[INFO] - 02-27 20:21:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0030)
[INFO] - 02-27 20:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5867 (0.5866)
[INFO] - 02-27 20:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5457 (-287.5448)
[INFO] - 02-27 20:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7586 (31.8016)
[INFO] - 02-27 20:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2255 (371.2885)
[INFO] - 02-27 20:21:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:21:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9663)
[INFO] - 02-27 20:22:00 - [main.backward:225]: Epoch 243/500 - Iteration 60/95 - Time 0.320 batch, 0.049 data, 0.287 forward
[INFO] - 02-27 20:22:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:22:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0033)
[INFO] - 02-27 20:22:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5840 (0.5855)
[INFO] - 02-27 20:22:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5441 (-287.5442)
[INFO] - 02-27 20:22:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8336 (31.8047)
[INFO] - 02-27 20:22:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1373 (371.2756)
[INFO] - 02-27 20:22:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:22:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9623)
[INFO] - 02-27 20:22:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:22:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:22:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:22:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:22:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:22:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:22:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:22:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.973
[INFO] - 02-27 20:22:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.975
[INFO] - 02-27 20:22:13 - [main.summary_metrics:168]: Epoch 243/500 - Test Results:
{'auc': 0.8452011526424296,
 'f1': 0.3997843013468014,
 'loss': 0.43809960440773577,
 'ndcg': 0.7201884361530699,
 'precision': 0.534375,
 'recall': 0.31983105742296913}
[INFO] - 02-27 20:22:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[243] Complete. Time taken: 00:00:32.884
[INFO] - 02-27 20:22:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:22:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:22:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:22:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:22:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:22:13 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2188, 2202, 1]
[INFO] - 02-27 20:22:14 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:22:19 - [main.backward:225]: Epoch 244/500 - Iteration 15/95 - Time 0.369 batch, 0.100 data, 0.327 forward
[INFO] - 02-27 20:22:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:22:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0031)
[INFO] - 02-27 20:22:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5819 (0.5854)
[INFO] - 02-27 20:22:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5452)
[INFO] - 02-27 20:22:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8309 (31.7867)
[INFO] - 02-27 20:22:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9541 (371.2023)
[INFO] - 02-27 20:22:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:22:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9659)
[INFO] - 02-27 20:22:34 - [main.backward:225]: Epoch 244/500 - Iteration 65/95 - Time 0.326 batch, 0.051 data, 0.288 forward
[INFO] - 02-27 20:22:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:22:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0030)
[INFO] - 02-27 20:22:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5881 (0.5843)
[INFO] - 02-27 20:22:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5479 (-287.5469)
[INFO] - 02-27 20:22:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7243 (31.7930)
[INFO] - 02-27 20:22:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3834 (371.2620)
[INFO] - 02-27 20:22:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:22:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9695)
[INFO] - 02-27 20:22:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:22:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:22:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:22:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:22:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:22:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:22:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:22:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.803
[INFO] - 02-27 20:22:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.804
[INFO] - 02-27 20:22:47 - [main.summary_metrics:168]: Epoch 244/500 - Test Results:
{'auc': 0.8465369519131183,
 'f1': 0.4143329124579125,
 'loss': 0.4368924052269795,
 'ndcg': 0.7211831049945103,
 'precision': 0.5531250000000001,
 'recall': 0.33174457282913167}
[INFO] - 02-27 20:22:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[244] Complete. Time taken: 00:00:33.721
[INFO] - 02-27 20:22:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:22:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:22:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:22:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:22:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:22:47 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3097, 2200, 2194, 1]
[INFO] - 02-27 20:22:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:22:54 - [main.backward:225]: Epoch 245/500 - Iteration 20/95 - Time 0.344 batch, 0.080 data, 0.306 forward
[INFO] - 02-27 20:22:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0029)
[INFO] - 02-27 20:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5847)
[INFO] - 02-27 20:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5474 (-287.5468)
[INFO] - 02-27 20:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7796 (31.8079)
[INFO] - 02-27 20:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1847 (371.4339)
[INFO] - 02-27 20:22:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:22:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9680)
[INFO] - 02-27 20:23:09 - [main.backward:225]: Epoch 245/500 - Iteration 70/95 - Time 0.309 batch, 0.045 data, 0.276 forward
[INFO] - 02-27 20:23:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:23:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0031)
[INFO] - 02-27 20:23:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5883 (0.5851)
[INFO] - 02-27 20:23:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5465)
[INFO] - 02-27 20:23:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7615 (31.8088)
[INFO] - 02-27 20:23:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1529 (371.1197)
[INFO] - 02-27 20:23:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:23:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9642)
[INFO] - 02-27 20:23:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:23:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:23:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:23:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:23:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:23:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:23:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:23:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.690
[INFO] - 02-27 20:23:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.690
[INFO] - 02-27 20:23:19 - [main.summary_metrics:168]: Epoch 245/500 - Test Results:
{'auc': 0.8461577172535681,
 'f1': 0.4186731902356903,
 'loss': 0.4378449596170848,
 'ndcg': 0.7236203190385417,
 'precision': 0.559375,
 'recall': 0.33502713585434174}
[INFO] - 02-27 20:23:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[245] Complete. Time taken: 00:00:31.865
[INFO] - 02-27 20:23:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:23:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:23:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:23:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:23:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:23:19 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3038, 2231, 2210, 1]
[INFO] - 02-27 20:23:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:23:28 - [main.backward:225]: Epoch 246/500 - Iteration 25/95 - Time 0.347 batch, 0.066 data, 0.313 forward
[INFO] - 02-27 20:23:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0029)
[INFO] - 02-27 20:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5802 (0.5848)
[INFO] - 02-27 20:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5469 (-287.5435)
[INFO] - 02-27 20:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7019 (31.8078)
[INFO] - 02-27 20:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0045 (371.3288)
[INFO] - 02-27 20:23:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:23:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9711)
[INFO] - 02-27 20:23:43 - [main.backward:225]: Epoch 246/500 - Iteration 75/95 - Time 0.320 batch, 0.045 data, 0.286 forward
[INFO] - 02-27 20:23:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0014 (0.0030)
[INFO] - 02-27 20:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5850)
[INFO] - 02-27 20:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5475 (-287.5481)
[INFO] - 02-27 20:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7365 (31.7950)
[INFO] - 02-27 20:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6719 (371.2209)
[INFO] - 02-27 20:23:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:23:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9650)
[INFO] - 02-27 20:23:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:23:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:23:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:23:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:23:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:23:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:23:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:23:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.770
[INFO] - 02-27 20:23:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.772
[INFO] - 02-27 20:23:52 - [main.summary_metrics:168]: Epoch 246/500 - Test Results:
{'auc': 0.846370617609789,
 'f1': 0.4115435606060606,
 'loss': 0.43746525324980773,
 'ndcg': 0.72288536182604,
 'precision': 0.55,
 'recall': 0.32926733193277313}
[INFO] - 02-27 20:23:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[246] Complete. Time taken: 00:00:33.062
[INFO] - 02-27 20:23:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:23:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:23:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:23:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:23:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:23:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3067, 2212, 2189, 1]
[INFO] - 02-27 20:23:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:24:02 - [main.backward:225]: Epoch 247/500 - Iteration 30/95 - Time 0.331 batch, 0.057 data, 0.302 forward
[INFO] - 02-27 20:24:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0031)
[INFO] - 02-27 20:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5850 (0.5856)
[INFO] - 02-27 20:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5426 (-287.5476)
[INFO] - 02-27 20:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8317 (31.8183)
[INFO] - 02-27 20:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1212 (371.5246)
[INFO] - 02-27 20:24:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:24:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9652)
[INFO] - 02-27 20:24:17 - [main.backward:225]: Epoch 247/500 - Iteration 80/95 - Time 0.312 batch, 0.042 data, 0.280 forward
[INFO] - 02-27 20:24:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0030)
[INFO] - 02-27 20:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5797 (0.5852)
[INFO] - 02-27 20:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5477 (-287.5458)
[INFO] - 02-27 20:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9018 (31.8050)
[INFO] - 02-27 20:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6724 (371.3950)
[INFO] - 02-27 20:24:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:24:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9686)
[INFO] - 02-27 20:24:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:24:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:24:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:24:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:24:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:24:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:24:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:24:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.586
[INFO] - 02-27 20:24:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.587
[INFO] - 02-27 20:24:24 - [main.summary_metrics:168]: Epoch 247/500 - Test Results:
{'auc': 0.8465189605866856,
 'f1': 0.4091245791245791,
 'loss': 0.43815367598302,
 'ndcg': 0.7175207483522038,
 'precision': 0.546875,
 'recall': 0.3272802871148459}
[INFO] - 02-27 20:24:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[247] Complete. Time taken: 00:00:31.817
[INFO] - 02-27 20:24:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:24:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:24:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:24:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:24:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:24:24 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3046, 2187, 2199, 1]
[INFO] - 02-27 20:24:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:24:35 - [main.backward:225]: Epoch 248/500 - Iteration 35/95 - Time 0.316 batch, 0.053 data, 0.287 forward
[INFO] - 02-27 20:24:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5884 (0.5858)
[INFO] - 02-27 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5399 (-287.5473)
[INFO] - 02-27 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8012 (31.8030)
[INFO] - 02-27 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2871 (371.0882)
[INFO] - 02-27 20:24:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:24:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9656)
[INFO] - 02-27 20:24:50 - [main.backward:225]: Epoch 248/500 - Iteration 85/95 - Time 0.307 batch, 0.042 data, 0.274 forward
[INFO] - 02-27 20:24:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:24:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0030)
[INFO] - 02-27 20:24:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5959 (0.5864)
[INFO] - 02-27 20:24:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5409)
[INFO] - 02-27 20:24:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7631 (31.8154)
[INFO] - 02-27 20:24:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7283 (371.3126)
[INFO] - 02-27 20:24:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:24:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9683)
[INFO] - 02-27 20:24:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:24:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:24:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:24:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:24:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:24:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:24:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:24:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.853
[INFO] - 02-27 20:24:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.854
[INFO] - 02-27 20:24:56 - [main.summary_metrics:168]: Epoch 248/500 - Test Results:
{'auc': 0.8462168957656592,
 'f1': 0.40441393097643097,
 'loss': 0.43753334971415353,
 'ndcg': 0.7172130238567987,
 'precision': 0.540625,
 'recall': 0.32350752801120447}
[INFO] - 02-27 20:24:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[248] Complete. Time taken: 00:00:31.945
[INFO] - 02-27 20:24:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:24:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:24:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:24:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:24:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:24:56 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3076, 2203, 2201, 1]
[INFO] - 02-27 20:24:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:25:09 - [main.backward:225]: Epoch 249/500 - Iteration 40/95 - Time 0.325 batch, 0.052 data, 0.293 forward
[INFO] - 02-27 20:25:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:25:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 20:25:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5933 (0.5854)
[INFO] - 02-27 20:25:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5423)
[INFO] - 02-27 20:25:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7464 (31.7990)
[INFO] - 02-27 20:25:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3040 (371.2303)
[INFO] - 02-27 20:25:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:25:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9667)
[INFO] - 02-27 20:25:24 - [main.backward:225]: Epoch 249/500 - Iteration 90/95 - Time 0.316 batch, 0.039 data, 0.285 forward
[INFO] - 02-27 20:25:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0030)
[INFO] - 02-27 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5782 (0.5847)
[INFO] - 02-27 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5392 (-287.5422)
[INFO] - 02-27 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8450 (31.7928)
[INFO] - 02-27 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0654 (371.1877)
[INFO] - 02-27 20:25:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:25:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9672)
[INFO] - 02-27 20:25:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:25:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:25:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:25:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:25:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:25:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:25:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:25:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.891
[INFO] - 02-27 20:25:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.891
[INFO] - 02-27 20:25:29 - [main.summary_metrics:168]: Epoch 249/500 - Test Results:
{'auc': 0.8471053691697268,
 'f1': 0.40238846801346806,
 'loss': 0.4370947157462406,
 'ndcg': 0.7217273123604517,
 'precision': 0.5375000000000001,
 'recall': 0.32206320028011204}
[INFO] - 02-27 20:25:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[249] Complete. Time taken: 00:00:32.906
[INFO] - 02-27 20:25:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:25:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:25:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:25:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:25:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:25:29 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3067, 2219, 2219, 1]
[INFO] - 02-27 20:25:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:25:44 - [main.backward:225]: Epoch 250/500 - Iteration 45/95 - Time 0.340 batch, 0.056 data, 0.302 forward
[INFO] - 02-27 20:25:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:25:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 20:25:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5859)
[INFO] - 02-27 20:25:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5442 (-287.5425)
[INFO] - 02-27 20:25:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7138 (31.7930)
[INFO] - 02-27 20:25:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.7681 (371.2411)
[INFO] - 02-27 20:25:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:25:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9647)
[INFO] - 02-27 20:26:00 - [main.backward:225]: Epoch 250/500 - Iteration 0/95 - Time 0.326 batch, 0.046 data, 0.289 forward
[INFO] - 02-27 20:26:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0034)
[INFO] - 02-27 20:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5846)
[INFO] - 02-27 20:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5430)
[INFO] - 02-27 20:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8153 (31.8098)
[INFO] - 02-27 20:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9210 (371.3022)
[INFO] - 02-27 20:26:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:26:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9605)
[INFO] - 02-27 20:26:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:26:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:26:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:26:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:26:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:26:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:26:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:26:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.546
[INFO] - 02-27 20:26:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.546
[INFO] - 02-27 20:26:02 - [main.summary_metrics:168]: Epoch 250/500 - Test Results:
{'auc': 0.8478634190195685,
 'f1': 0.4164625420875421,
 'loss': 0.43657766787122804,
 'ndcg': 0.7236916291831654,
 'precision': 0.5562499999999999,
 'recall': 0.3333377100840336}
[INFO] - 02-27 20:26:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[250] Complete. Time taken: 00:00:33.555
[INFO] - 02-27 20:26:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:26:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:26:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:26:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:26:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:26:02 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2193, 2225, 1]
[INFO] - 02-27 20:26:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:26:19 - [main.backward:225]: Epoch 251/500 - Iteration 50/95 - Time 0.344 batch, 0.052 data, 0.311 forward
[INFO] - 02-27 20:26:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:26:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0033)
[INFO] - 02-27 20:26:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5855 (0.5865)
[INFO] - 02-27 20:26:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5450 (-287.5444)
[INFO] - 02-27 20:26:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7788 (31.7890)
[INFO] - 02-27 20:26:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7149 (371.1814)
[INFO] - 02-27 20:26:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:26:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9619)
[INFO] - 02-27 20:26:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:26:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:26:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:26:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:26:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:26:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:26:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:26:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.745
[INFO] - 02-27 20:26:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.745
[INFO] - 02-27 20:26:36 - [main.summary_metrics:168]: Epoch 251/500 - Test Results:
{'auc': 0.8475218585596003,
 'f1': 0.40893939393939394,
 'loss': 0.43735690981407405,
 'ndcg': 0.7238467913693014,
 'precision': 0.546875,
 'recall': 0.3270351890756303}
[INFO] - 02-27 20:26:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[251] Complete. Time taken: 00:00:33.804
[INFO] - 02-27 20:26:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:26:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:26:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:26:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:26:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:26:36 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2176, 2222, 1]
[INFO] - 02-27 20:26:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:26:38 - [main.backward:225]: Epoch 252/500 - Iteration 5/95 - Time 0.485 batch, 0.199 data, 0.452 forward
[INFO] - 02-27 20:26:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:26:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0029)
[INFO] - 02-27 20:26:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5807 (0.5855)
[INFO] - 02-27 20:26:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5458 (-287.5459)
[INFO] - 02-27 20:26:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7929 (31.8056)
[INFO] - 02-27 20:26:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6682 (371.3905)
[INFO] - 02-27 20:26:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:26:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9684)
[INFO] - 02-27 20:26:54 - [main.backward:225]: Epoch 252/500 - Iteration 55/95 - Time 0.326 batch, 0.050 data, 0.291 forward
[INFO] - 02-27 20:26:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0056 (0.0032)
[INFO] - 02-27 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5852)
[INFO] - 02-27 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5466)
[INFO] - 02-27 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7563 (31.7963)
[INFO] - 02-27 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2208 (371.2713)
[INFO] - 02-27 20:26:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:26:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9622)
[INFO] - 02-27 20:27:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:27:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:27:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:27:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:27:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:27:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:27:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:27:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.510
[INFO] - 02-27 20:27:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.511
[INFO] - 02-27 20:27:09 - [main.summary_metrics:168]: Epoch 252/500 - Test Results:
{'auc': 0.8464416991674121,
 'f1': 0.4135690235690236,
 'loss': 0.4380268719751973,
 'ndcg': 0.7199783306937519,
 'precision': 0.5531250000000001,
 'recall': 0.33071165966386556}
[INFO] - 02-27 20:27:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[252] Complete. Time taken: 00:00:32.714
[INFO] - 02-27 20:27:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:27:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:27:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:27:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:27:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:27:09 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3034, 2210, 2218, 1]
[INFO] - 02-27 20:27:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:27:13 - [main.backward:225]: Epoch 253/500 - Iteration 10/95 - Time 0.386 batch, 0.105 data, 0.354 forward
[INFO] - 02-27 20:27:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0030)
[INFO] - 02-27 20:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5845 (0.5855)
[INFO] - 02-27 20:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5468)
[INFO] - 02-27 20:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8686 (31.8017)
[INFO] - 02-27 20:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1865 (371.2436)
[INFO] - 02-27 20:27:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:27:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9684)
[INFO] - 02-27 20:27:27 - [main.backward:225]: Epoch 253/500 - Iteration 60/95 - Time 0.304 batch, 0.044 data, 0.272 forward
[INFO] - 02-27 20:27:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0032)
[INFO] - 02-27 20:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5873 (0.5860)
[INFO] - 02-27 20:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5434 (-287.5441)
[INFO] - 02-27 20:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7159 (31.7957)
[INFO] - 02-27 20:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1229 (371.4137)
[INFO] - 02-27 20:27:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9661)
[INFO] - 02-27 20:27:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:27:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:27:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:27:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:27:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:27:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:27:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:27:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.544
[INFO] - 02-27 20:27:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.545
[INFO] - 02-27 20:27:40 - [main.summary_metrics:168]: Epoch 253/500 - Test Results:
{'auc': 0.8471361770811265,
 'f1': 0.4017582070707071,
 'loss': 0.4379519630317799,
 'ndcg': 0.7260360104443943,
 'precision': 0.5375000000000001,
 'recall': 0.32114845938375347}
[INFO] - 02-27 20:27:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[253] Complete. Time taken: 00:00:31.080
[INFO] - 02-27 20:27:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:27:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:27:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:27:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:27:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:27:40 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2204, 2211, 1]
[INFO] - 02-27 20:27:41 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:27:45 - [main.backward:225]: Epoch 254/500 - Iteration 15/95 - Time 0.335 batch, 0.086 data, 0.300 forward
[INFO] - 02-27 20:27:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:27:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0029)
[INFO] - 02-27 20:27:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5923 (0.5857)
[INFO] - 02-27 20:27:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5444)
[INFO] - 02-27 20:27:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7345 (31.7938)
[INFO] - 02-27 20:27:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8658 (371.4415)
[INFO] - 02-27 20:27:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:27:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9692)
[INFO] - 02-27 20:27:59 - [main.backward:225]: Epoch 254/500 - Iteration 65/95 - Time 0.293 batch, 0.043 data, 0.262 forward
[INFO] - 02-27 20:27:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:27:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0032)
[INFO] - 02-27 20:27:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5854)
[INFO] - 02-27 20:27:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5442)
[INFO] - 02-27 20:27:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8051 (31.8080)
[INFO] - 02-27 20:27:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2483 (371.2616)
[INFO] - 02-27 20:27:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:27:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9650)
[INFO] - 02-27 20:28:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:28:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:28:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:28:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:28:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:28:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:28:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:28:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.614
[INFO] - 02-27 20:28:10 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.615
[INFO] - 02-27 20:28:10 - [main.summary_metrics:168]: Epoch 254/500 - Test Results:
{'auc': 0.8478653991621159,
 'f1': 0.42590698653198655,
 'loss': 0.4379899290087592,
 'ndcg': 0.7245722555465134,
 'precision': 0.5687500000000001,
 'recall': 0.34093574929971987}
[INFO] - 02-27 20:28:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[254] Complete. Time taken: 00:00:30.213
[INFO] - 02-27 20:28:10 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:28:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:28:10 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:28:10 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:28:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:28:10 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3042, 2203, 2200, 1]
[INFO] - 02-27 20:28:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:28:16 - [main.backward:225]: Epoch 255/500 - Iteration 20/95 - Time 0.316 batch, 0.064 data, 0.284 forward
[INFO] - 02-27 20:28:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:28:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0032)
[INFO] - 02-27 20:28:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5869)
[INFO] - 02-27 20:28:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5422)
[INFO] - 02-27 20:28:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7941 (31.7985)
[INFO] - 02-27 20:28:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6446 (371.3185)
[INFO] - 02-27 20:28:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:28:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9675)
[INFO] - 02-27 20:28:31 - [main.backward:225]: Epoch 255/500 - Iteration 70/95 - Time 0.300 batch, 0.043 data, 0.266 forward
[INFO] - 02-27 20:28:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0032)
[INFO] - 02-27 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5898 (0.5862)
[INFO] - 02-27 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5430 (-287.5432)
[INFO] - 02-27 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7859 (31.7987)
[INFO] - 02-27 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1703 (371.0830)
[INFO] - 02-27 20:28:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:28:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9628)
[INFO] - 02-27 20:28:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:28:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:28:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:28:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:28:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:28:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:28:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:28:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.615
[INFO] - 02-27 20:28:41 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.619
[INFO] - 02-27 20:28:41 - [main.summary_metrics:168]: Epoch 255/500 - Test Results:
{'auc': 0.847253701051499,
 'f1': 0.41843644781144784,
 'loss': 0.4371985460405856,
 'ndcg': 0.7150448518611205,
 'precision': 0.559375,
 'recall': 0.3346551120448179}
[INFO] - 02-27 20:28:41 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[255] Complete. Time taken: 00:00:30.888
[INFO] - 02-27 20:28:41 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:28:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:28:41 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:28:41 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:28:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:28:41 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2201, 2212, 1]
[INFO] - 02-27 20:28:42 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:28:49 - [main.backward:225]: Epoch 256/500 - Iteration 25/95 - Time 0.332 batch, 0.066 data, 0.296 forward
[INFO] - 02-27 20:28:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:28:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0033)
[INFO] - 02-27 20:28:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5876 (0.5856)
[INFO] - 02-27 20:28:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5440 (-287.5399)
[INFO] - 02-27 20:28:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6924 (31.8009)
[INFO] - 02-27 20:28:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9065 (371.2378)
[INFO] - 02-27 20:28:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:28:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9637)
[INFO] - 02-27 20:29:04 - [main.backward:225]: Epoch 256/500 - Iteration 75/95 - Time 0.311 batch, 0.044 data, 0.278 forward
[INFO] - 02-27 20:29:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 20:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5856)
[INFO] - 02-27 20:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5411 (-287.5437)
[INFO] - 02-27 20:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7090 (31.7990)
[INFO] - 02-27 20:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1126 (371.2345)
[INFO] - 02-27 20:29:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:29:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9642)
[INFO] - 02-27 20:29:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:29:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:29:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:29:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:29:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:29:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:29:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:29:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.654
[INFO] - 02-27 20:29:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.655
[INFO] - 02-27 20:29:13 - [main.summary_metrics:168]: Epoch 256/500 - Test Results:
{'auc': 0.846865341357131,
 'f1': 0.4161731902356902,
 'loss': 0.4377495411748118,
 'ndcg': 0.7248399213455412,
 'precision': 0.55625,
 'recall': 0.3329438025210084}
[INFO] - 02-27 20:29:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[256] Complete. Time taken: 00:00:31.847
[INFO] - 02-27 20:29:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:29:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:29:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:29:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:29:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:29:13 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2202, 2198, 1]
[INFO] - 02-27 20:29:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:29:22 - [main.backward:225]: Epoch 257/500 - Iteration 30/95 - Time 0.314 batch, 0.059 data, 0.280 forward
[INFO] - 02-27 20:29:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0030)
[INFO] - 02-27 20:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5862)
[INFO] - 02-27 20:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5407 (-287.5434)
[INFO] - 02-27 20:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7801 (31.8000)
[INFO] - 02-27 20:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2248 (371.3424)
[INFO] - 02-27 20:29:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:29:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9677)
[INFO] - 02-27 20:29:38 - [main.backward:225]: Epoch 257/500 - Iteration 80/95 - Time 0.314 batch, 0.043 data, 0.280 forward
[INFO] - 02-27 20:29:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:29:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0032)
[INFO] - 02-27 20:29:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5865)
[INFO] - 02-27 20:29:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5390 (-287.5430)
[INFO] - 02-27 20:29:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7613 (31.8056)
[INFO] - 02-27 20:29:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5652 (371.3897)
[INFO] - 02-27 20:29:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:29:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9636)
[INFO] - 02-27 20:29:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:29:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:29:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:29:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:29:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:29:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:29:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:29:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.670
[INFO] - 02-27 20:29:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.671
[INFO] - 02-27 20:29:45 - [main.summary_metrics:168]: Epoch 257/500 - Test Results:
{'auc': 0.8463543984995959,
 'f1': 0.41385837542087545,
 'loss': 0.4371171968205504,
 'ndcg': 0.7177109590555433,
 'precision': 0.553125,
 'recall': 0.3311055672268907}
[INFO] - 02-27 20:29:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[257] Complete. Time taken: 00:00:32.420
[INFO] - 02-27 20:29:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:29:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:29:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:29:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:29:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:29:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3032, 2198, 2216, 1]
[INFO] - 02-27 20:29:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:29:56 - [main.backward:225]: Epoch 258/500 - Iteration 35/95 - Time 0.318 batch, 0.059 data, 0.284 forward
[INFO] - 02-27 20:29:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:29:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0032)
[INFO] - 02-27 20:29:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5864)
[INFO] - 02-27 20:29:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5427)
[INFO] - 02-27 20:29:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7299 (31.7957)
[INFO] - 02-27 20:29:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6919 (371.2480)
[INFO] - 02-27 20:29:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:29:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9639)
[INFO] - 02-27 20:30:11 - [main.backward:225]: Epoch 258/500 - Iteration 85/95 - Time 0.306 batch, 0.044 data, 0.272 forward
[INFO] - 02-27 20:30:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:30:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 20:30:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5956 (0.5854)
[INFO] - 02-27 20:30:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5417 (-287.5415)
[INFO] - 02-27 20:30:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7221 (31.7891)
[INFO] - 02-27 20:30:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4286 (371.2022)
[INFO] - 02-27 20:30:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:30:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9645)
[INFO] - 02-27 20:30:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:30:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:30:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:30:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:30:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:30:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:30:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:30:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.683
[INFO] - 02-27 20:30:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.683
[INFO] - 02-27 20:30:17 - [main.summary_metrics:168]: Epoch 258/500 - Test Results:
{'auc': 0.8476599324165941,
 'f1': 0.4161731902356902,
 'loss': 0.43680027024538987,
 'ndcg': 0.724398320119509,
 'precision': 0.5562499999999999,
 'recall': 0.3329438025210084}
[INFO] - 02-27 20:30:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[258] Complete. Time taken: 00:00:31.786
[INFO] - 02-27 20:30:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:30:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:30:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:30:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:30:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:30:17 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3030, 2208, 2203, 1]
[INFO] - 02-27 20:30:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:30:30 - [main.backward:225]: Epoch 259/500 - Iteration 40/95 - Time 0.318 batch, 0.055 data, 0.284 forward
[INFO] - 02-27 20:30:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:30:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0031)
[INFO] - 02-27 20:30:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5854 (0.5853)
[INFO] - 02-27 20:30:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5438 (-287.5444)
[INFO] - 02-27 20:30:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7683 (31.8007)
[INFO] - 02-27 20:30:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.8240 (371.1991)
[INFO] - 02-27 20:30:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:30:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9664)
[INFO] - 02-27 20:30:44 - [main.backward:225]: Epoch 259/500 - Iteration 90/95 - Time 0.305 batch, 0.043 data, 0.271 forward
[INFO] - 02-27 20:30:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0028)
[INFO] - 02-27 20:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5856)
[INFO] - 02-27 20:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5458 (-287.5460)
[INFO] - 02-27 20:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7217 (31.7975)
[INFO] - 02-27 20:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5057 (371.1743)
[INFO] - 02-27 20:30:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:30:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9727)
[INFO] - 02-27 20:30:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:30:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:30:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:30:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:30:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:30:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:30:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:30:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.616
[INFO] - 02-27 20:30:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.616
[INFO] - 02-27 20:30:48 - [main.summary_metrics:168]: Epoch 259/500 - Test Results:
{'auc': 0.8474328131988089,
 'f1': 0.4212773569023569,
 'loss': 0.4364172100150564,
 'ndcg': 0.7235337600107901,
 'precision': 0.5625,
 'recall': 0.3372592787114846}
[INFO] - 02-27 20:30:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[259] Complete. Time taken: 00:00:31.459
[INFO] - 02-27 20:30:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:30:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:30:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:30:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:30:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:30:48 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3065, 2197, 2202, 1]
[INFO] - 02-27 20:30:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:31:02 - [main.backward:225]: Epoch 260/500 - Iteration 45/95 - Time 0.306 batch, 0.049 data, 0.275 forward
[INFO] - 02-27 20:31:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:31:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0032)
[INFO] - 02-27 20:31:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5852)
[INFO] - 02-27 20:31:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5434 (-287.5419)
[INFO] - 02-27 20:31:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7445 (31.7837)
[INFO] - 02-27 20:31:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0065 (371.1663)
[INFO] - 02-27 20:31:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:31:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9653)
[INFO] - 02-27 20:31:18 - [main.backward:225]: Epoch 260/500 - Iteration 0/95 - Time 0.314 batch, 0.044 data, 0.278 forward
[INFO] - 02-27 20:31:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0033)
[INFO] - 02-27 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5847)
[INFO] - 02-27 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5437)
[INFO] - 02-27 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9159 (31.8021)
[INFO] - 02-27 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.5526 (371.3891)
[INFO] - 02-27 20:31:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:31:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9642)
[INFO] - 02-27 20:31:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:31:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:31:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:31:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:31:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:31:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:31:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:31:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.726
[INFO] - 02-27 20:31:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.728
[INFO] - 02-27 20:31:21 - [main.summary_metrics:168]: Epoch 260/500 - Test Results:
{'auc': 0.8479487055238761,
 'f1': 0.41896254208754213,
 'loss': 0.43648842782575187,
 'ndcg': 0.7174654035456599,
 'precision': 0.559375,
 'recall': 0.33542104341736695}
[INFO] - 02-27 20:31:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[260] Complete. Time taken: 00:00:32.532
[INFO] - 02-27 20:31:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:31:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:31:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:31:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:31:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:31:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3058, 2213, 2213, 1]
[INFO] - 02-27 20:31:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:31:37 - [main.backward:225]: Epoch 261/500 - Iteration 50/95 - Time 0.323 batch, 0.052 data, 0.288 forward
[INFO] - 02-27 20:31:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0034)
[INFO] - 02-27 20:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5852)
[INFO] - 02-27 20:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5417 (-287.5445)
[INFO] - 02-27 20:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8374 (31.8145)
[INFO] - 02-27 20:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1817 (371.3343)
[INFO] - 02-27 20:31:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9608)
[INFO] - 02-27 20:31:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:31:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:31:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:31:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:31:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:31:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:31:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:31:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.603
[INFO] - 02-27 20:31:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.603
[INFO] - 02-27 20:31:53 - [main.summary_metrics:168]: Epoch 261/500 - Test Results:
{'auc': 0.8458215680880194,
 'f1': 0.4118329124579124,
 'loss': 0.43832172141525483,
 'ndcg': 0.718617833883423,
 'precision': 0.55,
 'recall': 0.32966123949579834}
[INFO] - 02-27 20:31:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[261] Complete. Time taken: 00:00:32.145
[INFO] - 02-27 20:31:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:31:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:31:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:31:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:31:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:31:53 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3029, 2204, 2195, 1]
[INFO] - 02-27 20:31:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:31:55 - [main.backward:225]: Epoch 262/500 - Iteration 5/95 - Time 0.447 batch, 0.180 data, 0.409 forward
[INFO] - 02-27 20:31:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:31:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0034)
[INFO] - 02-27 20:31:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5847)
[INFO] - 02-27 20:31:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5401 (-287.5427)
[INFO] - 02-27 20:31:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8321 (31.8061)
[INFO] - 02-27 20:31:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4419 (371.2393)
[INFO] - 02-27 20:31:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:31:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9603)
[INFO] - 02-27 20:32:10 - [main.backward:225]: Epoch 262/500 - Iteration 55/95 - Time 0.308 batch, 0.048 data, 0.273 forward
[INFO] - 02-27 20:32:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:32:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0032)
[INFO] - 02-27 20:32:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5854 (0.5860)
[INFO] - 02-27 20:32:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5381 (-287.5401)
[INFO] - 02-27 20:32:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8770 (31.8064)
[INFO] - 02-27 20:32:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7960 (371.5293)
[INFO] - 02-27 20:32:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:32:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9664)
[INFO] - 02-27 20:32:22 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:32:22 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:32:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:32:22 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:32:22 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:32:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:32:22 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:32:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.946
[INFO] - 02-27 20:32:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.947
[INFO] - 02-27 20:32:25 - [main.summary_metrics:168]: Epoch 262/500 - Test Results:
{'auc': 0.8467964470101765,
 'f1': 0.4140435606060606,
 'loss': 0.4379716753218148,
 'ndcg': 0.7202080347583834,
 'precision': 0.553125,
 'recall': 0.33135066526610646}
[INFO] - 02-27 20:32:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[262] Complete. Time taken: 00:00:32.066
[INFO] - 02-27 20:32:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:32:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:32:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:32:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:32:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:32:25 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3057, 2201, 2203, 1]
[INFO] - 02-27 20:32:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:32:30 - [main.backward:225]: Epoch 263/500 - Iteration 10/95 - Time 0.506 batch, 0.169 data, 0.434 forward
[INFO] - 02-27 20:32:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:32:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0029)
[INFO] - 02-27 20:32:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5846 (0.5857)
[INFO] - 02-27 20:32:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5367 (-287.5392)
[INFO] - 02-27 20:32:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8550 (31.7817)
[INFO] - 02-27 20:32:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3253 (371.0441)
[INFO] - 02-27 20:32:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:32:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9706)
[INFO] - 02-27 20:32:46 - [main.backward:225]: Epoch 263/500 - Iteration 60/95 - Time 0.344 batch, 0.059 data, 0.301 forward
[INFO] - 02-27 20:32:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0031)
[INFO] - 02-27 20:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5768 (0.5848)
[INFO] - 02-27 20:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5428)
[INFO] - 02-27 20:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8314 (31.7986)
[INFO] - 02-27 20:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3980 (371.3164)
[INFO] - 02-27 20:32:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:32:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9675)
[INFO] - 02-27 20:32:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:32:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:32:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:32:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:32:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:32:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:32:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:32:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.584
[INFO] - 02-27 20:32:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.585
[INFO] - 02-27 20:32:59 - [main.summary_metrics:168]: Epoch 263/500 - Test Results:
{'auc': 0.8463072597298723,
 'f1': 0.409413930976431,
 'loss': 0.43871060180274957,
 'ndcg': 0.7197276165903339,
 'precision': 0.546875,
 'recall': 0.3276741946778712}
[INFO] - 02-27 20:32:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[263] Complete. Time taken: 00:00:34.200
[INFO] - 02-27 20:32:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:32:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:32:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:32:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:32:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:32:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3022, 2194, 2188, 1]
[INFO] - 02-27 20:33:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:33:04 - [main.backward:225]: Epoch 264/500 - Iteration 15/95 - Time 0.343 batch, 0.083 data, 0.313 forward
[INFO] - 02-27 20:33:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:33:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0030)
[INFO] - 02-27 20:33:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5859)
[INFO] - 02-27 20:33:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5416)
[INFO] - 02-27 20:33:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8221 (31.7881)
[INFO] - 02-27 20:33:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5049 (370.9862)
[INFO] - 02-27 20:33:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:33:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9703)
[INFO] - 02-27 20:33:21 - [main.backward:225]: Epoch 264/500 - Iteration 65/95 - Time 0.328 batch, 0.050 data, 0.291 forward
[INFO] - 02-27 20:33:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 20:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5819 (0.5846)
[INFO] - 02-27 20:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5473 (-287.5473)
[INFO] - 02-27 20:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7678 (31.7923)
[INFO] - 02-27 20:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5048 (371.1790)
[INFO] - 02-27 20:33:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:33:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9664)
[INFO] - 02-27 20:33:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:33:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:33:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:33:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:33:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:33:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:33:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:33:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.596
[INFO] - 02-27 20:33:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.596
[INFO] - 02-27 20:33:33 - [main.summary_metrics:168]: Epoch 264/500 - Test Results:
{'auc': 0.8475063542573893,
 'f1': 0.42330281986531987,
 'loss': 0.4376626851660844,
 'ndcg': 0.7250808805568159,
 'precision': 0.565625,
 'recall': 0.338703606442577}
[INFO] - 02-27 20:33:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[264] Complete. Time taken: 00:00:33.471
[INFO] - 02-27 20:33:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:33:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:33:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:33:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:33:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:33:33 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3056, 2215, 2221, 1]
[INFO] - 02-27 20:33:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:33:40 - [main.backward:225]: Epoch 265/500 - Iteration 20/95 - Time 0.340 batch, 0.072 data, 0.307 forward
[INFO] - 02-27 20:33:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0033)
[INFO] - 02-27 20:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5908 (0.5870)
[INFO] - 02-27 20:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5479 (-287.5448)
[INFO] - 02-27 20:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7716 (31.8034)
[INFO] - 02-27 20:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9859 (371.1972)
[INFO] - 02-27 20:33:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:33:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9645)
[INFO] - 02-27 20:33:54 - [main.backward:225]: Epoch 265/500 - Iteration 70/95 - Time 0.309 batch, 0.046 data, 0.274 forward
[INFO] - 02-27 20:33:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:33:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0031)
[INFO] - 02-27 20:33:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5851)
[INFO] - 02-27 20:33:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5424)
[INFO] - 02-27 20:33:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7877 (31.8048)
[INFO] - 02-27 20:33:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5586 (371.0224)
[INFO] - 02-27 20:33:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:33:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9670)
[INFO] - 02-27 20:34:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:34:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:34:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:34:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:34:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:34:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:34:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:34:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.657
[INFO] - 02-27 20:34:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.657
[INFO] - 02-27 20:34:04 - [main.summary_metrics:168]: Epoch 265/500 - Test Results:
{'auc': 0.8470491496843835,
 'f1': 0.4088878367003367,
 'loss': 0.43822113985019695,
 'ndcg': 0.72215347233013,
 'precision': 0.546875,
 'recall': 0.3269082633053221}
[INFO] - 02-27 20:34:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[265] Complete. Time taken: 00:00:31.667
[INFO] - 02-27 20:34:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:34:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:34:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:34:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:34:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:34:04 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3046, 2201, 2230, 1]
[INFO] - 02-27 20:34:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:34:12 - [main.backward:225]: Epoch 266/500 - Iteration 25/95 - Time 0.317 batch, 0.057 data, 0.288 forward
[INFO] - 02-27 20:34:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:34:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0031)
[INFO] - 02-27 20:34:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5826 (0.5870)
[INFO] - 02-27 20:34:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5413 (-287.5425)
[INFO] - 02-27 20:34:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8255 (31.7844)
[INFO] - 02-27 20:34:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5539 (370.9248)
[INFO] - 02-27 20:34:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:34:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9677)
[INFO] - 02-27 20:34:27 - [main.backward:225]: Epoch 266/500 - Iteration 75/95 - Time 0.301 batch, 0.039 data, 0.272 forward
[INFO] - 02-27 20:34:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:34:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0031)
[INFO] - 02-27 20:34:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5838 (0.5864)
[INFO] - 02-27 20:34:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5434 (-287.5441)
[INFO] - 02-27 20:34:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8777 (31.7875)
[INFO] - 02-27 20:34:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3645 (370.9660)
[INFO] - 02-27 20:34:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:34:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9636)
[INFO] - 02-27 20:34:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:34:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:34:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:34:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:34:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:34:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:34:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:34:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.381
[INFO] - 02-27 20:34:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.382
[INFO] - 02-27 20:34:36 - [main.summary_metrics:168]: Epoch 266/500 - Test Results:
{'auc': 0.8480391444568023,
 'f1': 0.4300620791245791,
 'loss': 0.43716233913162666,
 'ndcg': 0.7195623819960384,
 'precision': 0.575,
 'recall': 0.3439732142857143}
[INFO] - 02-27 20:34:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[266] Complete. Time taken: 00:00:32.037
[INFO] - 02-27 20:34:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:34:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:34:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:34:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:34:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:34:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2202, 2196, 1]
[INFO] - 02-27 20:34:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:34:46 - [main.backward:225]: Epoch 267/500 - Iteration 30/95 - Time 0.320 batch, 0.057 data, 0.289 forward
[INFO] - 02-27 20:34:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0032)
[INFO] - 02-27 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5855)
[INFO] - 02-27 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5462 (-287.5454)
[INFO] - 02-27 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7740 (31.8065)
[INFO] - 02-27 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2011 (371.2579)
[INFO] - 02-27 20:34:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:34:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9664)
[INFO] - 02-27 20:35:01 - [main.backward:225]: Epoch 267/500 - Iteration 80/95 - Time 0.305 batch, 0.042 data, 0.273 forward
[INFO] - 02-27 20:35:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0031)
[INFO] - 02-27 20:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5907 (0.5846)
[INFO] - 02-27 20:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5420 (-287.5455)
[INFO] - 02-27 20:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8111 (31.7980)
[INFO] - 02-27 20:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3801 (371.0438)
[INFO] - 02-27 20:35:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:35:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9666)
[INFO] - 02-27 20:35:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:35:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:35:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:35:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:35:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:35:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:35:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:35:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.623
[INFO] - 02-27 20:35:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.627
[INFO] - 02-27 20:35:08 - [main.summary_metrics:168]: Epoch 267/500 - Test Results:
{'auc': 0.8470678884911808,
 'f1': 0.42306607744107744,
 'loss': 0.4380304700607217,
 'ndcg': 0.723073976988393,
 'precision': 0.565625,
 'recall': 0.3383315826330532}
[INFO] - 02-27 20:35:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[267] Complete. Time taken: 00:00:31.479
[INFO] - 02-27 20:35:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:35:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:35:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:35:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:35:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:35:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2204, 2209, 1]
[INFO] - 02-27 20:35:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:35:19 - [main.backward:225]: Epoch 268/500 - Iteration 35/95 - Time 0.318 batch, 0.054 data, 0.287 forward
[INFO] - 02-27 20:35:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0028)
[INFO] - 02-27 20:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5818 (0.5863)
[INFO] - 02-27 20:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5420 (-287.5406)
[INFO] - 02-27 20:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8071 (31.7965)
[INFO] - 02-27 20:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5137 (371.2191)
[INFO] - 02-27 20:35:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:35:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9727)
[INFO] - 02-27 20:35:34 - [main.backward:225]: Epoch 268/500 - Iteration 85/95 - Time 0.303 batch, 0.041 data, 0.272 forward
[INFO] - 02-27 20:35:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 20:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5878 (0.5848)
[INFO] - 02-27 20:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5413 (-287.5417)
[INFO] - 02-27 20:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7262 (31.7722)
[INFO] - 02-27 20:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.8316 (371.1996)
[INFO] - 02-27 20:35:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:35:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9658)
[INFO] - 02-27 20:35:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:35:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:35:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:35:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:35:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:35:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:35:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:35:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.466
[INFO] - 02-27 20:35:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.468
[INFO] - 02-27 20:35:39 - [main.summary_metrics:168]: Epoch 268/500 - Test Results:
{'auc': 0.8473356671099812,
 'f1': 0.4189625420875421,
 'loss': 0.43649351465629005,
 'ndcg': 0.7198222455444256,
 'precision': 0.559375,
 'recall': 0.3354210434173669}
[INFO] - 02-27 20:35:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[268] Complete. Time taken: 00:00:31.149
[INFO] - 02-27 20:35:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:35:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:35:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:35:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:35:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:35:39 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2186, 2218, 1]
[INFO] - 02-27 20:35:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:35:52 - [main.backward:225]: Epoch 269/500 - Iteration 40/95 - Time 0.324 batch, 0.055 data, 0.288 forward
[INFO] - 02-27 20:35:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0029)
[INFO] - 02-27 20:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5855)
[INFO] - 02-27 20:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5427)
[INFO] - 02-27 20:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8133 (31.7941)
[INFO] - 02-27 20:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5205 (371.1175)
[INFO] - 02-27 20:35:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9714)
[INFO] - 02-27 20:36:07 - [main.backward:225]: Epoch 269/500 - Iteration 90/95 - Time 0.306 batch, 0.042 data, 0.273 forward
[INFO] - 02-27 20:36:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:36:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0013 (0.0030)
[INFO] - 02-27 20:36:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5857 (0.5861)
[INFO] - 02-27 20:36:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5509 (-287.5452)
[INFO] - 02-27 20:36:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9194 (31.7863)
[INFO] - 02-27 20:36:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2846 (371.2275)
[INFO] - 02-27 20:36:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:36:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9686)
[INFO] - 02-27 20:36:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:36:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:36:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:36:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:36:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:36:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:36:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:36:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.477
[INFO] - 02-27 20:36:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.478
[INFO] - 02-27 20:36:11 - [main.summary_metrics:168]: Epoch 269/500 - Test Results:
{'auc': 0.8470113847622383,
 'f1': 0.41125420875420876,
 'loss': 0.43769246852722765,
 'ndcg': 0.7155353555159552,
 'precision': 0.55,
 'recall': 0.32887342436974787}
[INFO] - 02-27 20:36:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[269] Complete. Time taken: 00:00:31.517
[INFO] - 02-27 20:36:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:36:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:36:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:36:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:36:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:36:11 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3100, 2203, 2202, 1]
[INFO] - 02-27 20:36:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:36:25 - [main.backward:225]: Epoch 270/500 - Iteration 45/95 - Time 0.308 batch, 0.053 data, 0.275 forward
[INFO] - 02-27 20:36:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:36:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0029)
[INFO] - 02-27 20:36:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5864)
[INFO] - 02-27 20:36:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5441 (-287.5479)
[INFO] - 02-27 20:36:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8271 (31.7934)
[INFO] - 02-27 20:36:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3015 (371.3239)
[INFO] - 02-27 20:36:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:36:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9692)
[INFO] - 02-27 20:36:40 - [main.backward:225]: Epoch 270/500 - Iteration 0/95 - Time 0.308 batch, 0.044 data, 0.272 forward
[INFO] - 02-27 20:36:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:36:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0014 (0.0031)
[INFO] - 02-27 20:36:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5845 (0.5858)
[INFO] - 02-27 20:36:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5416 (-287.5420)
[INFO] - 02-27 20:36:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7750 (31.7862)
[INFO] - 02-27 20:36:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5095 (371.2187)
[INFO] - 02-27 20:36:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:36:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9667)
[INFO] - 02-27 20:36:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:36:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:36:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:36:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:36:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:36:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:36:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:36:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.688
[INFO] - 02-27 20:36:43 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.689
[INFO] - 02-27 20:36:43 - [main.summary_metrics:168]: Epoch 270/500 - Test Results:
{'auc': 0.8474869820477211,
 'f1': 0.41819865319865324,
 'loss': 0.43763183505565295,
 'ndcg': 0.7133109963628088,
 'precision': 0.559375,
 'recall': 0.33438813025210085}
[INFO] - 02-27 20:36:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[270] Complete. Time taken: 00:00:31.952
[INFO] - 02-27 20:36:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:36:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:36:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:36:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:36:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:36:43 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2202, 2210, 1]
[INFO] - 02-27 20:36:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:36:58 - [main.backward:225]: Epoch 271/500 - Iteration 50/95 - Time 0.317 batch, 0.050 data, 0.282 forward
[INFO] - 02-27 20:36:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:36:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 20:36:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5862)
[INFO] - 02-27 20:36:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5426)
[INFO] - 02-27 20:36:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7985 (31.7992)
[INFO] - 02-27 20:36:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9412 (371.1396)
[INFO] - 02-27 20:36:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:36:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9667)
[INFO] - 02-27 20:37:12 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:37:12 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:37:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:37:12 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:37:12 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:37:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:37:12 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:37:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.506
[INFO] - 02-27 20:37:14 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.507
[INFO] - 02-27 20:37:14 - [main.summary_metrics:168]: Epoch 271/500 - Test Results:
{'auc': 0.8462934889029141,
 'f1': 0.4282218013468013,
 'loss': 0.4392506480246163,
 'ndcg': 0.7197833578220763,
 'precision': 0.571875,
 'recall': 0.34277398459383757}
[INFO] - 02-27 20:37:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[271] Complete. Time taken: 00:00:31.650
[INFO] - 02-27 20:37:14 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:37:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:37:14 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:37:14 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:37:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:37:14 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2201, 2187, 1]
[INFO] - 02-27 20:37:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:37:16 - [main.backward:225]: Epoch 272/500 - Iteration 5/95 - Time 0.446 batch, 0.184 data, 0.414 forward
[INFO] - 02-27 20:37:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0030)
[INFO] - 02-27 20:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5874 (0.5861)
[INFO] - 02-27 20:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5433)
[INFO] - 02-27 20:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8307 (31.7988)
[INFO] - 02-27 20:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7888 (371.0662)
[INFO] - 02-27 20:37:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:37:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9698)
[INFO] - 02-27 20:37:32 - [main.backward:225]: Epoch 272/500 - Iteration 55/95 - Time 0.328 batch, 0.049 data, 0.293 forward
[INFO] - 02-27 20:37:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:37:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0049 (0.0031)
[INFO] - 02-27 20:37:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5884 (0.5872)
[INFO] - 02-27 20:37:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5386 (-287.5420)
[INFO] - 02-27 20:37:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8399 (31.8036)
[INFO] - 02-27 20:37:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4266 (371.2011)
[INFO] - 02-27 20:37:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:37:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9659)
[INFO] - 02-27 20:37:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:37:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:37:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:37:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:37:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:37:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:37:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:37:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.585
[INFO] - 02-27 20:37:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.586
[INFO] - 02-27 20:37:47 - [main.summary_metrics:168]: Epoch 272/500 - Test Results:
{'auc': 0.8467525865125463,
 'f1': 0.42098800505050504,
 'loss': 0.4384246205026685,
 'ndcg': 0.724118667851713,
 'precision': 0.5625,
 'recall': 0.3368653711484594}
[INFO] - 02-27 20:37:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[272] Complete. Time taken: 00:00:32.786
[INFO] - 02-27 20:37:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:37:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:37:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:37:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:37:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:37:47 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3065, 2201, 2186, 1]
[INFO] - 02-27 20:37:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:37:51 - [main.backward:225]: Epoch 273/500 - Iteration 10/95 - Time 0.402 batch, 0.122 data, 0.371 forward
[INFO] - 02-27 20:37:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:37:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0031)
[INFO] - 02-27 20:37:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5801 (0.5860)
[INFO] - 02-27 20:37:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5451 (-287.5434)
[INFO] - 02-27 20:37:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8950 (31.7943)
[INFO] - 02-27 20:37:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9257 (371.3873)
[INFO] - 02-27 20:37:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:37:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9645)
[INFO] - 02-27 20:38:06 - [main.backward:225]: Epoch 273/500 - Iteration 60/95 - Time 0.311 batch, 0.046 data, 0.281 forward
[INFO] - 02-27 20:38:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:38:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0033)
[INFO] - 02-27 20:38:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5891 (0.5857)
[INFO] - 02-27 20:38:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5399 (-287.5401)
[INFO] - 02-27 20:38:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8342 (31.7836)
[INFO] - 02-27 20:38:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1135 (371.0580)
[INFO] - 02-27 20:38:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:38:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9616)
[INFO] - 02-27 20:38:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:38:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:38:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:38:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:38:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:38:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:38:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:38:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.586
[INFO] - 02-27 20:38:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.587
[INFO] - 02-27 20:38:18 - [main.summary_metrics:168]: Epoch 273/500 - Test Results:
{'auc': 0.8462695901277177,
 'f1': 0.4231176346801347,
 'loss': 0.43774126113222,
 'ndcg': 0.7199256911936514,
 'precision': 0.565625,
 'recall': 0.33845850840336134}
[INFO] - 02-27 20:38:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[273] Complete. Time taken: 00:00:31.280
[INFO] - 02-27 20:38:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:38:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:38:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:38:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:38:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:38:18 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3046, 2188, 2235, 1]
[INFO] - 02-27 20:38:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:38:24 - [main.backward:225]: Epoch 274/500 - Iteration 15/95 - Time 0.373 batch, 0.089 data, 0.332 forward
[INFO] - 02-27 20:38:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0028)
[INFO] - 02-27 20:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5832 (0.5859)
[INFO] - 02-27 20:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5417 (-287.5419)
[INFO] - 02-27 20:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8077 (31.7989)
[INFO] - 02-27 20:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0128 (371.4028)
[INFO] - 02-27 20:38:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:38:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9684)
[INFO] - 02-27 20:38:39 - [main.backward:225]: Epoch 274/500 - Iteration 65/95 - Time 0.320 batch, 0.045 data, 0.286 forward
[INFO] - 02-27 20:38:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:38:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0030)
[INFO] - 02-27 20:38:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5790 (0.5857)
[INFO] - 02-27 20:38:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5480)
[INFO] - 02-27 20:38:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6863 (31.7641)
[INFO] - 02-27 20:38:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5023 (370.9804)
[INFO] - 02-27 20:38:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:38:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9661)
[INFO] - 02-27 20:38:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:38:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:38:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:38:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:38:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:38:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:38:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:38:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.709
[INFO] - 02-27 20:38:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.711
[INFO] - 02-27 20:38:51 - [main.summary_metrics:168]: Epoch 274/500 - Test Results:
{'auc': 0.8479358332793903,
 'f1': 0.4161731902356902,
 'loss': 0.436612097864904,
 'ndcg': 0.7201630150460987,
 'precision': 0.55625,
 'recall': 0.3329438025210084}
[INFO] - 02-27 20:38:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[274] Complete. Time taken: 00:00:32.675
[INFO] - 02-27 20:38:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:38:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:38:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:38:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:38:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:38:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2200, 2186, 1]
[INFO] - 02-27 20:38:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:38:58 - [main.backward:225]: Epoch 275/500 - Iteration 20/95 - Time 0.354 batch, 0.078 data, 0.315 forward
[INFO] - 02-27 20:38:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:38:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0029)
[INFO] - 02-27 20:38:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5924 (0.5856)
[INFO] - 02-27 20:38:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5465 (-287.5487)
[INFO] - 02-27 20:38:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7954 (31.7725)
[INFO] - 02-27 20:38:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7918 (371.1497)
[INFO] - 02-27 20:38:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:38:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9702)
[INFO] - 02-27 20:39:13 - [main.backward:225]: Epoch 275/500 - Iteration 70/95 - Time 0.320 batch, 0.047 data, 0.284 forward
[INFO] - 02-27 20:39:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:39:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0030)
[INFO] - 02-27 20:39:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5847)
[INFO] - 02-27 20:39:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5466)
[INFO] - 02-27 20:39:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7885 (31.8032)
[INFO] - 02-27 20:39:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8226 (371.3316)
[INFO] - 02-27 20:39:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:39:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9675)
[INFO] - 02-27 20:39:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:39:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:39:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:39:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:39:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:39:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:39:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:39:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.625
[INFO] - 02-27 20:39:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.626
[INFO] - 02-27 20:39:24 - [main.summary_metrics:168]: Epoch 275/500 - Test Results:
{'auc': 0.8471646535452416,
 'f1': 0.41385837542087545,
 'loss': 0.43617168443527293,
 'ndcg': 0.7234529005692019,
 'precision': 0.553125,
 'recall': 0.3311055672268908}
[INFO] - 02-27 20:39:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[275] Complete. Time taken: 00:00:32.827
[INFO] - 02-27 20:39:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:39:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:39:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:39:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:39:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:39:24 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3041, 2201, 2204, 1]
[INFO] - 02-27 20:39:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:39:32 - [main.backward:225]: Epoch 276/500 - Iteration 25/95 - Time 0.346 batch, 0.073 data, 0.314 forward
[INFO] - 02-27 20:39:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0029)
[INFO] - 02-27 20:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5844)
[INFO] - 02-27 20:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5445 (-287.5441)
[INFO] - 02-27 20:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7504 (31.8016)
[INFO] - 02-27 20:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5526 (371.2829)
[INFO] - 02-27 20:39:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:39:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9678)
[INFO] - 02-27 20:39:48 - [main.backward:225]: Epoch 276/500 - Iteration 75/95 - Time 0.321 batch, 0.045 data, 0.290 forward
[INFO] - 02-27 20:39:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0033)
[INFO] - 02-27 20:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5850)
[INFO] - 02-27 20:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5449 (-287.5456)
[INFO] - 02-27 20:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8592 (31.8035)
[INFO] - 02-27 20:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6535 (371.1150)
[INFO] - 02-27 20:39:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:39:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9606)
[INFO] - 02-27 20:39:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:39:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:39:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:39:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:39:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:39:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:39:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:39:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.474
[INFO] - 02-27 20:39:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.475
[INFO] - 02-27 20:39:57 - [main.summary_metrics:168]: Epoch 276/500 - Test Results:
{'auc': 0.8458282795961521,
 'f1': 0.41606902356902364,
 'loss': 0.4380198139244392,
 'ndcg': 0.7240808908180343,
 'precision': 0.5562499999999999,
 'recall': 0.3327949929971989}
[INFO] - 02-27 20:39:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[276] Complete. Time taken: 00:00:32.717
[INFO] - 02-27 20:39:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:39:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:39:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:39:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:39:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:39:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3070, 2209, 2201, 1]
[INFO] - 02-27 20:39:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:40:06 - [main.backward:225]: Epoch 277/500 - Iteration 30/95 - Time 0.331 batch, 0.064 data, 0.294 forward
[INFO] - 02-27 20:40:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0032)
[INFO] - 02-27 20:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5860 (0.5851)
[INFO] - 02-27 20:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5428 (-287.5443)
[INFO] - 02-27 20:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7498 (31.7994)
[INFO] - 02-27 20:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2401 (371.2163)
[INFO] - 02-27 20:40:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:40:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9645)
[INFO] - 02-27 20:40:22 - [main.backward:225]: Epoch 277/500 - Iteration 80/95 - Time 0.321 batch, 0.047 data, 0.284 forward
[INFO] - 02-27 20:40:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0032)
[INFO] - 02-27 20:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5875 (0.5863)
[INFO] - 02-27 20:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5433 (-287.5446)
[INFO] - 02-27 20:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7959 (31.7942)
[INFO] - 02-27 20:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0597 (371.1249)
[INFO] - 02-27 20:40:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:40:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9663)
[INFO] - 02-27 20:40:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:40:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:40:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:40:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:40:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:40:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:40:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:40:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.620
[INFO] - 02-27 20:40:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.620
[INFO] - 02-27 20:40:29 - [main.summary_metrics:168]: Epoch 277/500 - Test Results:
{'auc': 0.8469253436055795,
 'f1': 0.4257218013468014,
 'loss': 0.43787724517052096,
 'ndcg': 0.7189153677791855,
 'precision': 0.5687500000000001,
 'recall': 0.3406906512605042}
[INFO] - 02-27 20:40:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[277] Complete. Time taken: 00:00:32.951
[INFO] - 02-27 20:40:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:40:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:40:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:40:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:40:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:40:30 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3084, 2191, 2187, 1]
[INFO] - 02-27 20:40:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:40:41 - [main.backward:225]: Epoch 278/500 - Iteration 35/95 - Time 0.334 batch, 0.053 data, 0.303 forward
[INFO] - 02-27 20:40:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0032)
[INFO] - 02-27 20:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5827 (0.5865)
[INFO] - 02-27 20:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5454)
[INFO] - 02-27 20:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8159 (31.7967)
[INFO] - 02-27 20:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3861 (371.3014)
[INFO] - 02-27 20:40:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:40:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9658)
[INFO] - 02-27 20:40:56 - [main.backward:225]: Epoch 278/500 - Iteration 85/95 - Time 0.317 batch, 0.040 data, 0.287 forward
[INFO] - 02-27 20:40:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0029)
[INFO] - 02-27 20:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5870 (0.5859)
[INFO] - 02-27 20:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5442)
[INFO] - 02-27 20:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8721 (31.7994)
[INFO] - 02-27 20:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4259 (371.2395)
[INFO] - 02-27 20:40:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:40:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9705)
[INFO] - 02-27 20:41:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:41:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:41:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:41:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:41:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:41:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:41:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:41:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.600
[INFO] - 02-27 20:41:02 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.600
[INFO] - 02-27 20:41:02 - [main.summary_metrics:168]: Epoch 278/500 - Test Results:
{'auc': 0.845837879882345,
 'f1': 0.41664772727272725,
 'loss': 0.43887702909936277,
 'ndcg': 0.7165988820660251,
 'precision': 0.5562499999999999,
 'recall': 0.33358280812324925}
[INFO] - 02-27 20:41:02 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[278] Complete. Time taken: 00:00:32.742
[INFO] - 02-27 20:41:02 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:41:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:41:02 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:41:02 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:41:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:41:02 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3033, 2191, 2217, 1]
[INFO] - 02-27 20:41:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:41:15 - [main.backward:225]: Epoch 279/500 - Iteration 40/95 - Time 0.331 batch, 0.053 data, 0.296 forward
[INFO] - 02-27 20:41:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 20:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5860)
[INFO] - 02-27 20:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5496 (-287.5474)
[INFO] - 02-27 20:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8164 (31.7896)
[INFO] - 02-27 20:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4008 (371.1205)
[INFO] - 02-27 20:41:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:41:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9653)
[INFO] - 02-27 20:41:29 - [main.backward:225]: Epoch 279/500 - Iteration 90/95 - Time 0.296 batch, 0.039 data, 0.265 forward
[INFO] - 02-27 20:41:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0032)
[INFO] - 02-27 20:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5856)
[INFO] - 02-27 20:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5420 (-287.5456)
[INFO] - 02-27 20:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6688 (31.7981)
[INFO] - 02-27 20:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.7657 (371.1078)
[INFO] - 02-27 20:41:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:41:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9620)
[INFO] - 02-27 20:41:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:41:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:41:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:41:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:41:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:41:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:41:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:41:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.130
[INFO] - 02-27 20:41:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.131
[INFO] - 02-27 20:41:32 - [main.summary_metrics:168]: Epoch 279/500 - Test Results:
{'auc': 0.847492777257962,
 'f1': 0.41101746632996633,
 'loss': 0.4380692449462781,
 'ndcg': 0.7213477634999867,
 'precision': 0.55,
 'recall': 0.3285014005602241}
[INFO] - 02-27 20:41:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[279] Complete. Time taken: 00:00:30.107
[INFO] - 02-27 20:41:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:41:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:41:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:41:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:41:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:41:32 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3065, 2202, 2222, 1]
[INFO] - 02-27 20:41:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:41:44 - [main.backward:225]: Epoch 280/500 - Iteration 45/95 - Time 0.269 batch, 0.040 data, 0.243 forward
[INFO] - 02-27 20:41:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0030)
[INFO] - 02-27 20:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5856)
[INFO] - 02-27 20:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5452)
[INFO] - 02-27 20:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7189 (31.8058)
[INFO] - 02-27 20:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0375 (371.2218)
[INFO] - 02-27 20:41:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:41:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9664)
[INFO] - 02-27 20:41:57 - [main.backward:225]: Epoch 280/500 - Iteration 0/95 - Time 0.262 batch, 0.032 data, 0.237 forward
[INFO] - 02-27 20:41:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 20:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5907 (0.5855)
[INFO] - 02-27 20:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5475 (-287.5461)
[INFO] - 02-27 20:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8044 (31.7953)
[INFO] - 02-27 20:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2911 (371.3448)
[INFO] - 02-27 20:41:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:41:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9658)
[INFO] - 02-27 20:41:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:41:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:41:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:41:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:41:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:41:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:41:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:41:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.115
[INFO] - 02-27 20:41:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.116
[INFO] - 02-27 20:41:59 - [main.summary_metrics:168]: Epoch 280/500 - Test Results:
{'auc': 0.8473423011361407,
 'f1': 0.40709911616161615,
 'loss': 0.43812493082747994,
 'ndcg': 0.7200188410411061,
 'precision': 0.5437500000000001,
 'recall': 0.32583595938375354}
[INFO] - 02-27 20:41:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[280] Complete. Time taken: 00:00:27.021
[INFO] - 02-27 20:41:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:41:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:41:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:41:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:41:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:41:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2191, 2208, 1]
[INFO] - 02-27 20:42:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:42:13 - [main.backward:225]: Epoch 281/500 - Iteration 50/95 - Time 0.265 batch, 0.038 data, 0.240 forward
[INFO] - 02-27 20:42:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:42:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0032)
[INFO] - 02-27 20:42:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5809 (0.5847)
[INFO] - 02-27 20:42:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5455)
[INFO] - 02-27 20:42:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8619 (31.8130)
[INFO] - 02-27 20:42:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6357 (371.2050)
[INFO] - 02-27 20:42:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:42:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9647)
[INFO] - 02-27 20:42:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:42:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:42:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:42:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:42:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:42:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:42:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:42:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.217
[INFO] - 02-27 20:42:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.217
[INFO] - 02-27 20:42:27 - [main.summary_metrics:168]: Epoch 281/500 - Test Results:
{'auc': 0.8465893649739308,
 'f1': 0.4065730218855219,
 'loss': 0.43764045333103174,
 'ndcg': 0.7199062862158602,
 'precision': 0.5437500000000001,
 'recall': 0.3250700280112045}
[INFO] - 02-27 20:42:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[281] Complete. Time taken: 00:00:27.317
[INFO] - 02-27 20:42:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:42:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:42:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:42:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:42:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:42:27 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3027, 2174, 2203, 1]
[INFO] - 02-27 20:42:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:42:29 - [main.backward:225]: Epoch 282/500 - Iteration 5/95 - Time 0.375 batch, 0.135 data, 0.351 forward
[INFO] - 02-27 20:42:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:42:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0032)
[INFO] - 02-27 20:42:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5850)
[INFO] - 02-27 20:42:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5490 (-287.5466)
[INFO] - 02-27 20:42:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8561 (31.7878)
[INFO] - 02-27 20:42:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6637 (371.0454)
[INFO] - 02-27 20:42:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:42:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9669)
[INFO] - 02-27 20:42:41 - [main.backward:225]: Epoch 282/500 - Iteration 55/95 - Time 0.268 batch, 0.035 data, 0.243 forward
[INFO] - 02-27 20:42:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:42:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 20:42:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5853)
[INFO] - 02-27 20:42:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5474 (-287.5475)
[INFO] - 02-27 20:42:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8090 (31.8067)
[INFO] - 02-27 20:42:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2928 (371.1984)
[INFO] - 02-27 20:42:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:42:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9631)
[INFO] - 02-27 20:42:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:42:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:42:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:42:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:42:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:42:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:42:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:42:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.167
[INFO] - 02-27 20:42:54 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.168
[INFO] - 02-27 20:42:54 - [main.summary_metrics:168]: Epoch 282/500 - Test Results:
{'auc': 0.8465987044327534,
 'f1': 0.4189625420875421,
 'loss': 0.4375485042073997,
 'ndcg': 0.7207053185236777,
 'precision': 0.5593750000000001,
 'recall': 0.33542104341736695}
[INFO] - 02-27 20:42:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[282] Complete. Time taken: 00:00:27.102
[INFO] - 02-27 20:42:54 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:42:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:42:54 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:42:54 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:42:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:42:54 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3065, 2191, 2195, 1]
[INFO] - 02-27 20:42:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:42:57 - [main.backward:225]: Epoch 283/500 - Iteration 10/95 - Time 0.344 batch, 0.107 data, 0.317 forward
[INFO] - 02-27 20:42:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:42:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 20:42:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5844)
[INFO] - 02-27 20:42:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5423)
[INFO] - 02-27 20:42:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7305 (31.8022)
[INFO] - 02-27 20:42:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3857 (371.0780)
[INFO] - 02-27 20:42:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:42:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9659)
[INFO] - 02-27 20:43:11 - [main.backward:225]: Epoch 283/500 - Iteration 60/95 - Time 0.280 batch, 0.040 data, 0.253 forward
[INFO] - 02-27 20:43:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:43:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0029)
[INFO] - 02-27 20:43:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5790 (0.5845)
[INFO] - 02-27 20:43:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5446 (-287.5449)
[INFO] - 02-27 20:43:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8732 (31.8129)
[INFO] - 02-27 20:43:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2345 (371.2819)
[INFO] - 02-27 20:43:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:43:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9706)
[INFO] - 02-27 20:43:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:43:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:43:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:43:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:43:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:43:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:43:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:43:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.037
[INFO] - 02-27 20:43:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.038
[INFO] - 02-27 20:43:22 - [main.summary_metrics:168]: Epoch 283/500 - Test Results:
{'auc': 0.8456567936610919,
 'f1': 0.4186731902356902,
 'loss': 0.4382222184778669,
 'ndcg': 0.7122252044933697,
 'precision': 0.559375,
 'recall': 0.33502713585434174}
[INFO] - 02-27 20:43:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[283] Complete. Time taken: 00:00:28.205
[INFO] - 02-27 20:43:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:43:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:43:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:43:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:43:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:43:22 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3043, 2214, 2207, 1]
[INFO] - 02-27 20:43:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:43:26 - [main.backward:225]: Epoch 284/500 - Iteration 15/95 - Time 0.293 batch, 0.068 data, 0.266 forward
[INFO] - 02-27 20:43:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:43:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0029)
[INFO] - 02-27 20:43:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5843)
[INFO] - 02-27 20:43:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5449 (-287.5434)
[INFO] - 02-27 20:43:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7863 (31.8103)
[INFO] - 02-27 20:43:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0653 (371.0764)
[INFO] - 02-27 20:43:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:43:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9691)
[INFO] - 02-27 20:43:39 - [main.backward:225]: Epoch 284/500 - Iteration 65/95 - Time 0.265 batch, 0.036 data, 0.239 forward
[INFO] - 02-27 20:43:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:43:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0030)
[INFO] - 02-27 20:43:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5893 (0.5858)
[INFO] - 02-27 20:43:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5438 (-287.5421)
[INFO] - 02-27 20:43:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7163 (31.7981)
[INFO] - 02-27 20:43:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4785 (371.1680)
[INFO] - 02-27 20:43:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:43:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9675)
[INFO] - 02-27 20:43:47 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:43:47 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:43:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:43:47 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:43:47 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:43:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:43:47 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:43:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.224
[INFO] - 02-27 20:43:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.225
[INFO] - 02-27 20:43:49 - [main.summary_metrics:168]: Epoch 284/500 - Test Results:
{'auc': 0.8452456087214298,
 'f1': 0.42359217171717173,
 'loss': 0.43925989823378075,
 'ndcg': 0.721012977417669,
 'precision': 0.565625,
 'recall': 0.3390975140056023}
[INFO] - 02-27 20:43:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[284] Complete. Time taken: 00:00:27.294
[INFO] - 02-27 20:43:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:43:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:43:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:43:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:43:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:43:49 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2194, 2219, 1]
[INFO] - 02-27 20:43:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:43:55 - [main.backward:225]: Epoch 285/500 - Iteration 20/95 - Time 0.292 batch, 0.055 data, 0.265 forward
[INFO] - 02-27 20:43:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:43:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0031)
[INFO] - 02-27 20:43:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5848 (0.5858)
[INFO] - 02-27 20:43:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5437 (-287.5439)
[INFO] - 02-27 20:43:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6744 (31.7897)
[INFO] - 02-27 20:43:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3593 (371.2010)
[INFO] - 02-27 20:43:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:43:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9667)
[INFO] - 02-27 20:44:08 - [main.backward:225]: Epoch 285/500 - Iteration 70/95 - Time 0.272 batch, 0.035 data, 0.246 forward
[INFO] - 02-27 20:44:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0029)
[INFO] - 02-27 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5855)
[INFO] - 02-27 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5446 (-287.5450)
[INFO] - 02-27 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7640 (31.7988)
[INFO] - 02-27 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3497 (371.3480)
[INFO] - 02-27 20:44:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:44:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9697)
[INFO] - 02-27 20:44:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:44:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:44:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:44:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:44:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:44:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:44:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:44:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.196
[INFO] - 02-27 20:44:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.198
[INFO] - 02-27 20:44:17 - [main.summary_metrics:168]: Epoch 285/500 - Test Results:
{'auc': 0.8460155129453744,
 'f1': 0.40680976430976434,
 'loss': 0.4386060269876,
 'ndcg': 0.720152533109919,
 'precision': 0.54375,
 'recall': 0.3254420518207283}
[INFO] - 02-27 20:44:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[285] Complete. Time taken: 00:00:27.852
[INFO] - 02-27 20:44:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:44:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:44:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:44:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:44:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:44:17 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3015, 2202, 2206, 1]
[INFO] - 02-27 20:44:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:44:25 - [main.backward:225]: Epoch 286/500 - Iteration 25/95 - Time 0.308 batch, 0.054 data, 0.280 forward
[INFO] - 02-27 20:44:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:44:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0031)
[INFO] - 02-27 20:44:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5849)
[INFO] - 02-27 20:44:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5518 (-287.5486)
[INFO] - 02-27 20:44:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6947 (31.7958)
[INFO] - 02-27 20:44:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2827 (371.3599)
[INFO] - 02-27 20:44:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:44:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9625)
[INFO] - 02-27 20:44:38 - [main.backward:225]: Epoch 286/500 - Iteration 75/95 - Time 0.273 batch, 0.035 data, 0.247 forward
[INFO] - 02-27 20:44:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:44:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0032)
[INFO] - 02-27 20:44:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5799 (0.5861)
[INFO] - 02-27 20:44:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5477 (-287.5501)
[INFO] - 02-27 20:44:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7355 (31.7941)
[INFO] - 02-27 20:44:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7491 (371.2342)
[INFO] - 02-27 20:44:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:44:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9653)
[INFO] - 02-27 20:44:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:44:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:44:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:44:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:44:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:44:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:44:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:44:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.201
[INFO] - 02-27 20:44:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.202
[INFO] - 02-27 20:44:45 - [main.summary_metrics:168]: Epoch 286/500 - Test Results:
{'auc': 0.8484791131526139,
 'f1': 0.42330281986531987,
 'loss': 0.43720611152724576,
 'ndcg': 0.7170164416769544,
 'precision': 0.565625,
 'recall': 0.338703606442577}
[INFO] - 02-27 20:44:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[286] Complete. Time taken: 00:00:27.773
[INFO] - 02-27 20:44:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:44:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:44:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:44:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:44:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:44:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3067, 2207, 2186, 1]
[INFO] - 02-27 20:44:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:44:53 - [main.backward:225]: Epoch 287/500 - Iteration 30/95 - Time 0.279 batch, 0.050 data, 0.253 forward
[INFO] - 02-27 20:44:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0030)
[INFO] - 02-27 20:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5854)
[INFO] - 02-27 20:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5496 (-287.5487)
[INFO] - 02-27 20:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7509 (31.7954)
[INFO] - 02-27 20:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4921 (371.2002)
[INFO] - 02-27 20:44:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:44:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9678)
[INFO] - 02-27 20:45:06 - [main.backward:225]: Epoch 287/500 - Iteration 80/95 - Time 0.262 batch, 0.034 data, 0.237 forward
[INFO] - 02-27 20:45:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:45:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0032)
[INFO] - 02-27 20:45:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5931 (0.5861)
[INFO] - 02-27 20:45:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5511 (-287.5518)
[INFO] - 02-27 20:45:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7662 (31.7983)
[INFO] - 02-27 20:45:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2785 (371.1812)
[INFO] - 02-27 20:45:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:45:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9678)
[INFO] - 02-27 20:45:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:45:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:45:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:45:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:45:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:45:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:45:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:45:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.206
[INFO] - 02-27 20:45:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.207
[INFO] - 02-27 20:45:12 - [main.summary_metrics:168]: Epoch 287/500 - Test Results:
{'auc': 0.8475769256231904,
 'f1': 0.41635837542087545,
 'loss': 0.4371462256970169,
 'ndcg': 0.7174027638503228,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 20:45:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[287] Complete. Time taken: 00:00:26.918
[INFO] - 02-27 20:45:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:45:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:45:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:45:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:45:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:45:12 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2186, 2204, 1]
[INFO] - 02-27 20:45:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:45:21 - [main.backward:225]: Epoch 288/500 - Iteration 35/95 - Time 0.266 batch, 0.040 data, 0.242 forward
[INFO] - 02-27 20:45:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:45:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0032)
[INFO] - 02-27 20:45:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5893 (0.5850)
[INFO] - 02-27 20:45:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5512 (-287.5514)
[INFO] - 02-27 20:45:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9158 (31.8089)
[INFO] - 02-27 20:45:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6819 (371.1785)
[INFO] - 02-27 20:45:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:45:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9656)
[INFO] - 02-27 20:45:34 - [main.backward:225]: Epoch 288/500 - Iteration 85/95 - Time 0.259 batch, 0.031 data, 0.234 forward
[INFO] - 02-27 20:45:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:45:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0032)
[INFO] - 02-27 20:45:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5814 (0.5867)
[INFO] - 02-27 20:45:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5502)
[INFO] - 02-27 20:45:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8644 (31.7936)
[INFO] - 02-27 20:45:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2790 (371.2846)
[INFO] - 02-27 20:45:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:45:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9628)
[INFO] - 02-27 20:45:36 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:45:36 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:45:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:45:36 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:45:36 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:45:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:45:36 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:45:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.208
[INFO] - 02-27 20:45:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.208
[INFO] - 02-27 20:45:39 - [main.summary_metrics:168]: Epoch 288/500 - Test Results:
{'auc': 0.8476973701245204,
 'f1': 0.4212773569023569,
 'loss': 0.4369004702070186,
 'ndcg': 0.7188145419653811,
 'precision': 0.5625,
 'recall': 0.3372592787114846}
[INFO] - 02-27 20:45:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[288] Complete. Time taken: 00:00:26.774
[INFO] - 02-27 20:45:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:45:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:45:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:45:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:45:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:45:39 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3029, 2195, 2228, 1]
[INFO] - 02-27 20:45:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:45:49 - [main.backward:225]: Epoch 289/500 - Iteration 40/95 - Time 0.265 batch, 0.039 data, 0.240 forward
[INFO] - 02-27 20:45:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:45:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 20:45:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5855)
[INFO] - 02-27 20:45:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5473)
[INFO] - 02-27 20:45:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8628 (31.8101)
[INFO] - 02-27 20:45:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.5746 (371.2069)
[INFO] - 02-27 20:45:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:45:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9672)
[INFO] - 02-27 20:46:02 - [main.backward:225]: Epoch 289/500 - Iteration 90/95 - Time 0.256 batch, 0.031 data, 0.232 forward
[INFO] - 02-27 20:46:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:46:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0030)
[INFO] - 02-27 20:46:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5849 (0.5855)
[INFO] - 02-27 20:46:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5458 (-287.5487)
[INFO] - 02-27 20:46:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8796 (31.8004)
[INFO] - 02-27 20:46:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3553 (371.3646)
[INFO] - 02-27 20:46:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:46:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9656)
[INFO] - 02-27 20:46:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:46:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:46:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:46:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:46:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:46:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:46:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:46:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.110
[INFO] - 02-27 20:46:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.110
[INFO] - 02-27 20:46:05 - [main.summary_metrics:168]: Epoch 289/500 - Test Results:
{'auc': 0.8469628023390728,
 'f1': 0.4140435606060606,
 'loss': 0.4374412543499201,
 'ndcg': 0.7190841836922685,
 'precision': 0.5531250000000001,
 'recall': 0.33135066526610646}
[INFO] - 02-27 20:46:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[289] Complete. Time taken: 00:00:26.474
[INFO] - 02-27 20:46:05 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:46:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:46:05 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:46:05 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:46:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:46:05 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2195, 2207, 1]
[INFO] - 02-27 20:46:06 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:46:17 - [main.backward:225]: Epoch 290/500 - Iteration 45/95 - Time 0.266 batch, 0.037 data, 0.241 forward
[INFO] - 02-27 20:46:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0030)
[INFO] - 02-27 20:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5919 (0.5870)
[INFO] - 02-27 20:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5450 (-287.5443)
[INFO] - 02-27 20:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7439 (31.8031)
[INFO] - 02-27 20:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1729 (371.3179)
[INFO] - 02-27 20:46:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:46:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9673)
[INFO] - 02-27 20:46:30 - [main.backward:225]: Epoch 290/500 - Iteration 0/95 - Time 0.261 batch, 0.030 data, 0.236 forward
[INFO] - 02-27 20:46:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0032)
[INFO] - 02-27 20:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5860 (0.5862)
[INFO] - 02-27 20:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5458 (-287.5455)
[INFO] - 02-27 20:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7465 (31.8185)
[INFO] - 02-27 20:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6908 (371.3864)
[INFO] - 02-27 20:46:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:46:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9620)
[INFO] - 02-27 20:46:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:46:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:46:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:46:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:46:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:46:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:46:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:46:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.658
[INFO] - 02-27 20:46:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.658
[INFO] - 02-27 20:46:33 - [main.summary_metrics:168]: Epoch 290/500 - Test Results:
{'auc': 0.8464094463765899,
 'f1': 0.4282218013468014,
 'loss': 0.438840172921852,
 'ndcg': 0.7248485622104498,
 'precision': 0.571875,
 'recall': 0.34277398459383757}
[INFO] - 02-27 20:46:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[290] Complete. Time taken: 00:00:27.441
[INFO] - 02-27 20:46:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:46:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:46:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:46:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:46:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:46:33 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3056, 2197, 2214, 1]
[INFO] - 02-27 20:46:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:46:47 - [main.backward:225]: Epoch 291/500 - Iteration 50/95 - Time 0.280 batch, 0.039 data, 0.253 forward
[INFO] - 02-27 20:46:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:46:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0031)
[INFO] - 02-27 20:46:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5925 (0.5868)
[INFO] - 02-27 20:46:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5421 (-287.5442)
[INFO] - 02-27 20:46:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7956 (31.7860)
[INFO] - 02-27 20:46:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7177 (371.2437)
[INFO] - 02-27 20:46:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:46:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9648)
[INFO] - 02-27 20:46:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:46:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:46:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:46:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:46:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:46:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:46:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:47:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.303
[INFO] - 02-27 20:47:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.304
[INFO] - 02-27 20:47:00 - [main.summary_metrics:168]: Epoch 291/500 - Test Results:
{'auc': 0.8465681471730849,
 'f1': 0.42259154040404046,
 'loss': 0.4383135717030384,
 'ndcg': 0.7210660090455328,
 'precision': 0.565625,
 'recall': 0.33769257703081235}
[INFO] - 02-27 20:47:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[291] Complete. Time taken: 00:00:27.818
[INFO] - 02-27 20:47:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:47:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:47:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:47:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:47:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:47:00 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3068, 2209, 2228, 1]
[INFO] - 02-27 20:47:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:47:02 - [main.backward:225]: Epoch 292/500 - Iteration 5/95 - Time 0.398 batch, 0.150 data, 0.369 forward
[INFO] - 02-27 20:47:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0029)
[INFO] - 02-27 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5876 (0.5865)
[INFO] - 02-27 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5488 (-287.5441)
[INFO] - 02-27 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7424 (31.7847)
[INFO] - 02-27 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7640 (371.1122)
[INFO] - 02-27 20:47:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:47:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9708)
[INFO] - 02-27 20:47:15 - [main.backward:225]: Epoch 292/500 - Iteration 55/95 - Time 0.261 batch, 0.036 data, 0.236 forward
[INFO] - 02-27 20:47:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:47:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0032)
[INFO] - 02-27 20:47:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5863)
[INFO] - 02-27 20:47:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5501)
[INFO] - 02-27 20:47:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7768 (31.7749)
[INFO] - 02-27 20:47:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1718 (371.3288)
[INFO] - 02-27 20:47:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:47:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9639)
[INFO] - 02-27 20:47:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:47:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:47:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:47:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:47:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.155
[INFO] - 02-27 20:47:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.157
[INFO] - 02-27 20:47:27 - [main.summary_metrics:168]: Epoch 292/500 - Test Results:
{'auc': 0.846062293544869,
 'f1': 0.41396254208754213,
 'loss': 0.43821255757418476,
 'ndcg': 0.7222887187896682,
 'precision': 0.5531250000000001,
 'recall': 0.33125437675070024}
[INFO] - 02-27 20:47:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[292] Complete. Time taken: 00:00:26.698
[INFO] - 02-27 20:47:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:47:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:47:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:47:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:47:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:47:27 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3073, 2188, 2217, 1]
[INFO] - 02-27 20:47:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:47:30 - [main.backward:225]: Epoch 293/500 - Iteration 10/95 - Time 0.322 batch, 0.083 data, 0.295 forward
[INFO] - 02-27 20:47:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0030)
[INFO] - 02-27 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5845)
[INFO] - 02-27 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5483)
[INFO] - 02-27 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7709 (31.7763)
[INFO] - 02-27 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1427 (371.2300)
[INFO] - 02-27 20:47:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9650)
[INFO] - 02-27 20:47:44 - [main.backward:225]: Epoch 293/500 - Iteration 60/95 - Time 0.286 batch, 0.037 data, 0.258 forward
[INFO] - 02-27 20:47:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:47:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0031)
[INFO] - 02-27 20:47:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5857)
[INFO] - 02-27 20:47:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5478 (-287.5474)
[INFO] - 02-27 20:47:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8445 (31.7941)
[INFO] - 02-27 20:47:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3418 (371.1332)
[INFO] - 02-27 20:47:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:47:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9681)
[INFO] - 02-27 20:47:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:47:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:47:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:47:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:47:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.397
[INFO] - 02-27 20:47:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.398
[INFO] - 02-27 20:47:56 - [main.summary_metrics:168]: Epoch 293/500 - Test Results:
{'auc': 0.8462746708977709,
 'f1': 0.40246948653198655,
 'loss': 0.4384294021250549,
 'ndcg': 0.7212748758541035,
 'precision': 0.5375000000000001,
 'recall': 0.3221594887955182}
[INFO] - 02-27 20:47:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[293] Complete. Time taken: 00:00:29.052
[INFO] - 02-27 20:47:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:47:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:47:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:47:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:47:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:47:56 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3064, 2207, 2207, 1]
[INFO] - 02-27 20:47:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:48:01 - [main.backward:225]: Epoch 294/500 - Iteration 15/95 - Time 0.310 batch, 0.072 data, 0.284 forward
[INFO] - 02-27 20:48:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0030)
[INFO] - 02-27 20:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5896 (0.5861)
[INFO] - 02-27 20:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5450 (-287.5484)
[INFO] - 02-27 20:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8462 (31.7925)
[INFO] - 02-27 20:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4017 (371.2020)
[INFO] - 02-27 20:48:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:48:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9694)
[INFO] - 02-27 20:48:13 - [main.backward:225]: Epoch 294/500 - Iteration 65/95 - Time 0.267 batch, 0.036 data, 0.241 forward
[INFO] - 02-27 20:48:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:48:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0030)
[INFO] - 02-27 20:48:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5886 (0.5857)
[INFO] - 02-27 20:48:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5438 (-287.5455)
[INFO] - 02-27 20:48:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7377 (31.7877)
[INFO] - 02-27 20:48:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2155 (371.2913)
[INFO] - 02-27 20:48:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:48:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9684)
[INFO] - 02-27 20:48:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:48:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:48:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:48:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:48:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:48:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:48:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:48:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.129
[INFO] - 02-27 20:48:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.130
[INFO] - 02-27 20:48:23 - [main.summary_metrics:168]: Epoch 294/500 - Test Results:
{'auc': 0.8466412246271058,
 'f1': 0.3976546717171717,
 'loss': 0.4387896136121827,
 'ndcg': 0.7234760520469425,
 'precision': 0.53125,
 'recall': 0.31823792016806723}
[INFO] - 02-27 20:48:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[294] Complete. Time taken: 00:00:27.077
[INFO] - 02-27 20:48:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:48:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:48:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:48:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:48:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:48:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2201, 2214, 1]
[INFO] - 02-27 20:48:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:48:29 - [main.backward:225]: Epoch 295/500 - Iteration 20/95 - Time 0.297 batch, 0.063 data, 0.270 forward
[INFO] - 02-27 20:48:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:48:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0030)
[INFO] - 02-27 20:48:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5866)
[INFO] - 02-27 20:48:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5414 (-287.5425)
[INFO] - 02-27 20:48:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8198 (31.7999)
[INFO] - 02-27 20:48:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3190 (371.2960)
[INFO] - 02-27 20:48:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:48:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9659)
[INFO] - 02-27 20:48:42 - [main.backward:225]: Epoch 295/500 - Iteration 70/95 - Time 0.270 batch, 0.036 data, 0.244 forward
[INFO] - 02-27 20:48:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:48:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0029)
[INFO] - 02-27 20:48:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5836 (0.5870)
[INFO] - 02-27 20:48:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5400 (-287.5383)
[INFO] - 02-27 20:48:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7768 (31.7972)
[INFO] - 02-27 20:48:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9725 (371.2496)
[INFO] - 02-27 20:48:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:48:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9716)
[INFO] - 02-27 20:48:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:48:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:48:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:48:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:48:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.063
[INFO] - 02-27 20:48:50 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.063
[INFO] - 02-27 20:48:50 - [main.summary_metrics:168]: Epoch 295/500 - Test Results:
{'auc': 0.8471765630884707,
 'f1': 0.41351746632996633,
 'loss': 0.43793494709139164,
 'ndcg': 0.7266471166240196,
 'precision': 0.5531250000000001,
 'recall': 0.3305847338935574}
[INFO] - 02-27 20:48:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[295] Complete. Time taken: 00:00:27.208
[INFO] - 02-27 20:48:50 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:48:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:48:50 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:48:50 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:48:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:48:50 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3078, 2196, 2211, 1]
[INFO] - 02-27 20:48:51 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:48:57 - [main.backward:225]: Epoch 296/500 - Iteration 25/95 - Time 0.278 batch, 0.049 data, 0.252 forward
[INFO] - 02-27 20:48:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:48:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0032)
[INFO] - 02-27 20:48:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5870 (0.5864)
[INFO] - 02-27 20:48:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5446 (-287.5406)
[INFO] - 02-27 20:48:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7173 (31.7967)
[INFO] - 02-27 20:48:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3021 (371.2814)
[INFO] - 02-27 20:48:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:48:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9666)
[INFO] - 02-27 20:49:10 - [main.backward:225]: Epoch 296/500 - Iteration 75/95 - Time 0.265 batch, 0.034 data, 0.239 forward
[INFO] - 02-27 20:49:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0030)
[INFO] - 02-27 20:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5863)
[INFO] - 02-27 20:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5487 (-287.5458)
[INFO] - 02-27 20:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7277 (31.7909)
[INFO] - 02-27 20:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.6056 (371.2243)
[INFO] - 02-27 20:49:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:49:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9670)
[INFO] - 02-27 20:49:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:49:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:49:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:49:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:49:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:49:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:49:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:49:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.031
[INFO] - 02-27 20:49:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.032
[INFO] - 02-27 20:49:17 - [main.summary_metrics:168]: Epoch 296/500 - Test Results:
{'auc': 0.8459709780971212,
 'f1': 0.4022843013468013,
 'loss': 0.4388263926252788,
 'ndcg': 0.7199469546327308,
 'precision': 0.5375,
 'recall': 0.3219143907563025}
[INFO] - 02-27 20:49:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[296] Complete. Time taken: 00:00:26.872
[INFO] - 02-27 20:49:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:49:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:49:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:49:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:49:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:49:17 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2208, 2213, 1]
[INFO] - 02-27 20:49:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:49:25 - [main.backward:225]: Epoch 297/500 - Iteration 30/95 - Time 0.266 batch, 0.045 data, 0.242 forward
[INFO] - 02-27 20:49:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0030)
[INFO] - 02-27 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5817 (0.5857)
[INFO] - 02-27 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5466 (-287.5497)
[INFO] - 02-27 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8185 (31.8077)
[INFO] - 02-27 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7448 (371.3833)
[INFO] - 02-27 20:49:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:49:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9652)
[INFO] - 02-27 20:49:37 - [main.backward:225]: Epoch 297/500 - Iteration 80/95 - Time 0.251 batch, 0.032 data, 0.226 forward
[INFO] - 02-27 20:49:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:49:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 20:49:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5806 (0.5858)
[INFO] - 02-27 20:49:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5502 (-287.5476)
[INFO] - 02-27 20:49:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8473 (31.7934)
[INFO] - 02-27 20:49:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1545 (371.2263)
[INFO] - 02-27 20:49:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:49:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9655)
[INFO] - 02-27 20:49:41 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:49:41 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:49:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:49:41 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:49:41 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:49:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:49:41 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:49:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.134
[INFO] - 02-27 20:49:43 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.134
[INFO] - 02-27 20:49:43 - [main.summary_metrics:168]: Epoch 297/500 - Test Results:
{'auc': 0.8464769598403087,
 'f1': 0.41154356060606057,
 'loss': 0.4380168917524494,
 'ndcg': 0.7205495839686649,
 'precision': 0.55,
 'recall': 0.32926733193277313}
[INFO] - 02-27 20:49:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[297] Complete. Time taken: 00:00:26.065
[INFO] - 02-27 20:49:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:49:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:49:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:49:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:49:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:49:43 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3071, 2194, 2205, 1]
[INFO] - 02-27 20:49:44 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:49:52 - [main.backward:225]: Epoch 298/500 - Iteration 35/95 - Time 0.257 batch, 0.041 data, 0.232 forward
[INFO] - 02-27 20:49:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 20:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5816 (0.5855)
[INFO] - 02-27 20:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5466 (-287.5473)
[INFO] - 02-27 20:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8231 (31.7853)
[INFO] - 02-27 20:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6345 (371.1284)
[INFO] - 02-27 20:49:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:49:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9673)
[INFO] - 02-27 20:50:04 - [main.backward:225]: Epoch 298/500 - Iteration 85/95 - Time 0.245 batch, 0.031 data, 0.221 forward
[INFO] - 02-27 20:50:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:50:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0030)
[INFO] - 02-27 20:50:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5850)
[INFO] - 02-27 20:50:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5438 (-287.5451)
[INFO] - 02-27 20:50:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8089 (31.7932)
[INFO] - 02-27 20:50:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9979 (371.1626)
[INFO] - 02-27 20:50:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:50:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9672)
[INFO] - 02-27 20:50:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:50:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:50:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:50:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:50:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:50:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:50:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:50:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.000
[INFO] - 02-27 20:50:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.001
[INFO] - 02-27 20:50:08 - [main.summary_metrics:168]: Epoch 298/500 - Test Results:
{'auc': 0.8473746755442373,
 'f1': 0.41385837542087545,
 'loss': 0.4367874038871409,
 'ndcg': 0.7245378512326123,
 'precision': 0.553125,
 'recall': 0.3311055672268908}
[INFO] - 02-27 20:50:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[298] Complete. Time taken: 00:00:25.150
[INFO] - 02-27 20:50:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:50:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:50:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:50:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:50:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:50:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3065, 2202, 2213, 1]
[INFO] - 02-27 20:50:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:50:18 - [main.backward:225]: Epoch 299/500 - Iteration 40/95 - Time 0.248 batch, 0.037 data, 0.224 forward
[INFO] - 02-27 20:50:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:50:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0033)
[INFO] - 02-27 20:50:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5795 (0.5852)
[INFO] - 02-27 20:50:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5505 (-287.5461)
[INFO] - 02-27 20:50:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7887 (31.7761)
[INFO] - 02-27 20:50:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0179 (371.0175)
[INFO] - 02-27 20:50:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:50:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9634)
[INFO] - 02-27 20:50:30 - [main.backward:225]: Epoch 299/500 - Iteration 90/95 - Time 0.243 batch, 0.030 data, 0.219 forward
[INFO] - 02-27 20:50:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0030)
[INFO] - 02-27 20:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5840 (0.5854)
[INFO] - 02-27 20:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5451 (-287.5493)
[INFO] - 02-27 20:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7933 (31.7782)
[INFO] - 02-27 20:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0301 (371.3186)
[INFO] - 02-27 20:50:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:50:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9664)
[INFO] - 02-27 20:50:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:50:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:50:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:50:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:50:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:50:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:50:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:50:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.954
[INFO] - 02-27 20:50:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.514
[INFO] - 02-27 20:50:34 - [main.summary_metrics:168]: Epoch 299/500 - Test Results:
{'auc': 0.8457201270826957,
 'f1': 0.40951809764309766,
 'loss': 0.4383060693706798,
 'ndcg': 0.7217446773612619,
 'precision': 0.546875,
 'recall': 0.32782300420168065}
[INFO] - 02-27 20:50:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[299] Complete. Time taken: 00:00:25.609
[INFO] - 02-27 20:50:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:50:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:50:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:50:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:50:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:50:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2187, 2224, 1]
[INFO] - 02-27 20:50:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:50:45 - [main.backward:225]: Epoch 300/500 - Iteration 45/95 - Time 0.247 batch, 0.035 data, 0.224 forward
[INFO] - 02-27 20:50:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:50:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0029)
[INFO] - 02-27 20:50:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5839 (0.5857)
[INFO] - 02-27 20:50:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5457 (-287.5483)
[INFO] - 02-27 20:50:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7812 (31.7922)
[INFO] - 02-27 20:50:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9824 (371.1117)
[INFO] - 02-27 20:50:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:50:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9684)
[INFO] - 02-27 20:50:57 - [main.backward:225]: Epoch 300/500 - Iteration 0/95 - Time 0.246 batch, 0.030 data, 0.222 forward
[INFO] - 02-27 20:50:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0033)
[INFO] - 02-27 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5856)
[INFO] - 02-27 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5520 (-287.5499)
[INFO] - 02-27 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7938 (31.7938)
[INFO] - 02-27 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4458 (370.9854)
[INFO] - 02-27 20:50:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:50:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9639)
[INFO] - 02-27 20:50:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:50:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:50:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:50:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:50:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:50:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:50:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:50:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.919
[INFO] - 02-27 20:50:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.919
[INFO] - 02-27 20:50:59 - [main.summary_metrics:168]: Epoch 300/500 - Test Results:
{'auc': 0.8455893781532221,
 'f1': 0.4118329124579125,
 'loss': 0.4387733527436459,
 'ndcg': 0.7200073402936228,
 'precision': 0.55,
 'recall': 0.3296612394957983}
[INFO] - 02-27 20:50:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[300] Complete. Time taken: 00:00:25.292
[INFO] - 02-27 20:50:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:50:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:50:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:50:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:50:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:50:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3081, 2209, 2199, 1]
[INFO] - 02-27 20:51:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:51:12 - [main.backward:225]: Epoch 301/500 - Iteration 50/95 - Time 0.255 batch, 0.035 data, 0.231 forward
[INFO] - 02-27 20:51:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0032)
[INFO] - 02-27 20:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5866 (0.5857)
[INFO] - 02-27 20:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5512 (-287.5509)
[INFO] - 02-27 20:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7889 (31.7984)
[INFO] - 02-27 20:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6436 (371.1643)
[INFO] - 02-27 20:51:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:51:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9620)
[INFO] - 02-27 20:51:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:51:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:51:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:51:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:51:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:51:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:51:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:51:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.295
[INFO] - 02-27 20:51:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.296
[INFO] - 02-27 20:51:26 - [main.summary_metrics:168]: Epoch 301/500 - Test Results:
{'auc': 0.847503382173948,
 'f1': 0.42080281986531987,
 'loss': 0.4366107990826865,
 'ndcg': 0.7230097912009323,
 'precision': 0.5625,
 'recall': 0.3366202731092437}
[INFO] - 02-27 20:51:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[301] Complete. Time taken: 00:00:26.791
[INFO] - 02-27 20:51:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:51:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:51:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:51:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:51:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:51:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3025, 2193, 2194, 1]
[INFO] - 02-27 20:51:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:51:28 - [main.backward:225]: Epoch 302/500 - Iteration 5/95 - Time 0.399 batch, 0.173 data, 0.371 forward
[INFO] - 02-27 20:51:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:51:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0033)
[INFO] - 02-27 20:51:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5867)
[INFO] - 02-27 20:51:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5450 (-287.5489)
[INFO] - 02-27 20:51:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8304 (31.7833)
[INFO] - 02-27 20:51:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0408 (371.0834)
[INFO] - 02-27 20:51:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:51:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9611)
[INFO] - 02-27 20:51:41 - [main.backward:225]: Epoch 302/500 - Iteration 55/95 - Time 0.271 batch, 0.039 data, 0.244 forward
[INFO] - 02-27 20:51:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:51:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0032)
[INFO] - 02-27 20:51:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5854)
[INFO] - 02-27 20:51:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5405 (-287.5435)
[INFO] - 02-27 20:51:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8030 (31.7889)
[INFO] - 02-27 20:51:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9896 (370.8299)
[INFO] - 02-27 20:51:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:51:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9652)
[INFO] - 02-27 20:51:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:51:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:51:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:51:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:51:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:51:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:51:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:51:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.020
[INFO] - 02-27 20:51:54 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.020
[INFO] - 02-27 20:51:54 - [main.summary_metrics:168]: Epoch 302/500 - Test Results:
{'auc': 0.8472084586285493,
 'f1': 0.4143329124579125,
 'loss': 0.43764065729969104,
 'ndcg': 0.7204274562383489,
 'precision': 0.553125,
 'recall': 0.33174457282913167}
[INFO] - 02-27 20:51:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[302] Complete. Time taken: 00:00:27.603
[INFO] - 02-27 20:51:54 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:51:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:51:54 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:51:54 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:51:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:51:54 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3043, 2207, 2201, 1]
[INFO] - 02-27 20:51:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:51:57 - [main.backward:225]: Epoch 303/500 - Iteration 10/95 - Time 0.300 batch, 0.076 data, 0.276 forward
[INFO] - 02-27 20:51:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0033)
[INFO] - 02-27 20:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5855)
[INFO] - 02-27 20:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5398 (-287.5339)
[INFO] - 02-27 20:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7315 (31.7837)
[INFO] - 02-27 20:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9758 (371.0770)
[INFO] - 02-27 20:51:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:51:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9620)
[INFO] - 02-27 20:52:09 - [main.backward:225]: Epoch 303/500 - Iteration 60/95 - Time 0.254 batch, 0.033 data, 0.230 forward
[INFO] - 02-27 20:52:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:52:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0035)
[INFO] - 02-27 20:52:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5860)
[INFO] - 02-27 20:52:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5421 (-287.5414)
[INFO] - 02-27 20:52:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8517 (31.7953)
[INFO] - 02-27 20:52:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0781 (371.2850)
[INFO] - 02-27 20:52:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:52:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9623)
[INFO] - 02-27 20:52:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:52:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:52:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:52:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:52:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:52:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:52:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:52:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.146
[INFO] - 02-27 20:52:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.148
[INFO] - 02-27 20:52:19 - [main.summary_metrics:168]: Epoch 303/500 - Test Results:
{'auc': 0.8459950120979765,
 'f1': 0.4212773569023569,
 'loss': 0.4394451346487006,
 'ndcg': 0.7206645171366935,
 'precision': 0.5625,
 'recall': 0.3372592787114846}
[INFO] - 02-27 20:52:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[303] Complete. Time taken: 00:00:25.700
[INFO] - 02-27 20:52:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:52:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:52:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:52:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:52:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:52:19 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3043, 2205, 2216, 1]
[INFO] - 02-27 20:52:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:52:24 - [main.backward:225]: Epoch 304/500 - Iteration 15/95 - Time 0.277 batch, 0.060 data, 0.252 forward
[INFO] - 02-27 20:52:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:52:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0030)
[INFO] - 02-27 20:52:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5865 (0.5857)
[INFO] - 02-27 20:52:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5378 (-287.5409)
[INFO] - 02-27 20:52:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6652 (31.7856)
[INFO] - 02-27 20:52:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9534 (371.1798)
[INFO] - 02-27 20:52:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:52:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9702)
[INFO] - 02-27 20:52:36 - [main.backward:225]: Epoch 304/500 - Iteration 65/95 - Time 0.255 batch, 0.033 data, 0.230 forward
[INFO] - 02-27 20:52:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:52:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0048 (0.0032)
[INFO] - 02-27 20:52:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5882 (0.5854)
[INFO] - 02-27 20:52:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5430 (-287.5407)
[INFO] - 02-27 20:52:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8049 (31.7910)
[INFO] - 02-27 20:52:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1046 (371.3904)
[INFO] - 02-27 20:52:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:52:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9647)
[INFO] - 02-27 20:52:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:52:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:52:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:52:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:52:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:52:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:52:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:52:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.198
[INFO] - 02-27 20:52:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.199
[INFO] - 02-27 20:52:46 - [main.summary_metrics:168]: Epoch 304/500 - Test Results:
{'auc': 0.8469234684069706,
 'f1': 0.4186731902356903,
 'loss': 0.43860068257196655,
 'ndcg': 0.7187329112808984,
 'precision': 0.559375,
 'recall': 0.33502713585434174}
[INFO] - 02-27 20:52:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[304] Complete. Time taken: 00:00:26.304
[INFO] - 02-27 20:52:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:52:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:52:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:52:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:52:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:52:46 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3039, 2198, 2199, 1]
[INFO] - 02-27 20:52:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:52:52 - [main.backward:225]: Epoch 305/500 - Iteration 20/95 - Time 0.293 batch, 0.062 data, 0.267 forward
[INFO] - 02-27 20:52:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:52:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0030)
[INFO] - 02-27 20:52:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5928 (0.5862)
[INFO] - 02-27 20:52:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5511 (-287.5476)
[INFO] - 02-27 20:52:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7977 (31.7842)
[INFO] - 02-27 20:52:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0516 (371.2738)
[INFO] - 02-27 20:52:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:52:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9689)
[INFO] - 02-27 20:53:04 - [main.backward:225]: Epoch 305/500 - Iteration 70/95 - Time 0.256 batch, 0.035 data, 0.231 forward
[INFO] - 02-27 20:53:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:53:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0030)
[INFO] - 02-27 20:53:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5830 (0.5866)
[INFO] - 02-27 20:53:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5477 (-287.5479)
[INFO] - 02-27 20:53:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8629 (31.7890)
[INFO] - 02-27 20:53:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4060 (371.2231)
[INFO] - 02-27 20:53:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:53:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9658)
[INFO] - 02-27 20:53:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:53:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:53:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:53:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:53:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:53:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:53:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:53:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.899
[INFO] - 02-27 20:53:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.899
[INFO] - 02-27 20:53:12 - [main.summary_metrics:168]: Epoch 305/500 - Test Results:
{'auc': 0.8464170556703074,
 'f1': 0.4235921717171718,
 'loss': 0.4386458284265002,
 'ndcg': 0.7190291188648161,
 'precision': 0.565625,
 'recall': 0.33909751400560223}
[INFO] - 02-27 20:53:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[305] Complete. Time taken: 00:00:25.762
[INFO] - 02-27 20:53:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:53:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:53:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:53:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:53:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:53:12 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3057, 2198, 2201, 1]
[INFO] - 02-27 20:53:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:53:18 - [main.backward:225]: Epoch 306/500 - Iteration 25/95 - Time 0.248 batch, 0.047 data, 0.223 forward
[INFO] - 02-27 20:53:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0030)
[INFO] - 02-27 20:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5863)
[INFO] - 02-27 20:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5457)
[INFO] - 02-27 20:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7697 (31.7947)
[INFO] - 02-27 20:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2129 (371.2896)
[INFO] - 02-27 20:53:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:53:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9666)
[INFO] - 02-27 20:53:30 - [main.backward:225]: Epoch 306/500 - Iteration 75/95 - Time 0.240 batch, 0.032 data, 0.216 forward
[INFO] - 02-27 20:53:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:53:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 20:53:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5789 (0.5870)
[INFO] - 02-27 20:53:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5475 (-287.5464)
[INFO] - 02-27 20:53:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7491 (31.7941)
[INFO] - 02-27 20:53:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1955 (371.1660)
[INFO] - 02-27 20:53:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:53:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9677)
[INFO] - 02-27 20:53:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:53:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:53:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:53:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:53:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:53:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:53:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:53:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.834
[INFO] - 02-27 20:53:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.834
[INFO] - 02-27 20:53:36 - [main.summary_metrics:168]: Epoch 306/500 - Test Results:
{'auc': 0.8465855069969164,
 'f1': 0.41593644781144784,
 'loss': 0.4385328371104521,
 'ndcg': 0.7231802476811209,
 'precision': 0.5562499999999999,
 'recall': 0.3325717787114846}
[INFO] - 02-27 20:53:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[306] Complete. Time taken: 00:00:24.625
[INFO] - 02-27 20:53:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:53:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:53:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:53:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:53:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:53:36 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3043, 2187, 2199, 1]
[INFO] - 02-27 20:53:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:53:44 - [main.backward:225]: Epoch 307/500 - Iteration 30/95 - Time 0.260 batch, 0.045 data, 0.234 forward
[INFO] - 02-27 20:53:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:53:44 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0032)
[INFO] - 02-27 20:53:44 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5888 (0.5867)
[INFO] - 02-27 20:53:44 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5444 (-287.5463)
[INFO] - 02-27 20:53:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7805 (31.8027)
[INFO] - 02-27 20:53:44 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3268 (371.4293)
[INFO] - 02-27 20:53:44 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:53:44 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9647)
[INFO] - 02-27 20:53:56 - [main.backward:225]: Epoch 307/500 - Iteration 80/95 - Time 0.248 batch, 0.033 data, 0.222 forward
[INFO] - 02-27 20:53:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0032)
[INFO] - 02-27 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5836 (0.5854)
[INFO] - 02-27 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5431 (-287.5465)
[INFO] - 02-27 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9155 (31.8061)
[INFO] - 02-27 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3135 (371.2917)
[INFO] - 02-27 20:53:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:53:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9650)
[INFO] - 02-27 20:53:59 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:53:59 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:53:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:53:59 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:53:59 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:53:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:53:59 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:54:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.969
[INFO] - 02-27 20:54:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.971
[INFO] - 02-27 20:54:01 - [main.summary_metrics:168]: Epoch 307/500 - Test Results:
{'auc': 0.8463678286265486,
 'f1': 0.4249063552188552,
 'loss': 0.439523486378235,
 'ndcg': 0.7186608184874294,
 'precision': 0.5687500000000001,
 'recall': 0.33953081232493}
[INFO] - 02-27 20:54:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[307] Complete. Time taken: 00:00:25.302
[INFO] - 02-27 20:54:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:54:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:54:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:54:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:54:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:54:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3033, 2178, 2200, 1]
[INFO] - 02-27 20:54:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:54:10 - [main.backward:225]: Epoch 308/500 - Iteration 35/95 - Time 0.253 batch, 0.041 data, 0.228 forward
[INFO] - 02-27 20:54:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0029)
[INFO] - 02-27 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5875)
[INFO] - 02-27 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5437 (-287.5439)
[INFO] - 02-27 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7660 (31.7946)
[INFO] - 02-27 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0963 (371.1581)
[INFO] - 02-27 20:54:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:54:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9692)
[INFO] - 02-27 20:54:22 - [main.backward:225]: Epoch 308/500 - Iteration 85/95 - Time 0.241 batch, 0.031 data, 0.217 forward
[INFO] - 02-27 20:54:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:54:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0031)
[INFO] - 02-27 20:54:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5808 (0.5859)
[INFO] - 02-27 20:54:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5474 (-287.5456)
[INFO] - 02-27 20:54:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8177 (31.7960)
[INFO] - 02-27 20:54:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1073 (371.1297)
[INFO] - 02-27 20:54:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:54:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9677)
[INFO] - 02-27 20:54:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:54:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:54:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:54:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:54:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:54:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:54:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:54:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.852
[INFO] - 02-27 20:54:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.853
[INFO] - 02-27 20:54:26 - [main.summary_metrics:168]: Epoch 308/500 - Test Results:
{'auc': 0.8454703068727492,
 'f1': 0.41351746632996633,
 'loss': 0.4389592918354908,
 'ndcg': 0.7160102654602174,
 'precision': 0.5531250000000001,
 'recall': 0.3305847338935574}
[INFO] - 02-27 20:54:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[308] Complete. Time taken: 00:00:24.935
[INFO] - 02-27 20:54:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:54:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:54:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:54:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:54:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:54:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3087, 2206, 2204, 1]
[INFO] - 02-27 20:54:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:54:37 - [main.backward:225]: Epoch 309/500 - Iteration 40/95 - Time 0.267 batch, 0.044 data, 0.241 forward
[INFO] - 02-27 20:54:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 20:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5855)
[INFO] - 02-27 20:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5505 (-287.5502)
[INFO] - 02-27 20:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7678 (31.7923)
[INFO] - 02-27 20:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9508 (370.9314)
[INFO] - 02-27 20:54:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:54:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9661)
[INFO] - 02-27 20:54:49 - [main.backward:225]: Epoch 309/500 - Iteration 90/95 - Time 0.249 batch, 0.033 data, 0.224 forward
[INFO] - 02-27 20:54:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0032)
[INFO] - 02-27 20:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5818 (0.5851)
[INFO] - 02-27 20:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5510)
[INFO] - 02-27 20:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7849 (31.7870)
[INFO] - 02-27 20:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7474 (370.8957)
[INFO] - 02-27 20:54:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:54:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9655)
[INFO] - 02-27 20:54:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:54:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:54:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:54:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:54:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:54:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:54:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:54:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.886
[INFO] - 02-27 20:54:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.982
[INFO] - 02-27 20:54:53 - [main.summary_metrics:168]: Epoch 309/500 - Test Results:
{'auc': 0.8450136340075245,
 'f1': 0.40638783670033674,
 'loss': 0.43909182643656175,
 'ndcg': 0.7166748467781643,
 'precision': 0.54375,
 'recall': 0.32482492997198875}
[INFO] - 02-27 20:54:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[309] Complete. Time taken: 00:00:26.573
[INFO] - 02-27 20:54:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:54:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:54:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:54:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:54:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:54:53 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3061, 2178, 2211, 1]
[INFO] - 02-27 20:54:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:55:04 - [main.backward:225]: Epoch 310/500 - Iteration 45/95 - Time 0.248 batch, 0.037 data, 0.223 forward
[INFO] - 02-27 20:55:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0030)
[INFO] - 02-27 20:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5816 (0.5873)
[INFO] - 02-27 20:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5463 (-287.5477)
[INFO] - 02-27 20:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6178 (31.7714)
[INFO] - 02-27 20:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7209 (370.9414)
[INFO] - 02-27 20:55:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:55:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9691)
[INFO] - 02-27 20:55:16 - [main.backward:225]: Epoch 310/500 - Iteration 0/95 - Time 0.240 batch, 0.030 data, 0.215 forward
[INFO] - 02-27 20:55:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0033)
[INFO] - 02-27 20:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5737 (0.5851)
[INFO] - 02-27 20:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5509 (-287.5466)
[INFO] - 02-27 20:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7095 (31.7979)
[INFO] - 02-27 20:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9453 (371.1825)
[INFO] - 02-27 20:55:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:55:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9652)
[INFO] - 02-27 20:55:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:55:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:55:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:55:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:55:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:55:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:55:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:55:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.852
[INFO] - 02-27 20:55:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.854
[INFO] - 02-27 20:55:18 - [main.summary_metrics:168]: Epoch 310/500 - Test Results:
{'auc': 0.8466288061180354,
 'f1': 0.40922874579124585,
 'loss': 0.4375680764874059,
 'ndcg': 0.7208647357242701,
 'precision': 0.546875,
 'recall': 0.3274290966386555}
[INFO] - 02-27 20:55:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[310] Complete. Time taken: 00:00:24.623
[INFO] - 02-27 20:55:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:55:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:55:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:55:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:55:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:55:18 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3034, 2201, 2211, 1]
[INFO] - 02-27 20:55:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:55:30 - [main.backward:225]: Epoch 311/500 - Iteration 50/95 - Time 0.253 batch, 0.036 data, 0.229 forward
[INFO] - 02-27 20:55:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0031)
[INFO] - 02-27 20:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5844 (0.5874)
[INFO] - 02-27 20:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5532 (-287.5490)
[INFO] - 02-27 20:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7338 (31.7809)
[INFO] - 02-27 20:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2103 (371.0161)
[INFO] - 02-27 20:55:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:55:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9673)
[INFO] - 02-27 20:55:41 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:55:41 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:55:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:55:41 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:55:41 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:55:41 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:55:41 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:55:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.877
[INFO] - 02-27 20:55:43 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.878
[INFO] - 02-27 20:55:43 - [main.summary_metrics:168]: Epoch 311/500 - Test Results:
{'auc': 0.8461906397975856,
 'f1': 0.4162773569023569,
 'loss': 0.43834903169354544,
 'ndcg': 0.720106236982082,
 'precision': 0.55625,
 'recall': 0.33309261204481794}
[INFO] - 02-27 20:55:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[311] Complete. Time taken: 00:00:25.187
[INFO] - 02-27 20:55:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:55:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:55:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:55:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:55:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:55:43 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3059, 2225, 2212, 1]
[INFO] - 02-27 20:55:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:55:45 - [main.backward:225]: Epoch 312/500 - Iteration 5/95 - Time 0.346 batch, 0.138 data, 0.322 forward
[INFO] - 02-27 20:55:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0032)
[INFO] - 02-27 20:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5860)
[INFO] - 02-27 20:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5521 (-287.5496)
[INFO] - 02-27 20:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8410 (31.7801)
[INFO] - 02-27 20:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.8139 (371.2311)
[INFO] - 02-27 20:55:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:55:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9678)
[INFO] - 02-27 20:55:57 - [main.backward:225]: Epoch 312/500 - Iteration 55/95 - Time 0.254 batch, 0.035 data, 0.228 forward
[INFO] - 02-27 20:55:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0030)
[INFO] - 02-27 20:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5836 (0.5878)
[INFO] - 02-27 20:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5503 (-287.5512)
[INFO] - 02-27 20:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7610 (31.7911)
[INFO] - 02-27 20:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3524 (371.1711)
[INFO] - 02-27 20:55:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:55:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9663)
[INFO] - 02-27 20:56:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:56:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:56:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:56:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:56:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:56:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:56:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:56:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.923
[INFO] - 02-27 20:56:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.924
[INFO] - 02-27 20:56:08 - [main.summary_metrics:168]: Epoch 312/500 - Test Results:
{'auc': 0.8470340547983899,
 'f1': 0.41367319023569027,
 'loss': 0.43759004439464605,
 'ndcg': 0.7236858646563078,
 'precision': 0.5531250000000001,
 'recall': 0.3308604691876751}
[INFO] - 02-27 20:56:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[312] Complete. Time taken: 00:00:25.303
[INFO] - 02-27 20:56:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:56:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:56:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:56:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:56:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:56:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3027, 2179, 2227, 1]
[INFO] - 02-27 20:56:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:56:11 - [main.backward:225]: Epoch 313/500 - Iteration 10/95 - Time 0.295 batch, 0.092 data, 0.272 forward
[INFO] - 02-27 20:56:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0029)
[INFO] - 02-27 20:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5816 (0.5869)
[INFO] - 02-27 20:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5521 (-287.5510)
[INFO] - 02-27 20:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7771 (31.7929)
[INFO] - 02-27 20:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4717 (371.1662)
[INFO] - 02-27 20:56:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:56:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9700)
[INFO] - 02-27 20:56:23 - [main.backward:225]: Epoch 313/500 - Iteration 60/95 - Time 0.248 batch, 0.035 data, 0.224 forward
[INFO] - 02-27 20:56:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:56:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 20:56:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5864)
[INFO] - 02-27 20:56:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5503 (-287.5533)
[INFO] - 02-27 20:56:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7702 (31.7888)
[INFO] - 02-27 20:56:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9315 (370.9469)
[INFO] - 02-27 20:56:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:56:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9642)
[INFO] - 02-27 20:56:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:56:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:56:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:56:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:56:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:56:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:56:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:56:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.962
[INFO] - 02-27 20:56:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.964
[INFO] - 02-27 20:56:33 - [main.summary_metrics:168]: Epoch 313/500 - Test Results:
{'auc': 0.847703852374283,
 'f1': 0.42359217171717173,
 'loss': 0.4364884419427493,
 'ndcg': 0.7255247251551868,
 'precision': 0.565625,
 'recall': 0.33909751400560223}
[INFO] - 02-27 20:56:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[313] Complete. Time taken: 00:00:24.901
[INFO] - 02-27 20:56:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:56:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:56:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:56:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:56:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:56:33 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2181, 2203, 1]
[INFO] - 02-27 20:56:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:56:37 - [main.backward:225]: Epoch 314/500 - Iteration 15/95 - Time 0.286 batch, 0.067 data, 0.260 forward
[INFO] - 02-27 20:56:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:56:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0031)
[INFO] - 02-27 20:56:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5813 (0.5862)
[INFO] - 02-27 20:56:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5500 (-287.5507)
[INFO] - 02-27 20:56:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7311 (31.7841)
[INFO] - 02-27 20:56:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5883 (371.0092)
[INFO] - 02-27 20:56:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:56:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9663)
[INFO] - 02-27 20:56:49 - [main.backward:225]: Epoch 314/500 - Iteration 65/95 - Time 0.247 batch, 0.034 data, 0.222 forward
[INFO] - 02-27 20:56:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:56:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0031)
[INFO] - 02-27 20:56:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5824 (0.5867)
[INFO] - 02-27 20:56:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5538 (-287.5524)
[INFO] - 02-27 20:56:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8263 (31.7850)
[INFO] - 02-27 20:56:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8309 (371.0020)
[INFO] - 02-27 20:56:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:56:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9683)
[INFO] - 02-27 20:56:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:56:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:56:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:56:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:56:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:56:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:56:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:56:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.836
[INFO] - 02-27 20:56:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.836
[INFO] - 02-27 20:56:58 - [main.summary_metrics:168]: Epoch 314/500 - Test Results:
{'auc': 0.848035107180127,
 'f1': 0.4210921717171717,
 'loss': 0.43708302340728133,
 'ndcg': 0.714838717941333,
 'precision': 0.5625,
 'recall': 0.33701418067226896}
[INFO] - 02-27 20:56:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[314] Complete. Time taken: 00:00:25.078
[INFO] - 02-27 20:56:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:56:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:56:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:56:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:56:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:56:58 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2215, 2209, 1]
[INFO] - 02-27 20:56:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:57:03 - [main.backward:225]: Epoch 315/500 - Iteration 20/95 - Time 0.256 batch, 0.052 data, 0.231 forward
[INFO] - 02-27 20:57:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:57:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0017 (0.0029)
[INFO] - 02-27 20:57:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5868)
[INFO] - 02-27 20:57:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5540 (-287.5536)
[INFO] - 02-27 20:57:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8915 (31.7962)
[INFO] - 02-27 20:57:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3862 (371.2560)
[INFO] - 02-27 20:57:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:57:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9678)
[INFO] - 02-27 20:57:15 - [main.backward:225]: Epoch 315/500 - Iteration 70/95 - Time 0.246 batch, 0.032 data, 0.222 forward
[INFO] - 02-27 20:57:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0031)
[INFO] - 02-27 20:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5866 (0.5861)
[INFO] - 02-27 20:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5526 (-287.5520)
[INFO] - 02-27 20:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8109 (31.7905)
[INFO] - 02-27 20:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7627 (371.1549)
[INFO] - 02-27 20:57:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9656)
[INFO] - 02-27 20:57:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:57:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:57:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:57:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:57:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:57:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:57:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:57:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.861
[INFO] - 02-27 20:57:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.862
[INFO] - 02-27 20:57:23 - [main.summary_metrics:168]: Epoch 315/500 - Test Results:
{'auc': 0.8482320162133481,
 'f1': 0.4092287457912458,
 'loss': 0.4356079671908888,
 'ndcg': 0.7223091518920458,
 'precision': 0.546875,
 'recall': 0.3274290966386555}
[INFO] - 02-27 20:57:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[315] Complete. Time taken: 00:00:25.275
[INFO] - 02-27 20:57:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:57:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:57:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:57:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:57:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:57:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3080, 2199, 2221, 1]
[INFO] - 02-27 20:57:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:57:30 - [main.backward:225]: Epoch 316/500 - Iteration 25/95 - Time 0.259 batch, 0.051 data, 0.233 forward
[INFO] - 02-27 20:57:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0029)
[INFO] - 02-27 20:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5854)
[INFO] - 02-27 20:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5509 (-287.5526)
[INFO] - 02-27 20:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8133 (31.7847)
[INFO] - 02-27 20:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5176 (371.2235)
[INFO] - 02-27 20:57:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:57:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9680)
[INFO] - 02-27 20:57:42 - [main.backward:225]: Epoch 316/500 - Iteration 75/95 - Time 0.248 batch, 0.034 data, 0.223 forward
[INFO] - 02-27 20:57:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0031)
[INFO] - 02-27 20:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5893 (0.5850)
[INFO] - 02-27 20:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5457 (-287.5484)
[INFO] - 02-27 20:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6527 (31.7846)
[INFO] - 02-27 20:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9877 (371.2155)
[INFO] - 02-27 20:57:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:57:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9664)
[INFO] - 02-27 20:57:47 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:57:47 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:57:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:57:47 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:57:47 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:57:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:57:47 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:57:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.827
[INFO] - 02-27 20:57:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.827
[INFO] - 02-27 20:57:48 - [main.summary_metrics:168]: Epoch 316/500 - Test Results:
{'auc': 0.8469668205517501,
 'f1': 0.4186731902356903,
 'loss': 0.43695622736497275,
 'ndcg': 0.7222311349347073,
 'precision': 0.559375,
 'recall': 0.33502713585434174}
[INFO] - 02-27 20:57:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[316] Complete. Time taken: 00:00:25.152
[INFO] - 02-27 20:57:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:57:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:57:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:57:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:57:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:57:49 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2193, 2199, 1]
[INFO] - 02-27 20:57:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:57:56 - [main.backward:225]: Epoch 317/500 - Iteration 30/95 - Time 0.257 batch, 0.050 data, 0.232 forward
[INFO] - 02-27 20:57:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:57:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 20:57:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5893 (0.5857)
[INFO] - 02-27 20:57:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5459 (-287.5445)
[INFO] - 02-27 20:57:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8455 (31.8166)
[INFO] - 02-27 20:57:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7384 (371.3757)
[INFO] - 02-27 20:57:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:57:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9645)
[INFO] - 02-27 20:58:09 - [main.backward:225]: Epoch 317/500 - Iteration 80/95 - Time 0.251 batch, 0.034 data, 0.226 forward
[INFO] - 02-27 20:58:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:58:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0029)
[INFO] - 02-27 20:58:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5826 (0.5845)
[INFO] - 02-27 20:58:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5488 (-287.5497)
[INFO] - 02-27 20:58:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7777 (31.7955)
[INFO] - 02-27 20:58:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4467 (371.1098)
[INFO] - 02-27 20:58:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:58:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9714)
[INFO] - 02-27 20:58:12 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:58:12 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:58:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:58:12 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:58:12 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:58:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:58:12 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:58:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.943
[INFO] - 02-27 20:58:14 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.944
[INFO] - 02-27 20:58:14 - [main.summary_metrics:168]: Epoch 317/500 - Test Results:
{'auc': 0.846932815282976,
 'f1': 0.4140435606060606,
 'loss': 0.43695968833834414,
 'ndcg': 0.7161598400092641,
 'precision': 0.553125,
 'recall': 0.33135066526610646}
[INFO] - 02-27 20:58:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[317] Complete. Time taken: 00:00:25.774
[INFO] - 02-27 20:58:14 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:58:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:58:14 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:58:14 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:58:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:58:14 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3071, 2203, 2210, 1]
[INFO] - 02-27 20:58:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:58:24 - [main.backward:225]: Epoch 318/500 - Iteration 35/95 - Time 0.267 batch, 0.041 data, 0.243 forward
[INFO] - 02-27 20:58:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:58:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0034)
[INFO] - 02-27 20:58:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5881 (0.5863)
[INFO] - 02-27 20:58:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5501 (-287.5501)
[INFO] - 02-27 20:58:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6906 (31.7837)
[INFO] - 02-27 20:58:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1591 (371.2328)
[INFO] - 02-27 20:58:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:58:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9625)
[INFO] - 02-27 20:58:35 - [main.backward:225]: Epoch 318/500 - Iteration 85/95 - Time 0.245 batch, 0.031 data, 0.221 forward
[INFO] - 02-27 20:58:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0029)
[INFO] - 02-27 20:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5859)
[INFO] - 02-27 20:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5507 (-287.5491)
[INFO] - 02-27 20:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7402 (31.7755)
[INFO] - 02-27 20:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4749 (370.9480)
[INFO] - 02-27 20:58:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9691)
[INFO] - 02-27 20:58:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:58:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:58:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:58:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:58:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:58:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:58:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:58:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.963
[INFO] - 02-27 20:58:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.963
[INFO] - 02-27 20:58:40 - [main.summary_metrics:168]: Epoch 318/500 - Test Results:
{'auc': 0.8462988404307801,
 'f1': 0.4066771885521886,
 'loss': 0.4384206791272995,
 'ndcg': 0.7158816725682482,
 'precision': 0.54375,
 'recall': 0.325218837535014}
[INFO] - 02-27 20:58:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[318] Complete. Time taken: 00:00:25.353
[INFO] - 02-27 20:58:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:58:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:58:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:58:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:58:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:58:40 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3092, 2190, 2220, 1]
[INFO] - 02-27 20:58:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:58:50 - [main.backward:225]: Epoch 319/500 - Iteration 40/95 - Time 0.257 batch, 0.037 data, 0.234 forward
[INFO] - 02-27 20:58:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:58:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 20:58:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5806 (0.5861)
[INFO] - 02-27 20:58:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5441)
[INFO] - 02-27 20:58:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7980 (31.7865)
[INFO] - 02-27 20:58:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5054 (371.3562)
[INFO] - 02-27 20:58:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:58:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9658)
[INFO] - 02-27 20:59:02 - [main.backward:225]: Epoch 319/500 - Iteration 90/95 - Time 0.243 batch, 0.030 data, 0.220 forward
[INFO] - 02-27 20:59:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0030)
[INFO] - 02-27 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5914 (0.5875)
[INFO] - 02-27 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5489 (-287.5445)
[INFO] - 02-27 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7863 (31.7946)
[INFO] - 02-27 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0257 (371.4520)
[INFO] - 02-27 20:59:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:59:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9658)
[INFO] - 02-27 20:59:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:59:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:59:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:59:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:59:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:59:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:59:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:59:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.858
[INFO] - 02-27 20:59:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.004
[INFO] - 02-27 20:59:05 - [main.summary_metrics:168]: Epoch 319/500 - Test Results:
{'auc': 0.8478499275322875,
 'f1': 0.42590698653198655,
 'loss': 0.4374686899827092,
 'ndcg': 0.7194445154857897,
 'precision': 0.56875,
 'recall': 0.3409357492997199}
[INFO] - 02-27 20:59:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[319] Complete. Time taken: 00:00:25.057
[INFO] - 02-27 20:59:05 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:59:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:59:05 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:59:05 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:59:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:59:05 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2201, 2216, 1]
[INFO] - 02-27 20:59:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:59:16 - [main.backward:225]: Epoch 320/500 - Iteration 45/95 - Time 0.255 batch, 0.036 data, 0.231 forward
[INFO] - 02-27 20:59:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0030)
[INFO] - 02-27 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5812 (0.5848)
[INFO] - 02-27 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5511 (-287.5495)
[INFO] - 02-27 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8526 (31.7858)
[INFO] - 02-27 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.7186 (371.1911)
[INFO] - 02-27 20:59:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:59:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9691)
[INFO] - 02-27 20:59:28 - [main.backward:225]: Epoch 320/500 - Iteration 0/95 - Time 0.243 batch, 0.030 data, 0.219 forward
[INFO] - 02-27 20:59:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:59:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0028)
[INFO] - 02-27 20:59:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5897 (0.5868)
[INFO] - 02-27 20:59:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5447 (-287.5514)
[INFO] - 02-27 20:59:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8205 (31.7856)
[INFO] - 02-27 20:59:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0108 (371.1105)
[INFO] - 02-27 20:59:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:59:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9705)
[INFO] - 02-27 20:59:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:59:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:59:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:59:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:59:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:59:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:59:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:59:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.833
[INFO] - 02-27 20:59:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.833
[INFO] - 02-27 20:59:30 - [main.summary_metrics:168]: Epoch 320/500 - Test Results:
{'auc': 0.8472596602979428,
 'f1': 0.42080281986531987,
 'loss': 0.4368356223746051,
 'ndcg': 0.7247761292015508,
 'precision': 0.5625,
 'recall': 0.3366202731092437}
[INFO] - 02-27 20:59:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[320] Complete. Time taken: 00:00:24.937
[INFO] - 02-27 20:59:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:59:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:59:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:59:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:59:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:59:30 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3038, 2205, 2213, 1]
[INFO] - 02-27 20:59:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:59:43 - [main.backward:225]: Epoch 321/500 - Iteration 50/95 - Time 0.272 batch, 0.037 data, 0.245 forward
[INFO] - 02-27 20:59:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:59:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0031)
[INFO] - 02-27 20:59:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5895 (0.5867)
[INFO] - 02-27 20:59:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5511 (-287.5485)
[INFO] - 02-27 20:59:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7600 (31.7925)
[INFO] - 02-27 20:59:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6084 (371.2471)
[INFO] - 02-27 20:59:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:59:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9691)
[INFO] - 02-27 20:59:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 20:59:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:59:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:59:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 20:59:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:59:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 20:59:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 20:59:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.951
[INFO] - 02-27 20:59:56 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.952
[INFO] - 02-27 20:59:56 - [main.summary_metrics:168]: Epoch 321/500 - Test Results:
{'auc': 0.8466155154463746,
 'f1': 0.4206986531986532,
 'loss': 0.4381332088812093,
 'ndcg': 0.7213883816139948,
 'precision': 0.5625,
 'recall': 0.33647146358543417}
[INFO] - 02-27 20:59:56 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[321] Complete. Time taken: 00:00:26.364
[INFO] - 02-27 20:59:56 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 20:59:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 20:59:56 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 20:59:56 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 20:59:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 20:59:56 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2222, 2204, 1]
[INFO] - 02-27 20:59:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 20:59:58 - [main.backward:225]: Epoch 322/500 - Iteration 5/95 - Time 0.348 batch, 0.143 data, 0.317 forward
[INFO] - 02-27 20:59:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 20:59:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0032)
[INFO] - 02-27 20:59:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5888 (0.5858)
[INFO] - 02-27 20:59:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5502 (-287.5495)
[INFO] - 02-27 20:59:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8086 (31.8069)
[INFO] - 02-27 20:59:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6431 (371.3304)
[INFO] - 02-27 20:59:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 20:59:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9627)
[INFO] - 02-27 21:00:11 - [main.backward:225]: Epoch 322/500 - Iteration 55/95 - Time 0.265 batch, 0.036 data, 0.239 forward
[INFO] - 02-27 21:00:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:00:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0032)
[INFO] - 02-27 21:00:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5865 (0.5868)
[INFO] - 02-27 21:00:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5494 (-287.5499)
[INFO] - 02-27 21:00:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7618 (31.7910)
[INFO] - 02-27 21:00:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0646 (371.1487)
[INFO] - 02-27 21:00:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:00:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9648)
[INFO] - 02-27 21:00:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:00:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:00:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:00:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:00:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:00:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:00:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:00:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.005
[INFO] - 02-27 21:00:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.005
[INFO] - 02-27 21:00:22 - [main.summary_metrics:168]: Epoch 322/500 - Test Results:
{'auc': 0.847190565135368,
 'f1': 0.41367319023569027,
 'loss': 0.4376985860318269,
 'ndcg': 0.717057837052081,
 'precision': 0.5531250000000001,
 'recall': 0.3308604691876751}
[INFO] - 02-27 21:00:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[322] Complete. Time taken: 00:00:26.207
[INFO] - 02-27 21:00:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:00:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:00:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:00:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:00:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:00:22 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3079, 2187, 2215, 1]
[INFO] - 02-27 21:00:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:00:25 - [main.backward:225]: Epoch 323/500 - Iteration 10/95 - Time 0.298 batch, 0.084 data, 0.272 forward
[INFO] - 02-27 21:00:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:00:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0030)
[INFO] - 02-27 21:00:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5820 (0.5863)
[INFO] - 02-27 21:00:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5491 (-287.5488)
[INFO] - 02-27 21:00:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8674 (31.7951)
[INFO] - 02-27 21:00:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9488 (371.0912)
[INFO] - 02-27 21:00:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:00:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9653)
[INFO] - 02-27 21:00:37 - [main.backward:225]: Epoch 323/500 - Iteration 60/95 - Time 0.252 batch, 0.035 data, 0.227 forward
[INFO] - 02-27 21:00:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 21:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5879 (0.5855)
[INFO] - 02-27 21:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5484 (-287.5512)
[INFO] - 02-27 21:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7596 (31.7981)
[INFO] - 02-27 21:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.6854 (370.9961)
[INFO] - 02-27 21:00:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:00:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9648)
[INFO] - 02-27 21:00:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:00:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:00:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:00:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:00:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:00:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:00:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:00:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.909
[INFO] - 02-27 21:00:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.910
[INFO] - 02-27 21:00:48 - [main.summary_metrics:168]: Epoch 323/500 - Test Results:
{'auc': 0.8479112459934954,
 'f1': 0.4257218013468013,
 'loss': 0.43748307693569277,
 'ndcg': 0.7214010093144145,
 'precision': 0.56875,
 'recall': 0.34069065126050424}
[INFO] - 02-27 21:00:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[323] Complete. Time taken: 00:00:25.495
[INFO] - 02-27 21:00:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:00:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:00:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:00:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:00:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:00:48 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3024, 2209, 2204, 1]
[INFO] - 02-27 21:00:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:00:52 - [main.backward:225]: Epoch 324/500 - Iteration 15/95 - Time 0.292 batch, 0.074 data, 0.267 forward
[INFO] - 02-27 21:00:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:00:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0031)
[INFO] - 02-27 21:00:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5849)
[INFO] - 02-27 21:00:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5460)
[INFO] - 02-27 21:00:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7752 (31.7925)
[INFO] - 02-27 21:00:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5483 (371.1370)
[INFO] - 02-27 21:00:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:00:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9666)
[INFO] - 02-27 21:01:05 - [main.backward:225]: Epoch 324/500 - Iteration 65/95 - Time 0.268 batch, 0.037 data, 0.242 forward
[INFO] - 02-27 21:01:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:01:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0029)
[INFO] - 02-27 21:01:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5818 (0.5857)
[INFO] - 02-27 21:01:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5518 (-287.5470)
[INFO] - 02-27 21:01:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8091 (31.7912)
[INFO] - 02-27 21:01:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6095 (371.0796)
[INFO] - 02-27 21:01:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:01:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9666)
[INFO] - 02-27 21:01:13 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:01:13 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:01:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:01:13 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:01:13 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:01:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:01:13 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:01:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.768
[INFO] - 02-27 21:01:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.769
[INFO] - 02-27 21:01:16 - [main.summary_metrics:168]: Epoch 324/500 - Test Results:
{'auc': 0.8470465634783324,
 'f1': 0.41367319023569027,
 'loss': 0.43769918333714963,
 'ndcg': 0.7172228505812857,
 'precision': 0.5531250000000001,
 'recall': 0.3308604691876751}
[INFO] - 02-27 21:01:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[324] Complete. Time taken: 00:00:27.839
[INFO] - 02-27 21:01:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:01:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:01:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:01:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:01:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:01:16 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2200, 2187, 1]
[INFO] - 02-27 21:01:16 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:01:21 - [main.backward:225]: Epoch 325/500 - Iteration 20/95 - Time 0.276 batch, 0.053 data, 0.250 forward
[INFO] - 02-27 21:01:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:01:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0031)
[INFO] - 02-27 21:01:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5947 (0.5860)
[INFO] - 02-27 21:01:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5466 (-287.5472)
[INFO] - 02-27 21:01:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8664 (31.7954)
[INFO] - 02-27 21:01:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5704 (371.1569)
[INFO] - 02-27 21:01:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:01:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9642)
[INFO] - 02-27 21:01:34 - [main.backward:225]: Epoch 325/500 - Iteration 70/95 - Time 0.264 batch, 0.034 data, 0.238 forward
[INFO] - 02-27 21:01:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0030)
[INFO] - 02-27 21:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5849)
[INFO] - 02-27 21:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5451)
[INFO] - 02-27 21:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7297 (31.7950)
[INFO] - 02-27 21:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7904 (370.9696)
[INFO] - 02-27 21:01:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:01:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9692)
[INFO] - 02-27 21:01:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:01:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:01:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:01:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:01:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:01:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:01:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:01:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.150
[INFO] - 02-27 21:01:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.150
[INFO] - 02-27 21:01:42 - [main.summary_metrics:168]: Epoch 325/500 - Test Results:
{'auc': 0.8453426791672551,
 'f1': 0.42293244949494946,
 'loss': 0.4379858028500102,
 'ndcg': 0.7164919856555418,
 'precision': 0.565625,
 'recall': 0.33821341036414565}
[INFO] - 02-27 21:01:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[325] Complete. Time taken: 00:00:26.706
[INFO] - 02-27 21:01:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:01:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:01:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:01:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:01:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:01:42 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3065, 2217, 2208, 1]
[INFO] - 02-27 21:01:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:01:49 - [main.backward:225]: Epoch 326/500 - Iteration 25/95 - Time 0.279 batch, 0.047 data, 0.254 forward
[INFO] - 02-27 21:01:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:01:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0032)
[INFO] - 02-27 21:01:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5854)
[INFO] - 02-27 21:01:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5416 (-287.5444)
[INFO] - 02-27 21:01:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8542 (31.7857)
[INFO] - 02-27 21:01:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0980 (371.0995)
[INFO] - 02-27 21:01:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:01:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9636)
[INFO] - 02-27 21:02:02 - [main.backward:225]: Epoch 326/500 - Iteration 75/95 - Time 0.260 batch, 0.033 data, 0.235 forward
[INFO] - 02-27 21:02:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0033)
[INFO] - 02-27 21:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5866 (0.5850)
[INFO] - 02-27 21:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5462 (-287.5439)
[INFO] - 02-27 21:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7763 (31.7841)
[INFO] - 02-27 21:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5807 (371.0664)
[INFO] - 02-27 21:02:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:02:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9630)
[INFO] - 02-27 21:02:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:02:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:02:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:02:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:02:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:02:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:02:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:02:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.610
[INFO] - 02-27 21:02:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.612
[INFO] - 02-27 21:02:09 - [main.summary_metrics:168]: Epoch 326/500 - Test Results:
{'auc': 0.8468823238241374,
 'f1': 0.41617319023569027,
 'loss': 0.43735503571791245,
 'ndcg': 0.7206380821761,
 'precision': 0.5562499999999999,
 'recall': 0.3329438025210084}
[INFO] - 02-27 21:02:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[326] Complete. Time taken: 00:00:27.115
[INFO] - 02-27 21:02:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:02:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:02:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:02:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:02:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:02:09 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3039, 2190, 2212, 1]
[INFO] - 02-27 21:02:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:02:18 - [main.backward:225]: Epoch 327/500 - Iteration 30/95 - Time 0.297 batch, 0.051 data, 0.268 forward
[INFO] - 02-27 21:02:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:02:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 21:02:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5936 (0.5863)
[INFO] - 02-27 21:02:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5461 (-287.5470)
[INFO] - 02-27 21:02:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7685 (31.7773)
[INFO] - 02-27 21:02:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7901 (371.0550)
[INFO] - 02-27 21:02:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:02:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9706)
[INFO] - 02-27 21:02:31 - [main.backward:225]: Epoch 327/500 - Iteration 80/95 - Time 0.271 batch, 0.035 data, 0.244 forward
[INFO] - 02-27 21:02:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:02:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0033)
[INFO] - 02-27 21:02:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5859)
[INFO] - 02-27 21:02:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5367 (-287.5453)
[INFO] - 02-27 21:02:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7450 (31.8090)
[INFO] - 02-27 21:02:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9463 (371.1992)
[INFO] - 02-27 21:02:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:02:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9637)
[INFO] - 02-27 21:02:35 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:02:35 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:02:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:02:35 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:02:35 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:02:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:02:35 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:02:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.138
[INFO] - 02-27 21:02:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.139
[INFO] - 02-27 21:02:37 - [main.summary_metrics:168]: Epoch 327/500 - Test Results:
{'auc': 0.8463016862382208,
 'f1': 0.42590698653198655,
 'loss': 0.4378855837821579,
 'ndcg': 0.7222578632787363,
 'precision': 0.56875,
 'recall': 0.3409357492997199}
[INFO] - 02-27 21:02:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[327] Complete. Time taken: 00:00:27.415
[INFO] - 02-27 21:02:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:02:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:02:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:02:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:02:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:02:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3036, 2195, 2217, 1]
[INFO] - 02-27 21:02:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:02:47 - [main.backward:225]: Epoch 328/500 - Iteration 35/95 - Time 0.279 batch, 0.043 data, 0.253 forward
[INFO] - 02-27 21:02:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:02:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0033)
[INFO] - 02-27 21:02:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5877 (0.5865)
[INFO] - 02-27 21:02:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5276 (-287.5313)
[INFO] - 02-27 21:02:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8639 (31.8099)
[INFO] - 02-27 21:02:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9066 (371.1671)
[INFO] - 02-27 21:02:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:02:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9633)
[INFO] - 02-27 21:03:00 - [main.backward:225]: Epoch 328/500 - Iteration 85/95 - Time 0.274 batch, 0.033 data, 0.248 forward
[INFO] - 02-27 21:03:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0033)
[INFO] - 02-27 21:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5843 (0.5862)
[INFO] - 02-27 21:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5181 (-287.5235)
[INFO] - 02-27 21:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7765 (31.8053)
[INFO] - 02-27 21:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2145 (371.0290)
[INFO] - 02-27 21:03:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:03:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9637)
[INFO] - 02-27 21:03:03 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:03:03 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:03:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:03:03 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:03:03 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:03:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:03:03 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:03:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.315
[INFO] - 02-27 21:03:05 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.317
[INFO] - 02-27 21:03:05 - [main.summary_metrics:168]: Epoch 328/500 - Test Results:
{'auc': 0.8465499255461988,
 'f1': 0.4207512626262626,
 'loss': 0.43848222253520314,
 'ndcg': 0.7189492163614537,
 'precision': 0.5625,
 'recall': 0.33649334733893554}
[INFO] - 02-27 21:03:05 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[328] Complete. Time taken: 00:00:28.318
[INFO] - 02-27 21:03:05 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:03:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:03:05 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:03:05 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:03:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:03:05 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3029, 2199, 2209, 1]
[INFO] - 02-27 21:03:06 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:03:17 - [main.backward:225]: Epoch 329/500 - Iteration 40/95 - Time 0.288 batch, 0.042 data, 0.260 forward
[INFO] - 02-27 21:03:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0030)
[INFO] - 02-27 21:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5868)
[INFO] - 02-27 21:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5190 (-287.5198)
[INFO] - 02-27 21:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7598 (31.7885)
[INFO] - 02-27 21:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5061 (371.3204)
[INFO] - 02-27 21:03:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:03:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9675)
[INFO] - 02-27 21:03:30 - [main.backward:225]: Epoch 329/500 - Iteration 90/95 - Time 0.275 batch, 0.033 data, 0.248 forward
[INFO] - 02-27 21:03:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0029)
[INFO] - 02-27 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5842)
[INFO] - 02-27 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5166 (-287.5145)
[INFO] - 02-27 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7972 (31.7937)
[INFO] - 02-27 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1473 (371.2743)
[INFO] - 02-27 21:03:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:03:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9703)
[INFO] - 02-27 21:03:31 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:03:31 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:03:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:03:31 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:03:31 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:03:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:03:31 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:03:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.161
[INFO] - 02-27 21:03:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.161
[INFO] - 02-27 21:03:33 - [main.summary_metrics:168]: Epoch 329/500 - Test Results:
{'auc': 0.8474074949219883,
 'f1': 0.4254324494949495,
 'loss': 0.4373245075737713,
 'ndcg': 0.723637024568552,
 'precision': 0.56875,
 'recall': 0.340296743697479}
[INFO] - 02-27 21:03:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[329] Complete. Time taken: 00:00:28.145
[INFO] - 02-27 21:03:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:03:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:03:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:03:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:03:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:03:33 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2190, 2216, 1]
[INFO] - 02-27 21:03:34 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:03:46 - [main.backward:225]: Epoch 330/500 - Iteration 45/95 - Time 0.279 batch, 0.040 data, 0.252 forward
[INFO] - 02-27 21:03:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:03:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0028)
[INFO] - 02-27 21:03:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5859)
[INFO] - 02-27 21:03:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5230 (-287.5156)
[INFO] - 02-27 21:03:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8080 (31.7911)
[INFO] - 02-27 21:03:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3248 (371.3928)
[INFO] - 02-27 21:03:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:03:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9709)
[INFO] - 02-27 21:03:58 - [main.backward:225]: Epoch 330/500 - Iteration 0/95 - Time 0.265 batch, 0.032 data, 0.239 forward
[INFO] - 02-27 21:03:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0033)
[INFO] - 02-27 21:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5914 (0.5856)
[INFO] - 02-27 21:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5381 (-287.5326)
[INFO] - 02-27 21:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8142 (31.7852)
[INFO] - 02-27 21:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0541 (371.2868)
[INFO] - 02-27 21:03:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9641)
[INFO] - 02-27 21:03:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:03:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:03:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:03:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:03:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:03:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:03:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:04:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.140
[INFO] - 02-27 21:04:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.141
[INFO] - 02-27 21:04:01 - [main.summary_metrics:168]: Epoch 330/500 - Test Results:
{'auc': 0.8452171790284742,
 'f1': 0.4113583754208754,
 'loss': 0.4386007382865773,
 'ndcg': 0.7167724177938222,
 'precision': 0.55,
 'recall': 0.32902223389355745}
[INFO] - 02-27 21:04:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[330] Complete. Time taken: 00:00:27.327
[INFO] - 02-27 21:04:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:04:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:04:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:04:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:04:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:04:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3034, 2208, 2210, 1]
[INFO] - 02-27 21:04:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:04:13 - [main.backward:225]: Epoch 331/500 - Iteration 50/95 - Time 0.258 batch, 0.037 data, 0.234 forward
[INFO] - 02-27 21:04:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:04:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0034)
[INFO] - 02-27 21:04:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5904 (0.5854)
[INFO] - 02-27 21:04:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5404 (-287.5400)
[INFO] - 02-27 21:04:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7990 (31.7837)
[INFO] - 02-27 21:04:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7139 (371.3479)
[INFO] - 02-27 21:04:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:04:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9611)
[INFO] - 02-27 21:04:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:04:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:04:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:04:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:04:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:04:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:04:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:04:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.070
[INFO] - 02-27 21:04:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.071
[INFO] - 02-27 21:04:26 - [main.summary_metrics:168]: Epoch 331/500 - Test Results:
{'auc': 0.8447287356731908,
 'f1': 0.41877735690235696,
 'loss': 0.4393329085146871,
 'ndcg': 0.7178804240323737,
 'precision': 0.559375,
 'recall': 0.33517594537815126}
[INFO] - 02-27 21:04:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[331] Complete. Time taken: 00:00:25.750
[INFO] - 02-27 21:04:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:04:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:04:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:04:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:04:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:04:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2193, 2220, 1]
[INFO] - 02-27 21:04:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:04:28 - [main.backward:225]: Epoch 332/500 - Iteration 5/95 - Time 0.351 batch, 0.131 data, 0.323 forward
[INFO] - 02-27 21:04:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:04:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0031)
[INFO] - 02-27 21:04:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5883 (0.5873)
[INFO] - 02-27 21:04:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5317 (-287.5407)
[INFO] - 02-27 21:04:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7401 (31.7845)
[INFO] - 02-27 21:04:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4929 (371.3505)
[INFO] - 02-27 21:04:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:04:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9683)
[INFO] - 02-27 21:04:40 - [main.backward:225]: Epoch 332/500 - Iteration 55/95 - Time 0.252 batch, 0.034 data, 0.228 forward
[INFO] - 02-27 21:04:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:04:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0030)
[INFO] - 02-27 21:04:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5853)
[INFO] - 02-27 21:04:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5374)
[INFO] - 02-27 21:04:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8962 (31.8102)
[INFO] - 02-27 21:04:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1888 (370.9335)
[INFO] - 02-27 21:04:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:04:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9689)
[INFO] - 02-27 21:04:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:04:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:04:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:04:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:04:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:04:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:04:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:04:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.044
[INFO] - 02-27 21:04:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.045
[INFO] - 02-27 21:04:52 - [main.summary_metrics:168]: Epoch 332/500 - Test Results:
{'auc': 0.8478222343471702,
 'f1': 0.42822180134680143,
 'loss': 0.4367532730767273,
 'ndcg': 0.7243370470363975,
 'precision': 0.5718749999999999,
 'recall': 0.34277398459383757}
[INFO] - 02-27 21:04:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[332] Complete. Time taken: 00:00:25.646
[INFO] - 02-27 21:04:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:04:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:04:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:04:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:04:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:04:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3038, 2180, 2223, 1]
[INFO] - 02-27 21:04:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:04:55 - [main.backward:225]: Epoch 333/500 - Iteration 10/95 - Time 0.325 batch, 0.099 data, 0.298 forward
[INFO] - 02-27 21:04:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:04:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0030)
[INFO] - 02-27 21:04:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5925 (0.5874)
[INFO] - 02-27 21:04:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5465 (-287.5457)
[INFO] - 02-27 21:04:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7889 (31.8123)
[INFO] - 02-27 21:04:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0388 (371.0784)
[INFO] - 02-27 21:04:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:04:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9692)
[INFO] - 02-27 21:05:08 - [main.backward:225]: Epoch 333/500 - Iteration 60/95 - Time 0.262 batch, 0.037 data, 0.237 forward
[INFO] - 02-27 21:05:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:05:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0030)
[INFO] - 02-27 21:05:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5905 (0.5859)
[INFO] - 02-27 21:05:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5517 (-287.5502)
[INFO] - 02-27 21:05:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6880 (31.7991)
[INFO] - 02-27 21:05:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2239 (371.3190)
[INFO] - 02-27 21:05:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:05:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9683)
[INFO] - 02-27 21:05:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:05:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:05:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:05:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:05:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:05:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:05:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:05:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.924
[INFO] - 02-27 21:05:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.925
[INFO] - 02-27 21:05:19 - [main.summary_metrics:168]: Epoch 333/500 - Test Results:
{'auc': 0.8474520091737676,
 'f1': 0.4206176346801347,
 'loss': 0.43704020624531764,
 'ndcg': 0.7230465941201673,
 'precision': 0.5625,
 'recall': 0.336375175070028}
[INFO] - 02-27 21:05:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[333] Complete. Time taken: 00:00:26.622
[INFO] - 02-27 21:05:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:05:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:05:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:05:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:05:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:05:19 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2200, 2214, 1]
[INFO] - 02-27 21:05:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:05:23 - [main.backward:225]: Epoch 334/500 - Iteration 15/95 - Time 0.308 batch, 0.068 data, 0.279 forward
[INFO] - 02-27 21:05:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0031)
[INFO] - 02-27 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5884 (0.5849)
[INFO] - 02-27 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5415 (-287.5417)
[INFO] - 02-27 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7428 (31.8036)
[INFO] - 02-27 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.7967 (371.3082)
[INFO] - 02-27 21:05:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:05:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9623)
[INFO] - 02-27 21:05:36 - [main.backward:225]: Epoch 334/500 - Iteration 65/95 - Time 0.271 batch, 0.035 data, 0.245 forward
[INFO] - 02-27 21:05:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0030)
[INFO] - 02-27 21:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5877 (0.5860)
[INFO] - 02-27 21:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5449 (-287.5448)
[INFO] - 02-27 21:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7518 (31.7911)
[INFO] - 02-27 21:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0435 (371.2442)
[INFO] - 02-27 21:05:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:05:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9661)
[INFO] - 02-27 21:05:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:05:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:05:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:05:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:05:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:05:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:05:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:05:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.390
[INFO] - 02-27 21:05:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.390
[INFO] - 02-27 21:05:46 - [main.summary_metrics:168]: Epoch 334/500 - Test Results:
{'auc': 0.8468250051858979,
 'f1': 0.4254324494949495,
 'loss': 0.4385469201067172,
 'ndcg': 0.7212066451118139,
 'precision': 0.56875,
 'recall': 0.340296743697479}
[INFO] - 02-27 21:05:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[334] Complete. Time taken: 00:00:27.372
[INFO] - 02-27 21:05:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:05:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:05:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:05:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:05:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:05:46 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3037, 2195, 2208, 1]
[INFO] - 02-27 21:05:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:05:51 - [main.backward:225]: Epoch 335/500 - Iteration 20/95 - Time 0.267 batch, 0.050 data, 0.244 forward
[INFO] - 02-27 21:05:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:05:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0032)
[INFO] - 02-27 21:05:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5854 (0.5863)
[INFO] - 02-27 21:05:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5478 (-287.5488)
[INFO] - 02-27 21:05:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7587 (31.8080)
[INFO] - 02-27 21:05:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.7495 (371.0719)
[INFO] - 02-27 21:05:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:05:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9633)
[INFO] - 02-27 21:06:04 - [main.backward:225]: Epoch 335/500 - Iteration 70/95 - Time 0.255 batch, 0.032 data, 0.231 forward
[INFO] - 02-27 21:06:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 21:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5859)
[INFO] - 02-27 21:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5442)
[INFO] - 02-27 21:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8539 (31.8042)
[INFO] - 02-27 21:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2908 (371.2405)
[INFO] - 02-27 21:06:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9639)
[INFO] - 02-27 21:06:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:06:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:06:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:06:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:06:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:06:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:06:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:06:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.164
[INFO] - 02-27 21:06:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.165
[INFO] - 02-27 21:06:12 - [main.summary_metrics:168]: Epoch 335/500 - Test Results:
{'auc': 0.8470744854927265,
 'f1': 0.41848800505050504,
 'loss': 0.43693804373464773,
 'ndcg': 0.7250940673438963,
 'precision': 0.5593750000000001,
 'recall': 0.33478203781512605}
[INFO] - 02-27 21:06:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[335] Complete. Time taken: 00:00:26.250
[INFO] - 02-27 21:06:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:06:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:06:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:06:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:06:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:06:12 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2188, 2197, 1]
[INFO] - 02-27 21:06:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:06:19 - [main.backward:225]: Epoch 336/500 - Iteration 25/95 - Time 0.272 batch, 0.048 data, 0.247 forward
[INFO] - 02-27 21:06:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:06:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0028)
[INFO] - 02-27 21:06:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5863)
[INFO] - 02-27 21:06:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5437)
[INFO] - 02-27 21:06:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8482 (31.7888)
[INFO] - 02-27 21:06:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2469 (371.1650)
[INFO] - 02-27 21:06:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:06:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9703)
[INFO] - 02-27 21:06:31 - [main.backward:225]: Epoch 336/500 - Iteration 75/95 - Time 0.253 batch, 0.032 data, 0.228 forward
[INFO] - 02-27 21:06:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:06:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0031)
[INFO] - 02-27 21:06:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5875 (0.5856)
[INFO] - 02-27 21:06:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5449 (-287.5445)
[INFO] - 02-27 21:06:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8039 (31.8118)
[INFO] - 02-27 21:06:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2942 (371.2301)
[INFO] - 02-27 21:06:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:06:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9652)
[INFO] - 02-27 21:06:36 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:06:36 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:06:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:06:36 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:06:36 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:06:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:06:36 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:06:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.035
[INFO] - 02-27 21:06:38 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.036
[INFO] - 02-27 21:06:38 - [main.summary_metrics:168]: Epoch 336/500 - Test Results:
{'auc': 0.8459163462566399,
 'f1': 0.41106902356902353,
 'loss': 0.4380928233922581,
 'ndcg': 0.7217893413632128,
 'precision': 0.55,
 'recall': 0.3286283263305322}
[INFO] - 02-27 21:06:38 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[336] Complete. Time taken: 00:00:26.037
[INFO] - 02-27 21:06:38 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:06:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:06:38 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:06:38 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:06:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:06:38 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3075, 2196, 2202, 1]
[INFO] - 02-27 21:06:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:06:46 - [main.backward:225]: Epoch 337/500 - Iteration 30/95 - Time 0.261 batch, 0.043 data, 0.237 forward
[INFO] - 02-27 21:06:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0031)
[INFO] - 02-27 21:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5853)
[INFO] - 02-27 21:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5460)
[INFO] - 02-27 21:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8180 (31.7905)
[INFO] - 02-27 21:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5107 (371.1302)
[INFO] - 02-27 21:06:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:06:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9678)
[INFO] - 02-27 21:06:58 - [main.backward:225]: Epoch 337/500 - Iteration 80/95 - Time 0.249 batch, 0.031 data, 0.224 forward
[INFO] - 02-27 21:06:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0031)
[INFO] - 02-27 21:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5908 (0.5862)
[INFO] - 02-27 21:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5499 (-287.5471)
[INFO] - 02-27 21:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7563 (31.7959)
[INFO] - 02-27 21:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9715 (371.0478)
[INFO] - 02-27 21:06:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9658)
[INFO] - 02-27 21:07:02 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:07:02 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:07:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:07:02 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:07:02 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:07:02 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:07:02 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:07:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.203
[INFO] - 02-27 21:07:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.203
[INFO] - 02-27 21:07:04 - [main.summary_metrics:168]: Epoch 337/500 - Test Results:
{'auc': 0.8462975388684886,
 'f1': 0.42080281986531987,
 'loss': 0.43846333912876956,
 'ndcg': 0.7204383964698242,
 'precision': 0.5625,
 'recall': 0.3366202731092437}
[INFO] - 02-27 21:07:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[337] Complete. Time taken: 00:00:25.768
[INFO] - 02-27 21:07:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:07:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:07:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:07:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:07:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:07:04 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3030, 2189, 2208, 1]
[INFO] - 02-27 21:07:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:07:13 - [main.backward:225]: Epoch 338/500 - Iteration 35/95 - Time 0.266 batch, 0.041 data, 0.240 forward
[INFO] - 02-27 21:07:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0032)
[INFO] - 02-27 21:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5862)
[INFO] - 02-27 21:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5474 (-287.5498)
[INFO] - 02-27 21:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8249 (31.7983)
[INFO] - 02-27 21:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5777 (371.0435)
[INFO] - 02-27 21:07:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9652)
[INFO] - 02-27 21:07:26 - [main.backward:225]: Epoch 338/500 - Iteration 85/95 - Time 0.256 batch, 0.031 data, 0.231 forward
[INFO] - 02-27 21:07:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:07:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0031)
[INFO] - 02-27 21:07:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5860)
[INFO] - 02-27 21:07:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5494 (-287.5509)
[INFO] - 02-27 21:07:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7976 (31.7999)
[INFO] - 02-27 21:07:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3830 (371.1168)
[INFO] - 02-27 21:07:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:07:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9650)
[INFO] - 02-27 21:07:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:07:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:07:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:07:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:07:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:07:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:07:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:07:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.116
[INFO] - 02-27 21:07:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.117
[INFO] - 02-27 21:07:30 - [main.summary_metrics:168]: Epoch 338/500 - Test Results:
{'auc': 0.8465585410634842,
 'f1': 0.4232218013468014,
 'loss': 0.4382684544349465,
 'ndcg': 0.7235991569951975,
 'precision': 0.565625,
 'recall': 0.3386073179271709}
[INFO] - 02-27 21:07:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[338] Complete. Time taken: 00:00:26.464
[INFO] - 02-27 21:07:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:07:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:07:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:07:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:07:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:07:30 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2171, 2225, 1]
[INFO] - 02-27 21:07:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:07:42 - [main.backward:225]: Epoch 339/500 - Iteration 40/95 - Time 0.279 batch, 0.044 data, 0.253 forward
[INFO] - 02-27 21:07:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:07:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 21:07:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5933 (0.5865)
[INFO] - 02-27 21:07:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5497 (-287.5471)
[INFO] - 02-27 21:07:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8769 (31.8018)
[INFO] - 02-27 21:07:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9083 (371.2329)
[INFO] - 02-27 21:07:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:07:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9661)
[INFO] - 02-27 21:07:54 - [main.backward:225]: Epoch 339/500 - Iteration 90/95 - Time 0.262 batch, 0.033 data, 0.237 forward
[INFO] - 02-27 21:07:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:07:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0030)
[INFO] - 02-27 21:07:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5850)
[INFO] - 02-27 21:07:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5506 (-287.5473)
[INFO] - 02-27 21:07:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7582 (31.8086)
[INFO] - 02-27 21:07:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0557 (371.5142)
[INFO] - 02-27 21:07:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:07:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9677)
[INFO] - 02-27 21:07:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:07:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:07:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:07:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:07:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:07:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:07:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:07:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.034
[INFO] - 02-27 21:07:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.035
[INFO] - 02-27 21:07:57 - [main.summary_metrics:168]: Epoch 339/500 - Test Results:
{'auc': 0.8461846895008003,
 'f1': 0.41414772727272725,
 'loss': 0.4374176533781219,
 'ndcg': 0.7202077409936779,
 'precision': 0.553125,
 'recall': 0.331499474789916}
[INFO] - 02-27 21:07:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[339] Complete. Time taken: 00:00:26.900
[INFO] - 02-27 21:07:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:07:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:07:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:07:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:07:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:07:58 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3090, 2215, 2224, 1]
[INFO] - 02-27 21:07:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:08:09 - [main.backward:225]: Epoch 340/500 - Iteration 45/95 - Time 0.263 batch, 0.043 data, 0.238 forward
[INFO] - 02-27 21:08:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:08:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0032)
[INFO] - 02-27 21:08:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5906 (0.5858)
[INFO] - 02-27 21:08:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5447 (-287.5469)
[INFO] - 02-27 21:08:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8667 (31.7877)
[INFO] - 02-27 21:08:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8746 (371.2838)
[INFO] - 02-27 21:08:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:08:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9650)
[INFO] - 02-27 21:08:21 - [main.backward:225]: Epoch 340/500 - Iteration 0/95 - Time 0.251 batch, 0.033 data, 0.227 forward
[INFO] - 02-27 21:08:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:08:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0030)
[INFO] - 02-27 21:08:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5789 (0.5847)
[INFO] - 02-27 21:08:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5451 (-287.5445)
[INFO] - 02-27 21:08:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7523 (31.8053)
[INFO] - 02-27 21:08:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9412 (371.5495)
[INFO] - 02-27 21:08:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:08:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9681)
[INFO] - 02-27 21:08:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:08:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:08:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:08:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:08:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:08:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:08:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:08:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.163
[INFO] - 02-27 21:08:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.163
[INFO] - 02-27 21:08:23 - [main.summary_metrics:168]: Epoch 340/500 - Test Results:
{'auc': 0.8465821959298425,
 'f1': 0.4115435606060606,
 'loss': 0.43700800618171753,
 'ndcg': 0.7292317826813461,
 'precision': 0.55,
 'recall': 0.32926733193277313}
[INFO] - 02-27 21:08:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[340] Complete. Time taken: 00:00:26.022
[INFO] - 02-27 21:08:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:08:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:08:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:08:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:08:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:08:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2197, 2231, 1]
[INFO] - 02-27 21:08:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:08:39 - [main.backward:225]: Epoch 341/500 - Iteration 50/95 - Time 0.305 batch, 0.037 data, 0.280 forward
[INFO] - 02-27 21:08:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:08:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0028)
[INFO] - 02-27 21:08:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5825 (0.5851)
[INFO] - 02-27 21:08:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5375 (-287.5367)
[INFO] - 02-27 21:08:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8051 (31.7937)
[INFO] - 02-27 21:08:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2654 (371.0130)
[INFO] - 02-27 21:08:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:08:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9695)
[INFO] - 02-27 21:08:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:08:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:08:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:08:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:08:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:08:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:08:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:08:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.168
[INFO] - 02-27 21:08:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.168
[INFO] - 02-27 21:08:52 - [main.summary_metrics:168]: Epoch 341/500 - Test Results:
{'auc': 0.8468234629023178,
 'f1': 0.41135837542087544,
 'loss': 0.4374525687432521,
 'ndcg': 0.7166455936325283,
 'precision': 0.55,
 'recall': 0.32902223389355745}
[INFO] - 02-27 21:08:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[341] Complete. Time taken: 00:00:28.164
[INFO] - 02-27 21:08:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:08:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:08:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:08:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:08:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:08:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2234, 2208, 1]
[INFO] - 02-27 21:08:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:08:53 - [main.backward:225]: Epoch 342/500 - Iteration 5/95 - Time 0.355 batch, 0.139 data, 0.327 forward
[INFO] - 02-27 21:08:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:08:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0029)
[INFO] - 02-27 21:08:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5852)
[INFO] - 02-27 21:08:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5477 (-287.5431)
[INFO] - 02-27 21:08:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7834 (31.7846)
[INFO] - 02-27 21:08:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7812 (371.1126)
[INFO] - 02-27 21:08:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:08:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9681)
[INFO] - 02-27 21:09:05 - [main.backward:225]: Epoch 342/500 - Iteration 55/95 - Time 0.243 batch, 0.035 data, 0.219 forward
[INFO] - 02-27 21:09:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0030)
[INFO] - 02-27 21:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5891 (0.5863)
[INFO] - 02-27 21:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5465)
[INFO] - 02-27 21:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8158 (31.7962)
[INFO] - 02-27 21:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9739 (371.1646)
[INFO] - 02-27 21:09:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:09:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9670)
[INFO] - 02-27 21:09:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:09:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:09:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:09:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:09:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:09:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:09:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:09:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.071
[INFO] - 02-27 21:09:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.071
[INFO] - 02-27 21:09:17 - [main.summary_metrics:168]: Epoch 342/500 - Test Results:
{'auc': 0.846118077561907,
 'f1': 0.402388468013468,
 'loss': 0.43797384836658604,
 'ndcg': 0.7131437121658826,
 'precision': 0.5375,
 'recall': 0.32206320028011204}
[INFO] - 02-27 21:09:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[342] Complete. Time taken: 00:00:24.960
[INFO] - 02-27 21:09:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:09:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:09:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:09:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:09:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:09:17 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2209, 2206, 1]
[INFO] - 02-27 21:09:17 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:09:20 - [main.backward:225]: Epoch 343/500 - Iteration 10/95 - Time 0.317 batch, 0.090 data, 0.293 forward
[INFO] - 02-27 21:09:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0029)
[INFO] - 02-27 21:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5838 (0.5863)
[INFO] - 02-27 21:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5382 (-287.5414)
[INFO] - 02-27 21:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7765 (31.8028)
[INFO] - 02-27 21:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1469 (371.3053)
[INFO] - 02-27 21:09:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:09:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9691)
[INFO] - 02-27 21:09:32 - [main.backward:225]: Epoch 343/500 - Iteration 60/95 - Time 0.259 batch, 0.036 data, 0.233 forward
[INFO] - 02-27 21:09:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:09:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0017 (0.0030)
[INFO] - 02-27 21:09:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5818 (0.5862)
[INFO] - 02-27 21:09:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5361)
[INFO] - 02-27 21:09:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7844 (31.7840)
[INFO] - 02-27 21:09:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5605 (371.4152)
[INFO] - 02-27 21:09:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:09:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9650)
[INFO] - 02-27 21:09:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:09:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:09:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:09:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:09:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:09:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:09:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:09:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.049
[INFO] - 02-27 21:09:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.049
[INFO] - 02-27 21:09:42 - [main.summary_metrics:168]: Epoch 343/500 - Test Results:
{'auc': 0.845892475249904,
 'f1': 0.4117287457912458,
 'loss': 0.43872267503213636,
 'ndcg': 0.7183501820429224,
 'precision': 0.55,
 'recall': 0.3295124299719888}
[INFO] - 02-27 21:09:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[343] Complete. Time taken: 00:00:25.985
[INFO] - 02-27 21:09:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:09:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:09:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:09:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:09:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:09:43 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3046, 2191, 2196, 1]
[INFO] - 02-27 21:09:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:09:47 - [main.backward:225]: Epoch 344/500 - Iteration 15/95 - Time 0.288 batch, 0.066 data, 0.264 forward
[INFO] - 02-27 21:09:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0014 (0.0032)
[INFO] - 02-27 21:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5867)
[INFO] - 02-27 21:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5494 (-287.5450)
[INFO] - 02-27 21:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8044 (31.7934)
[INFO] - 02-27 21:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9345 (371.2303)
[INFO] - 02-27 21:09:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:09:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9644)
[INFO] - 02-27 21:09:59 - [main.backward:225]: Epoch 344/500 - Iteration 65/95 - Time 0.257 batch, 0.034 data, 0.232 forward
[INFO] - 02-27 21:09:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0030)
[INFO] - 02-27 21:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5805 (0.5864)
[INFO] - 02-27 21:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5484)
[INFO] - 02-27 21:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7416 (31.8011)
[INFO] - 02-27 21:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6717 (371.1632)
[INFO] - 02-27 21:09:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:09:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9677)
[INFO] - 02-27 21:10:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:10:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:10:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:10:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:10:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:10:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:10:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:10:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.221
[INFO] - 02-27 21:10:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.223
[INFO] - 02-27 21:10:09 - [main.summary_metrics:168]: Epoch 344/500 - Test Results:
{'auc': 0.8464401371455446,
 'f1': 0.4212773569023569,
 'loss': 0.43851546105772876,
 'ndcg': 0.7218722275852598,
 'precision': 0.5625,
 'recall': 0.33725927871148464}
[INFO] - 02-27 21:10:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[344] Complete. Time taken: 00:00:26.268
[INFO] - 02-27 21:10:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:10:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:10:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:10:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:10:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:10:09 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2184, 2211, 1]
[INFO] - 02-27 21:10:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:10:14 - [main.backward:225]: Epoch 345/500 - Iteration 20/95 - Time 0.274 batch, 0.050 data, 0.250 forward
[INFO] - 02-27 21:10:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:10:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0031)
[INFO] - 02-27 21:10:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5936 (0.5876)
[INFO] - 02-27 21:10:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5404 (-287.5448)
[INFO] - 02-27 21:10:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8440 (31.8005)
[INFO] - 02-27 21:10:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0847 (371.2193)
[INFO] - 02-27 21:10:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:10:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9659)
[INFO] - 02-27 21:10:27 - [main.backward:225]: Epoch 345/500 - Iteration 70/95 - Time 0.257 batch, 0.033 data, 0.232 forward
[INFO] - 02-27 21:10:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0028)
[INFO] - 02-27 21:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5797 (0.5866)
[INFO] - 02-27 21:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5500 (-287.5444)
[INFO] - 02-27 21:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7553 (31.7791)
[INFO] - 02-27 21:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8496 (371.0337)
[INFO] - 02-27 21:10:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9708)
[INFO] - 02-27 21:10:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:10:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:10:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:10:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:10:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:10:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:10:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:10:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:01.902
[INFO] - 02-27 21:10:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:01.903
[INFO] - 02-27 21:10:35 - [main.summary_metrics:168]: Epoch 345/500 - Test Results:
{'auc': 0.8465756574688699,
 'f1': 0.42340698653198655,
 'loss': 0.4384170605720036,
 'ndcg': 0.7206702124723623,
 'precision': 0.565625,
 'recall': 0.33885241596638654}
[INFO] - 02-27 21:10:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[345] Complete. Time taken: 00:00:25.878
[INFO] - 02-27 21:10:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:10:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:10:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:10:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:10:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:10:35 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3079, 2219, 2195, 1]
[INFO] - 02-27 21:10:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:10:42 - [main.backward:225]: Epoch 346/500 - Iteration 25/95 - Time 0.277 batch, 0.057 data, 0.251 forward
[INFO] - 02-27 21:10:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0031)
[INFO] - 02-27 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5751 (0.5863)
[INFO] - 02-27 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5499 (-287.5494)
[INFO] - 02-27 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7806 (31.8081)
[INFO] - 02-27 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9770 (371.2956)
[INFO] - 02-27 21:10:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9672)
[INFO] - 02-27 21:10:54 - [main.backward:225]: Epoch 346/500 - Iteration 75/95 - Time 0.256 batch, 0.036 data, 0.230 forward
[INFO] - 02-27 21:10:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:10:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0030)
[INFO] - 02-27 21:10:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5866)
[INFO] - 02-27 21:10:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5354 (-287.5446)
[INFO] - 02-27 21:10:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9305 (31.8015)
[INFO] - 02-27 21:10:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9209 (371.3466)
[INFO] - 02-27 21:10:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:10:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9681)
[INFO] - 02-27 21:10:59 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:10:59 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:10:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:10:59 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:10:59 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:10:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:10:59 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:11:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.014
[INFO] - 02-27 21:11:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.014
[INFO] - 02-27 21:11:01 - [main.summary_metrics:168]: Epoch 346/500 - Test Results:
{'auc': 0.8463470164413804,
 'f1': 0.41143939393939394,
 'loss': 0.4385655748079312,
 'ndcg': 0.7253678798306457,
 'precision': 0.55,
 'recall': 0.3291185224089636}
[INFO] - 02-27 21:11:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[346] Complete. Time taken: 00:00:26.033
[INFO] - 02-27 21:11:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:11:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:11:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:11:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:11:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:11:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2193, 2188, 1]
[INFO] - 02-27 21:11:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:11:09 - [main.backward:225]: Epoch 347/500 - Iteration 30/95 - Time 0.266 batch, 0.042 data, 0.242 forward
[INFO] - 02-27 21:11:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:11:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0029)
[INFO] - 02-27 21:11:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5875 (0.5861)
[INFO] - 02-27 21:11:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5438 (-287.5394)
[INFO] - 02-27 21:11:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8733 (31.7980)
[INFO] - 02-27 21:11:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2731 (371.1114)
[INFO] - 02-27 21:11:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:11:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9659)
[INFO] - 02-27 21:11:21 - [main.backward:225]: Epoch 347/500 - Iteration 80/95 - Time 0.256 batch, 0.031 data, 0.231 forward
[INFO] - 02-27 21:11:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:11:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0028)
[INFO] - 02-27 21:11:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5886 (0.5866)
[INFO] - 02-27 21:11:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5483 (-287.5485)
[INFO] - 02-27 21:11:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8705 (31.7924)
[INFO] - 02-27 21:11:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2061 (370.9561)
[INFO] - 02-27 21:11:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:11:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9688)
[INFO] - 02-27 21:11:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:11:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:11:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:11:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:11:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:11:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:11:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:11:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.084
[INFO] - 02-27 21:11:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.085
[INFO] - 02-27 21:11:27 - [main.summary_metrics:168]: Epoch 347/500 - Test Results:
{'auc': 0.84662406022458,
 'f1': 0.42098800505050504,
 'loss': 0.43838971465333343,
 'ndcg': 0.7185413481832852,
 'precision': 0.5625,
 'recall': 0.3368653711484594}
[INFO] - 02-27 21:11:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[347] Complete. Time taken: 00:00:26.189
[INFO] - 02-27 21:11:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:11:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:11:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:11:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:11:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:11:27 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3046, 2179, 2210, 1]
[INFO] - 02-27 21:11:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:11:36 - [main.backward:225]: Epoch 348/500 - Iteration 35/95 - Time 0.264 batch, 0.042 data, 0.239 forward
[INFO] - 02-27 21:11:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:11:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0032)
[INFO] - 02-27 21:11:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5863)
[INFO] - 02-27 21:11:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5518 (-287.5505)
[INFO] - 02-27 21:11:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8139 (31.7937)
[INFO] - 02-27 21:11:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9229 (370.9966)
[INFO] - 02-27 21:11:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:11:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9656)
[INFO] - 02-27 21:11:48 - [main.backward:225]: Epoch 348/500 - Iteration 85/95 - Time 0.253 batch, 0.032 data, 0.228 forward
[INFO] - 02-27 21:11:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 21:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5860 (0.5864)
[INFO] - 02-27 21:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5459 (-287.5506)
[INFO] - 02-27 21:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7658 (31.7972)
[INFO] - 02-27 21:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7743 (371.3671)
[INFO] - 02-27 21:11:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:11:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9661)
[INFO] - 02-27 21:11:51 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:11:51 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:11:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:11:51 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:11:51 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:11:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:11:51 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:11:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.302
[INFO] - 02-27 21:11:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.304
[INFO] - 02-27 21:11:53 - [main.summary_metrics:168]: Epoch 348/500 - Test Results:
{'auc': 0.8474175932627952,
 'f1': 0.40917718855218854,
 'loss': 0.4379589472879236,
 'ndcg': 0.7226401526924889,
 'precision': 0.546875,
 'recall': 0.32730217086834734}
[INFO] - 02-27 21:11:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[348] Complete. Time taken: 00:00:26.441
[INFO] - 02-27 21:11:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:11:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:11:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:11:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:11:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:11:53 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3029, 2205, 2202, 1]
[INFO] - 02-27 21:11:54 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:12:04 - [main.backward:225]: Epoch 349/500 - Iteration 40/95 - Time 0.268 batch, 0.040 data, 0.242 forward
[INFO] - 02-27 21:12:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 21:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5862)
[INFO] - 02-27 21:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5479 (-287.5446)
[INFO] - 02-27 21:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7768 (31.7966)
[INFO] - 02-27 21:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0023 (371.3514)
[INFO] - 02-27 21:12:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:12:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9680)
[INFO] - 02-27 21:12:17 - [main.backward:225]: Epoch 349/500 - Iteration 90/95 - Time 0.265 batch, 0.033 data, 0.239 forward
[INFO] - 02-27 21:12:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:12:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0029)
[INFO] - 02-27 21:12:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5901 (0.5858)
[INFO] - 02-27 21:12:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5408 (-287.5462)
[INFO] - 02-27 21:12:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7656 (31.7950)
[INFO] - 02-27 21:12:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1439 (371.2690)
[INFO] - 02-27 21:12:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:12:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9672)
[INFO] - 02-27 21:12:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:12:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:12:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:12:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:12:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:12:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:12:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:12:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.196
[INFO] - 02-27 21:12:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.197
[INFO] - 02-27 21:12:21 - [main.summary_metrics:168]: Epoch 349/500 - Test Results:
{'auc': 0.8475254859909651,
 'f1': 0.4113068181818182,
 'loss': 0.43796302136650994,
 'ndcg': 0.7205474297578236,
 'precision': 0.55,
 'recall': 0.3288953081232493}
[INFO] - 02-27 21:12:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[349] Complete. Time taken: 00:00:27.382
[INFO] - 02-27 21:12:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:12:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:12:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:12:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:12:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:12:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2213, 2209, 1]
[INFO] - 02-27 21:12:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:12:33 - [main.backward:225]: Epoch 350/500 - Iteration 45/95 - Time 0.273 batch, 0.040 data, 0.247 forward
[INFO] - 02-27 21:12:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:12:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 21:12:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5846)
[INFO] - 02-27 21:12:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5452)
[INFO] - 02-27 21:12:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7247 (31.7820)
[INFO] - 02-27 21:12:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7947 (370.9933)
[INFO] - 02-27 21:12:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:12:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9667)
[INFO] - 02-27 21:12:46 - [main.backward:225]: Epoch 350/500 - Iteration 0/95 - Time 0.272 batch, 0.034 data, 0.244 forward
[INFO] - 02-27 21:12:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:12:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0030)
[INFO] - 02-27 21:12:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5913 (0.5848)
[INFO] - 02-27 21:12:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5456)
[INFO] - 02-27 21:12:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7962 (31.7904)
[INFO] - 02-27 21:12:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0310 (371.1151)
[INFO] - 02-27 21:12:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:12:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9672)
[INFO] - 02-27 21:12:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:12:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:12:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:12:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:12:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:12:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:12:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:12:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.268
[INFO] - 02-27 21:12:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.269
[INFO] - 02-27 21:12:49 - [main.summary_metrics:168]: Epoch 350/500 - Test Results:
{'auc': 0.8469658114471279,
 'f1': 0.40917718855218854,
 'loss': 0.4381185577476595,
 'ndcg': 0.7143587716515131,
 'precision': 0.546875,
 'recall': 0.32730217086834734}
[INFO] - 02-27 21:12:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[350] Complete. Time taken: 00:00:28.069
[INFO] - 02-27 21:12:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:12:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:12:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:12:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:12:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:12:49 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3039, 2205, 2218, 1]
[INFO] - 02-27 21:12:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:13:04 - [main.backward:225]: Epoch 351/500 - Iteration 50/95 - Time 0.314 batch, 0.049 data, 0.280 forward
[INFO] - 02-27 21:13:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0030)
[INFO] - 02-27 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5832 (0.5859)
[INFO] - 02-27 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5466 (-287.5456)
[INFO] - 02-27 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7904 (31.7740)
[INFO] - 02-27 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7430 (370.9750)
[INFO] - 02-27 21:13:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:13:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9683)
[INFO] - 02-27 21:13:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:13:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:13:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:13:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:13:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:13:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:13:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:13:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.669
[INFO] - 02-27 21:13:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.669
[INFO] - 02-27 21:13:21 - [main.summary_metrics:168]: Epoch 351/500 - Test Results:
{'auc': 0.8467332781764667,
 'f1': 0.4282218013468013,
 'loss': 0.4376587824254389,
 'ndcg': 0.721930641467297,
 'precision': 0.5718750000000001,
 'recall': 0.3427739845938375}
[INFO] - 02-27 21:13:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[351] Complete. Time taken: 00:00:32.266
[INFO] - 02-27 21:13:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:13:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:13:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:13:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:13:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:13:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2172, 2197, 1]
[INFO] - 02-27 21:13:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:13:23 - [main.backward:225]: Epoch 352/500 - Iteration 5/95 - Time 0.462 batch, 0.184 data, 0.427 forward
[INFO] - 02-27 21:13:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:13:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0030)
[INFO] - 02-27 21:13:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5898 (0.5855)
[INFO] - 02-27 21:13:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5479 (-287.5456)
[INFO] - 02-27 21:13:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8326 (31.7941)
[INFO] - 02-27 21:13:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9782 (371.2382)
[INFO] - 02-27 21:13:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:13:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9694)
[INFO] - 02-27 21:13:36 - [main.backward:225]: Epoch 352/500 - Iteration 55/95 - Time 0.271 batch, 0.040 data, 0.244 forward
[INFO] - 02-27 21:13:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:13:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0034)
[INFO] - 02-27 21:13:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5857)
[INFO] - 02-27 21:13:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5497 (-287.5481)
[INFO] - 02-27 21:13:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8625 (31.8018)
[INFO] - 02-27 21:13:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8641 (371.3245)
[INFO] - 02-27 21:13:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:13:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9625)
[INFO] - 02-27 21:13:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:13:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:13:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:13:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:13:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:13:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:13:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:13:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.097
[INFO] - 02-27 21:13:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.097
[INFO] - 02-27 21:13:48 - [main.summary_metrics:168]: Epoch 352/500 - Test Results:
{'auc': 0.8466245189865163,
 'f1': 0.41351746632996633,
 'loss': 0.43828586777152867,
 'ndcg': 0.7181818723412955,
 'precision': 0.5531250000000001,
 'recall': 0.3305847338935574}
[INFO] - 02-27 21:13:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[352] Complete. Time taken: 00:00:27.459
[INFO] - 02-27 21:13:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:13:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:13:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:13:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:13:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:13:49 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3032, 2213, 2219, 1]
[INFO] - 02-27 21:13:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:13:52 - [main.backward:225]: Epoch 353/500 - Iteration 10/95 - Time 0.315 batch, 0.087 data, 0.289 forward
[INFO] - 02-27 21:13:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0033)
[INFO] - 02-27 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5856)
[INFO] - 02-27 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5473 (-287.5495)
[INFO] - 02-27 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8101 (31.8004)
[INFO] - 02-27 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3756 (371.1441)
[INFO] - 02-27 21:13:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:13:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9631)
[INFO] - 02-27 21:14:05 - [main.backward:225]: Epoch 353/500 - Iteration 60/95 - Time 0.267 batch, 0.036 data, 0.242 forward
[INFO] - 02-27 21:14:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:14:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0031)
[INFO] - 02-27 21:14:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5818 (0.5871)
[INFO] - 02-27 21:14:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5421 (-287.5447)
[INFO] - 02-27 21:14:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7483 (31.7760)
[INFO] - 02-27 21:14:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9511 (371.1441)
[INFO] - 02-27 21:14:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:14:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9647)
[INFO] - 02-27 21:14:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:14:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:14:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:14:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:14:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:14:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:14:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:14:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.030
[INFO] - 02-27 21:14:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.030
[INFO] - 02-27 21:14:16 - [main.summary_metrics:168]: Epoch 353/500 - Test Results:
{'auc': 0.8462056742427363,
 'f1': 0.4088878367003367,
 'loss': 0.43902106701020205,
 'ndcg': 0.719932465035697,
 'precision': 0.546875,
 'recall': 0.32690826330532213}
[INFO] - 02-27 21:14:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[353] Complete. Time taken: 00:00:27.173
[INFO] - 02-27 21:14:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:14:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:14:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:14:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:14:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:14:16 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3002, 2214, 2225, 1]
[INFO] - 02-27 21:14:16 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:14:20 - [main.backward:225]: Epoch 354/500 - Iteration 15/95 - Time 0.288 batch, 0.065 data, 0.264 forward
[INFO] - 02-27 21:14:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0030)
[INFO] - 02-27 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5833 (0.5860)
[INFO] - 02-27 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5303 (-287.5342)
[INFO] - 02-27 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7995 (31.7996)
[INFO] - 02-27 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4563 (371.1715)
[INFO] - 02-27 21:14:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:14:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9673)
[INFO] - 02-27 21:14:32 - [main.backward:225]: Epoch 354/500 - Iteration 65/95 - Time 0.256 batch, 0.033 data, 0.232 forward
[INFO] - 02-27 21:14:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:14:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 21:14:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5884 (0.5858)
[INFO] - 02-27 21:14:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5193 (-287.5242)
[INFO] - 02-27 21:14:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8755 (31.8022)
[INFO] - 02-27 21:14:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4079 (371.3428)
[INFO] - 02-27 21:14:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:14:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9684)
[INFO] - 02-27 21:14:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:14:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:14:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:14:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:14:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:14:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:14:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:14:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.370
[INFO] - 02-27 21:14:42 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.371
[INFO] - 02-27 21:14:42 - [main.summary_metrics:168]: Epoch 354/500 - Test Results:
{'auc': 0.8472132584651508,
 'f1': 0.4184880050505051,
 'loss': 0.43791683297841627,
 'ndcg': 0.7187296871151936,
 'precision': 0.559375,
 'recall': 0.33478203781512605}
[INFO] - 02-27 21:14:42 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[354] Complete. Time taken: 00:00:26.433
[INFO] - 02-27 21:14:42 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:14:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:14:42 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:14:42 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:14:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:14:42 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3068, 2204, 2217, 1]
[INFO] - 02-27 21:14:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:14:48 - [main.backward:225]: Epoch 355/500 - Iteration 20/95 - Time 0.297 batch, 0.054 data, 0.272 forward
[INFO] - 02-27 21:14:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:14:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0030)
[INFO] - 02-27 21:14:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5861)
[INFO] - 02-27 21:14:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5286 (-287.5186)
[INFO] - 02-27 21:14:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6971 (31.8056)
[INFO] - 02-27 21:14:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3813 (371.2273)
[INFO] - 02-27 21:14:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:14:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9670)
[INFO] - 02-27 21:15:01 - [main.backward:225]: Epoch 355/500 - Iteration 70/95 - Time 0.269 batch, 0.033 data, 0.243 forward
[INFO] - 02-27 21:15:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:15:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0030)
[INFO] - 02-27 21:15:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5898 (0.5867)
[INFO] - 02-27 21:15:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5421 (-287.5367)
[INFO] - 02-27 21:15:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7749 (31.7841)
[INFO] - 02-27 21:15:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7460 (371.2092)
[INFO] - 02-27 21:15:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:15:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9677)
[INFO] - 02-27 21:15:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:15:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:15:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:15:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:15:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:15:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:15:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:15:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.256
[INFO] - 02-27 21:15:10 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.256
[INFO] - 02-27 21:15:10 - [main.summary_metrics:168]: Epoch 355/500 - Test Results:
{'auc': 0.8466466799342286,
 'f1': 0.41125420875420876,
 'loss': 0.4377290323707746,
 'ndcg': 0.7207291967132664,
 'precision': 0.55,
 'recall': 0.32887342436974787}
[INFO] - 02-27 21:15:10 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[355] Complete. Time taken: 00:00:27.458
[INFO] - 02-27 21:15:10 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:15:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:15:10 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:15:10 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:15:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:15:10 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3018, 2203, 2208, 1]
[INFO] - 02-27 21:15:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:15:17 - [main.backward:225]: Epoch 356/500 - Iteration 25/95 - Time 0.291 batch, 0.048 data, 0.266 forward
[INFO] - 02-27 21:15:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:15:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0030)
[INFO] - 02-27 21:15:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5910 (0.5868)
[INFO] - 02-27 21:15:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5428 (-287.5436)
[INFO] - 02-27 21:15:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7713 (31.8012)
[INFO] - 02-27 21:15:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0488 (371.3145)
[INFO] - 02-27 21:15:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:15:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9692)
[INFO] - 02-27 21:15:31 - [main.backward:225]: Epoch 356/500 - Iteration 75/95 - Time 0.283 batch, 0.035 data, 0.256 forward
[INFO] - 02-27 21:15:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:15:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0032)
[INFO] - 02-27 21:15:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5849 (0.5869)
[INFO] - 02-27 21:15:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5494 (-287.5463)
[INFO] - 02-27 21:15:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6952 (31.7838)
[INFO] - 02-27 21:15:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5029 (371.1454)
[INFO] - 02-27 21:15:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:15:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9630)
[INFO] - 02-27 21:15:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:15:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:15:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:15:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.206
[INFO] - 02-27 21:15:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.208
[INFO] - 02-27 21:15:39 - [main.summary_metrics:168]: Epoch 356/500 - Test Results:
{'auc': 0.8463642094092538,
 'f1': 0.41385837542087545,
 'loss': 0.4370339156097922,
 'ndcg': 0.7193838729504017,
 'precision': 0.553125,
 'recall': 0.3311055672268908}
[INFO] - 02-27 21:15:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[356] Complete. Time taken: 00:00:29.317
[INFO] - 02-27 21:15:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:15:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:15:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:15:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:15:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:15:39 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3052, 2196, 2188, 1]
[INFO] - 02-27 21:15:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:15:47 - [main.backward:225]: Epoch 357/500 - Iteration 30/95 - Time 0.278 batch, 0.043 data, 0.253 forward
[INFO] - 02-27 21:15:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:15:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0031)
[INFO] - 02-27 21:15:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5816 (0.5861)
[INFO] - 02-27 21:15:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5463 (-287.5464)
[INFO] - 02-27 21:15:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7619 (31.7900)
[INFO] - 02-27 21:15:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7191 (371.2244)
[INFO] - 02-27 21:15:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:15:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9678)
[INFO] - 02-27 21:16:00 - [main.backward:225]: Epoch 357/500 - Iteration 80/95 - Time 0.269 batch, 0.032 data, 0.243 forward
[INFO] - 02-27 21:16:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:16:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0032)
[INFO] - 02-27 21:16:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5858)
[INFO] - 02-27 21:16:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5506 (-287.5503)
[INFO] - 02-27 21:16:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7835 (31.8135)
[INFO] - 02-27 21:16:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2819 (371.4050)
[INFO] - 02-27 21:16:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:16:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9636)
[INFO] - 02-27 21:16:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:16:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:16:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:16:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:16:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:16:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:16:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:16:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.422
[INFO] - 02-27 21:16:07 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.423
[INFO] - 02-27 21:16:07 - [main.summary_metrics:168]: Epoch 357/500 - Test Results:
{'auc': 0.8461259726929987,
 'f1': 0.4163583754208754,
 'loss': 0.43801973335438527,
 'ndcg': 0.7205847719843661,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 21:16:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[357] Complete. Time taken: 00:00:28.032
[INFO] - 02-27 21:16:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:16:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:16:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:16:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:16:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:16:07 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2195, 2231, 1]
[INFO] - 02-27 21:16:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:16:17 - [main.backward:225]: Epoch 358/500 - Iteration 35/95 - Time 0.289 batch, 0.043 data, 0.262 forward
[INFO] - 02-27 21:16:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0032)
[INFO] - 02-27 21:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5770 (0.5859)
[INFO] - 02-27 21:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5469 (-287.5501)
[INFO] - 02-27 21:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7773 (31.8001)
[INFO] - 02-27 21:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4614 (371.1905)
[INFO] - 02-27 21:16:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:16:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9661)
[INFO] - 02-27 21:16:30 - [main.backward:225]: Epoch 358/500 - Iteration 85/95 - Time 0.277 batch, 0.033 data, 0.251 forward
[INFO] - 02-27 21:16:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0031)
[INFO] - 02-27 21:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5861)
[INFO] - 02-27 21:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5425 (-287.5450)
[INFO] - 02-27 21:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8883 (31.8009)
[INFO] - 02-27 21:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5229 (371.1073)
[INFO] - 02-27 21:16:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:16:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9652)
[INFO] - 02-27 21:16:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:16:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:16:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:16:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:16:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:16:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:16:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:16:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.295
[INFO] - 02-27 21:16:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.296
[INFO] - 02-27 21:16:35 - [main.summary_metrics:168]: Epoch 358/500 - Test Results:
{'auc': 0.8459422632410807,
 'f1': 0.4090435606060606,
 'loss': 0.4382952088226745,
 'ndcg': 0.7201710970778321,
 'precision': 0.546875,
 'recall': 0.3271839985994398}
[INFO] - 02-27 21:16:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[358] Complete. Time taken: 00:00:28.472
[INFO] - 02-27 21:16:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:16:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:16:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:16:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:16:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:16:35 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3010, 2197, 2238, 1]
[INFO] - 02-27 21:16:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:16:46 - [main.backward:225]: Epoch 359/500 - Iteration 40/95 - Time 0.275 batch, 0.039 data, 0.250 forward
[INFO] - 02-27 21:16:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0030)
[INFO] - 02-27 21:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5816 (0.5864)
[INFO] - 02-27 21:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5444 (-287.5445)
[INFO] - 02-27 21:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7548 (31.7881)
[INFO] - 02-27 21:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4867 (371.1583)
[INFO] - 02-27 21:16:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:16:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9667)
[INFO] - 02-27 21:16:59 - [main.backward:225]: Epoch 359/500 - Iteration 90/95 - Time 0.268 batch, 0.032 data, 0.242 forward
[INFO] - 02-27 21:16:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:16:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0031)
[INFO] - 02-27 21:16:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5946 (0.5871)
[INFO] - 02-27 21:16:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5446 (-287.5430)
[INFO] - 02-27 21:16:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8061 (31.7817)
[INFO] - 02-27 21:16:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1532 (371.1038)
[INFO] - 02-27 21:16:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:16:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9688)
[INFO] - 02-27 21:17:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:17:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:17:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:17:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:17:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:17:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:17:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:17:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.220
[INFO] - 02-27 21:17:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.221
[INFO] - 02-27 21:17:03 - [main.summary_metrics:168]: Epoch 359/500 - Test Results:
{'auc': 0.8466328715309653,
 'f1': 0.39949494949494946,
 'loss': 0.4386392054083017,
 'ndcg': 0.719887505621576,
 'precision': 0.534375,
 'recall': 0.319437149859944}
[INFO] - 02-27 21:17:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[359] Complete. Time taken: 00:00:27.655
[INFO] - 02-27 21:17:03 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:17:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:17:03 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:17:03 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:17:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:17:03 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3068, 2196, 2224, 1]
[INFO] - 02-27 21:17:04 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:17:15 - [main.backward:225]: Epoch 360/500 - Iteration 45/95 - Time 0.275 batch, 0.038 data, 0.249 forward
[INFO] - 02-27 21:17:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0028)
[INFO] - 02-27 21:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5844 (0.5861)
[INFO] - 02-27 21:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5444)
[INFO] - 02-27 21:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7108 (31.7743)
[INFO] - 02-27 21:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1833 (370.9538)
[INFO] - 02-27 21:17:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:17:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9719)
[INFO] - 02-27 21:17:29 - [main.backward:225]: Epoch 360/500 - Iteration 0/95 - Time 0.274 batch, 0.033 data, 0.247 forward
[INFO] - 02-27 21:17:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0029)
[INFO] - 02-27 21:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5816 (0.5855)
[INFO] - 02-27 21:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5468)
[INFO] - 02-27 21:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8211 (31.7926)
[INFO] - 02-27 21:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4320 (371.3115)
[INFO] - 02-27 21:17:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:17:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9688)
[INFO] - 02-27 21:17:29 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:17:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:17:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:17:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:17:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:17:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:17:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:17:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.089
[INFO] - 02-27 21:17:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.089
[INFO] - 02-27 21:17:31 - [main.summary_metrics:168]: Epoch 360/500 - Test Results:
{'auc': 0.8468695332912577,
 'f1': 0.4116477272727273,
 'loss': 0.4368743438234097,
 'ndcg': 0.7222726943216886,
 'precision': 0.55,
 'recall': 0.32941614145658266}
[INFO] - 02-27 21:17:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[360] Complete. Time taken: 00:00:28.101
[INFO] - 02-27 21:17:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:17:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:17:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:17:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:17:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:17:31 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3064, 2176, 2219, 1]
[INFO] - 02-27 21:17:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:17:45 - [main.backward:225]: Epoch 361/500 - Iteration 50/95 - Time 0.285 batch, 0.040 data, 0.258 forward
[INFO] - 02-27 21:17:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:17:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0031)
[INFO] - 02-27 21:17:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5862 (0.5858)
[INFO] - 02-27 21:17:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5536 (-287.5513)
[INFO] - 02-27 21:17:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7142 (31.7999)
[INFO] - 02-27 21:17:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5920 (371.0559)
[INFO] - 02-27 21:17:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:17:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9672)
[INFO] - 02-27 21:17:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:17:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:17:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:17:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:17:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:17:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:17:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:18:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.341
[INFO] - 02-27 21:18:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.342
[INFO] - 02-27 21:18:00 - [main.summary_metrics:168]: Epoch 361/500 - Test Results:
{'auc': 0.8472929586663096,
 'f1': 0.4186731902356903,
 'loss': 0.43728033299337943,
 'ndcg': 0.7251967649313852,
 'precision': 0.559375,
 'recall': 0.33502713585434174}
[INFO] - 02-27 21:18:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[361] Complete. Time taken: 00:00:28.399
[INFO] - 02-27 21:18:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:18:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:18:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:18:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:18:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:18:00 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3038, 2198, 2219, 1]
[INFO] - 02-27 21:18:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:18:01 - [main.backward:225]: Epoch 362/500 - Iteration 5/95 - Time 0.376 batch, 0.146 data, 0.350 forward
[INFO] - 02-27 21:18:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0030)
[INFO] - 02-27 21:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5835 (0.5853)
[INFO] - 02-27 21:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5515 (-287.5521)
[INFO] - 02-27 21:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8463 (31.8058)
[INFO] - 02-27 21:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5571 (371.1364)
[INFO] - 02-27 21:18:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:18:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9672)
[INFO] - 02-27 21:18:14 - [main.backward:225]: Epoch 362/500 - Iteration 55/95 - Time 0.270 batch, 0.037 data, 0.245 forward
[INFO] - 02-27 21:18:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:18:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0031)
[INFO] - 02-27 21:18:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5807 (0.5858)
[INFO] - 02-27 21:18:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5499 (-287.5505)
[INFO] - 02-27 21:18:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7900 (31.8053)
[INFO] - 02-27 21:18:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4471 (371.2740)
[INFO] - 02-27 21:18:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:18:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9658)
[INFO] - 02-27 21:18:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:18:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:18:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:18:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:18:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:18:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:18:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:18:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.495
[INFO] - 02-27 21:18:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.496
[INFO] - 02-27 21:18:27 - [main.summary_metrics:168]: Epoch 362/500 - Test Results:
{'auc': 0.848556339937936,
 'f1': 0.42609217171717173,
 'loss': 0.4359335030511158,
 'ndcg': 0.7256868959310092,
 'precision': 0.56875,
 'recall': 0.34118084733893556}
[INFO] - 02-27 21:18:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[362] Complete. Time taken: 00:00:27.940
[INFO] - 02-27 21:18:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:18:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:18:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:18:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:18:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:18:27 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2187, 2203, 1]
[INFO] - 02-27 21:18:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:18:31 - [main.backward:225]: Epoch 363/500 - Iteration 10/95 - Time 0.346 batch, 0.091 data, 0.317 forward
[INFO] - 02-27 21:18:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:18:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0030)
[INFO] - 02-27 21:18:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5887 (0.5867)
[INFO] - 02-27 21:18:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5489 (-287.5502)
[INFO] - 02-27 21:18:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8830 (31.8010)
[INFO] - 02-27 21:18:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0544 (371.1076)
[INFO] - 02-27 21:18:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:18:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9667)
[INFO] - 02-27 21:18:45 - [main.backward:225]: Epoch 363/500 - Iteration 60/95 - Time 0.295 batch, 0.039 data, 0.266 forward
[INFO] - 02-27 21:18:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:18:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0034)
[INFO] - 02-27 21:18:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5900 (0.5862)
[INFO] - 02-27 21:18:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5469 (-287.5452)
[INFO] - 02-27 21:18:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7888 (31.8035)
[INFO] - 02-27 21:18:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0240 (371.1591)
[INFO] - 02-27 21:18:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:18:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9609)
[INFO] - 02-27 21:18:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:18:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:18:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:18:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:18:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:18:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:18:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:18:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.512
[INFO] - 02-27 21:18:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.513
[INFO] - 02-27 21:18:57 - [main.summary_metrics:168]: Epoch 363/500 - Test Results:
{'auc': 0.8479282948473507,
 'f1': 0.42340698653198655,
 'loss': 0.4372794546301624,
 'ndcg': 0.7206753379302665,
 'precision': 0.565625,
 'recall': 0.33885241596638654}
[INFO] - 02-27 21:18:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[363] Complete. Time taken: 00:00:30.004
[INFO] - 02-27 21:18:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:18:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:18:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:18:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:18:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:18:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3040, 2197, 2206, 1]
[INFO] - 02-27 21:18:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:19:02 - [main.backward:225]: Epoch 364/500 - Iteration 15/95 - Time 0.315 batch, 0.065 data, 0.289 forward
[INFO] - 02-27 21:19:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:19:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0030)
[INFO] - 02-27 21:19:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5889 (0.5860)
[INFO] - 02-27 21:19:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5448)
[INFO] - 02-27 21:19:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8071 (31.8065)
[INFO] - 02-27 21:19:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0423 (371.1420)
[INFO] - 02-27 21:19:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:19:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9663)
[INFO] - 02-27 21:19:16 - [main.backward:225]: Epoch 364/500 - Iteration 65/95 - Time 0.289 batch, 0.036 data, 0.262 forward
[INFO] - 02-27 21:19:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:19:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0031)
[INFO] - 02-27 21:19:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5808 (0.5863)
[INFO] - 02-27 21:19:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5480 (-287.5478)
[INFO] - 02-27 21:19:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8794 (31.8065)
[INFO] - 02-27 21:19:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6917 (371.2049)
[INFO] - 02-27 21:19:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:19:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9675)
[INFO] - 02-27 21:19:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:19:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:19:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:19:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:19:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:19:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:19:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:19:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.382
[INFO] - 02-27 21:19:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.383
[INFO] - 02-27 21:19:27 - [main.summary_metrics:168]: Epoch 364/500 - Test Results:
{'auc': 0.8473822123212029,
 'f1': 0.4186731902356903,
 'loss': 0.43750318180942027,
 'ndcg': 0.7202499240919642,
 'precision': 0.559375,
 'recall': 0.33502713585434174}
[INFO] - 02-27 21:19:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[364] Complete. Time taken: 00:00:29.620
[INFO] - 02-27 21:19:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:19:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:19:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:19:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:19:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:19:27 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3029, 2206, 2224, 1]
[INFO] - 02-27 21:19:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:19:33 - [main.backward:225]: Epoch 365/500 - Iteration 20/95 - Time 0.309 batch, 0.062 data, 0.282 forward
[INFO] - 02-27 21:19:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0031)
[INFO] - 02-27 21:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5888 (0.5858)
[INFO] - 02-27 21:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5367 (-287.5457)
[INFO] - 02-27 21:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7518 (31.8012)
[INFO] - 02-27 21:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9243 (371.3570)
[INFO] - 02-27 21:19:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:19:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9672)
[INFO] - 02-27 21:19:47 - [main.backward:225]: Epoch 365/500 - Iteration 70/95 - Time 0.288 batch, 0.038 data, 0.260 forward
[INFO] - 02-27 21:19:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:19:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0032)
[INFO] - 02-27 21:19:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5856)
[INFO] - 02-27 21:19:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5401 (-287.5398)
[INFO] - 02-27 21:19:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6980 (31.7804)
[INFO] - 02-27 21:19:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8972 (371.1854)
[INFO] - 02-27 21:19:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:19:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9659)
[INFO] - 02-27 21:19:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:19:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:19:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:19:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:19:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:19:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:19:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:19:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.222
[INFO] - 02-27 21:19:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.223
[INFO] - 02-27 21:19:57 - [main.summary_metrics:168]: Epoch 365/500 - Test Results:
{'auc': 0.8475572876822297,
 'f1': 0.40701809764309765,
 'loss': 0.43733030491546676,
 'ndcg': 0.7201738712351331,
 'precision': 0.54375,
 'recall': 0.3257396708683474}
[INFO] - 02-27 21:19:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[365] Complete. Time taken: 00:00:29.462
[INFO] - 02-27 21:19:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:19:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:19:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:19:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:19:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:19:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3073, 2196, 2200, 1]
[INFO] - 02-27 21:19:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:20:04 - [main.backward:225]: Epoch 366/500 - Iteration 25/95 - Time 0.284 batch, 0.051 data, 0.257 forward
[INFO] - 02-27 21:20:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:20:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0032)
[INFO] - 02-27 21:20:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5855)
[INFO] - 02-27 21:20:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5479 (-287.5462)
[INFO] - 02-27 21:20:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7581 (31.7859)
[INFO] - 02-27 21:20:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9563 (371.1528)
[INFO] - 02-27 21:20:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:20:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9631)
[INFO] - 02-27 21:20:17 - [main.backward:225]: Epoch 366/500 - Iteration 75/95 - Time 0.277 batch, 0.035 data, 0.250 forward
[INFO] - 02-27 21:20:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0030)
[INFO] - 02-27 21:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5785 (0.5852)
[INFO] - 02-27 21:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5463)
[INFO] - 02-27 21:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7611 (31.8116)
[INFO] - 02-27 21:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9635 (371.2156)
[INFO] - 02-27 21:20:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:20:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9663)
[INFO] - 02-27 21:20:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:20:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:20:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:20:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:20:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:20:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:20:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:20:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.249
[INFO] - 02-27 21:20:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.249
[INFO] - 02-27 21:20:25 - [main.summary_metrics:168]: Epoch 366/500 - Test Results:
{'auc': 0.847508846185533,
 'f1': 0.41172874579124574,
 'loss': 0.4372604751889705,
 'ndcg': 0.7237494827543629,
 'precision': 0.55,
 'recall': 0.3295124299719888}
[INFO] - 02-27 21:20:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[366] Complete. Time taken: 00:00:28.491
[INFO] - 02-27 21:20:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:20:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:20:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:20:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:20:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:20:25 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3071, 2197, 2207, 1]
[INFO] - 02-27 21:20:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:20:34 - [main.backward:225]: Epoch 367/500 - Iteration 30/95 - Time 0.290 batch, 0.049 data, 0.263 forward
[INFO] - 02-27 21:20:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:20:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0029)
[INFO] - 02-27 21:20:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5924 (0.5862)
[INFO] - 02-27 21:20:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5515 (-287.5485)
[INFO] - 02-27 21:20:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7968 (31.7772)
[INFO] - 02-27 21:20:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5756 (371.0050)
[INFO] - 02-27 21:20:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:20:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9683)
[INFO] - 02-27 21:20:48 - [main.backward:225]: Epoch 367/500 - Iteration 80/95 - Time 0.283 batch, 0.036 data, 0.255 forward
[INFO] - 02-27 21:20:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0031)
[INFO] - 02-27 21:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5823 (0.5856)
[INFO] - 02-27 21:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5525 (-287.5504)
[INFO] - 02-27 21:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7920 (31.7809)
[INFO] - 02-27 21:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0869 (371.3789)
[INFO] - 02-27 21:20:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9652)
[INFO] - 02-27 21:20:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:20:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:20:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:20:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:20:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:20:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:20:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:20:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.344
[INFO] - 02-27 21:20:54 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.345
[INFO] - 02-27 21:20:54 - [main.summary_metrics:168]: Epoch 367/500 - Test Results:
{'auc': 0.8472411992370479,
 'f1': 0.41877735690235696,
 'loss': 0.43706180078606605,
 'ndcg': 0.7248737639283956,
 'precision': 0.559375,
 'recall': 0.33517594537815126}
[INFO] - 02-27 21:20:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[367] Complete. Time taken: 00:00:29.213
[INFO] - 02-27 21:20:54 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:20:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:20:54 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:20:54 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:20:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:20:54 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3042, 2208, 2206, 1]
[INFO] - 02-27 21:20:55 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:21:05 - [main.backward:225]: Epoch 368/500 - Iteration 35/95 - Time 0.299 batch, 0.045 data, 0.270 forward
[INFO] - 02-27 21:21:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:21:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0032)
[INFO] - 02-27 21:21:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5804 (0.5866)
[INFO] - 02-27 21:21:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5497 (-287.5514)
[INFO] - 02-27 21:21:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8137 (31.7977)
[INFO] - 02-27 21:21:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3822 (371.2279)
[INFO] - 02-27 21:21:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:21:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9652)
[INFO] - 02-27 21:21:19 - [main.backward:225]: Epoch 368/500 - Iteration 85/95 - Time 0.289 batch, 0.035 data, 0.260 forward
[INFO] - 02-27 21:21:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:21:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0033)
[INFO] - 02-27 21:21:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5767 (0.5855)
[INFO] - 02-27 21:21:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5493 (-287.5510)
[INFO] - 02-27 21:21:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8921 (31.8035)
[INFO] - 02-27 21:21:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4800 (371.2260)
[INFO] - 02-27 21:21:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:21:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9655)
[INFO] - 02-27 21:21:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:21:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:21:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:21:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:21:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:21:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:21:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:21:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.301
[INFO] - 02-27 21:21:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.302
[INFO] - 02-27 21:21:24 - [main.summary_metrics:168]: Epoch 368/500 - Test Results:
{'auc': 0.8466268296534301,
 'f1': 0.42561763468013464,
 'loss': 0.4375863091770046,
 'ndcg': 0.7198286388625836,
 'precision': 0.5687500000000001,
 'recall': 0.34054184173669466}
[INFO] - 02-27 21:21:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[368] Complete. Time taken: 00:00:29.447
[INFO] - 02-27 21:21:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:21:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:21:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:21:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:21:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:21:24 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2198, 2208, 1]
[INFO] - 02-27 21:21:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:21:35 - [main.backward:225]: Epoch 369/500 - Iteration 40/95 - Time 0.294 batch, 0.047 data, 0.265 forward
[INFO] - 02-27 21:21:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0033)
[INFO] - 02-27 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5807 (0.5864)
[INFO] - 02-27 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5500 (-287.5491)
[INFO] - 02-27 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8057 (31.7865)
[INFO] - 02-27 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3569 (371.1727)
[INFO] - 02-27 21:21:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:21:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9645)
[INFO] - 02-27 21:21:48 - [main.backward:225]: Epoch 369/500 - Iteration 90/95 - Time 0.270 batch, 0.034 data, 0.244 forward
[INFO] - 02-27 21:21:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:21:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0029)
[INFO] - 02-27 21:21:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5831 (0.5854)
[INFO] - 02-27 21:21:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5445 (-287.5474)
[INFO] - 02-27 21:21:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7653 (31.7863)
[INFO] - 02-27 21:21:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4096 (371.0936)
[INFO] - 02-27 21:21:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:21:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9666)
[INFO] - 02-27 21:21:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:21:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:21:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:21:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:21:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:21:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:21:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:21:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.387
[INFO] - 02-27 21:21:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.387
[INFO] - 02-27 21:21:52 - [main.summary_metrics:168]: Epoch 369/500 - Test Results:
{'auc': 0.8463886029902157,
 'f1': 0.40015467171717173,
 'loss': 0.43791594326030603,
 'ndcg': 0.71709835744966,
 'precision': 0.534375,
 'recall': 0.32032125350140056}
[INFO] - 02-27 21:21:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[369] Complete. Time taken: 00:00:27.961
[INFO] - 02-27 21:21:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:21:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:21:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:21:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:21:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:21:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3052, 2187, 2204, 1]
[INFO] - 02-27 21:21:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:22:05 - [main.backward:225]: Epoch 370/500 - Iteration 45/95 - Time 0.298 batch, 0.040 data, 0.270 forward
[INFO] - 02-27 21:22:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:22:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0030)
[INFO] - 02-27 21:22:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5807 (0.5857)
[INFO] - 02-27 21:22:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5471)
[INFO] - 02-27 21:22:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7787 (31.7902)
[INFO] - 02-27 21:22:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0263 (371.0510)
[INFO] - 02-27 21:22:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:22:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9697)
[INFO] - 02-27 21:22:20 - [main.backward:225]: Epoch 370/500 - Iteration 0/95 - Time 0.294 batch, 0.034 data, 0.266 forward
[INFO] - 02-27 21:22:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:22:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0028)
[INFO] - 02-27 21:22:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5878 (0.5866)
[INFO] - 02-27 21:22:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5463 (-287.5474)
[INFO] - 02-27 21:22:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9014 (31.7936)
[INFO] - 02-27 21:22:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6027 (371.1716)
[INFO] - 02-27 21:22:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:22:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9728)
[INFO] - 02-27 21:22:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:22:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:22:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:22:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:22:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:22:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:22:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:22:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.284
[INFO] - 02-27 21:22:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.285
[INFO] - 02-27 21:22:22 - [main.summary_metrics:168]: Epoch 370/500 - Test Results:
{'auc': 0.8474145766149597,
 'f1': 0.4163583754208754,
 'loss': 0.43776517837075957,
 'ndcg': 0.7203636137624999,
 'precision': 0.5562499999999999,
 'recall': 0.3331889005602241}
[INFO] - 02-27 21:22:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[370] Complete. Time taken: 00:00:30.208
[INFO] - 02-27 21:22:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:22:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:22:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:22:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:22:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:22:22 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3034, 2215, 2200, 1]
[INFO] - 02-27 21:22:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:22:36 - [main.backward:225]: Epoch 371/500 - Iteration 50/95 - Time 0.274 batch, 0.038 data, 0.248 forward
[INFO] - 02-27 21:22:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:22:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0032)
[INFO] - 02-27 21:22:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5843 (0.5874)
[INFO] - 02-27 21:22:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5506 (-287.5479)
[INFO] - 02-27 21:22:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7330 (31.7807)
[INFO] - 02-27 21:22:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2644 (371.1366)
[INFO] - 02-27 21:22:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:22:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9623)
[INFO] - 02-27 21:22:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:22:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:22:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:22:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:22:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:22:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:22:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:22:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.170
[INFO] - 02-27 21:22:50 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.172
[INFO] - 02-27 21:22:50 - [main.summary_metrics:168]: Epoch 371/500 - Test Results:
{'auc': 0.8466573473752246,
 'f1': 0.40691393097643097,
 'loss': 0.43820805148467246,
 'ndcg': 0.721148322037488,
 'precision': 0.5437500000000001,
 'recall': 0.32559086134453785}
[INFO] - 02-27 21:22:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[371] Complete. Time taken: 00:00:27.837
[INFO] - 02-27 21:22:50 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:22:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:22:50 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:22:50 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:22:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:22:50 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2210, 2212, 1]
[INFO] - 02-27 21:22:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:22:52 - [main.backward:225]: Epoch 372/500 - Iteration 5/95 - Time 0.380 batch, 0.145 data, 0.353 forward
[INFO] - 02-27 21:22:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:22:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 21:22:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5918 (0.5865)
[INFO] - 02-27 21:22:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5502 (-287.5500)
[INFO] - 02-27 21:22:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7334 (31.7939)
[INFO] - 02-27 21:22:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.6538 (371.1614)
[INFO] - 02-27 21:22:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:22:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9678)
[INFO] - 02-27 21:23:05 - [main.backward:225]: Epoch 372/500 - Iteration 55/95 - Time 0.272 batch, 0.037 data, 0.246 forward
[INFO] - 02-27 21:23:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:23:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0031)
[INFO] - 02-27 21:23:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5858 (0.5870)
[INFO] - 02-27 21:23:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5478)
[INFO] - 02-27 21:23:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8433 (31.7927)
[INFO] - 02-27 21:23:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2974 (371.1455)
[INFO] - 02-27 21:23:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:23:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9669)
[INFO] - 02-27 21:23:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:23:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:23:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:23:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:23:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:23:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:23:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:23:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.481
[INFO] - 02-27 21:23:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.482
[INFO] - 02-27 21:23:18 - [main.summary_metrics:168]: Epoch 372/500 - Test Results:
{'auc': 0.8467923034409842,
 'f1': 0.41635837542087545,
 'loss': 0.43878435975535934,
 'ndcg': 0.7210892275525933,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 21:23:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[372] Complete. Time taken: 00:00:28.225
[INFO] - 02-27 21:23:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:23:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:23:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:23:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:23:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:23:18 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3039, 2202, 2205, 1]
[INFO] - 02-27 21:23:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:23:21 - [main.backward:225]: Epoch 373/500 - Iteration 10/95 - Time 0.342 batch, 0.095 data, 0.314 forward
[INFO] - 02-27 21:23:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:23:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0031)
[INFO] - 02-27 21:23:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5825 (0.5857)
[INFO] - 02-27 21:23:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5499)
[INFO] - 02-27 21:23:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7561 (31.7874)
[INFO] - 02-27 21:23:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4957 (370.9896)
[INFO] - 02-27 21:23:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:23:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9647)
[INFO] - 02-27 21:23:35 - [main.backward:225]: Epoch 373/500 - Iteration 60/95 - Time 0.277 batch, 0.037 data, 0.250 forward
[INFO] - 02-27 21:23:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:23:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0032)
[INFO] - 02-27 21:23:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5955 (0.5865)
[INFO] - 02-27 21:23:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5499 (-287.5497)
[INFO] - 02-27 21:23:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8020 (31.7952)
[INFO] - 02-27 21:23:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9108 (371.1664)
[INFO] - 02-27 21:23:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:23:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9631)
[INFO] - 02-27 21:23:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:23:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:23:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:23:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:23:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:23:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:23:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:23:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.270
[INFO] - 02-27 21:23:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.271
[INFO] - 02-27 21:23:46 - [main.summary_metrics:168]: Epoch 373/500 - Test Results:
{'auc': 0.8445690193969746,
 'f1': 0.4092287457912458,
 'loss': 0.43873490571100227,
 'ndcg': 0.7216718008972159,
 'precision': 0.546875,
 'recall': 0.32742909663865544}
[INFO] - 02-27 21:23:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[373] Complete. Time taken: 00:00:28.241
[INFO] - 02-27 21:23:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:23:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:23:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:23:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:23:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:23:46 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3072, 2194, 2189, 1]
[INFO] - 02-27 21:23:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:23:51 - [main.backward:225]: Epoch 374/500 - Iteration 15/95 - Time 0.309 batch, 0.073 data, 0.279 forward
[INFO] - 02-27 21:23:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:23:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0029)
[INFO] - 02-27 21:23:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5877 (0.5853)
[INFO] - 02-27 21:23:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5486)
[INFO] - 02-27 21:23:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7139 (31.7959)
[INFO] - 02-27 21:23:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1979 (371.1965)
[INFO] - 02-27 21:23:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:23:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9681)
[INFO] - 02-27 21:24:05 - [main.backward:225]: Epoch 374/500 - Iteration 65/95 - Time 0.287 batch, 0.039 data, 0.258 forward
[INFO] - 02-27 21:24:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:24:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0029)
[INFO] - 02-27 21:24:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5907 (0.5869)
[INFO] - 02-27 21:24:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5467)
[INFO] - 02-27 21:24:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7658 (31.7878)
[INFO] - 02-27 21:24:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2440 (371.0542)
[INFO] - 02-27 21:24:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:24:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9697)
[INFO] - 02-27 21:24:13 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:24:13 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:24:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:24:13 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:24:13 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:24:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:24:13 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:24:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.442
[INFO] - 02-27 21:24:16 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.443
[INFO] - 02-27 21:24:16 - [main.summary_metrics:168]: Epoch 374/500 - Test Results:
{'auc': 0.8475668607516536,
 'f1': 0.42098800505050504,
 'loss': 0.4370602028212147,
 'ndcg': 0.7263768923785656,
 'precision': 0.5625,
 'recall': 0.3368653711484594}
[INFO] - 02-27 21:24:16 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[374] Complete. Time taken: 00:00:29.406
[INFO] - 02-27 21:24:16 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:24:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:24:16 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:24:16 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:24:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:24:16 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2208, 2194, 1]
[INFO] - 02-27 21:24:16 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:24:22 - [main.backward:225]: Epoch 375/500 - Iteration 20/95 - Time 0.311 batch, 0.062 data, 0.283 forward
[INFO] - 02-27 21:24:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:24:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0031)
[INFO] - 02-27 21:24:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5882 (0.5852)
[INFO] - 02-27 21:24:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5522 (-287.5483)
[INFO] - 02-27 21:24:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7513 (31.8014)
[INFO] - 02-27 21:24:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8412 (371.2436)
[INFO] - 02-27 21:24:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:24:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9677)
[INFO] - 02-27 21:24:36 - [main.backward:225]: Epoch 375/500 - Iteration 70/95 - Time 0.290 batch, 0.039 data, 0.261 forward
[INFO] - 02-27 21:24:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:24:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0032)
[INFO] - 02-27 21:24:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5830 (0.5852)
[INFO] - 02-27 21:24:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5498 (-287.5501)
[INFO] - 02-27 21:24:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9177 (31.7930)
[INFO] - 02-27 21:24:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6841 (371.0914)
[INFO] - 02-27 21:24:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:24:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9663)
[INFO] - 02-27 21:24:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:24:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:24:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:24:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:24:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:24:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:24:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:24:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.305
[INFO] - 02-27 21:24:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.306
[INFO] - 02-27 21:24:45 - [main.summary_metrics:168]: Epoch 375/500 - Test Results:
{'auc': 0.8460952043194728,
 'f1': 0.42740635521885517,
 'loss': 0.4373282800974244,
 'ndcg': 0.7226903332704864,
 'precision': 0.571875,
 'recall': 0.3416141456582633}
[INFO] - 02-27 21:24:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[375] Complete. Time taken: 00:00:29.236
[INFO] - 02-27 21:24:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:24:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:24:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:24:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:24:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:24:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3069, 2203, 2199, 1]
[INFO] - 02-27 21:24:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:24:52 - [main.backward:225]: Epoch 376/500 - Iteration 25/95 - Time 0.291 batch, 0.049 data, 0.264 forward
[INFO] - 02-27 21:24:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:24:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0030)
[INFO] - 02-27 21:24:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5818 (0.5860)
[INFO] - 02-27 21:24:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5496 (-287.5487)
[INFO] - 02-27 21:24:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8022 (31.8036)
[INFO] - 02-27 21:24:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8454 (371.1911)
[INFO] - 02-27 21:24:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:24:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9670)
[INFO] - 02-27 21:25:05 - [main.backward:225]: Epoch 376/500 - Iteration 75/95 - Time 0.272 batch, 0.035 data, 0.245 forward
[INFO] - 02-27 21:25:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:25:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0031)
[INFO] - 02-27 21:25:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5875 (0.5853)
[INFO] - 02-27 21:25:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5474 (-287.5475)
[INFO] - 02-27 21:25:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8481 (31.7824)
[INFO] - 02-27 21:25:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.8002 (371.4950)
[INFO] - 02-27 21:25:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:25:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9648)
[INFO] - 02-27 21:25:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:25:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:25:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:25:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:25:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:25:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:25:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:25:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.040
[INFO] - 02-27 21:25:12 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.040
[INFO] - 02-27 21:25:12 - [main.summary_metrics:168]: Epoch 376/500 - Test Results:
{'auc': 0.8471423876535908,
 'f1': 0.4163583754208754,
 'loss': 0.4375316400136866,
 'ndcg': 0.7227160704401834,
 'precision': 0.5562499999999999,
 'recall': 0.3331889005602241}
[INFO] - 02-27 21:25:12 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[376] Complete. Time taken: 00:00:27.361
[INFO] - 02-27 21:25:12 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:25:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:25:12 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:25:12 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:25:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:25:12 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3073, 2185, 2203, 1]
[INFO] - 02-27 21:25:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:25:20 - [main.backward:225]: Epoch 377/500 - Iteration 30/95 - Time 0.264 batch, 0.046 data, 0.239 forward
[INFO] - 02-27 21:25:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:25:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0029)
[INFO] - 02-27 21:25:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5877 (0.5861)
[INFO] - 02-27 21:25:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5414 (-287.5453)
[INFO] - 02-27 21:25:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8072 (31.8006)
[INFO] - 02-27 21:25:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6490 (371.2445)
[INFO] - 02-27 21:25:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:25:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9708)
[INFO] - 02-27 21:25:34 - [main.backward:225]: Epoch 377/500 - Iteration 80/95 - Time 0.267 batch, 0.034 data, 0.241 forward
[INFO] - 02-27 21:25:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:25:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0030)
[INFO] - 02-27 21:25:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5959 (0.5861)
[INFO] - 02-27 21:25:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5207 (-287.5323)
[INFO] - 02-27 21:25:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9019 (31.8278)
[INFO] - 02-27 21:25:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5806 (371.3978)
[INFO] - 02-27 21:25:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:25:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9678)
[INFO] - 02-27 21:25:38 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:25:38 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:25:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:25:38 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:25:38 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:25:38 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:25:38 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:25:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.299
[INFO] - 02-27 21:25:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.300
[INFO] - 02-27 21:25:40 - [main.summary_metrics:168]: Epoch 377/500 - Test Results:
{'auc': 0.8466053727250704,
 'f1': 0.4067287457912458,
 'loss': 0.437178281244481,
 'ndcg': 0.7181309001629612,
 'precision': 0.54375,
 'recall': 0.3253457633053221}
[INFO] - 02-27 21:25:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[377] Complete. Time taken: 00:00:27.883
[INFO] - 02-27 21:25:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:25:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:25:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:25:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:25:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:25:40 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3033, 2208, 2209, 1]
[INFO] - 02-27 21:25:41 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:25:50 - [main.backward:225]: Epoch 378/500 - Iteration 35/95 - Time 0.281 batch, 0.045 data, 0.256 forward
[INFO] - 02-27 21:25:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0030)
[INFO] - 02-27 21:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5868 (0.5855)
[INFO] - 02-27 21:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5142 (-287.5194)
[INFO] - 02-27 21:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7945 (31.8041)
[INFO] - 02-27 21:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.0800 (371.0084)
[INFO] - 02-27 21:25:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:25:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9684)
[INFO] - 02-27 21:26:03 - [main.backward:225]: Epoch 378/500 - Iteration 85/95 - Time 0.273 batch, 0.034 data, 0.247 forward
[INFO] - 02-27 21:26:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:26:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0031)
[INFO] - 02-27 21:26:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5828 (0.5854)
[INFO] - 02-27 21:26:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5219 (-287.5171)
[INFO] - 02-27 21:26:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6902 (31.7928)
[INFO] - 02-27 21:26:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9017 (371.1200)
[INFO] - 02-27 21:26:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:26:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9658)
[INFO] - 02-27 21:26:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:26:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:26:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:26:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:26:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:26:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:26:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:26:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.446
[INFO] - 02-27 21:26:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.447
[INFO] - 02-27 21:26:09 - [main.summary_metrics:168]: Epoch 378/500 - Test Results:
{'auc': 0.8469946755663049,
 'f1': 0.4162773569023569,
 'loss': 0.43716611405750283,
 'ndcg': 0.7168449061258908,
 'precision': 0.55625,
 'recall': 0.33309261204481794}
[INFO] - 02-27 21:26:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[378] Complete. Time taken: 00:00:28.591
[INFO] - 02-27 21:26:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:26:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:26:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:26:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:26:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:26:09 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2197, 2218, 1]
[INFO] - 02-27 21:26:09 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:26:21 - [main.backward:225]: Epoch 379/500 - Iteration 40/95 - Time 0.305 batch, 0.043 data, 0.276 forward
[INFO] - 02-27 21:26:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:26:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0034)
[INFO] - 02-27 21:26:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5819 (0.5857)
[INFO] - 02-27 21:26:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5230 (-287.5180)
[INFO] - 02-27 21:26:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8346 (31.8015)
[INFO] - 02-27 21:26:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0287 (371.2506)
[INFO] - 02-27 21:26:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:26:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9608)
[INFO] - 02-27 21:26:35 - [main.backward:225]: Epoch 379/500 - Iteration 90/95 - Time 0.296 batch, 0.037 data, 0.266 forward
[INFO] - 02-27 21:26:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:26:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0031)
[INFO] - 02-27 21:26:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5787 (0.5855)
[INFO] - 02-27 21:26:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5451 (-287.5345)
[INFO] - 02-27 21:26:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7999 (31.8010)
[INFO] - 02-27 21:26:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0861 (371.1147)
[INFO] - 02-27 21:26:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:26:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9661)
[INFO] - 02-27 21:26:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:26:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:26:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:26:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:26:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:26:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:26:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:26:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.406
[INFO] - 02-27 21:26:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.408
[INFO] - 02-27 21:26:39 - [main.summary_metrics:168]: Epoch 379/500 - Test Results:
{'auc': 0.8469819570597847,
 'f1': 0.42590698653198655,
 'loss': 0.4376035036214498,
 'ndcg': 0.7205974349540407,
 'precision': 0.5687500000000001,
 'recall': 0.3409357492997199}
[INFO] - 02-27 21:26:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[379] Complete. Time taken: 00:00:30.496
[INFO] - 02-27 21:26:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:26:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:26:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:26:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:26:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:26:39 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3068, 2193, 2199, 1]
[INFO] - 02-27 21:26:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:26:53 - [main.backward:225]: Epoch 380/500 - Iteration 45/95 - Time 0.305 batch, 0.048 data, 0.276 forward
[INFO] - 02-27 21:26:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0033)
[INFO] - 02-27 21:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5779 (0.5860)
[INFO] - 02-27 21:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5453)
[INFO] - 02-27 21:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8899 (31.8018)
[INFO] - 02-27 21:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3279 (371.1915)
[INFO] - 02-27 21:26:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:26:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9617)
[INFO] - 02-27 21:27:06 - [main.backward:225]: Epoch 380/500 - Iteration 0/95 - Time 0.279 batch, 0.037 data, 0.251 forward
[INFO] - 02-27 21:27:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:27:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0032)
[INFO] - 02-27 21:27:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5826 (0.5861)
[INFO] - 02-27 21:27:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5348 (-287.5435)
[INFO] - 02-27 21:27:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7661 (31.7986)
[INFO] - 02-27 21:27:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.0481 (371.1377)
[INFO] - 02-27 21:27:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:27:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9669)
[INFO] - 02-27 21:27:06 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:27:06 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:27:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:27:06 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:27:06 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:27:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:27:06 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:27:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.044
[INFO] - 02-27 21:27:08 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.044
[INFO] - 02-27 21:27:08 - [main.summary_metrics:168]: Epoch 380/500 - Test Results:
{'auc': 0.8474164443963861,
 'f1': 0.40893939393939394,
 'loss': 0.4378038462925251,
 'ndcg': 0.7261001832458363,
 'precision': 0.546875,
 'recall': 0.32703518907563023}
[INFO] - 02-27 21:27:08 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[380] Complete. Time taken: 00:00:28.551
[INFO] - 02-27 21:27:08 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:27:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:27:08 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:27:08 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:27:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:27:08 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3018, 2197, 2204, 1]
[INFO] - 02-27 21:27:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:27:21 - [main.backward:225]: Epoch 381/500 - Iteration 50/95 - Time 0.266 batch, 0.037 data, 0.240 forward
[INFO] - 02-27 21:27:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:27:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0031)
[INFO] - 02-27 21:27:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5854)
[INFO] - 02-27 21:27:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5238 (-287.5310)
[INFO] - 02-27 21:27:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7688 (31.8073)
[INFO] - 02-27 21:27:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0035 (371.2846)
[INFO] - 02-27 21:27:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:27:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9663)
[INFO] - 02-27 21:27:32 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:27:32 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:27:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:27:32 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:27:32 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:27:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:27:32 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:27:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.213
[INFO] - 02-27 21:27:34 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.214
[INFO] - 02-27 21:27:34 - [main.summary_metrics:168]: Epoch 381/500 - Test Results:
{'auc': 0.8470144040459321,
 'f1': 0.4256176346801347,
 'loss': 0.43789113608184377,
 'ndcg': 0.723828211034225,
 'precision': 0.56875,
 'recall': 0.34054184173669466}
[INFO] - 02-27 21:27:34 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[381] Complete. Time taken: 00:00:26.619
[INFO] - 02-27 21:27:34 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:27:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:27:34 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:27:34 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:27:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:27:34 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2188, 2187, 1]
[INFO] - 02-27 21:27:35 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:27:36 - [main.backward:225]: Epoch 382/500 - Iteration 5/95 - Time 0.381 batch, 0.142 data, 0.357 forward
[INFO] - 02-27 21:27:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:27:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0028)
[INFO] - 02-27 21:27:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5860)
[INFO] - 02-27 21:27:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5258 (-287.5234)
[INFO] - 02-27 21:27:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8328 (31.7929)
[INFO] - 02-27 21:27:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5370 (371.0268)
[INFO] - 02-27 21:27:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:27:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9702)
[INFO] - 02-27 21:27:49 - [main.backward:225]: Epoch 382/500 - Iteration 55/95 - Time 0.267 batch, 0.035 data, 0.243 forward
[INFO] - 02-27 21:27:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0029)
[INFO] - 02-27 21:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5811 (0.5855)
[INFO] - 02-27 21:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5235 (-287.5221)
[INFO] - 02-27 21:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7938 (31.7749)
[INFO] - 02-27 21:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8101 (371.0019)
[INFO] - 02-27 21:27:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:27:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9678)
[INFO] - 02-27 21:27:59 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:27:59 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:27:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:27:59 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:27:59 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:27:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:27:59 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:28:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.217
[INFO] - 02-27 21:28:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.218
[INFO] - 02-27 21:28:01 - [main.summary_metrics:168]: Epoch 382/500 - Test Results:
{'auc': 0.8470452929946488,
 'f1': 0.4185921717171717,
 'loss': 0.4369992150138219,
 'ndcg': 0.7189252053577194,
 'precision': 0.559375,
 'recall': 0.3349308473389356}
[INFO] - 02-27 21:28:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[382] Complete. Time taken: 00:00:27.110
[INFO] - 02-27 21:28:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:28:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:28:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:28:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:28:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:28:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2199, 2213, 1]
[INFO] - 02-27 21:28:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:28:05 - [main.backward:225]: Epoch 383/500 - Iteration 10/95 - Time 0.307 batch, 0.082 data, 0.282 forward
[INFO] - 02-27 21:28:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0030)
[INFO] - 02-27 21:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5943 (0.5846)
[INFO] - 02-27 21:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5260 (-287.5229)
[INFO] - 02-27 21:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8182 (31.7987)
[INFO] - 02-27 21:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2302 (371.0318)
[INFO] - 02-27 21:28:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:28:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9675)
[INFO] - 02-27 21:28:18 - [main.backward:225]: Epoch 383/500 - Iteration 60/95 - Time 0.275 batch, 0.037 data, 0.247 forward
[INFO] - 02-27 21:28:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0031)
[INFO] - 02-27 21:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5921 (0.5866)
[INFO] - 02-27 21:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5168 (-287.5244)
[INFO] - 02-27 21:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7740 (31.8206)
[INFO] - 02-27 21:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.6552 (371.4672)
[INFO] - 02-27 21:28:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9664)
[INFO] - 02-27 21:28:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:28:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:28:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:28:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:28:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:28:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:28:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:28:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.172
[INFO] - 02-27 21:28:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.174
[INFO] - 02-27 21:28:29 - [main.summary_metrics:168]: Epoch 383/500 - Test Results:
{'auc': 0.8461621926344067,
 'f1': 0.4186731902356903,
 'loss': 0.43747932589288224,
 'ndcg': 0.717966807161633,
 'precision': 0.5593750000000001,
 'recall': 0.33502713585434174}
[INFO] - 02-27 21:28:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[383] Complete. Time taken: 00:00:27.384
[INFO] - 02-27 21:28:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:28:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:28:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:28:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:28:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:28:29 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3073, 2212, 2195, 1]
[INFO] - 02-27 21:28:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:28:33 - [main.backward:225]: Epoch 384/500 - Iteration 15/95 - Time 0.288 batch, 0.061 data, 0.264 forward
[INFO] - 02-27 21:28:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:28:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0031)
[INFO] - 02-27 21:28:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5850 (0.5861)
[INFO] - 02-27 21:28:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5125 (-287.5126)
[INFO] - 02-27 21:28:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7775 (31.8141)
[INFO] - 02-27 21:28:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1274 (371.2374)
[INFO] - 02-27 21:28:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:28:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9686)
[INFO] - 02-27 21:28:46 - [main.backward:225]: Epoch 384/500 - Iteration 65/95 - Time 0.259 batch, 0.033 data, 0.234 forward
[INFO] - 02-27 21:28:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0032)
[INFO] - 02-27 21:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5793 (0.5855)
[INFO] - 02-27 21:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5336 (-287.5231)
[INFO] - 02-27 21:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8551 (31.7984)
[INFO] - 02-27 21:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3584 (371.1413)
[INFO] - 02-27 21:28:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:28:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9641)
[INFO] - 02-27 21:28:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:28:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:28:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:28:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:28:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:28:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:28:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:28:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.136
[INFO] - 02-27 21:28:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.137
[INFO] - 02-27 21:28:55 - [main.summary_metrics:168]: Epoch 384/500 - Test Results:
{'auc': 0.8458757639085046,
 'f1': 0.4117287457912458,
 'loss': 0.4376733908197744,
 'ndcg': 0.7223020885888454,
 'precision': 0.55,
 'recall': 0.3295124299719888}
[INFO] - 02-27 21:28:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[384] Complete. Time taken: 00:00:26.514
[INFO] - 02-27 21:28:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:28:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:28:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:28:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:28:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:28:55 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3081, 2177, 2216, 1]
[INFO] - 02-27 21:28:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:29:01 - [main.backward:225]: Epoch 385/500 - Iteration 20/95 - Time 0.283 batch, 0.058 data, 0.258 forward
[INFO] - 02-27 21:29:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0031)
[INFO] - 02-27 21:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5889 (0.5856)
[INFO] - 02-27 21:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5311 (-287.5302)
[INFO] - 02-27 21:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7756 (31.7995)
[INFO] - 02-27 21:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1071 (371.1292)
[INFO] - 02-27 21:29:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:29:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9670)
[INFO] - 02-27 21:29:13 - [main.backward:225]: Epoch 385/500 - Iteration 70/95 - Time 0.259 batch, 0.034 data, 0.235 forward
[INFO] - 02-27 21:29:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 21:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5895 (0.5850)
[INFO] - 02-27 21:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5177 (-287.5257)
[INFO] - 02-27 21:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8171 (31.8070)
[INFO] - 02-27 21:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4111 (371.0709)
[INFO] - 02-27 21:29:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9653)
[INFO] - 02-27 21:29:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:29:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:29:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:29:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:29:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:29:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:29:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:29:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.077
[INFO] - 02-27 21:29:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.079
[INFO] - 02-27 21:29:22 - [main.summary_metrics:168]: Epoch 385/500 - Test Results:
{'auc': 0.8460801709164059,
 'f1': 0.4117287457912458,
 'loss': 0.4378402344596798,
 'ndcg': 0.7209610687476569,
 'precision': 0.55,
 'recall': 0.3295124299719888}
[INFO] - 02-27 21:29:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[385] Complete. Time taken: 00:00:26.616
[INFO] - 02-27 21:29:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:29:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:29:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:29:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:29:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:29:22 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3017, 2206, 2211, 1]
[INFO] - 02-27 21:29:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:29:29 - [main.backward:225]: Epoch 386/500 - Iteration 25/95 - Time 0.284 batch, 0.049 data, 0.258 forward
[INFO] - 02-27 21:29:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:29:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 21:29:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5861)
[INFO] - 02-27 21:29:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5111 (-287.5157)
[INFO] - 02-27 21:29:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7516 (31.8004)
[INFO] - 02-27 21:29:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7121 (371.0631)
[INFO] - 02-27 21:29:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:29:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9656)
[INFO] - 02-27 21:29:43 - [main.backward:225]: Epoch 386/500 - Iteration 75/95 - Time 0.282 batch, 0.035 data, 0.255 forward
[INFO] - 02-27 21:29:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0032)
[INFO] - 02-27 21:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5845 (0.5866)
[INFO] - 02-27 21:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5171 (-287.5140)
[INFO] - 02-27 21:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6861 (31.7871)
[INFO] - 02-27 21:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4802 (371.2444)
[INFO] - 02-27 21:29:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:29:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9650)
[INFO] - 02-27 21:29:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:29:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:29:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:29:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:29:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:29:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:29:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:29:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.339
[INFO] - 02-27 21:29:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.340
[INFO] - 02-27 21:29:51 - [main.summary_metrics:168]: Epoch 386/500 - Test Results:
{'auc': 0.8471367442197466,
 'f1': 0.4090435606060606,
 'loss': 0.4370158903108195,
 'ndcg': 0.7207134744606265,
 'precision': 0.546875,
 'recall': 0.32718399859943975}
[INFO] - 02-27 21:29:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[386] Complete. Time taken: 00:00:29.019
[INFO] - 02-27 21:29:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:29:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:29:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:29:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:29:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:29:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3021, 2207, 2216, 1]
[INFO] - 02-27 21:29:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:29:59 - [main.backward:225]: Epoch 387/500 - Iteration 30/95 - Time 0.282 batch, 0.044 data, 0.255 forward
[INFO] - 02-27 21:29:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:29:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0032)
[INFO] - 02-27 21:29:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5861)
[INFO] - 02-27 21:29:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5233 (-287.5271)
[INFO] - 02-27 21:29:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8129 (31.7941)
[INFO] - 02-27 21:29:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7844 (371.2805)
[INFO] - 02-27 21:29:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:29:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9656)
[INFO] - 02-27 21:30:12 - [main.backward:225]: Epoch 387/500 - Iteration 80/95 - Time 0.266 batch, 0.032 data, 0.240 forward
[INFO] - 02-27 21:30:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:30:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0032)
[INFO] - 02-27 21:30:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5857)
[INFO] - 02-27 21:30:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5362 (-287.5269)
[INFO] - 02-27 21:30:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7639 (31.8050)
[INFO] - 02-27 21:30:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3336 (371.3743)
[INFO] - 02-27 21:30:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:30:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9653)
[INFO] - 02-27 21:30:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:30:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:30:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:30:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:30:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:30:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:30:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:30:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.183
[INFO] - 02-27 21:30:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.183
[INFO] - 02-27 21:30:18 - [main.summary_metrics:168]: Epoch 387/500 - Test Results:
{'auc': 0.8468975169111762,
 'f1': 0.40875420875420876,
 'loss': 0.4376053084288237,
 'ndcg': 0.7198413450652983,
 'precision': 0.546875,
 'recall': 0.32679009103641454}
[INFO] - 02-27 21:30:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[387] Complete. Time taken: 00:00:27.298
[INFO] - 02-27 21:30:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:30:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:30:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:30:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:30:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:30:18 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3056, 2175, 2210, 1]
[INFO] - 02-27 21:30:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:30:28 - [main.backward:225]: Epoch 388/500 - Iteration 35/95 - Time 0.265 batch, 0.040 data, 0.240 forward
[INFO] - 02-27 21:30:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:30:28 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0028)
[INFO] - 02-27 21:30:28 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5866)
[INFO] - 02-27 21:30:28 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5402)
[INFO] - 02-27 21:30:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7230 (31.7850)
[INFO] - 02-27 21:30:28 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3898 (371.0816)
[INFO] - 02-27 21:30:28 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:30:28 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9714)
[INFO] - 02-27 21:30:40 - [main.backward:225]: Epoch 388/500 - Iteration 85/95 - Time 0.256 batch, 0.031 data, 0.231 forward
[INFO] - 02-27 21:30:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:30:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0031)
[INFO] - 02-27 21:30:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5784 (0.5859)
[INFO] - 02-27 21:30:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5456)
[INFO] - 02-27 21:30:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7335 (31.7829)
[INFO] - 02-27 21:30:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8405 (371.2117)
[INFO] - 02-27 21:30:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:30:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9661)
[INFO] - 02-27 21:30:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:30:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:30:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:30:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:30:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:30:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:30:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:30:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.073
[INFO] - 02-27 21:30:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.074
[INFO] - 02-27 21:30:45 - [main.summary_metrics:168]: Epoch 388/500 - Test Results:
{'auc': 0.8477466849484891,
 'f1': 0.41801346801346806,
 'loss': 0.436739872940089,
 'ndcg': 0.7252643091745898,
 'precision': 0.5593750000000001,
 'recall': 0.33414303221288516}
[INFO] - 02-27 21:30:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[388] Complete. Time taken: 00:00:26.313
[INFO] - 02-27 21:30:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:30:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:30:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:30:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:30:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:30:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3036, 2185, 2202, 1]
[INFO] - 02-27 21:30:45 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:30:55 - [main.backward:225]: Epoch 389/500 - Iteration 40/95 - Time 0.267 batch, 0.039 data, 0.242 forward
[INFO] - 02-27 21:30:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:30:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0029)
[INFO] - 02-27 21:30:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5781 (0.5861)
[INFO] - 02-27 21:30:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5496 (-287.5478)
[INFO] - 02-27 21:30:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8554 (31.7861)
[INFO] - 02-27 21:30:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3982 (371.1244)
[INFO] - 02-27 21:30:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:30:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9691)
[INFO] - 02-27 21:31:08 - [main.backward:225]: Epoch 389/500 - Iteration 90/95 - Time 0.260 batch, 0.031 data, 0.235 forward
[INFO] - 02-27 21:31:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0030)
[INFO] - 02-27 21:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5856)
[INFO] - 02-27 21:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5517 (-287.5498)
[INFO] - 02-27 21:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8273 (31.7875)
[INFO] - 02-27 21:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1703 (371.0564)
[INFO] - 02-27 21:31:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:31:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9673)
[INFO] - 02-27 21:31:09 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:31:09 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:31:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:31:09 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:31:09 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:31:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:31:09 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:31:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.144
[INFO] - 02-27 21:31:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.145
[INFO] - 02-27 21:31:11 - [main.summary_metrics:168]: Epoch 389/500 - Test Results:
{'auc': 0.8481343157973973,
 'f1': 0.41569865319865323,
 'loss': 0.436201913973494,
 'ndcg': 0.7220116232450111,
 'precision': 0.5562499999999999,
 'recall': 0.33230479691876746}
[INFO] - 02-27 21:31:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[389] Complete. Time taken: 00:00:26.757
[INFO] - 02-27 21:31:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:31:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:31:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:31:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:31:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:31:11 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3058, 2191, 2226, 1]
[INFO] - 02-27 21:31:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:31:24 - [main.backward:225]: Epoch 390/500 - Iteration 45/95 - Time 0.276 batch, 0.039 data, 0.249 forward
[INFO] - 02-27 21:31:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:31:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0029)
[INFO] - 02-27 21:31:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5948 (0.5859)
[INFO] - 02-27 21:31:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5494 (-287.5489)
[INFO] - 02-27 21:31:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8008 (31.7812)
[INFO] - 02-27 21:31:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9048 (371.2353)
[INFO] - 02-27 21:31:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:31:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9694)
[INFO] - 02-27 21:31:37 - [main.backward:225]: Epoch 390/500 - Iteration 0/95 - Time 0.266 batch, 0.032 data, 0.240 forward
[INFO] - 02-27 21:31:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0031)
[INFO] - 02-27 21:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5881 (0.5857)
[INFO] - 02-27 21:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5470 (-287.5490)
[INFO] - 02-27 21:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7620 (31.7751)
[INFO] - 02-27 21:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7730 (371.1659)
[INFO] - 02-27 21:31:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:31:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9656)
[INFO] - 02-27 21:31:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:31:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:31:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:31:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:31:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:31:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:31:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:31:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.252
[INFO] - 02-27 21:31:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.253
[INFO] - 02-27 21:31:39 - [main.summary_metrics:168]: Epoch 390/500 - Test Results:
{'auc': 0.8474268280228758,
 'f1': 0.42069865319865324,
 'loss': 0.4370746313567002,
 'ndcg': 0.719472978072994,
 'precision': 0.5625,
 'recall': 0.33647146358543417}
[INFO] - 02-27 21:31:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[390] Complete. Time taken: 00:00:27.495
[INFO] - 02-27 21:31:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:31:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:31:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:31:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:31:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:31:39 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3079, 2202, 2209, 1]
[INFO] - 02-27 21:31:39 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:31:53 - [main.backward:225]: Epoch 391/500 - Iteration 50/95 - Time 0.279 batch, 0.039 data, 0.253 forward
[INFO] - 02-27 21:31:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0032)
[INFO] - 02-27 21:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5822 (0.5864)
[INFO] - 02-27 21:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5473 (-287.5470)
[INFO] - 02-27 21:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7717 (31.7928)
[INFO] - 02-27 21:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5059 (371.1795)
[INFO] - 02-27 21:31:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:31:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9637)
[INFO] - 02-27 21:32:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:32:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:32:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:32:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:32:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:32:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:32:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:32:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.410
[INFO] - 02-27 21:32:07 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.411
[INFO] - 02-27 21:32:07 - [main.summary_metrics:168]: Epoch 391/500 - Test Results:
{'auc': 0.8463596364403605,
 'f1': 0.40701809764309765,
 'loss': 0.43729127873402296,
 'ndcg': 0.7240719178434462,
 'precision': 0.54375,
 'recall': 0.3257396708683473}
[INFO] - 02-27 21:32:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[391] Complete. Time taken: 00:00:28.425
[INFO] - 02-27 21:32:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:32:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:32:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:32:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:32:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:32:07 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3059, 2226, 2200, 1]
[INFO] - 02-27 21:32:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:32:09 - [main.backward:225]: Epoch 392/500 - Iteration 5/95 - Time 0.388 batch, 0.146 data, 0.363 forward
[INFO] - 02-27 21:32:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0030)
[INFO] - 02-27 21:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5864)
[INFO] - 02-27 21:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5478)
[INFO] - 02-27 21:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8738 (31.8057)
[INFO] - 02-27 21:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4661 (371.1519)
[INFO] - 02-27 21:32:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:32:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9672)
[INFO] - 02-27 21:32:23 - [main.backward:225]: Epoch 392/500 - Iteration 55/95 - Time 0.277 batch, 0.037 data, 0.251 forward
[INFO] - 02-27 21:32:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:32:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0030)
[INFO] - 02-27 21:32:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5840 (0.5847)
[INFO] - 02-27 21:32:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5446 (-287.5478)
[INFO] - 02-27 21:32:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8369 (31.7802)
[INFO] - 02-27 21:32:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9103 (371.0867)
[INFO] - 02-27 21:32:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:32:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9684)
[INFO] - 02-27 21:32:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:32:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:32:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:32:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:32:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:32:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:32:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:32:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.251
[INFO] - 02-27 21:32:35 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.252
[INFO] - 02-27 21:32:35 - [main.summary_metrics:168]: Epoch 392/500 - Test Results:
{'auc': 0.8473671955301729,
 'f1': 0.4282218013468013,
 'loss': 0.43693650776820503,
 'ndcg': 0.722649659967879,
 'precision': 0.571875,
 'recall': 0.34277398459383757}
[INFO] - 02-27 21:32:35 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[392] Complete. Time taken: 00:00:27.965
[INFO] - 02-27 21:32:35 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:32:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:32:35 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:32:35 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:32:35 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:32:35 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3075, 2187, 2227, 1]
[INFO] - 02-27 21:32:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:32:39 - [main.backward:225]: Epoch 393/500 - Iteration 10/95 - Time 0.332 batch, 0.092 data, 0.305 forward
[INFO] - 02-27 21:32:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:32:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0029)
[INFO] - 02-27 21:32:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5857 (0.5850)
[INFO] - 02-27 21:32:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5495 (-287.5480)
[INFO] - 02-27 21:32:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6762 (31.7863)
[INFO] - 02-27 21:32:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0775 (371.0541)
[INFO] - 02-27 21:32:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:32:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9700)
[INFO] - 02-27 21:32:52 - [main.backward:225]: Epoch 393/500 - Iteration 60/95 - Time 0.276 batch, 0.037 data, 0.250 forward
[INFO] - 02-27 21:32:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:32:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0030)
[INFO] - 02-27 21:32:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5847)
[INFO] - 02-27 21:32:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5451 (-287.5462)
[INFO] - 02-27 21:32:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8211 (31.7809)
[INFO] - 02-27 21:32:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6365 (371.3039)
[INFO] - 02-27 21:32:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:32:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9680)
[INFO] - 02-27 21:33:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:33:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:33:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:33:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:33:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:33:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:33:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:33:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.416
[INFO] - 02-27 21:33:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.418
[INFO] - 02-27 21:33:04 - [main.summary_metrics:168]: Epoch 393/500 - Test Results:
{'auc': 0.8476738983583629,
 'f1': 0.41569865319865323,
 'loss': 0.4365730459881036,
 'ndcg': 0.7200973305792278,
 'precision': 0.5562499999999999,
 'recall': 0.33230479691876746}
[INFO] - 02-27 21:33:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[393] Complete. Time taken: 00:00:28.504
[INFO] - 02-27 21:33:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:33:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:33:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:33:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:33:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:33:04 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2211, 2212, 1]
[INFO] - 02-27 21:33:04 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:33:09 - [main.backward:225]: Epoch 394/500 - Iteration 15/95 - Time 0.326 batch, 0.071 data, 0.295 forward
[INFO] - 02-27 21:33:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 21:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5886 (0.5853)
[INFO] - 02-27 21:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5470)
[INFO] - 02-27 21:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8414 (31.7847)
[INFO] - 02-27 21:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9644 (371.3120)
[INFO] - 02-27 21:33:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:33:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9644)
[INFO] - 02-27 21:33:22 - [main.backward:225]: Epoch 394/500 - Iteration 65/95 - Time 0.288 batch, 0.038 data, 0.260 forward
[INFO] - 02-27 21:33:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:33:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 21:33:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5895 (0.5865)
[INFO] - 02-27 21:33:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5449 (-287.5449)
[INFO] - 02-27 21:33:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8141 (31.7881)
[INFO] - 02-27 21:33:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5743 (371.0795)
[INFO] - 02-27 21:33:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:33:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9664)
[INFO] - 02-27 21:33:30 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:33:30 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:33:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:33:30 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:33:30 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:33:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:33:30 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:33:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.278
[INFO] - 02-27 21:33:33 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.280
[INFO] - 02-27 21:33:33 - [main.summary_metrics:168]: Epoch 394/500 - Test Results:
{'auc': 0.8469739151788167,
 'f1': 0.41367319023569027,
 'loss': 0.43685814668305967,
 'ndcg': 0.7165370549739162,
 'precision': 0.5531250000000001,
 'recall': 0.3308604691876751}
[INFO] - 02-27 21:33:33 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[394] Complete. Time taken: 00:00:28.887
[INFO] - 02-27 21:33:33 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:33:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:33:33 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:33:33 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:33:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:33:33 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3036, 2200, 2195, 1]
[INFO] - 02-27 21:33:33 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:33:39 - [main.backward:225]: Epoch 395/500 - Iteration 20/95 - Time 0.298 batch, 0.053 data, 0.271 forward
[INFO] - 02-27 21:33:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:33:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0051 (0.0033)
[INFO] - 02-27 21:33:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5734 (0.5862)
[INFO] - 02-27 21:33:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5449 (-287.5437)
[INFO] - 02-27 21:33:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7644 (31.7854)
[INFO] - 02-27 21:33:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3502 (371.2376)
[INFO] - 02-27 21:33:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:33:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9602)
[INFO] - 02-27 21:33:52 - [main.backward:225]: Epoch 395/500 - Iteration 70/95 - Time 0.279 batch, 0.034 data, 0.252 forward
[INFO] - 02-27 21:33:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0032)
[INFO] - 02-27 21:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5845)
[INFO] - 02-27 21:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5414 (-287.5430)
[INFO] - 02-27 21:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8728 (31.7953)
[INFO] - 02-27 21:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8501 (371.3566)
[INFO] - 02-27 21:33:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:33:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9648)
[INFO] - 02-27 21:33:59 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:33:59 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:33:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:33:59 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:33:59 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:33:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:33:59 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:34:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.409
[INFO] - 02-27 21:34:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.410
[INFO] - 02-27 21:34:01 - [main.summary_metrics:168]: Epoch 395/500 - Test Results:
{'auc': 0.8479647084936917,
 'f1': 0.4234069865319865,
 'loss': 0.4357732600719236,
 'ndcg': 0.7199911250727968,
 'precision': 0.565625,
 'recall': 0.3388524159663866}
[INFO] - 02-27 21:34:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[395] Complete. Time taken: 00:00:28.826
[INFO] - 02-27 21:34:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:34:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:34:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:34:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:34:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:34:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3092, 2172, 2204, 1]
[INFO] - 02-27 21:34:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:34:09 - [main.backward:225]: Epoch 396/500 - Iteration 25/95 - Time 0.294 batch, 0.050 data, 0.266 forward
[INFO] - 02-27 21:34:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0030)
[INFO] - 02-27 21:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5874 (0.5847)
[INFO] - 02-27 21:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5477 (-287.5437)
[INFO] - 02-27 21:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8657 (31.7984)
[INFO] - 02-27 21:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7913 (371.4345)
[INFO] - 02-27 21:34:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:34:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9691)
[INFO] - 02-27 21:34:22 - [main.backward:225]: Epoch 396/500 - Iteration 75/95 - Time 0.280 batch, 0.035 data, 0.253 forward
[INFO] - 02-27 21:34:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:34:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0029)
[INFO] - 02-27 21:34:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5957 (0.5853)
[INFO] - 02-27 21:34:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5484 (-287.5476)
[INFO] - 02-27 21:34:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7188 (31.7897)
[INFO] - 02-27 21:34:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.8121 (371.2968)
[INFO] - 02-27 21:34:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:34:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9717)
[INFO] - 02-27 21:34:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:34:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:34:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:34:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:34:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:34:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:34:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:34:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.524
[INFO] - 02-27 21:34:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.525
[INFO] - 02-27 21:34:31 - [main.summary_metrics:168]: Epoch 396/500 - Test Results:
{'auc': 0.845947986241065,
 'f1': 0.4143329124579125,
 'loss': 0.4370850906568868,
 'ndcg': 0.7172225188448792,
 'precision': 0.553125,
 'recall': 0.3317445728291316}
[INFO] - 02-27 21:34:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[396] Complete. Time taken: 00:00:29.117
[INFO] - 02-27 21:34:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:34:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:34:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:34:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:34:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:34:31 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2189, 2202, 1]
[INFO] - 02-27 21:34:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:34:40 - [main.backward:225]: Epoch 397/500 - Iteration 30/95 - Time 0.298 batch, 0.046 data, 0.271 forward
[INFO] - 02-27 21:34:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5840)
[INFO] - 02-27 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5476 (-287.5480)
[INFO] - 02-27 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8857 (31.8016)
[INFO] - 02-27 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3738 (371.2862)
[INFO] - 02-27 21:34:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:34:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9667)
[INFO] - 02-27 21:34:53 - [main.backward:225]: Epoch 397/500 - Iteration 80/95 - Time 0.280 batch, 0.034 data, 0.254 forward
[INFO] - 02-27 21:34:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:34:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0031)
[INFO] - 02-27 21:34:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5791 (0.5835)
[INFO] - 02-27 21:34:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5486 (-287.5493)
[INFO] - 02-27 21:34:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8168 (31.7916)
[INFO] - 02-27 21:34:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.8043 (371.2545)
[INFO] - 02-27 21:34:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:34:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9656)
[INFO] - 02-27 21:34:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:34:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:34:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:34:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:34:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:34:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:34:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:35:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.478
[INFO] - 02-27 21:35:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.478
[INFO] - 02-27 21:35:00 - [main.summary_metrics:168]: Epoch 397/500 - Test Results:
{'auc': 0.8466254504865672,
 'f1': 0.407388468013468,
 'loss': 0.4369235784876584,
 'ndcg': 0.718338936208899,
 'precision': 0.54375,
 'recall': 0.3262298669467787}
[INFO] - 02-27 21:35:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[397] Complete. Time taken: 00:00:29.139
[INFO] - 02-27 21:35:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:35:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:35:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:35:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:35:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:35:00 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3015, 2219, 2208, 1]
[INFO] - 02-27 21:35:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:35:09 - [main.backward:225]: Epoch 398/500 - Iteration 35/95 - Time 0.275 batch, 0.044 data, 0.249 forward
[INFO] - 02-27 21:35:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0032)
[INFO] - 02-27 21:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5792 (0.5865)
[INFO] - 02-27 21:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5419 (-287.5460)
[INFO] - 02-27 21:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7956 (31.7907)
[INFO] - 02-27 21:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5324 (371.1303)
[INFO] - 02-27 21:35:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:35:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9650)
[INFO] - 02-27 21:35:23 - [main.backward:225]: Epoch 398/500 - Iteration 85/95 - Time 0.268 batch, 0.033 data, 0.242 forward
[INFO] - 02-27 21:35:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0032)
[INFO] - 02-27 21:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5793 (0.5855)
[INFO] - 02-27 21:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5440 (-287.5444)
[INFO] - 02-27 21:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6886 (31.7893)
[INFO] - 02-27 21:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6967 (371.0541)
[INFO] - 02-27 21:35:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:35:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9653)
[INFO] - 02-27 21:35:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:35:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:35:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:35:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:35:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:35:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:35:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:35:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.250
[INFO] - 02-27 21:35:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.251
[INFO] - 02-27 21:35:27 - [main.summary_metrics:168]: Epoch 398/500 - Test Results:
{'auc': 0.8465747978725804,
 'f1': 0.42590698653198655,
 'loss': 0.43777140091376743,
 'ndcg': 0.7218280417699459,
 'precision': 0.5687500000000001,
 'recall': 0.34093574929971987}
[INFO] - 02-27 21:35:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[398] Complete. Time taken: 00:00:27.674
[INFO] - 02-27 21:35:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:35:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:35:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:35:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:35:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:35:27 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3069, 2208, 2195, 1]
[INFO] - 02-27 21:35:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:35:39 - [main.backward:225]: Epoch 399/500 - Iteration 40/95 - Time 0.281 batch, 0.042 data, 0.255 forward
[INFO] - 02-27 21:35:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0029)
[INFO] - 02-27 21:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5848)
[INFO] - 02-27 21:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5474 (-287.5469)
[INFO] - 02-27 21:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7187 (31.7899)
[INFO] - 02-27 21:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6624 (371.2766)
[INFO] - 02-27 21:35:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:35:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9695)
[INFO] - 02-27 21:35:52 - [main.backward:225]: Epoch 399/500 - Iteration 90/95 - Time 0.271 batch, 0.033 data, 0.245 forward
[INFO] - 02-27 21:35:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 21:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5859)
[INFO] - 02-27 21:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5502 (-287.5483)
[INFO] - 02-27 21:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7224 (31.7889)
[INFO] - 02-27 21:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1597 (371.3897)
[INFO] - 02-27 21:35:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:35:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9672)
[INFO] - 02-27 21:35:53 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:35:53 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:35:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:35:53 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:35:53 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:35:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:35:53 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:35:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.265
[INFO] - 02-27 21:35:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.266
[INFO] - 02-27 21:35:55 - [main.summary_metrics:168]: Epoch 399/500 - Test Results:
{'auc': 0.8458273601107109,
 'f1': 0.42359217171717173,
 'loss': 0.4381862452951071,
 'ndcg': 0.7176803398260097,
 'precision': 0.565625,
 'recall': 0.33909751400560223}
[INFO] - 02-27 21:35:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[399] Complete. Time taken: 00:00:27.969
[INFO] - 02-27 21:35:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:35:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:35:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:35:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:35:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:35:55 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3076, 2198, 2209, 1]
[INFO] - 02-27 21:35:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:36:08 - [main.backward:225]: Epoch 400/500 - Iteration 45/95 - Time 0.271 batch, 0.038 data, 0.246 forward
[INFO] - 02-27 21:36:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0032)
[INFO] - 02-27 21:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5848 (0.5860)
[INFO] - 02-27 21:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5500 (-287.5504)
[INFO] - 02-27 21:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8275 (31.8039)
[INFO] - 02-27 21:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6081 (371.1824)
[INFO] - 02-27 21:36:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:36:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9625)
[INFO] - 02-27 21:36:21 - [main.backward:225]: Epoch 400/500 - Iteration 0/95 - Time 0.267 batch, 0.032 data, 0.241 forward
[INFO] - 02-27 21:36:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:36:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0032)
[INFO] - 02-27 21:36:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5864)
[INFO] - 02-27 21:36:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5493 (-287.5500)
[INFO] - 02-27 21:36:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7563 (31.7964)
[INFO] - 02-27 21:36:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9189 (371.2025)
[INFO] - 02-27 21:36:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:36:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9641)
[INFO] - 02-27 21:36:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:36:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:36:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:36:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:36:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:36:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:36:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:36:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.270
[INFO] - 02-27 21:36:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.272
[INFO] - 02-27 21:36:23 - [main.summary_metrics:168]: Epoch 400/500 - Test Results:
{'auc': 0.8454362139463628,
 'f1': 0.4186731902356903,
 'loss': 0.4387033685315519,
 'ndcg': 0.7135908748111979,
 'precision': 0.559375,
 'recall': 0.33502713585434174}
[INFO] - 02-27 21:36:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[400] Complete. Time taken: 00:00:27.635
[INFO] - 02-27 21:36:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:36:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:36:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:36:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:36:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:36:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2189, 2212, 1]
[INFO] - 02-27 21:36:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:36:37 - [main.backward:225]: Epoch 401/500 - Iteration 50/95 - Time 0.282 batch, 0.039 data, 0.256 forward
[INFO] - 02-27 21:36:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:36:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0033)
[INFO] - 02-27 21:36:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5871)
[INFO] - 02-27 21:36:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5502 (-287.5512)
[INFO] - 02-27 21:36:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7796 (31.8010)
[INFO] - 02-27 21:36:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5515 (371.2791)
[INFO] - 02-27 21:36:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:36:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9645)
[INFO] - 02-27 21:36:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:36:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:36:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:36:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:36:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:36:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:36:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:36:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.172
[INFO] - 02-27 21:36:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.174
[INFO] - 02-27 21:36:51 - [main.summary_metrics:168]: Epoch 401/500 - Test Results:
{'auc': 0.8470052081494363,
 'f1': 0.4256176346801347,
 'loss': 0.438443825623458,
 'ndcg': 0.7195174253500729,
 'precision': 0.56875,
 'recall': 0.34054184173669466}
[INFO] - 02-27 21:36:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[401] Complete. Time taken: 00:00:28.088
[INFO] - 02-27 21:36:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:36:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:36:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:36:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:36:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:36:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2197, 2205, 1]
[INFO] - 02-27 21:36:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:36:53 - [main.backward:225]: Epoch 402/500 - Iteration 5/95 - Time 0.397 batch, 0.158 data, 0.372 forward
[INFO] - 02-27 21:36:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:36:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0032)
[INFO] - 02-27 21:36:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5865)
[INFO] - 02-27 21:36:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5551 (-287.5523)
[INFO] - 02-27 21:36:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7513 (31.8018)
[INFO] - 02-27 21:36:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3125 (371.2075)
[INFO] - 02-27 21:36:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:36:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9636)
[INFO] - 02-27 21:37:07 - [main.backward:225]: Epoch 402/500 - Iteration 55/95 - Time 0.286 batch, 0.039 data, 0.259 forward
[INFO] - 02-27 21:37:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:37:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0029)
[INFO] - 02-27 21:37:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5905 (0.5865)
[INFO] - 02-27 21:37:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5535 (-287.5527)
[INFO] - 02-27 21:37:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9085 (31.7999)
[INFO] - 02-27 21:37:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.7430 (371.2874)
[INFO] - 02-27 21:37:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:37:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9688)
[INFO] - 02-27 21:37:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:37:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:37:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:37:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:37:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:37:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:37:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:37:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.636
[INFO] - 02-27 21:37:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.637
[INFO] - 02-27 21:37:21 - [main.summary_metrics:168]: Epoch 402/500 - Test Results:
{'auc': 0.8475726150754419,
 'f1': 0.432851430976431,
 'loss': 0.43708696734082975,
 'ndcg': 0.7250233488751991,
 'precision': 0.578125,
 'recall': 0.34645045518207285}
[INFO] - 02-27 21:37:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[402] Complete. Time taken: 00:00:30.398
[INFO] - 02-27 21:37:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:37:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:37:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:37:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:37:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:37:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3031, 2184, 2209, 1]
[INFO] - 02-27 21:37:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:37:25 - [main.backward:225]: Epoch 403/500 - Iteration 10/95 - Time 0.335 batch, 0.088 data, 0.308 forward
[INFO] - 02-27 21:37:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 21:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5854)
[INFO] - 02-27 21:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5447 (-287.5490)
[INFO] - 02-27 21:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6939 (31.7941)
[INFO] - 02-27 21:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1754 (371.1072)
[INFO] - 02-27 21:37:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:37:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9666)
[INFO] - 02-27 21:37:39 - [main.backward:225]: Epoch 403/500 - Iteration 60/95 - Time 0.290 batch, 0.038 data, 0.262 forward
[INFO] - 02-27 21:37:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:37:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0032)
[INFO] - 02-27 21:37:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5752 (0.5858)
[INFO] - 02-27 21:37:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5467)
[INFO] - 02-27 21:37:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8371 (31.7949)
[INFO] - 02-27 21:37:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5043 (371.3272)
[INFO] - 02-27 21:37:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:37:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9636)
[INFO] - 02-27 21:37:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:37:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:37:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:37:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:37:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:37:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:37:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:37:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.462
[INFO] - 02-27 21:37:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.462
[INFO] - 02-27 21:37:51 - [main.summary_metrics:168]: Epoch 403/500 - Test Results:
{'auc': 0.8484194714037576,
 'f1': 0.42080281986531987,
 'loss': 0.4362315750477316,
 'ndcg': 0.7222664494819866,
 'precision': 0.5625,
 'recall': 0.3366202731092437}
[INFO] - 02-27 21:37:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[403] Complete. Time taken: 00:00:29.572
[INFO] - 02-27 21:37:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:37:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:37:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:37:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:37:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:37:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3058, 2203, 2214, 1]
[INFO] - 02-27 21:37:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:37:56 - [main.backward:225]: Epoch 404/500 - Iteration 15/95 - Time 0.334 batch, 0.070 data, 0.304 forward
[INFO] - 02-27 21:37:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:37:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0054 (0.0029)
[INFO] - 02-27 21:37:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5855)
[INFO] - 02-27 21:37:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5482)
[INFO] - 02-27 21:37:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7208 (31.7930)
[INFO] - 02-27 21:37:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3048 (371.2051)
[INFO] - 02-27 21:37:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:37:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9062 (0.9675)
[INFO] - 02-27 21:38:10 - [main.backward:225]: Epoch 404/500 - Iteration 65/95 - Time 0.298 batch, 0.038 data, 0.269 forward
[INFO] - 02-27 21:38:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:38:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0029)
[INFO] - 02-27 21:38:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5822 (0.5856)
[INFO] - 02-27 21:38:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5428 (-287.5462)
[INFO] - 02-27 21:38:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7841 (31.7754)
[INFO] - 02-27 21:38:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8096 (371.1890)
[INFO] - 02-27 21:38:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:38:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9673)
[INFO] - 02-27 21:38:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:38:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:38:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:38:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:38:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:38:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:38:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:38:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.462
[INFO] - 02-27 21:38:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.463
[INFO] - 02-27 21:38:21 - [main.summary_metrics:168]: Epoch 404/500 - Test Results:
{'auc': 0.8479636767697275,
 'f1': 0.4189625420875421,
 'loss': 0.4367053509218961,
 'ndcg': 0.7246142709614478,
 'precision': 0.5593750000000001,
 'recall': 0.335421043417367}
[INFO] - 02-27 21:38:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[404] Complete. Time taken: 00:00:30.219
[INFO] - 02-27 21:38:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:38:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:38:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:38:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:38:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:38:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3059, 2211, 2214, 1]
[INFO] - 02-27 21:38:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:38:27 - [main.backward:225]: Epoch 405/500 - Iteration 20/95 - Time 0.307 batch, 0.059 data, 0.279 forward
[INFO] - 02-27 21:38:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0032)
[INFO] - 02-27 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5793 (0.5860)
[INFO] - 02-27 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5425 (-287.5429)
[INFO] - 02-27 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8579 (31.7931)
[INFO] - 02-27 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8934 (371.1914)
[INFO] - 02-27 21:38:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:38:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9652)
[INFO] - 02-27 21:38:41 - [main.backward:225]: Epoch 405/500 - Iteration 70/95 - Time 0.286 batch, 0.037 data, 0.258 forward
[INFO] - 02-27 21:38:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0031)
[INFO] - 02-27 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5866)
[INFO] - 02-27 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5416 (-287.5410)
[INFO] - 02-27 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7308 (31.7794)
[INFO] - 02-27 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6484 (371.0784)
[INFO] - 02-27 21:38:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:38:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9661)
[INFO] - 02-27 21:38:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:38:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:38:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:38:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:38:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:38:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:38:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:38:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.716
[INFO] - 02-27 21:38:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.718
[INFO] - 02-27 21:38:52 - [main.summary_metrics:168]: Epoch 405/500 - Test Results:
{'auc': 0.8488638369563513,
 'f1': 0.42359217171717173,
 'loss': 0.43696348270941804,
 'ndcg': 0.7256522727083987,
 'precision': 0.565625,
 'recall': 0.3390975140056023}
[INFO] - 02-27 21:38:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[405] Complete. Time taken: 00:00:30.909
[INFO] - 02-27 21:38:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:38:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:38:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:38:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:38:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:38:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2184, 2207, 1]
[INFO] - 02-27 21:38:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:39:00 - [main.backward:225]: Epoch 406/500 - Iteration 25/95 - Time 0.331 batch, 0.060 data, 0.299 forward
[INFO] - 02-27 21:39:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:39:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 21:39:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5808 (0.5867)
[INFO] - 02-27 21:39:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5399 (-287.5425)
[INFO] - 02-27 21:39:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6807 (31.7833)
[INFO] - 02-27 21:39:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.0705 (371.1876)
[INFO] - 02-27 21:39:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:39:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9663)
[INFO] - 02-27 21:39:15 - [main.backward:225]: Epoch 406/500 - Iteration 75/95 - Time 0.309 batch, 0.039 data, 0.279 forward
[INFO] - 02-27 21:39:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:39:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0033)
[INFO] - 02-27 21:39:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5849)
[INFO] - 02-27 21:39:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5405)
[INFO] - 02-27 21:39:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8605 (31.7845)
[INFO] - 02-27 21:39:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2018 (371.0308)
[INFO] - 02-27 21:39:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:39:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9614)
[INFO] - 02-27 21:39:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:39:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:39:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:39:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:39:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:39:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:39:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:39:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.523
[INFO] - 02-27 21:39:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.524
[INFO] - 02-27 21:39:23 - [main.summary_metrics:168]: Epoch 406/500 - Test Results:
{'auc': 0.8462164926632417,
 'f1': 0.4282218013468013,
 'loss': 0.4381078971532682,
 'ndcg': 0.723757594820966,
 'precision': 0.571875,
 'recall': 0.34277398459383757}
[INFO] - 02-27 21:39:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[406] Complete. Time taken: 00:00:31.296
[INFO] - 02-27 21:39:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:39:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:39:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:39:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:39:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:39:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2200, 2193, 1]
[INFO] - 02-27 21:39:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:39:33 - [main.backward:225]: Epoch 407/500 - Iteration 30/95 - Time 0.326 batch, 0.055 data, 0.291 forward
[INFO] - 02-27 21:39:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:39:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0032)
[INFO] - 02-27 21:39:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5818 (0.5859)
[INFO] - 02-27 21:39:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5465 (-287.5447)
[INFO] - 02-27 21:39:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9048 (31.7870)
[INFO] - 02-27 21:39:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9048 (371.0412)
[INFO] - 02-27 21:39:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:39:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9653)
[INFO] - 02-27 21:39:47 - [main.backward:225]: Epoch 407/500 - Iteration 80/95 - Time 0.300 batch, 0.037 data, 0.270 forward
[INFO] - 02-27 21:39:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:39:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0030)
[INFO] - 02-27 21:39:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5842)
[INFO] - 02-27 21:39:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5473)
[INFO] - 02-27 21:39:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7371 (31.7942)
[INFO] - 02-27 21:39:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1773 (371.2431)
[INFO] - 02-27 21:39:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:39:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9675)
[INFO] - 02-27 21:39:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:39:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:39:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:39:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:39:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:39:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:39:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:39:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.561
[INFO] - 02-27 21:39:54 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.562
[INFO] - 02-27 21:39:54 - [main.summary_metrics:168]: Epoch 407/500 - Test Results:
{'auc': 0.8465031962539917,
 'f1': 0.42288089225589226,
 'loss': 0.4378301765534172,
 'ndcg': 0.7233949829411053,
 'precision': 0.565625,
 'recall': 0.3380864845938375}
[INFO] - 02-27 21:39:54 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[407] Complete. Time taken: 00:00:30.741
[INFO] - 02-27 21:39:54 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:39:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:39:54 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:39:54 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:39:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:39:54 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [2992, 2197, 2197, 1]
[INFO] - 02-27 21:39:55 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:40:04 - [main.backward:225]: Epoch 408/500 - Iteration 35/95 - Time 0.283 batch, 0.043 data, 0.257 forward
[INFO] - 02-27 21:40:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:40:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0031)
[INFO] - 02-27 21:40:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5878 (0.5862)
[INFO] - 02-27 21:40:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5454 (-287.5446)
[INFO] - 02-27 21:40:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7300 (31.7909)
[INFO] - 02-27 21:40:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0462 (371.0545)
[INFO] - 02-27 21:40:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:40:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9641)
[INFO] - 02-27 21:40:17 - [main.backward:225]: Epoch 408/500 - Iteration 85/95 - Time 0.271 batch, 0.033 data, 0.246 forward
[INFO] - 02-27 21:40:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:40:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0029)
[INFO] - 02-27 21:40:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5805 (0.5856)
[INFO] - 02-27 21:40:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5483 (-287.5451)
[INFO] - 02-27 21:40:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7685 (31.7935)
[INFO] - 02-27 21:40:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7047 (371.0329)
[INFO] - 02-27 21:40:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:40:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9689)
[INFO] - 02-27 21:40:20 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:40:20 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:40:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:40:20 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:40:20 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:40:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:40:20 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:40:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.262
[INFO] - 02-27 21:40:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.263
[INFO] - 02-27 21:40:22 - [main.summary_metrics:168]: Epoch 408/500 - Test Results:
{'auc': 0.8476028299187323,
 'f1': 0.40951809764309766,
 'loss': 0.43665104448826275,
 'ndcg': 0.7247560629386716,
 'precision': 0.546875,
 'recall': 0.32782300420168065}
[INFO] - 02-27 21:40:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[408] Complete. Time taken: 00:00:27.984
[INFO] - 02-27 21:40:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:40:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:40:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:40:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:40:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:40:22 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3043, 2203, 2208, 1]
[INFO] - 02-27 21:40:23 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:40:34 - [main.backward:225]: Epoch 409/500 - Iteration 40/95 - Time 0.285 batch, 0.044 data, 0.258 forward
[INFO] - 02-27 21:40:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:40:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0031)
[INFO] - 02-27 21:40:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5787 (0.5860)
[INFO] - 02-27 21:40:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5399 (-287.5455)
[INFO] - 02-27 21:40:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7850 (31.7935)
[INFO] - 02-27 21:40:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8408 (371.1918)
[INFO] - 02-27 21:40:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:40:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9673)
[INFO] - 02-27 21:40:47 - [main.backward:225]: Epoch 409/500 - Iteration 90/95 - Time 0.275 batch, 0.034 data, 0.249 forward
[INFO] - 02-27 21:40:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:40:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0030)
[INFO] - 02-27 21:40:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5825 (0.5865)
[INFO] - 02-27 21:40:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5410 (-287.5414)
[INFO] - 02-27 21:40:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7642 (31.7825)
[INFO] - 02-27 21:40:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3293 (371.2379)
[INFO] - 02-27 21:40:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:40:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9652)
[INFO] - 02-27 21:40:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:40:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:40:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:40:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:40:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:40:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:40:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:40:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.483
[INFO] - 02-27 21:40:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.484
[INFO] - 02-27 21:40:51 - [main.summary_metrics:168]: Epoch 409/500 - Test Results:
{'auc': 0.8475064682122849,
 'f1': 0.4161731902356902,
 'loss': 0.4369966960935574,
 'ndcg': 0.7209114492157038,
 'precision': 0.55625,
 'recall': 0.3329438025210084}
[INFO] - 02-27 21:40:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[409] Complete. Time taken: 00:00:28.615
[INFO] - 02-27 21:40:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:40:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:40:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:40:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:40:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:40:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3084, 2201, 2215, 1]
[INFO] - 02-27 21:40:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:41:03 - [main.backward:225]: Epoch 410/500 - Iteration 45/95 - Time 0.276 batch, 0.042 data, 0.251 forward
[INFO] - 02-27 21:41:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0030)
[INFO] - 02-27 21:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5855 (0.5870)
[INFO] - 02-27 21:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5458 (-287.5431)
[INFO] - 02-27 21:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7995 (31.7829)
[INFO] - 02-27 21:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9423 (371.1969)
[INFO] - 02-27 21:41:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:41:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9666)
[INFO] - 02-27 21:41:18 - [main.backward:225]: Epoch 410/500 - Iteration 0/95 - Time 0.282 batch, 0.035 data, 0.255 forward
[INFO] - 02-27 21:41:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:41:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 21:41:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5870 (0.5865)
[INFO] - 02-27 21:41:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5425 (-287.5426)
[INFO] - 02-27 21:41:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7326 (31.7857)
[INFO] - 02-27 21:41:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6088 (371.2186)
[INFO] - 02-27 21:41:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:41:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9666)
[INFO] - 02-27 21:41:18 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:41:18 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:41:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:41:18 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:41:18 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:41:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:41:18 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:41:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.430
[INFO] - 02-27 21:41:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.431
[INFO] - 02-27 21:41:20 - [main.summary_metrics:168]: Epoch 410/500 - Test Results:
{'auc': 0.8465855023381901,
 'f1': 0.4140435606060606,
 'loss': 0.4384880376699072,
 'ndcg': 0.7181065704844387,
 'precision': 0.553125,
 'recall': 0.33135066526610646}
[INFO] - 02-27 21:41:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[410] Complete. Time taken: 00:00:29.258
[INFO] - 02-27 21:41:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:41:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:41:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:41:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:41:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:41:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3031, 2198, 2213, 1]
[INFO] - 02-27 21:41:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:41:35 - [main.backward:225]: Epoch 411/500 - Iteration 50/95 - Time 0.291 batch, 0.041 data, 0.263 forward
[INFO] - 02-27 21:41:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:41:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0028)
[INFO] - 02-27 21:41:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5889 (0.5872)
[INFO] - 02-27 21:41:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5447 (-287.5445)
[INFO] - 02-27 21:41:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7532 (31.7816)
[INFO] - 02-27 21:41:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3389 (371.0230)
[INFO] - 02-27 21:41:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:41:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9694)
[INFO] - 02-27 21:41:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:41:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:41:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:41:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:41:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:41:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:41:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:41:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.971
[INFO] - 02-27 21:41:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.971
[INFO] - 02-27 21:41:51 - [main.summary_metrics:168]: Epoch 411/500 - Test Results:
{'auc': 0.846564848427116,
 'f1': 0.40893939393939394,
 'loss': 0.4388411451585277,
 'ndcg': 0.7257373220447125,
 'precision': 0.546875,
 'recall': 0.32703518907563023}
[INFO] - 02-27 21:41:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[411] Complete. Time taken: 00:00:30.433
[INFO] - 02-27 21:41:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:41:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:41:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:41:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:41:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:41:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2211, 2222, 1]
[INFO] - 02-27 21:41:51 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:41:53 - [main.backward:225]: Epoch 412/500 - Iteration 5/95 - Time 0.435 batch, 0.169 data, 0.408 forward
[INFO] - 02-27 21:41:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:41:53 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0030)
[INFO] - 02-27 21:41:53 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5886 (0.5863)
[INFO] - 02-27 21:41:53 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5417 (-287.5474)
[INFO] - 02-27 21:41:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8352 (31.7852)
[INFO] - 02-27 21:41:53 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4117 (371.1305)
[INFO] - 02-27 21:41:53 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:41:53 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9664)
[INFO] - 02-27 21:42:08 - [main.backward:225]: Epoch 412/500 - Iteration 55/95 - Time 0.320 batch, 0.043 data, 0.290 forward
[INFO] - 02-27 21:42:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:42:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0029)
[INFO] - 02-27 21:42:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5867)
[INFO] - 02-27 21:42:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5453)
[INFO] - 02-27 21:42:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7665 (31.7852)
[INFO] - 02-27 21:42:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5256 (370.9695)
[INFO] - 02-27 21:42:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:42:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9683)
[INFO] - 02-27 21:42:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:42:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:42:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:42:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:42:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:42:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:42:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:42:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.615
[INFO] - 02-27 21:42:23 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.616
[INFO] - 02-27 21:42:23 - [main.summary_metrics:168]: Epoch 412/500 - Test Results:
{'auc': 0.8457734986151323,
 'f1': 0.4044949494949495,
 'loss': 0.4383741434950762,
 'ndcg': 0.7165028746767151,
 'precision': 0.540625,
 'recall': 0.32360381652661063}
[INFO] - 02-27 21:42:23 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[412] Complete. Time taken: 00:00:32.940
[INFO] - 02-27 21:42:23 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:42:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:42:23 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:42:23 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:42:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:42:23 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3042, 2174, 2226, 1]
[INFO] - 02-27 21:42:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:42:27 - [main.backward:225]: Epoch 413/500 - Iteration 10/95 - Time 0.380 batch, 0.098 data, 0.348 forward
[INFO] - 02-27 21:42:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:42:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0032)
[INFO] - 02-27 21:42:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5818 (0.5865)
[INFO] - 02-27 21:42:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5394 (-287.5431)
[INFO] - 02-27 21:42:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8158 (31.7971)
[INFO] - 02-27 21:42:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4104 (371.1050)
[INFO] - 02-27 21:42:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:42:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9672)
[INFO] - 02-27 21:42:42 - [main.backward:225]: Epoch 413/500 - Iteration 60/95 - Time 0.315 batch, 0.041 data, 0.285 forward
[INFO] - 02-27 21:42:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:42:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0030)
[INFO] - 02-27 21:42:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5877 (0.5865)
[INFO] - 02-27 21:42:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5430 (-287.5414)
[INFO] - 02-27 21:42:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7366 (31.7973)
[INFO] - 02-27 21:42:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9755 (370.9222)
[INFO] - 02-27 21:42:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:42:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9669)
[INFO] - 02-27 21:42:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:42:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:42:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:42:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:42:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:42:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:42:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:42:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.580
[INFO] - 02-27 21:42:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.581
[INFO] - 02-27 21:42:55 - [main.summary_metrics:168]: Epoch 413/500 - Test Results:
{'auc': 0.8478242548244788,
 'f1': 0.4163583754208754,
 'loss': 0.43711006725194457,
 'ndcg': 0.7232470676283768,
 'precision': 0.5562499999999999,
 'recall': 0.3331889005602241}
[INFO] - 02-27 21:42:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[413] Complete. Time taken: 00:00:31.314
[INFO] - 02-27 21:42:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:42:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:42:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:42:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:42:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:42:55 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2219, 2221, 1]
[INFO] - 02-27 21:42:55 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:43:00 - [main.backward:225]: Epoch 414/500 - Iteration 15/95 - Time 0.329 batch, 0.070 data, 0.301 forward
[INFO] - 02-27 21:43:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0032)
[INFO] - 02-27 21:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5868 (0.5855)
[INFO] - 02-27 21:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5428)
[INFO] - 02-27 21:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7561 (31.7952)
[INFO] - 02-27 21:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.6067 (370.9519)
[INFO] - 02-27 21:43:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:43:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9633)
[INFO] - 02-27 21:43:15 - [main.backward:225]: Epoch 414/500 - Iteration 65/95 - Time 0.305 batch, 0.039 data, 0.276 forward
[INFO] - 02-27 21:43:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:43:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0031)
[INFO] - 02-27 21:43:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5848)
[INFO] - 02-27 21:43:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5474 (-287.5459)
[INFO] - 02-27 21:43:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7599 (31.7953)
[INFO] - 02-27 21:43:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8068 (370.8814)
[INFO] - 02-27 21:43:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:43:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9650)
[INFO] - 02-27 21:43:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:43:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:43:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:43:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:43:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:43:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:43:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:43:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.548
[INFO] - 02-27 21:43:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.549
[INFO] - 02-27 21:43:26 - [main.summary_metrics:168]: Epoch 414/500 - Test Results:
{'auc': 0.84706437765057,
 'f1': 0.4143329124579125,
 'loss': 0.4374279353886674,
 'ndcg': 0.7231161665916904,
 'precision': 0.5531250000000001,
 'recall': 0.33174457282913167}
[INFO] - 02-27 21:43:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[414] Complete. Time taken: 00:00:31.089
[INFO] - 02-27 21:43:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:43:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:43:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:43:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:43:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:43:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3056, 2185, 2206, 1]
[INFO] - 02-27 21:43:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:43:32 - [main.backward:225]: Epoch 415/500 - Iteration 20/95 - Time 0.313 batch, 0.056 data, 0.286 forward
[INFO] - 02-27 21:43:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:43:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0030)
[INFO] - 02-27 21:43:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5761 (0.5846)
[INFO] - 02-27 21:43:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5459)
[INFO] - 02-27 21:43:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7704 (31.8089)
[INFO] - 02-27 21:43:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0807 (371.0745)
[INFO] - 02-27 21:43:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:43:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9684)
[INFO] - 02-27 21:43:47 - [main.backward:225]: Epoch 415/500 - Iteration 70/95 - Time 0.305 batch, 0.036 data, 0.277 forward
[INFO] - 02-27 21:43:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0031)
[INFO] - 02-27 21:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5839 (0.5855)
[INFO] - 02-27 21:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5459)
[INFO] - 02-27 21:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7522 (31.8024)
[INFO] - 02-27 21:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2390 (370.9605)
[INFO] - 02-27 21:43:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:43:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9677)
[INFO] - 02-27 21:43:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:43:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:43:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:43:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:43:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:43:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:43:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:43:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.956
[INFO] - 02-27 21:43:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.956
[INFO] - 02-27 21:43:57 - [main.summary_metrics:168]: Epoch 415/500 - Test Results:
{'auc': 0.8465803302325832,
 'f1': 0.41625420875420877,
 'loss': 0.4378512193016587,
 'ndcg': 0.7205598194556656,
 'precision': 0.55625,
 'recall': 0.3330400910364146}
[INFO] - 02-27 21:43:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[415] Complete. Time taken: 00:00:31.533
[INFO] - 02-27 21:43:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:43:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:43:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:43:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:43:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:43:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3067, 2181, 2203, 1]
[INFO] - 02-27 21:43:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:44:06 - [main.backward:225]: Epoch 416/500 - Iteration 25/95 - Time 0.326 batch, 0.055 data, 0.297 forward
[INFO] - 02-27 21:44:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0029)
[INFO] - 02-27 21:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5875 (0.5858)
[INFO] - 02-27 21:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5444)
[INFO] - 02-27 21:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8116 (31.8081)
[INFO] - 02-27 21:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8798 (371.1642)
[INFO] - 02-27 21:44:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:44:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9688)
[INFO] - 02-27 21:44:20 - [main.backward:225]: Epoch 416/500 - Iteration 75/95 - Time 0.306 batch, 0.038 data, 0.277 forward
[INFO] - 02-27 21:44:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:44:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 21:44:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5876 (0.5856)
[INFO] - 02-27 21:44:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5442)
[INFO] - 02-27 21:44:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8082 (31.8111)
[INFO] - 02-27 21:44:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7242 (371.0913)
[INFO] - 02-27 21:44:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:44:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9666)
[INFO] - 02-27 21:44:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:44:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:44:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:44:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:44:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:44:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:44:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:44:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.353
[INFO] - 02-27 21:44:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.353
[INFO] - 02-27 21:44:28 - [main.summary_metrics:168]: Epoch 416/500 - Test Results:
{'auc': 0.8480878263069934,
 'f1': 0.4184880050505051,
 'loss': 0.4368919913726883,
 'ndcg': 0.7208955927359834,
 'precision': 0.559375,
 'recall': 0.33478203781512605}
[INFO] - 02-27 21:44:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[416] Complete. Time taken: 00:00:31.024
[INFO] - 02-27 21:44:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:44:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:44:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:44:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:44:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:44:28 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2197, 2207, 1]
[INFO] - 02-27 21:44:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:44:37 - [main.backward:225]: Epoch 417/500 - Iteration 30/95 - Time 0.300 batch, 0.048 data, 0.274 forward
[INFO] - 02-27 21:44:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0030)
[INFO] - 02-27 21:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5857)
[INFO] - 02-27 21:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5401 (-287.5461)
[INFO] - 02-27 21:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6942 (31.8052)
[INFO] - 02-27 21:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3119 (371.2979)
[INFO] - 02-27 21:44:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:44:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9683)
[INFO] - 02-27 21:44:52 - [main.backward:225]: Epoch 417/500 - Iteration 80/95 - Time 0.289 batch, 0.035 data, 0.263 forward
[INFO] - 02-27 21:44:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:44:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0033)
[INFO] - 02-27 21:44:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5895 (0.5858)
[INFO] - 02-27 21:44:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5431)
[INFO] - 02-27 21:44:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7638 (31.7892)
[INFO] - 02-27 21:44:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1210 (371.1555)
[INFO] - 02-27 21:44:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:44:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9648)
[INFO] - 02-27 21:44:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:44:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:44:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:44:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:44:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:44:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:44:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:44:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.490
[INFO] - 02-27 21:44:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.492
[INFO] - 02-27 21:44:58 - [main.summary_metrics:168]: Epoch 417/500 - Test Results:
{'auc': 0.8472813491205305,
 'f1': 0.41120265151515156,
 'loss': 0.43677100847903483,
 'ndcg': 0.7187781975746481,
 'precision': 0.55,
 'recall': 0.3287464985994398}
[INFO] - 02-27 21:44:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[417] Complete. Time taken: 00:00:29.865
[INFO] - 02-27 21:44:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:44:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:44:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:44:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:44:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:44:58 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3016, 2186, 2197, 1]
[INFO] - 02-27 21:44:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:45:09 - [main.backward:225]: Epoch 418/500 - Iteration 35/95 - Time 0.296 batch, 0.044 data, 0.270 forward
[INFO] - 02-27 21:45:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:45:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0032)
[INFO] - 02-27 21:45:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5898 (0.5857)
[INFO] - 02-27 21:45:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5454 (-287.5454)
[INFO] - 02-27 21:45:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9233 (31.8016)
[INFO] - 02-27 21:45:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.3293 (371.4565)
[INFO] - 02-27 21:45:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:45:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9634)
[INFO] - 02-27 21:45:23 - [main.backward:225]: Epoch 418/500 - Iteration 85/95 - Time 0.289 batch, 0.034 data, 0.262 forward
[INFO] - 02-27 21:45:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0032)
[INFO] - 02-27 21:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5825 (0.5856)
[INFO] - 02-27 21:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5403 (-287.5457)
[INFO] - 02-27 21:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8238 (31.8000)
[INFO] - 02-27 21:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1114 (371.3543)
[INFO] - 02-27 21:45:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:45:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9659)
[INFO] - 02-27 21:45:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:45:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:45:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:45:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:45:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:45:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:45:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:45:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.508
[INFO] - 02-27 21:45:28 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.508
[INFO] - 02-27 21:45:28 - [main.summary_metrics:168]: Epoch 418/500 - Test Results:
{'auc': 0.8453987409301957,
 'f1': 0.40209911616161614,
 'loss': 0.43841400496283933,
 'ndcg': 0.7188727746941802,
 'precision': 0.5375,
 'recall': 0.32166929271708683}
[INFO] - 02-27 21:45:28 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[418] Complete. Time taken: 00:00:29.807
[INFO] - 02-27 21:45:28 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:45:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:45:28 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:45:28 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:45:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:45:28 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2194, 2206, 1]
[INFO] - 02-27 21:45:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:45:40 - [main.backward:225]: Epoch 419/500 - Iteration 40/95 - Time 0.296 batch, 0.041 data, 0.270 forward
[INFO] - 02-27 21:45:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:45:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0032)
[INFO] - 02-27 21:45:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5858)
[INFO] - 02-27 21:45:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5476 (-287.5443)
[INFO] - 02-27 21:45:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8179 (31.8008)
[INFO] - 02-27 21:45:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5378 (371.2235)
[INFO] - 02-27 21:45:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:45:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9641)
[INFO] - 02-27 21:45:54 - [main.backward:225]: Epoch 419/500 - Iteration 90/95 - Time 0.286 batch, 0.032 data, 0.261 forward
[INFO] - 02-27 21:45:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:45:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0032)
[INFO] - 02-27 21:45:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5811 (0.5846)
[INFO] - 02-27 21:45:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5440)
[INFO] - 02-27 21:45:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8147 (31.8059)
[INFO] - 02-27 21:45:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4188 (371.2942)
[INFO] - 02-27 21:45:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:45:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9652)
[INFO] - 02-27 21:45:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:45:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:45:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:45:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:45:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:45:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:45:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:45:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.440
[INFO] - 02-27 21:45:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.441
[INFO] - 02-27 21:45:58 - [main.summary_metrics:168]: Epoch 419/500 - Test Results:
{'auc': 0.8462887976268939,
 'f1': 0.42098800505050504,
 'loss': 0.43733259939110847,
 'ndcg': 0.7241831016945534,
 'precision': 0.5625,
 'recall': 0.3368653711484594}
[INFO] - 02-27 21:45:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[419] Complete. Time taken: 00:00:29.639
[INFO] - 02-27 21:45:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:45:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:45:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:45:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:45:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:45:58 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3063, 2199, 2198, 1]
[INFO] - 02-27 21:45:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:46:11 - [main.backward:225]: Epoch 420/500 - Iteration 45/95 - Time 0.288 batch, 0.038 data, 0.263 forward
[INFO] - 02-27 21:46:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0033)
[INFO] - 02-27 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5867 (0.5851)
[INFO] - 02-27 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5471 (-287.5456)
[INFO] - 02-27 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7651 (31.7860)
[INFO] - 02-27 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9438 (371.0544)
[INFO] - 02-27 21:46:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:46:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9637)
[INFO] - 02-27 21:46:25 - [main.backward:225]: Epoch 420/500 - Iteration 0/95 - Time 0.287 batch, 0.032 data, 0.260 forward
[INFO] - 02-27 21:46:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:46:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0029)
[INFO] - 02-27 21:46:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5827 (0.5858)
[INFO] - 02-27 21:46:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5458 (-287.5452)
[INFO] - 02-27 21:46:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8495 (31.7936)
[INFO] - 02-27 21:46:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5436 (371.2177)
[INFO] - 02-27 21:46:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:46:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9694)
[INFO] - 02-27 21:46:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:46:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:46:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:46:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:46:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:46:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:46:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:46:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.456
[INFO] - 02-27 21:46:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.457
[INFO] - 02-27 21:46:27 - [main.summary_metrics:168]: Epoch 420/500 - Test Results:
{'auc': 0.8474327391495814,
 'f1': 0.4256176346801347,
 'loss': 0.4365705211213581,
 'ndcg': 0.7246871365365481,
 'precision': 0.56875,
 'recall': 0.34054184173669466}
[INFO] - 02-27 21:46:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[420] Complete. Time taken: 00:00:29.687
[INFO] - 02-27 21:46:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:46:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:46:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:46:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:46:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:46:27 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3049, 2185, 2214, 1]
[INFO] - 02-27 21:46:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:46:42 - [main.backward:225]: Epoch 421/500 - Iteration 50/95 - Time 0.297 batch, 0.039 data, 0.270 forward
[INFO] - 02-27 21:46:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0029)
[INFO] - 02-27 21:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5881 (0.5867)
[INFO] - 02-27 21:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5479 (-287.5468)
[INFO] - 02-27 21:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7727 (31.7883)
[INFO] - 02-27 21:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9069 (371.3627)
[INFO] - 02-27 21:46:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:46:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9700)
[INFO] - 02-27 21:46:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:46:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:46:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:46:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:46:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:46:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:46:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:46:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.341
[INFO] - 02-27 21:46:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.341
[INFO] - 02-27 21:46:57 - [main.summary_metrics:168]: Epoch 421/500 - Test Results:
{'auc': 0.8457425718449144,
 'f1': 0.4143329124579125,
 'loss': 0.4384711023534789,
 'ndcg': 0.7138805314795353,
 'precision': 0.553125,
 'recall': 0.33174457282913167}
[INFO] - 02-27 21:46:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[421] Complete. Time taken: 00:00:29.719
[INFO] - 02-27 21:46:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:46:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:46:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:46:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:46:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:46:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3031, 2203, 2206, 1]
[INFO] - 02-27 21:46:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:46:59 - [main.backward:225]: Epoch 422/500 - Iteration 5/95 - Time 0.385 batch, 0.137 data, 0.359 forward
[INFO] - 02-27 21:46:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:46:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 21:46:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5832 (0.5851)
[INFO] - 02-27 21:46:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5444 (-287.5461)
[INFO] - 02-27 21:46:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8029 (31.7766)
[INFO] - 02-27 21:46:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4517 (371.2096)
[INFO] - 02-27 21:46:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:46:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9656)
[INFO] - 02-27 21:47:13 - [main.backward:225]: Epoch 422/500 - Iteration 55/95 - Time 0.288 batch, 0.036 data, 0.262 forward
[INFO] - 02-27 21:47:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0031)
[INFO] - 02-27 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5850 (0.5851)
[INFO] - 02-27 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5429 (-287.5437)
[INFO] - 02-27 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6868 (31.7712)
[INFO] - 02-27 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.0956 (371.0099)
[INFO] - 02-27 21:47:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:47:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9667)
[INFO] - 02-27 21:47:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:47:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:47:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:47:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:47:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:47:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:47:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:47:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.305
[INFO] - 02-27 21:47:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.307
[INFO] - 02-27 21:47:26 - [main.summary_metrics:168]: Epoch 422/500 - Test Results:
{'auc': 0.8454823113068757,
 'f1': 0.4120180976430976,
 'loss': 0.438130887145331,
 'ndcg': 0.7207792750820274,
 'precision': 0.55,
 'recall': 0.329906337535014}
[INFO] - 02-27 21:47:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[422] Complete. Time taken: 00:00:28.981
[INFO] - 02-27 21:47:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:47:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:47:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:47:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:47:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:47:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2192, 2218, 1]
[INFO] - 02-27 21:47:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:47:30 - [main.backward:225]: Epoch 423/500 - Iteration 10/95 - Time 0.349 batch, 0.085 data, 0.321 forward
[INFO] - 02-27 21:47:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0030)
[INFO] - 02-27 21:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5849 (0.5856)
[INFO] - 02-27 21:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5448 (-287.5455)
[INFO] - 02-27 21:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8042 (31.7910)
[INFO] - 02-27 21:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9865 (371.1254)
[INFO] - 02-27 21:47:30 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:47:30 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9688)
[INFO] - 02-27 21:47:46 - [main.backward:225]: Epoch 423/500 - Iteration 60/95 - Time 0.324 batch, 0.039 data, 0.294 forward
[INFO] - 02-27 21:47:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:47:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0030)
[INFO] - 02-27 21:47:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5839 (0.5866)
[INFO] - 02-27 21:47:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5436)
[INFO] - 02-27 21:47:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7654 (31.7818)
[INFO] - 02-27 21:47:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4883 (371.1249)
[INFO] - 02-27 21:47:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:47:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9664)
[INFO] - 02-27 21:47:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:47:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:47:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:47:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:47:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:47:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:47:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:47:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.722
[INFO] - 02-27 21:47:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.723
[INFO] - 02-27 21:47:59 - [main.summary_metrics:168]: Epoch 423/500 - Test Results:
{'auc': 0.8469951710463597,
 'f1': 0.42359217171717173,
 'loss': 0.43768976185278763,
 'ndcg': 0.7202594543539503,
 'precision': 0.565625,
 'recall': 0.3390975140056023}
[INFO] - 02-27 21:47:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[423] Complete. Time taken: 00:00:33.135
[INFO] - 02-27 21:47:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:47:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:47:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:47:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:47:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:47:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3067, 2192, 2224, 1]
[INFO] - 02-27 21:48:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:48:04 - [main.backward:225]: Epoch 424/500 - Iteration 15/95 - Time 0.349 batch, 0.072 data, 0.319 forward
[INFO] - 02-27 21:48:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:48:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0055 (0.0033)
[INFO] - 02-27 21:48:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5890 (0.5869)
[INFO] - 02-27 21:48:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5412 (-287.5415)
[INFO] - 02-27 21:48:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8207 (31.7966)
[INFO] - 02-27 21:48:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5056 (371.3784)
[INFO] - 02-27 21:48:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:48:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9650)
[INFO] - 02-27 21:48:20 - [main.backward:225]: Epoch 424/500 - Iteration 65/95 - Time 0.315 batch, 0.038 data, 0.286 forward
[INFO] - 02-27 21:48:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:48:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 21:48:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5867)
[INFO] - 02-27 21:48:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5423)
[INFO] - 02-27 21:48:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7863 (31.7927)
[INFO] - 02-27 21:48:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8224 (371.2794)
[INFO] - 02-27 21:48:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:48:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9652)
[INFO] - 02-27 21:48:29 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:48:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:48:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:48:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:48:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:48:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:48:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:48:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.575
[INFO] - 02-27 21:48:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.575
[INFO] - 02-27 21:48:32 - [main.summary_metrics:168]: Epoch 424/500 - Test Results:
{'auc': 0.8466819277956281,
 'f1': 0.4256176346801347,
 'loss': 0.4386823760193017,
 'ndcg': 0.7226012577004708,
 'precision': 0.5687500000000001,
 'recall': 0.34054184173669466}
[INFO] - 02-27 21:48:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[424] Complete. Time taken: 00:00:32.338
[INFO] - 02-27 21:48:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:48:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:48:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:48:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:48:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:48:32 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2201, 2219, 1]
[INFO] - 02-27 21:48:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:48:38 - [main.backward:225]: Epoch 425/500 - Iteration 20/95 - Time 0.334 batch, 0.065 data, 0.306 forward
[INFO] - 02-27 21:48:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:48:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0031)
[INFO] - 02-27 21:48:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5870 (0.5868)
[INFO] - 02-27 21:48:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5425 (-287.5424)
[INFO] - 02-27 21:48:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7999 (31.7883)
[INFO] - 02-27 21:48:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1108 (371.2572)
[INFO] - 02-27 21:48:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:48:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9652)
[INFO] - 02-27 21:48:54 - [main.backward:225]: Epoch 425/500 - Iteration 70/95 - Time 0.314 batch, 0.039 data, 0.286 forward
[INFO] - 02-27 21:48:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0031)
[INFO] - 02-27 21:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5908 (0.5867)
[INFO] - 02-27 21:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5480 (-287.5426)
[INFO] - 02-27 21:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7843 (31.7815)
[INFO] - 02-27 21:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0325 (371.0866)
[INFO] - 02-27 21:48:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:48:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9661)
[INFO] - 02-27 21:49:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:49:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:49:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:49:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:49:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:49:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:49:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:49:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.700
[INFO] - 02-27 21:49:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.701
[INFO] - 02-27 21:49:04 - [main.summary_metrics:168]: Epoch 425/500 - Test Results:
{'auc': 0.8467042031886283,
 'f1': 0.4257218013468013,
 'loss': 0.4377200610217674,
 'ndcg': 0.7198138795875504,
 'precision': 0.5687500000000001,
 'recall': 0.34069065126050424}
[INFO] - 02-27 21:49:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[425] Complete. Time taken: 00:00:32.394
[INFO] - 02-27 21:49:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:49:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:49:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:49:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:49:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:49:04 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2180, 2188, 1]
[INFO] - 02-27 21:49:05 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:49:12 - [main.backward:225]: Epoch 426/500 - Iteration 25/95 - Time 0.322 batch, 0.053 data, 0.294 forward
[INFO] - 02-27 21:49:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:49:12 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0031)
[INFO] - 02-27 21:49:12 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5851)
[INFO] - 02-27 21:49:12 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5479 (-287.5454)
[INFO] - 02-27 21:49:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7276 (31.8068)
[INFO] - 02-27 21:49:12 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3783 (371.3198)
[INFO] - 02-27 21:49:12 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:49:12 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9670)
[INFO] - 02-27 21:49:27 - [main.backward:225]: Epoch 426/500 - Iteration 75/95 - Time 0.307 batch, 0.036 data, 0.280 forward
[INFO] - 02-27 21:49:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:49:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0031)
[INFO] - 02-27 21:49:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5901 (0.5859)
[INFO] - 02-27 21:49:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5409 (-287.5428)
[INFO] - 02-27 21:49:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8583 (31.8007)
[INFO] - 02-27 21:49:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0254 (370.9862)
[INFO] - 02-27 21:49:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:49:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9677)
[INFO] - 02-27 21:49:33 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:49:33 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:49:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:49:33 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:49:33 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:49:33 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:49:33 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:49:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.572
[INFO] - 02-27 21:49:36 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.573
[INFO] - 02-27 21:49:36 - [main.summary_metrics:168]: Epoch 426/500 - Test Results:
{'auc': 0.8461745182141485,
 'f1': 0.42359217171717173,
 'loss': 0.43803157753459476,
 'ndcg': 0.7167816469537485,
 'precision': 0.565625,
 'recall': 0.3390975140056023}
[INFO] - 02-27 21:49:36 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[426] Complete. Time taken: 00:00:31.662
[INFO] - 02-27 21:49:36 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:49:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:49:36 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:49:36 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:49:36 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:49:36 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3079, 2181, 2221, 1]
[INFO] - 02-27 21:49:36 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:49:45 - [main.backward:225]: Epoch 427/500 - Iteration 30/95 - Time 0.321 batch, 0.049 data, 0.293 forward
[INFO] - 02-27 21:49:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0033)
[INFO] - 02-27 21:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5849 (0.5847)
[INFO] - 02-27 21:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5437)
[INFO] - 02-27 21:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8188 (31.7944)
[INFO] - 02-27 21:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3766 (371.1687)
[INFO] - 02-27 21:49:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:49:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9616)
[INFO] - 02-27 21:50:00 - [main.backward:225]: Epoch 427/500 - Iteration 80/95 - Time 0.309 batch, 0.036 data, 0.280 forward
[INFO] - 02-27 21:50:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0030)
[INFO] - 02-27 21:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5866 (0.5863)
[INFO] - 02-27 21:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5448)
[INFO] - 02-27 21:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8199 (31.7937)
[INFO] - 02-27 21:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3356 (371.2671)
[INFO] - 02-27 21:50:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:50:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9670)
[INFO] - 02-27 21:50:05 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:50:05 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:50:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:50:05 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:50:05 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:50:05 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:50:05 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:50:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.631
[INFO] - 02-27 21:50:07 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.633
[INFO] - 02-27 21:50:07 - [main.summary_metrics:168]: Epoch 427/500 - Test Results:
{'auc': 0.8477234827754632,
 'f1': 0.4256176346801347,
 'loss': 0.4375538795494074,
 'ndcg': 0.7217940728263619,
 'precision': 0.5687500000000001,
 'recall': 0.34054184173669466}
[INFO] - 02-27 21:50:07 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[427] Complete. Time taken: 00:00:31.777
[INFO] - 02-27 21:50:07 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:50:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:50:07 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:50:07 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:50:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:50:07 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3069, 2216, 2208, 1]
[INFO] - 02-27 21:50:08 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:50:19 - [main.backward:225]: Epoch 428/500 - Iteration 35/95 - Time 0.318 batch, 0.046 data, 0.290 forward
[INFO] - 02-27 21:50:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:50:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0030)
[INFO] - 02-27 21:50:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5823 (0.5861)
[INFO] - 02-27 21:50:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5382 (-287.5416)
[INFO] - 02-27 21:50:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8217 (31.8067)
[INFO] - 02-27 21:50:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4635 (371.4571)
[INFO] - 02-27 21:50:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:50:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9681)
[INFO] - 02-27 21:50:34 - [main.backward:225]: Epoch 428/500 - Iteration 85/95 - Time 0.307 batch, 0.036 data, 0.279 forward
[INFO] - 02-27 21:50:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:50:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0031)
[INFO] - 02-27 21:50:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5831 (0.5862)
[INFO] - 02-27 21:50:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5490 (-287.5426)
[INFO] - 02-27 21:50:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8294 (31.7984)
[INFO] - 02-27 21:50:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8055 (371.2828)
[INFO] - 02-27 21:50:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:50:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9658)
[INFO] - 02-27 21:50:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:50:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:50:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:50:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:50:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:50:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:50:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:50:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.585
[INFO] - 02-27 21:50:39 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.586
[INFO] - 02-27 21:50:39 - [main.summary_metrics:168]: Epoch 428/500 - Test Results:
{'auc': 0.8465689643504462,
 'f1': 0.41635837542087545,
 'loss': 0.43746357522385204,
 'ndcg': 0.7249807442029345,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 21:50:39 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[428] Complete. Time taken: 00:00:31.785
[INFO] - 02-27 21:50:39 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:50:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:50:39 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:50:39 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:50:39 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:50:39 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2201, 2201, 1]
[INFO] - 02-27 21:50:40 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:50:52 - [main.backward:225]: Epoch 429/500 - Iteration 40/95 - Time 0.314 batch, 0.043 data, 0.286 forward
[INFO] - 02-27 21:50:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0030)
[INFO] - 02-27 21:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5913 (0.5866)
[INFO] - 02-27 21:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5417 (-287.5438)
[INFO] - 02-27 21:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7733 (31.8024)
[INFO] - 02-27 21:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7367 (371.2449)
[INFO] - 02-27 21:50:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:50:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9697)
[INFO] - 02-27 21:51:07 - [main.backward:225]: Epoch 429/500 - Iteration 90/95 - Time 0.306 batch, 0.035 data, 0.277 forward
[INFO] - 02-27 21:51:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:51:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0031)
[INFO] - 02-27 21:51:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5849)
[INFO] - 02-27 21:51:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5431)
[INFO] - 02-27 21:51:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8303 (31.8039)
[INFO] - 02-27 21:51:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1584 (371.3397)
[INFO] - 02-27 21:51:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:51:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9663)
[INFO] - 02-27 21:51:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:51:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:51:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:51:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:51:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:51:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:51:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:51:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.527
[INFO] - 02-27 21:51:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.527
[INFO] - 02-27 21:51:11 - [main.summary_metrics:168]: Epoch 429/500 - Test Results:
{'auc': 0.8462642522695353,
 'f1': 0.4161731902356902,
 'loss': 0.4388876505094121,
 'ndcg': 0.7182852189946495,
 'precision': 0.55625,
 'recall': 0.3329438025210084}
[INFO] - 02-27 21:51:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[429] Complete. Time taken: 00:00:31.581
[INFO] - 02-27 21:51:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:51:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:51:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:51:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:51:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:51:11 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2201, 2204, 1]
[INFO] - 02-27 21:51:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:51:25 - [main.backward:225]: Epoch 430/500 - Iteration 45/95 - Time 0.320 batch, 0.042 data, 0.290 forward
[INFO] - 02-27 21:51:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0034)
[INFO] - 02-27 21:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5848 (0.5863)
[INFO] - 02-27 21:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5441 (-287.5432)
[INFO] - 02-27 21:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7780 (31.8053)
[INFO] - 02-27 21:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.0422 (371.2357)
[INFO] - 02-27 21:51:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:51:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9605)
[INFO] - 02-27 21:51:40 - [main.backward:225]: Epoch 430/500 - Iteration 0/95 - Time 0.310 batch, 0.035 data, 0.281 forward
[INFO] - 02-27 21:51:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0033)
[INFO] - 02-27 21:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5874)
[INFO] - 02-27 21:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5410 (-287.5423)
[INFO] - 02-27 21:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8042 (31.7947)
[INFO] - 02-27 21:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6104 (371.2415)
[INFO] - 02-27 21:51:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:51:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9650)
[INFO] - 02-27 21:51:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:51:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:51:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:51:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:51:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:51:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:51:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:51:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.525
[INFO] - 02-27 21:51:43 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.525
[INFO] - 02-27 21:51:43 - [main.summary_metrics:168]: Epoch 430/500 - Test Results:
{'auc': 0.8471892720323424,
 'f1': 0.42098800505050504,
 'loss': 0.43784808047493157,
 'ndcg': 0.7217921748105317,
 'precision': 0.5625,
 'recall': 0.3368653711484594}
[INFO] - 02-27 21:51:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[430] Complete. Time taken: 00:00:31.969
[INFO] - 02-27 21:51:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:51:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:51:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:51:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:51:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:51:43 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3040, 2202, 2197, 1]
[INFO] - 02-27 21:51:43 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:51:58 - [main.backward:225]: Epoch 431/500 - Iteration 50/95 - Time 0.314 batch, 0.040 data, 0.287 forward
[INFO] - 02-27 21:51:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0033)
[INFO] - 02-27 21:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5822 (0.5860)
[INFO] - 02-27 21:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5392 (-287.5403)
[INFO] - 02-27 21:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7978 (31.7947)
[INFO] - 02-27 21:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6066 (371.2537)
[INFO] - 02-27 21:51:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:51:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9623)
[INFO] - 02-27 21:52:12 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:52:12 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:52:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:52:12 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:52:12 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:52:12 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:52:12 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:52:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.633
[INFO] - 02-27 21:52:15 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.634
[INFO] - 02-27 21:52:15 - [main.summary_metrics:168]: Epoch 431/500 - Test Results:
{'auc': 0.8461873128540631,
 'f1': 0.4212773569023569,
 'loss': 0.43814636731451007,
 'ndcg': 0.7247500749040355,
 'precision': 0.5625,
 'recall': 0.3372592787114846}
[INFO] - 02-27 21:52:15 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[431] Complete. Time taken: 00:00:31.774
[INFO] - 02-27 21:52:15 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:52:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:52:15 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:52:15 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:52:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:52:15 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2196, 2196, 1]
[INFO] - 02-27 21:52:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:52:17 - [main.backward:225]: Epoch 432/500 - Iteration 5/95 - Time 0.435 batch, 0.156 data, 0.407 forward
[INFO] - 02-27 21:52:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:52:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0032)
[INFO] - 02-27 21:52:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5861)
[INFO] - 02-27 21:52:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5415)
[INFO] - 02-27 21:52:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8278 (31.8038)
[INFO] - 02-27 21:52:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9301 (371.2444)
[INFO] - 02-27 21:52:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:52:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9644)
[INFO] - 02-27 21:52:32 - [main.backward:225]: Epoch 432/500 - Iteration 55/95 - Time 0.314 batch, 0.040 data, 0.286 forward
[INFO] - 02-27 21:52:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:52:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0031)
[INFO] - 02-27 21:52:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5855)
[INFO] - 02-27 21:52:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5466 (-287.5443)
[INFO] - 02-27 21:52:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7771 (31.7879)
[INFO] - 02-27 21:52:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3620 (371.1439)
[INFO] - 02-27 21:52:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:52:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9647)
[INFO] - 02-27 21:52:44 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:52:44 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:52:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:52:44 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:52:44 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:52:44 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:52:44 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:52:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.576
[INFO] - 02-27 21:52:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.578
[INFO] - 02-27 21:52:47 - [main.summary_metrics:168]: Epoch 432/500 - Test Results:
{'auc': 0.8468043701549247,
 'f1': 0.41896254208754213,
 'loss': 0.43758329259003026,
 'ndcg': 0.724082562758015,
 'precision': 0.559375,
 'recall': 0.33542104341736695}
[INFO] - 02-27 21:52:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[432] Complete. Time taken: 00:00:32.175
[INFO] - 02-27 21:52:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:52:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:52:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:52:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:52:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:52:47 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2206, 2223, 1]
[INFO] - 02-27 21:52:47 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:52:51 - [main.backward:225]: Epoch 433/500 - Iteration 10/95 - Time 0.381 batch, 0.099 data, 0.351 forward
[INFO] - 02-27 21:52:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0031)
[INFO] - 02-27 21:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5860)
[INFO] - 02-27 21:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5462)
[INFO] - 02-27 21:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6487 (31.7761)
[INFO] - 02-27 21:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.0767 (371.2260)
[INFO] - 02-27 21:52:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:52:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9664)
[INFO] - 02-27 21:53:06 - [main.backward:225]: Epoch 433/500 - Iteration 60/95 - Time 0.319 batch, 0.041 data, 0.290 forward
[INFO] - 02-27 21:53:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0032)
[INFO] - 02-27 21:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5881 (0.5850)
[INFO] - 02-27 21:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5449)
[INFO] - 02-27 21:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8628 (31.7998)
[INFO] - 02-27 21:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2865 (371.1855)
[INFO] - 02-27 21:53:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:53:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9639)
[INFO] - 02-27 21:53:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:53:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:53:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:53:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:53:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:53:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:53:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:53:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.631
[INFO] - 02-27 21:53:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.632
[INFO] - 02-27 21:53:19 - [main.summary_metrics:168]: Epoch 433/500 - Test Results:
{'auc': 0.8460581714303368,
 'f1': 0.4184880050505051,
 'loss': 0.43833733127426366,
 'ndcg': 0.7201073782468927,
 'precision': 0.559375,
 'recall': 0.33478203781512605}
[INFO] - 02-27 21:53:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[433] Complete. Time taken: 00:00:32.683
[INFO] - 02-27 21:53:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:53:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:53:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:53:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:53:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:53:19 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3079, 2200, 2211, 1]
[INFO] - 02-27 21:53:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:53:24 - [main.backward:225]: Epoch 434/500 - Iteration 15/95 - Time 0.339 batch, 0.075 data, 0.310 forward
[INFO] - 02-27 21:53:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:53:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0031)
[INFO] - 02-27 21:53:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5867 (0.5865)
[INFO] - 02-27 21:53:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5451)
[INFO] - 02-27 21:53:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8510 (31.7960)
[INFO] - 02-27 21:53:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7959 (371.3018)
[INFO] - 02-27 21:53:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:53:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9631)
[INFO] - 02-27 21:53:40 - [main.backward:225]: Epoch 434/500 - Iteration 65/95 - Time 0.310 batch, 0.039 data, 0.282 forward
[INFO] - 02-27 21:53:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:53:40 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0033)
[INFO] - 02-27 21:53:40 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5856)
[INFO] - 02-27 21:53:40 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5443)
[INFO] - 02-27 21:53:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8259 (31.7956)
[INFO] - 02-27 21:53:40 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3538 (371.1732)
[INFO] - 02-27 21:53:40 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:53:40 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9613)
[INFO] - 02-27 21:53:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:53:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:53:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:53:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:53:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:53:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:53:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:53:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.004
[INFO] - 02-27 21:53:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.005
[INFO] - 02-27 21:53:52 - [main.summary_metrics:168]: Epoch 434/500 - Test Results:
{'auc': 0.8477989941074469,
 'f1': 0.4256176346801347,
 'loss': 0.4363535211363454,
 'ndcg': 0.728258110457799,
 'precision': 0.56875,
 'recall': 0.34054184173669466}
[INFO] - 02-27 21:53:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[434] Complete. Time taken: 00:00:32.462
[INFO] - 02-27 21:53:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:53:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:53:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:53:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:53:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:53:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3043, 2180, 2196, 1]
[INFO] - 02-27 21:53:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:53:59 - [main.backward:225]: Epoch 435/500 - Iteration 20/95 - Time 0.362 batch, 0.065 data, 0.330 forward
[INFO] - 02-27 21:53:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:53:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0043 (0.0029)
[INFO] - 02-27 21:53:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5925 (0.5859)
[INFO] - 02-27 21:53:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5458 (-287.5464)
[INFO] - 02-27 21:53:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7291 (31.7761)
[INFO] - 02-27 21:53:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5183 (371.1920)
[INFO] - 02-27 21:53:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:53:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9683)
[INFO] - 02-27 21:54:15 - [main.backward:225]: Epoch 435/500 - Iteration 70/95 - Time 0.334 batch, 0.041 data, 0.303 forward
[INFO] - 02-27 21:54:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0030)
[INFO] - 02-27 21:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5862)
[INFO] - 02-27 21:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5444 (-287.5459)
[INFO] - 02-27 21:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7997 (31.7847)
[INFO] - 02-27 21:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9260 (371.3833)
[INFO] - 02-27 21:54:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:54:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9675)
[INFO] - 02-27 21:54:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:54:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:54:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:54:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:54:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:54:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:54:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:54:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.657
[INFO] - 02-27 21:54:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.658
[INFO] - 02-27 21:54:26 - [main.summary_metrics:168]: Epoch 435/500 - Test Results:
{'auc': 0.8475688667010922,
 'f1': 0.41825126262626267,
 'loss': 0.4375135676979206,
 'ndcg': 0.7264975474154012,
 'precision': 0.559375,
 'recall': 0.3344100140056022}
[INFO] - 02-27 21:54:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[435] Complete. Time taken: 00:00:33.726
[INFO] - 02-27 21:54:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:54:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:54:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:54:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:54:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:54:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2211, 2212, 1]
[INFO] - 02-27 21:54:26 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:54:34 - [main.backward:225]: Epoch 436/500 - Iteration 25/95 - Time 0.324 batch, 0.053 data, 0.297 forward
[INFO] - 02-27 21:54:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0032)
[INFO] - 02-27 21:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5831 (0.5863)
[INFO] - 02-27 21:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5433 (-287.5416)
[INFO] - 02-27 21:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8098 (31.7792)
[INFO] - 02-27 21:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5057 (371.1474)
[INFO] - 02-27 21:54:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:54:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9658)
[INFO] - 02-27 21:54:48 - [main.backward:225]: Epoch 436/500 - Iteration 75/95 - Time 0.305 batch, 0.036 data, 0.277 forward
[INFO] - 02-27 21:54:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:54:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0031)
[INFO] - 02-27 21:54:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5857 (0.5848)
[INFO] - 02-27 21:54:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5448 (-287.5430)
[INFO] - 02-27 21:54:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7570 (31.8028)
[INFO] - 02-27 21:54:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4177 (371.2776)
[INFO] - 02-27 21:54:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:54:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9636)
[INFO] - 02-27 21:54:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:54:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:54:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:54:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:54:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:54:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:54:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:54:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.363
[INFO] - 02-27 21:54:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.364
[INFO] - 02-27 21:54:57 - [main.summary_metrics:168]: Epoch 436/500 - Test Results:
{'auc': 0.8470537558160519,
 'f1': 0.4254324494949495,
 'loss': 0.43700343109591994,
 'ndcg': 0.7279817120009255,
 'precision': 0.5687500000000001,
 'recall': 0.340296743697479}
[INFO] - 02-27 21:54:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[436] Complete. Time taken: 00:00:31.204
[INFO] - 02-27 21:54:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:54:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:54:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:54:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:54:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:54:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3007, 2191, 2218, 1]
[INFO] - 02-27 21:54:57 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:55:06 - [main.backward:225]: Epoch 437/500 - Iteration 30/95 - Time 0.306 batch, 0.047 data, 0.279 forward
[INFO] - 02-27 21:55:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:55:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0033)
[INFO] - 02-27 21:55:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5852)
[INFO] - 02-27 21:55:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5433 (-287.5437)
[INFO] - 02-27 21:55:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7758 (31.8101)
[INFO] - 02-27 21:55:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6667 (371.2588)
[INFO] - 02-27 21:55:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:55:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9639)
[INFO] - 02-27 21:55:20 - [main.backward:225]: Epoch 437/500 - Iteration 80/95 - Time 0.296 batch, 0.035 data, 0.269 forward
[INFO] - 02-27 21:55:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:55:20 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0031)
[INFO] - 02-27 21:55:20 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5855)
[INFO] - 02-27 21:55:20 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5390 (-287.5414)
[INFO] - 02-27 21:55:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9215 (31.8078)
[INFO] - 02-27 21:55:20 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 373.1149 (371.1668)
[INFO] - 02-27 21:55:20 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:55:20 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9652)
[INFO] - 02-27 21:55:25 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:55:25 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:55:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:55:25 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:55:25 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:55:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:55:25 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:55:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.445
[INFO] - 02-27 21:55:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.445
[INFO] - 02-27 21:55:27 - [main.summary_metrics:168]: Epoch 437/500 - Test Results:
{'auc': 0.8467408217576247,
 'f1': 0.4256176346801347,
 'loss': 0.4379657241615976,
 'ndcg': 0.7184208599198368,
 'precision': 0.5687500000000001,
 'recall': 0.34054184173669466}
[INFO] - 02-27 21:55:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[437] Complete. Time taken: 00:00:30.450
[INFO] - 02-27 21:55:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:55:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:55:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:55:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:55:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:55:27 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3029, 2193, 2210, 1]
[INFO] - 02-27 21:55:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:55:38 - [main.backward:225]: Epoch 438/500 - Iteration 35/95 - Time 0.295 batch, 0.043 data, 0.269 forward
[INFO] - 02-27 21:55:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:55:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0031)
[INFO] - 02-27 21:55:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5874)
[INFO] - 02-27 21:55:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5425 (-287.5420)
[INFO] - 02-27 21:55:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8403 (31.8067)
[INFO] - 02-27 21:55:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8841 (371.2975)
[INFO] - 02-27 21:55:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:55:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9637)
[INFO] - 02-27 21:55:52 - [main.backward:225]: Epoch 438/500 - Iteration 85/95 - Time 0.285 batch, 0.034 data, 0.259 forward
[INFO] - 02-27 21:55:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0034)
[INFO] - 02-27 21:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5863)
[INFO] - 02-27 21:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5441 (-287.5444)
[INFO] - 02-27 21:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8061 (31.8035)
[INFO] - 02-27 21:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4855 (371.3196)
[INFO] - 02-27 21:55:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:55:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9614)
[INFO] - 02-27 21:55:54 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:55:54 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:55:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:55:54 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:55:54 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:55:54 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:55:54 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:55:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.591
[INFO] - 02-27 21:55:57 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.592
[INFO] - 02-27 21:55:57 - [main.summary_metrics:168]: Epoch 438/500 - Test Results:
{'auc': 0.8467437007891392,
 'f1': 0.4185690235690236,
 'loss': 0.43785163369447516,
 'ndcg': 0.7172511417339564,
 'precision': 0.559375,
 'recall': 0.3348783263305322}
[INFO] - 02-27 21:55:57 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[438] Complete. Time taken: 00:00:29.697
[INFO] - 02-27 21:55:57 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:55:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:55:57 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:55:57 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:55:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:55:57 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2197, 2206, 1]
[INFO] - 02-27 21:55:58 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:56:09 - [main.backward:225]: Epoch 439/500 - Iteration 40/95 - Time 0.312 batch, 0.043 data, 0.283 forward
[INFO] - 02-27 21:56:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0031)
[INFO] - 02-27 21:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5846 (0.5860)
[INFO] - 02-27 21:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5417 (-287.5458)
[INFO] - 02-27 21:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7831 (31.8028)
[INFO] - 02-27 21:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9490 (371.0688)
[INFO] - 02-27 21:56:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:56:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9670)
[INFO] - 02-27 21:56:25 - [main.backward:225]: Epoch 439/500 - Iteration 90/95 - Time 0.313 batch, 0.036 data, 0.284 forward
[INFO] - 02-27 21:56:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:56:25 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0033)
[INFO] - 02-27 21:56:25 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5869 (0.5854)
[INFO] - 02-27 21:56:25 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5420 (-287.5420)
[INFO] - 02-27 21:56:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7800 (31.8071)
[INFO] - 02-27 21:56:25 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5179 (371.2001)
[INFO] - 02-27 21:56:25 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:56:25 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9645)
[INFO] - 02-27 21:56:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:56:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:56:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:56:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:56:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:56:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:56:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:56:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.750
[INFO] - 02-27 21:56:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.750
[INFO] - 02-27 21:56:29 - [main.summary_metrics:168]: Epoch 439/500 - Test Results:
{'auc': 0.8471589601526885,
 'f1': 0.4163583754208754,
 'loss': 0.4372117963336471,
 'ndcg': 0.7190824061043446,
 'precision': 0.5562499999999999,
 'recall': 0.3331889005602241}
[INFO] - 02-27 21:56:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[439] Complete. Time taken: 00:00:32.415
[INFO] - 02-27 21:56:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:56:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:56:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:56:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:56:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:56:29 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2212, 2200, 1]
[INFO] - 02-27 21:56:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:56:43 - [main.backward:225]: Epoch 440/500 - Iteration 45/95 - Time 0.314 batch, 0.044 data, 0.286 forward
[INFO] - 02-27 21:56:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:56:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 21:56:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5856)
[INFO] - 02-27 21:56:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5417)
[INFO] - 02-27 21:56:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7554 (31.8068)
[INFO] - 02-27 21:56:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3246 (371.4417)
[INFO] - 02-27 21:56:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:56:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9648)
[INFO] - 02-27 21:56:57 - [main.backward:225]: Epoch 440/500 - Iteration 0/95 - Time 0.296 batch, 0.035 data, 0.269 forward
[INFO] - 02-27 21:56:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:56:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0030)
[INFO] - 02-27 21:56:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5863 (0.5867)
[INFO] - 02-27 21:56:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5505 (-287.5458)
[INFO] - 02-27 21:56:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7436 (31.8109)
[INFO] - 02-27 21:56:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.7032 (371.3161)
[INFO] - 02-27 21:56:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:56:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9680)
[INFO] - 02-27 21:56:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:56:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:56:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:56:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:56:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:56:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:56:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:57:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.465
[INFO] - 02-27 21:57:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.467
[INFO] - 02-27 21:57:00 - [main.summary_metrics:168]: Epoch 440/500 - Test Results:
{'auc': 0.8459231264809846,
 'f1': 0.4163583754208754,
 'loss': 0.4384982158827433,
 'ndcg': 0.7191133103741922,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 21:57:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[440] Complete. Time taken: 00:00:30.606
[INFO] - 02-27 21:57:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:57:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:57:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:57:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:57:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:57:00 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3029, 2199, 2193, 1]
[INFO] - 02-27 21:57:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:57:15 - [main.backward:225]: Epoch 441/500 - Iteration 50/95 - Time 0.300 batch, 0.041 data, 0.273 forward
[INFO] - 02-27 21:57:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0031)
[INFO] - 02-27 21:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5820 (0.5861)
[INFO] - 02-27 21:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5484 (-287.5499)
[INFO] - 02-27 21:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7770 (31.8030)
[INFO] - 02-27 21:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4981 (371.1536)
[INFO] - 02-27 21:57:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:57:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9677)
[INFO] - 02-27 21:57:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:57:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:57:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:57:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:57:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:57:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:57:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:57:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.355
[INFO] - 02-27 21:57:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.357
[INFO] - 02-27 21:57:30 - [main.summary_metrics:168]: Epoch 441/500 - Test Results:
{'auc': 0.8488452167018767,
 'f1': 0.42330281986531987,
 'loss': 0.4368309425219718,
 'ndcg': 0.7233901965566921,
 'precision': 0.565625,
 'recall': 0.338703606442577}
[INFO] - 02-27 21:57:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[441] Complete. Time taken: 00:00:30.133
[INFO] - 02-27 21:57:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:57:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:57:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:57:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:57:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:57:30 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3073, 2176, 2200, 1]
[INFO] - 02-27 21:57:31 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:57:32 - [main.backward:225]: Epoch 442/500 - Iteration 5/95 - Time 0.406 batch, 0.149 data, 0.380 forward
[INFO] - 02-27 21:57:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:57:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0031)
[INFO] - 02-27 21:57:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5860 (0.5869)
[INFO] - 02-27 21:57:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5468)
[INFO] - 02-27 21:57:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8155 (31.7917)
[INFO] - 02-27 21:57:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8691 (371.1427)
[INFO] - 02-27 21:57:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:57:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9670)
[INFO] - 02-27 21:57:46 - [main.backward:225]: Epoch 442/500 - Iteration 55/95 - Time 0.297 batch, 0.042 data, 0.266 forward
[INFO] - 02-27 21:57:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:57:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0031)
[INFO] - 02-27 21:57:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5892 (0.5863)
[INFO] - 02-27 21:57:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5445)
[INFO] - 02-27 21:57:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7883 (31.7940)
[INFO] - 02-27 21:57:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6078 (371.1653)
[INFO] - 02-27 21:57:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:57:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9683)
[INFO] - 02-27 21:57:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:57:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:57:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:57:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:57:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:57:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:57:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:58:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.371
[INFO] - 02-27 21:58:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.372
[INFO] - 02-27 21:58:00 - [main.summary_metrics:168]: Epoch 442/500 - Test Results:
{'auc': 0.846888482844118,
 'f1': 0.4163583754208754,
 'loss': 0.43801361945827255,
 'ndcg': 0.7230359571982576,
 'precision': 0.5562499999999999,
 'recall': 0.3331889005602241}
[INFO] - 02-27 21:58:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[442] Complete. Time taken: 00:00:30.247
[INFO] - 02-27 21:58:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:58:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:58:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:58:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:58:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:58:00 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3014, 2216, 2209, 1]
[INFO] - 02-27 21:58:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:58:04 - [main.backward:225]: Epoch 443/500 - Iteration 10/95 - Time 0.348 batch, 0.088 data, 0.317 forward
[INFO] - 02-27 21:58:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:58:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0031)
[INFO] - 02-27 21:58:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5930 (0.5863)
[INFO] - 02-27 21:58:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5411 (-287.5446)
[INFO] - 02-27 21:58:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7064 (31.7832)
[INFO] - 02-27 21:58:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1155 (371.0802)
[INFO] - 02-27 21:58:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:58:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9675)
[INFO] - 02-27 21:58:18 - [main.backward:225]: Epoch 443/500 - Iteration 60/95 - Time 0.299 batch, 0.037 data, 0.271 forward
[INFO] - 02-27 21:58:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:58:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0031)
[INFO] - 02-27 21:58:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5922 (0.5863)
[INFO] - 02-27 21:58:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5377)
[INFO] - 02-27 21:58:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7600 (31.8079)
[INFO] - 02-27 21:58:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8709 (371.1926)
[INFO] - 02-27 21:58:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:58:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9658)
[INFO] - 02-27 21:58:29 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:58:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:58:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:58:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:58:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.429
[INFO] - 02-27 21:58:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.430
[INFO] - 02-27 21:58:31 - [main.summary_metrics:168]: Epoch 443/500 - Test Results:
{'auc': 0.8473161108806267,
 'f1': 0.4092287457912458,
 'loss': 0.43733475697385044,
 'ndcg': 0.7242640778451681,
 'precision': 0.546875,
 'recall': 0.3274290966386555}
[INFO] - 02-27 21:58:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[443] Complete. Time taken: 00:00:30.664
[INFO] - 02-27 21:58:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:58:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:58:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:58:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:58:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:58:31 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3048, 2208, 2223, 1]
[INFO] - 02-27 21:58:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:58:35 - [main.backward:225]: Epoch 444/500 - Iteration 15/95 - Time 0.295 batch, 0.062 data, 0.270 forward
[INFO] - 02-27 21:58:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 21:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5850)
[INFO] - 02-27 21:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5422 (-287.5416)
[INFO] - 02-27 21:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9223 (31.8174)
[INFO] - 02-27 21:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.9347 (371.2124)
[INFO] - 02-27 21:58:35 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:58:35 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9673)
[INFO] - 02-27 21:58:48 - [main.backward:225]: Epoch 444/500 - Iteration 65/95 - Time 0.264 batch, 0.033 data, 0.239 forward
[INFO] - 02-27 21:58:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0052 (0.0032)
[INFO] - 02-27 21:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5863)
[INFO] - 02-27 21:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5452)
[INFO] - 02-27 21:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8092 (31.8078)
[INFO] - 02-27 21:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7521 (371.3186)
[INFO] - 02-27 21:58:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:58:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9631)
[INFO] - 02-27 21:58:56 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:58:56 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:58:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:58:56 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:58:56 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:58:56 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:58:56 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:58:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.453
[INFO] - 02-27 21:58:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.455
[INFO] - 02-27 21:58:59 - [main.summary_metrics:168]: Epoch 444/500 - Test Results:
{'auc': 0.8466162308060479,
 'f1': 0.40459911616161615,
 'loss': 0.4383452185612196,
 'ndcg': 0.7260692875376124,
 'precision': 0.540625,
 'recall': 0.32375262605042016}
[INFO] - 02-27 21:58:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[444] Complete. Time taken: 00:00:27.548
[INFO] - 02-27 21:58:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:58:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:58:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:58:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:58:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:58:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2193, 2192, 1]
[INFO] - 02-27 21:58:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:59:05 - [main.backward:225]: Epoch 445/500 - Iteration 20/95 - Time 0.311 batch, 0.057 data, 0.284 forward
[INFO] - 02-27 21:59:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:59:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 21:59:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5878 (0.5852)
[INFO] - 02-27 21:59:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5510 (-287.5474)
[INFO] - 02-27 21:59:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7714 (31.8072)
[INFO] - 02-27 21:59:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6003 (371.1461)
[INFO] - 02-27 21:59:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:59:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9650)
[INFO] - 02-27 21:59:19 - [main.backward:225]: Epoch 445/500 - Iteration 70/95 - Time 0.292 batch, 0.035 data, 0.265 forward
[INFO] - 02-27 21:59:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:59:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0029)
[INFO] - 02-27 21:59:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5764 (0.5863)
[INFO] - 02-27 21:59:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5463)
[INFO] - 02-27 21:59:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8843 (31.8020)
[INFO] - 02-27 21:59:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5547 (371.3446)
[INFO] - 02-27 21:59:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:59:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9703)
[INFO] - 02-27 21:59:26 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:59:26 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:59:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:59:26 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:59:26 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:59:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:59:26 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:59:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.447
[INFO] - 02-27 21:59:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.449
[INFO] - 02-27 21:59:29 - [main.summary_metrics:168]: Epoch 445/500 - Test Results:
{'auc': 0.8472989220197883,
 'f1': 0.40709911616161615,
 'loss': 0.4374303156597574,
 'ndcg': 0.7251287990198425,
 'precision': 0.54375,
 'recall': 0.3258359593837535}
[INFO] - 02-27 21:59:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[445] Complete. Time taken: 00:00:30.040
[INFO] - 02-27 21:59:29 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:59:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:59:29 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:59:29 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:59:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:59:29 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3102, 2216, 2220, 1]
[INFO] - 02-27 21:59:29 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 21:59:37 - [main.backward:225]: Epoch 446/500 - Iteration 25/95 - Time 0.322 batch, 0.054 data, 0.293 forward
[INFO] - 02-27 21:59:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:59:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0030)
[INFO] - 02-27 21:59:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5847 (0.5866)
[INFO] - 02-27 21:59:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5446 (-287.5434)
[INFO] - 02-27 21:59:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7472 (31.7978)
[INFO] - 02-27 21:59:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8928 (371.2659)
[INFO] - 02-27 21:59:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:59:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9659)
[INFO] - 02-27 21:59:51 - [main.backward:225]: Epoch 446/500 - Iteration 75/95 - Time 0.299 batch, 0.036 data, 0.272 forward
[INFO] - 02-27 21:59:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 21:59:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0029)
[INFO] - 02-27 21:59:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5815 (0.5861)
[INFO] - 02-27 21:59:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5431 (-287.5464)
[INFO] - 02-27 21:59:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7471 (31.7822)
[INFO] - 02-27 21:59:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.4682 (371.0895)
[INFO] - 02-27 21:59:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 21:59:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9698)
[INFO] - 02-27 21:59:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 21:59:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:59:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:59:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 21:59:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:59:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 21:59:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 21:59:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.527
[INFO] - 02-27 21:59:59 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.527
[INFO] - 02-27 21:59:59 - [main.summary_metrics:168]: Epoch 446/500 - Test Results:
{'auc': 0.8463631670805577,
 'f1': 0.4070991161616162,
 'loss': 0.43829836663340127,
 'ndcg': 0.7192419182742033,
 'precision': 0.54375,
 'recall': 0.32583595938375354}
[INFO] - 02-27 21:59:59 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[446] Complete. Time taken: 00:00:30.646
[INFO] - 02-27 21:59:59 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 21:59:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 21:59:59 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 21:59:59 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 21:59:59 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 21:59:59 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3008, 2218, 2229, 1]
[INFO] - 02-27 22:00:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:00:09 - [main.backward:225]: Epoch 447/500 - Iteration 30/95 - Time 0.316 batch, 0.051 data, 0.289 forward
[INFO] - 02-27 22:00:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:00:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0028)
[INFO] - 02-27 22:00:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5824 (0.5863)
[INFO] - 02-27 22:00:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5482 (-287.5456)
[INFO] - 02-27 22:00:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7724 (31.8078)
[INFO] - 02-27 22:00:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3799 (371.2098)
[INFO] - 02-27 22:00:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:00:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9703)
[INFO] - 02-27 22:00:23 - [main.backward:225]: Epoch 447/500 - Iteration 80/95 - Time 0.295 batch, 0.036 data, 0.269 forward
[INFO] - 02-27 22:00:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:00:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0030)
[INFO] - 02-27 22:00:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5883 (0.5862)
[INFO] - 02-27 22:00:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5425 (-287.5470)
[INFO] - 02-27 22:00:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7951 (31.7992)
[INFO] - 02-27 22:00:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8140 (371.1791)
[INFO] - 02-27 22:00:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:00:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9681)
[INFO] - 02-27 22:00:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:00:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:00:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:00:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:00:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:00:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:00:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:00:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.399
[INFO] - 02-27 22:00:29 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.399
[INFO] - 02-27 22:00:29 - [main.summary_metrics:168]: Epoch 447/500 - Test Results:
{'auc': 0.845987738600342,
 'f1': 0.4092287457912458,
 'loss': 0.4381779166143057,
 'ndcg': 0.7213380643448402,
 'precision': 0.546875,
 'recall': 0.3274290966386555}
[INFO] - 02-27 22:00:29 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[447] Complete. Time taken: 00:00:30.256
[INFO] - 02-27 22:00:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:00:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:00:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:00:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:00:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:00:30 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3051, 2207, 2209, 1]
[INFO] - 02-27 22:00:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:00:41 - [main.backward:225]: Epoch 448/500 - Iteration 35/95 - Time 0.314 batch, 0.048 data, 0.285 forward
[INFO] - 02-27 22:00:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:00:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0029)
[INFO] - 02-27 22:00:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5809 (0.5853)
[INFO] - 02-27 22:00:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5441 (-287.5429)
[INFO] - 02-27 22:00:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7285 (31.8020)
[INFO] - 02-27 22:00:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.0285 (370.8586)
[INFO] - 02-27 22:00:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:00:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9705)
[INFO] - 02-27 22:00:57 - [main.backward:225]: Epoch 448/500 - Iteration 85/95 - Time 0.320 batch, 0.037 data, 0.291 forward
[INFO] - 02-27 22:00:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:00:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0032)
[INFO] - 02-27 22:00:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5841 (0.5860)
[INFO] - 02-27 22:00:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5440 (-287.5426)
[INFO] - 02-27 22:00:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7901 (31.8033)
[INFO] - 02-27 22:00:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3925 (370.9057)
[INFO] - 02-27 22:00:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:00:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9644)
[INFO] - 02-27 22:01:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:01:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:01:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:01:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:01:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:01:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:01:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:01:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.608
[INFO] - 02-27 22:01:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.608
[INFO] - 02-27 22:01:03 - [main.summary_metrics:168]: Epoch 448/500 - Test Results:
{'auc': 0.8453771482244858,
 'f1': 0.40720328282828283,
 'loss': 0.43905244897420925,
 'ndcg': 0.7218139908791621,
 'precision': 0.54375,
 'recall': 0.32598476890756306}
[INFO] - 02-27 22:01:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[448] Complete. Time taken: 00:00:33.134
[INFO] - 02-27 22:01:03 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:01:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:01:03 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:01:03 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:01:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:01:03 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3047, 2205, 2218, 1]
[INFO] - 02-27 22:01:03 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:01:16 - [main.backward:225]: Epoch 449/500 - Iteration 40/95 - Time 0.344 batch, 0.050 data, 0.315 forward
[INFO] - 02-27 22:01:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:01:16 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0032)
[INFO] - 02-27 22:01:16 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5853 (0.5863)
[INFO] - 02-27 22:01:16 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5437)
[INFO] - 02-27 22:01:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8439 (31.7979)
[INFO] - 02-27 22:01:16 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2950 (370.9798)
[INFO] - 02-27 22:01:16 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:01:16 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9623)
[INFO] - 02-27 22:01:32 - [main.backward:225]: Epoch 449/500 - Iteration 90/95 - Time 0.329 batch, 0.038 data, 0.301 forward
[INFO] - 02-27 22:01:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:01:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0030)
[INFO] - 02-27 22:01:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5876)
[INFO] - 02-27 22:01:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5470 (-287.5472)
[INFO] - 02-27 22:01:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7967 (31.7995)
[INFO] - 02-27 22:01:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7491 (371.0833)
[INFO] - 02-27 22:01:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:01:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9688)
[INFO] - 02-27 22:01:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:01:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:01:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:01:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:01:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:01:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:01:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:01:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.897
[INFO] - 02-27 22:01:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.898
[INFO] - 02-27 22:01:37 - [main.summary_metrics:168]: Epoch 449/500 - Test Results:
{'auc': 0.8463412209859433,
 'f1': 0.4140435606060606,
 'loss': 0.43907344600518644,
 'ndcg': 0.7160037315085455,
 'precision': 0.553125,
 'recall': 0.33135066526610646}
[INFO] - 02-27 22:01:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[449] Complete. Time taken: 00:00:34.096
[INFO] - 02-27 22:01:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:01:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:01:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:01:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:01:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:01:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3083, 2202, 2212, 1]
[INFO] - 02-27 22:01:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:01:51 - [main.backward:225]: Epoch 450/500 - Iteration 45/95 - Time 0.327 batch, 0.042 data, 0.299 forward
[INFO] - 02-27 22:01:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:01:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0031)
[INFO] - 02-27 22:01:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5872 (0.5858)
[INFO] - 02-27 22:01:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5466 (-287.5454)
[INFO] - 02-27 22:01:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8096 (31.7893)
[INFO] - 02-27 22:01:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4490 (371.1409)
[INFO] - 02-27 22:01:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:01:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9647)
[INFO] - 02-27 22:02:07 - [main.backward:225]: Epoch 450/500 - Iteration 0/95 - Time 0.317 batch, 0.035 data, 0.289 forward
[INFO] - 02-27 22:02:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:02:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0031)
[INFO] - 02-27 22:02:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5810 (0.5859)
[INFO] - 02-27 22:02:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5475 (-287.5484)
[INFO] - 02-27 22:02:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8546 (31.7954)
[INFO] - 02-27 22:02:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5588 (371.1731)
[INFO] - 02-27 22:02:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:02:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9647)
[INFO] - 02-27 22:02:07 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:02:07 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:02:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:02:07 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:02:07 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:02:07 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:02:07 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:02:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.631
[INFO] - 02-27 22:02:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.632
[INFO] - 02-27 22:02:09 - [main.summary_metrics:168]: Epoch 450/500 - Test Results:
{'auc': 0.8471921687792764,
 'f1': 0.4130429292929293,
 'loss': 0.4377099971369789,
 'ndcg': 0.7241134297815159,
 'precision': 0.553125,
 'recall': 0.3299457282913165}
[INFO] - 02-27 22:02:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[450] Complete. Time taken: 00:00:32.721
[INFO] - 02-27 22:02:09 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:02:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:02:09 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:02:09 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:02:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:02:09 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3041, 2215, 2210, 1]
[INFO] - 02-27 22:02:10 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:02:26 - [main.backward:225]: Epoch 451/500 - Iteration 50/95 - Time 0.333 batch, 0.041 data, 0.304 forward
[INFO] - 02-27 22:02:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:02:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0029)
[INFO] - 02-27 22:02:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5948 (0.5862)
[INFO] - 02-27 22:02:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5386 (-287.5452)
[INFO] - 02-27 22:02:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8961 (31.7906)
[INFO] - 02-27 22:02:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7259 (371.1003)
[INFO] - 02-27 22:02:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:02:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9694)
[INFO] - 02-27 22:02:40 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:02:40 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:02:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:02:40 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:02:40 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:02:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:02:40 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:02:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.680
[INFO] - 02-27 22:02:43 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.681
[INFO] - 02-27 22:02:43 - [main.summary_metrics:168]: Epoch 451/500 - Test Results:
{'auc': 0.8471152451176549,
 'f1': 0.4212773569023569,
 'loss': 0.43816646099527945,
 'ndcg': 0.7223057320420969,
 'precision': 0.5625,
 'recall': 0.3372592787114846}
[INFO] - 02-27 22:02:43 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[451] Complete. Time taken: 00:00:33.464
[INFO] - 02-27 22:02:43 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:02:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:02:43 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:02:43 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:02:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:02:43 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3053, 2201, 2198, 1]
[INFO] - 02-27 22:02:44 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:02:46 - [main.backward:225]: Epoch 452/500 - Iteration 5/95 - Time 0.573 batch, 0.228 data, 0.531 forward
[INFO] - 02-27 22:02:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0029)
[INFO] - 02-27 22:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5861)
[INFO] - 02-27 22:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5410 (-287.5413)
[INFO] - 02-27 22:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7742 (31.7918)
[INFO] - 02-27 22:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9331 (371.1783)
[INFO] - 02-27 22:02:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:02:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9698)
[INFO] - 02-27 22:03:03 - [main.backward:225]: Epoch 452/500 - Iteration 55/95 - Time 0.364 batch, 0.048 data, 0.332 forward
[INFO] - 02-27 22:03:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:03:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0034)
[INFO] - 02-27 22:03:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5926 (0.5866)
[INFO] - 02-27 22:03:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5449 (-287.5432)
[INFO] - 02-27 22:03:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7302 (31.7586)
[INFO] - 02-27 22:03:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4284 (371.3137)
[INFO] - 02-27 22:03:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:03:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9634)
[INFO] - 02-27 22:03:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:03:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:03:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:03:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:03:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:03:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:03:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:03:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.816
[INFO] - 02-27 22:03:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.817
[INFO] - 02-27 22:03:19 - [main.summary_metrics:168]: Epoch 452/500 - Test Results:
{'auc': 0.8465435453593202,
 'f1': 0.4165435606060606,
 'loss': 0.43795972592743726,
 'ndcg': 0.7164130779922455,
 'precision': 0.5562499999999999,
 'recall': 0.3334339985994398}
[INFO] - 02-27 22:03:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[452] Complete. Time taken: 00:00:35.656
[INFO] - 02-27 22:03:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:03:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:03:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:03:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:03:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:03:19 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3042, 2178, 2208, 1]
[INFO] - 02-27 22:03:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:03:23 - [main.backward:225]: Epoch 453/500 - Iteration 10/95 - Time 0.403 batch, 0.090 data, 0.374 forward
[INFO] - 02-27 22:03:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0031)
[INFO] - 02-27 22:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5868 (0.5851)
[INFO] - 02-27 22:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5430 (-287.5421)
[INFO] - 02-27 22:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7245 (31.7825)
[INFO] - 02-27 22:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5008 (371.4878)
[INFO] - 02-27 22:03:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:03:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9670)
[INFO] - 02-27 22:03:39 - [main.backward:225]: Epoch 453/500 - Iteration 60/95 - Time 0.335 batch, 0.039 data, 0.305 forward
[INFO] - 02-27 22:03:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0031)
[INFO] - 02-27 22:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5834 (0.5861)
[INFO] - 02-27 22:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5460 (-287.5439)
[INFO] - 02-27 22:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8723 (31.8128)
[INFO] - 02-27 22:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1122 (371.1682)
[INFO] - 02-27 22:03:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:03:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9650)
[INFO] - 02-27 22:03:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:03:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:03:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:03:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:03:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:03:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:03:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:03:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.893
[INFO] - 02-27 22:03:53 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.894
[INFO] - 02-27 22:03:53 - [main.summary_metrics:168]: Epoch 453/500 - Test Results:
{'auc': 0.8459849436710959,
 'f1': 0.42330281986531987,
 'loss': 0.4375068867910461,
 'ndcg': 0.7131777260019359,
 'precision': 0.565625,
 'recall': 0.338703606442577}
[INFO] - 02-27 22:03:53 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[453] Complete. Time taken: 00:00:34.320
[INFO] - 02-27 22:03:53 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:03:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:03:53 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:03:53 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:03:53 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:03:53 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2190, 2202, 1]
[INFO] - 02-27 22:03:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:03:58 - [main.backward:225]: Epoch 454/500 - Iteration 15/95 - Time 0.358 batch, 0.067 data, 0.331 forward
[INFO] - 02-27 22:03:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0033)
[INFO] - 02-27 22:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5903 (0.5861)
[INFO] - 02-27 22:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5450 (-287.5439)
[INFO] - 02-27 22:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7433 (31.8026)
[INFO] - 02-27 22:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2071 (371.1044)
[INFO] - 02-27 22:03:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:03:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9606)
[INFO] - 02-27 22:04:15 - [main.backward:225]: Epoch 454/500 - Iteration 65/95 - Time 0.335 batch, 0.038 data, 0.306 forward
[INFO] - 02-27 22:04:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:04:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0032)
[INFO] - 02-27 22:04:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5897 (0.5849)
[INFO] - 02-27 22:04:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5421)
[INFO] - 02-27 22:04:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6526 (31.8018)
[INFO] - 02-27 22:04:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9761 (371.2047)
[INFO] - 02-27 22:04:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:04:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9656)
[INFO] - 02-27 22:04:24 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:04:24 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:04:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:04:24 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:04:24 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:04:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:04:24 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:04:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.906
[INFO] - 02-27 22:04:27 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.906
[INFO] - 02-27 22:04:27 - [main.summary_metrics:168]: Epoch 454/500 - Test Results:
{'auc': 0.8468882145995653,
 'f1': 0.41385837542087545,
 'loss': 0.43660525860153876,
 'ndcg': 0.7201542314077234,
 'precision': 0.5531250000000001,
 'recall': 0.3311055672268908}
[INFO] - 02-27 22:04:27 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[454] Complete. Time taken: 00:00:33.992
[INFO] - 02-27 22:04:27 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:04:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:04:27 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:04:27 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:04:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:04:27 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3041, 2181, 2209, 1]
[INFO] - 02-27 22:04:28 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:04:34 - [main.backward:225]: Epoch 455/500 - Iteration 20/95 - Time 0.373 batch, 0.070 data, 0.340 forward
[INFO] - 02-27 22:04:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0029)
[INFO] - 02-27 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5837 (0.5847)
[INFO] - 02-27 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5426)
[INFO] - 02-27 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7718 (31.7853)
[INFO] - 02-27 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6461 (371.2122)
[INFO] - 02-27 22:04:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:04:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9678)
[INFO] - 02-27 22:04:52 - [main.backward:225]: Epoch 455/500 - Iteration 70/95 - Time 0.357 batch, 0.044 data, 0.324 forward
[INFO] - 02-27 22:04:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:04:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0030)
[INFO] - 02-27 22:04:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5852 (0.5856)
[INFO] - 02-27 22:04:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5426 (-287.5393)
[INFO] - 02-27 22:04:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7334 (31.7780)
[INFO] - 02-27 22:04:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4381 (371.1811)
[INFO] - 02-27 22:04:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:04:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9669)
[INFO] - 02-27 22:05:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:05:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:05:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:05:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:05:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:05:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:05:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:05:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.797
[INFO] - 02-27 22:05:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.798
[INFO] - 02-27 22:05:03 - [main.summary_metrics:168]: Epoch 455/500 - Test Results:
{'auc': 0.8469461946543323,
 'f1': 0.4140435606060606,
 'loss': 0.43662318702058694,
 'ndcg': 0.7201457753891043,
 'precision': 0.5531250000000001,
 'recall': 0.33135066526610646}
[INFO] - 02-27 22:05:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[455] Complete. Time taken: 00:00:36.094
[INFO] - 02-27 22:05:03 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:05:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:05:03 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:05:03 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:05:03 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:05:03 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3042, 2199, 2202, 1]
[INFO] - 02-27 22:05:04 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:05:11 - [main.backward:225]: Epoch 456/500 - Iteration 25/95 - Time 0.334 batch, 0.051 data, 0.306 forward
[INFO] - 02-27 22:05:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:05:11 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0030)
[INFO] - 02-27 22:05:11 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5800 (0.5849)
[INFO] - 02-27 22:05:11 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5451)
[INFO] - 02-27 22:05:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8287 (31.7940)
[INFO] - 02-27 22:05:11 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6895 (371.2223)
[INFO] - 02-27 22:05:11 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:05:11 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9683)
[INFO] - 02-27 22:05:27 - [main.backward:225]: Epoch 456/500 - Iteration 75/95 - Time 0.326 batch, 0.036 data, 0.298 forward
[INFO] - 02-27 22:05:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:05:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0029)
[INFO] - 02-27 22:05:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5798 (0.5836)
[INFO] - 02-27 22:05:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5463 (-287.5476)
[INFO] - 02-27 22:05:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8366 (31.7973)
[INFO] - 02-27 22:05:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4777 (371.3132)
[INFO] - 02-27 22:05:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:05:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9714)
[INFO] - 02-27 22:05:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:05:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:05:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:05:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:05:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:05:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:05:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:05:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.799
[INFO] - 02-27 22:05:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.801
[INFO] - 02-27 22:05:37 - [main.summary_metrics:168]: Epoch 456/500 - Test Results:
{'auc': 0.8465979315745906,
 'f1': 0.4043097643097643,
 'loss': 0.436110157561473,
 'ndcg': 0.714363465593457,
 'precision': 0.5406249999999999,
 'recall': 0.32335871848739495}
[INFO] - 02-27 22:05:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[456] Complete. Time taken: 00:00:33.575
[INFO] - 02-27 22:05:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:05:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:05:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:05:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:05:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:05:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2184, 2212, 1]
[INFO] - 02-27 22:05:37 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:05:48 - [main.backward:225]: Epoch 457/500 - Iteration 30/95 - Time 0.367 batch, 0.061 data, 0.334 forward
[INFO] - 02-27 22:05:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:05:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0030)
[INFO] - 02-27 22:05:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5832 (0.5843)
[INFO] - 02-27 22:05:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5493 (-287.5474)
[INFO] - 02-27 22:05:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7037 (31.7804)
[INFO] - 02-27 22:05:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.5173 (371.2451)
[INFO] - 02-27 22:05:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:05:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9659)
[INFO] - 02-27 22:06:04 - [main.backward:225]: Epoch 457/500 - Iteration 80/95 - Time 0.342 batch, 0.042 data, 0.311 forward
[INFO] - 02-27 22:06:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0032 (0.0030)
[INFO] - 02-27 22:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5938 (0.5854)
[INFO] - 02-27 22:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5494 (-287.5514)
[INFO] - 02-27 22:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7427 (31.7843)
[INFO] - 02-27 22:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4908 (371.2041)
[INFO] - 02-27 22:06:04 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:06:04 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9644)
[INFO] - 02-27 22:06:09 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:06:09 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:06:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:06:09 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:06:09 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:06:09 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:06:09 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:06:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.699
[INFO] - 02-27 22:06:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.699
[INFO] - 02-27 22:06:11 - [main.summary_metrics:168]: Epoch 457/500 - Test Results:
{'auc': 0.8465497043793007,
 'f1': 0.4143329124579125,
 'loss': 0.437181572657793,
 'ndcg': 0.7210073065984717,
 'precision': 0.553125,
 'recall': 0.3317445728291316}
[INFO] - 02-27 22:06:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[457] Complete. Time taken: 00:00:34.820
[INFO] - 02-27 22:06:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:06:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:06:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:06:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:06:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:06:11 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3043, 2204, 2203, 1]
[INFO] - 02-27 22:06:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:06:23 - [main.backward:225]: Epoch 458/500 - Iteration 35/95 - Time 0.341 batch, 0.048 data, 0.312 forward
[INFO] - 02-27 22:06:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:06:23 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0016 (0.0032)
[INFO] - 02-27 22:06:23 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5822 (0.5860)
[INFO] - 02-27 22:06:23 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5410 (-287.5459)
[INFO] - 02-27 22:06:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7787 (31.7888)
[INFO] - 02-27 22:06:23 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8805 (371.2100)
[INFO] - 02-27 22:06:23 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:06:23 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9628)
[INFO] - 02-27 22:06:39 - [main.backward:225]: Epoch 458/500 - Iteration 85/95 - Time 0.324 batch, 0.036 data, 0.295 forward
[INFO] - 02-27 22:06:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:06:39 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0029)
[INFO] - 02-27 22:06:39 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5888 (0.5859)
[INFO] - 02-27 22:06:39 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5436 (-287.5440)
[INFO] - 02-27 22:06:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7403 (31.7997)
[INFO] - 02-27 22:06:39 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6054 (371.3629)
[INFO] - 02-27 22:06:39 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:06:39 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9702)
[INFO] - 02-27 22:06:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:06:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:06:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:06:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:06:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:06:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:06:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:06:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.742
[INFO] - 02-27 22:06:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.742
[INFO] - 02-27 22:06:45 - [main.summary_metrics:168]: Epoch 458/500 - Test Results:
{'auc': 0.846296143579981,
 'f1': 0.4093329124579124,
 'loss': 0.43806368877435975,
 'ndcg': 0.7145699002265333,
 'precision': 0.546875,
 'recall': 0.327577906162465}
[INFO] - 02-27 22:06:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[458] Complete. Time taken: 00:00:33.708
[INFO] - 02-27 22:06:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:06:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:06:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:06:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:06:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:06:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2212, 2215, 1]
[INFO] - 02-27 22:06:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:06:58 - [main.backward:225]: Epoch 459/500 - Iteration 40/95 - Time 0.315 batch, 0.044 data, 0.287 forward
[INFO] - 02-27 22:06:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0031)
[INFO] - 02-27 22:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5825 (0.5857)
[INFO] - 02-27 22:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5442 (-287.5435)
[INFO] - 02-27 22:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7603 (31.7963)
[INFO] - 02-27 22:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.6788 (371.2649)
[INFO] - 02-27 22:06:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:06:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9677)
[INFO] - 02-27 22:07:13 - [main.backward:225]: Epoch 459/500 - Iteration 90/95 - Time 0.307 batch, 0.036 data, 0.279 forward
[INFO] - 02-27 22:07:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0032)
[INFO] - 02-27 22:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5855)
[INFO] - 02-27 22:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5396 (-287.5446)
[INFO] - 02-27 22:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7317 (31.7900)
[INFO] - 02-27 22:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5811 (371.1304)
[INFO] - 02-27 22:07:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:07:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9639)
[INFO] - 02-27 22:07:14 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:07:14 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:07:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:07:14 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:07:14 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:07:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:07:14 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:07:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.720
[INFO] - 02-27 22:07:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.720
[INFO] - 02-27 22:07:17 - [main.summary_metrics:168]: Epoch 459/500 - Test Results:
{'auc': 0.8456700674142206,
 'f1': 0.4139625420875421,
 'loss': 0.43852502698313683,
 'ndcg': 0.7194015975494602,
 'precision': 0.5531250000000001,
 'recall': 0.3312543767507003}
[INFO] - 02-27 22:07:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[459] Complete. Time taken: 00:00:32.040
[INFO] - 02-27 22:07:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:07:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:07:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:07:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:07:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:07:17 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3041, 2204, 2218, 1]
[INFO] - 02-27 22:07:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:07:31 - [main.backward:225]: Epoch 460/500 - Iteration 45/95 - Time 0.307 batch, 0.042 data, 0.280 forward
[INFO] - 02-27 22:07:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 22:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5864)
[INFO] - 02-27 22:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5410 (-287.5444)
[INFO] - 02-27 22:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7859 (31.7845)
[INFO] - 02-27 22:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7695 (371.4420)
[INFO] - 02-27 22:07:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:07:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9653)
[INFO] - 02-27 22:07:45 - [main.backward:225]: Epoch 460/500 - Iteration 0/95 - Time 0.293 batch, 0.034 data, 0.266 forward
[INFO] - 02-27 22:07:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0032)
[INFO] - 02-27 22:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5844 (0.5861)
[INFO] - 02-27 22:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5411)
[INFO] - 02-27 22:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8259 (31.7887)
[INFO] - 02-27 22:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.7019 (371.4807)
[INFO] - 02-27 22:07:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:07:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9637)
[INFO] - 02-27 22:07:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:07:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:07:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:07:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:07:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:07:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:07:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:07:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.469
[INFO] - 02-27 22:07:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.470
[INFO] - 02-27 22:07:47 - [main.summary_metrics:168]: Epoch 460/500 - Test Results:
{'auc': 0.8463394536736263,
 'f1': 0.41351746632996633,
 'loss': 0.4382668380838771,
 'ndcg': 0.7140323222465823,
 'precision': 0.5531250000000001,
 'recall': 0.3305847338935574}
[INFO] - 02-27 22:07:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[460] Complete. Time taken: 00:00:30.357
[INFO] - 02-27 22:07:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:07:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:07:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:07:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:07:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:07:48 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3065, 2203, 2215, 1]
[INFO] - 02-27 22:07:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:08:02 - [main.backward:225]: Epoch 461/500 - Iteration 50/95 - Time 0.290 batch, 0.038 data, 0.264 forward
[INFO] - 02-27 22:08:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0032)
[INFO] - 02-27 22:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5865 (0.5861)
[INFO] - 02-27 22:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5430)
[INFO] - 02-27 22:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7765 (31.8095)
[INFO] - 02-27 22:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9700 (371.3147)
[INFO] - 02-27 22:08:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:08:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9633)
[INFO] - 02-27 22:08:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:08:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:08:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:08:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:08:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:08:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:08:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:08:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.484
[INFO] - 02-27 22:08:17 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.484
[INFO] - 02-27 22:08:17 - [main.summary_metrics:168]: Epoch 461/500 - Test Results:
{'auc': 0.8461989223998423,
 'f1': 0.406439393939394,
 'loss': 0.43805828384156253,
 'ndcg': 0.7191717294383034,
 'precision': 0.54375,
 'recall': 0.32495185574229696}
[INFO] - 02-27 22:08:17 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[461] Complete. Time taken: 00:00:29.843
[INFO] - 02-27 22:08:17 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:08:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:08:17 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:08:17 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:08:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:08:17 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3046, 2216, 2220, 1]
[INFO] - 02-27 22:08:18 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:08:19 - [main.backward:225]: Epoch 462/500 - Iteration 5/95 - Time 0.417 batch, 0.165 data, 0.384 forward
[INFO] - 02-27 22:08:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:08:19 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0031)
[INFO] - 02-27 22:08:19 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5865)
[INFO] - 02-27 22:08:19 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5473 (-287.5453)
[INFO] - 02-27 22:08:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8035 (31.7957)
[INFO] - 02-27 22:08:19 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3793 (371.1834)
[INFO] - 02-27 22:08:19 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:08:19 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9297 (0.9680)
[INFO] - 02-27 22:08:34 - [main.backward:225]: Epoch 462/500 - Iteration 55/95 - Time 0.294 batch, 0.039 data, 0.267 forward
[INFO] - 02-27 22:08:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0032)
[INFO] - 02-27 22:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5870 (0.5857)
[INFO] - 02-27 22:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5457 (-287.5449)
[INFO] - 02-27 22:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8504 (31.8138)
[INFO] - 02-27 22:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9576 (371.4394)
[INFO] - 02-27 22:08:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:08:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9639)
[INFO] - 02-27 22:08:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:08:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:08:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:08:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:08:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:08:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:08:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:08:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.596
[INFO] - 02-27 22:08:47 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.597
[INFO] - 02-27 22:08:47 - [main.summary_metrics:168]: Epoch 462/500 - Test Results:
{'auc': 0.8449192268206301,
 'f1': 0.41375420875420876,
 'loss': 0.4391049859692005,
 'ndcg': 0.7212655776038495,
 'precision': 0.5531250000000001,
 'recall': 0.3309567577030812}
[INFO] - 02-27 22:08:47 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[462] Complete. Time taken: 00:00:29.995
[INFO] - 02-27 22:08:47 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:08:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:08:47 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:08:47 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:08:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:08:47 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3066, 2199, 2215, 1]
[INFO] - 02-27 22:08:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:08:51 - [main.backward:225]: Epoch 463/500 - Iteration 10/95 - Time 0.324 batch, 0.080 data, 0.297 forward
[INFO] - 02-27 22:08:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:08:51 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0015 (0.0031)
[INFO] - 02-27 22:08:51 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5827 (0.5863)
[INFO] - 02-27 22:08:51 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5475 (-287.5456)
[INFO] - 02-27 22:08:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7853 (31.8111)
[INFO] - 02-27 22:08:51 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2717 (371.2495)
[INFO] - 02-27 22:08:51 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:08:51 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9653)
[INFO] - 02-27 22:09:06 - [main.backward:225]: Epoch 463/500 - Iteration 60/95 - Time 0.311 batch, 0.040 data, 0.280 forward
[INFO] - 02-27 22:09:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0032)
[INFO] - 02-27 22:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5880 (0.5862)
[INFO] - 02-27 22:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5442)
[INFO] - 02-27 22:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7527 (31.7885)
[INFO] - 02-27 22:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3014 (371.0940)
[INFO] - 02-27 22:09:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:09:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9623)
[INFO] - 02-27 22:09:16 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:09:16 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:09:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:09:16 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:09:16 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:09:16 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:09:16 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:09:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.407
[INFO] - 02-27 22:09:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.407
[INFO] - 02-27 22:09:19 - [main.summary_metrics:168]: Epoch 463/500 - Test Results:
{'auc': 0.8463985606497499,
 'f1': 0.41635837542087545,
 'loss': 0.4380898004231546,
 'ndcg': 0.7234300111771561,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 22:09:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[463] Complete. Time taken: 00:00:31.274
[INFO] - 02-27 22:09:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:09:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:09:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:09:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:09:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:09:19 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2183, 2192, 1]
[INFO] - 02-27 22:09:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:09:24 - [main.backward:225]: Epoch 464/500 - Iteration 15/95 - Time 0.362 batch, 0.077 data, 0.331 forward
[INFO] - 02-27 22:09:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0046 (0.0031)
[INFO] - 02-27 22:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5779 (0.5853)
[INFO] - 02-27 22:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5421)
[INFO] - 02-27 22:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7800 (31.8032)
[INFO] - 02-27 22:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3527 (371.2983)
[INFO] - 02-27 22:09:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:09:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9667)
[INFO] - 02-27 22:09:38 - [main.backward:225]: Epoch 464/500 - Iteration 65/95 - Time 0.306 batch, 0.039 data, 0.277 forward
[INFO] - 02-27 22:09:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0032)
[INFO] - 02-27 22:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5874 (0.5847)
[INFO] - 02-27 22:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5428 (-287.5433)
[INFO] - 02-27 22:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7904 (31.7950)
[INFO] - 02-27 22:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8353 (371.1202)
[INFO] - 02-27 22:09:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:09:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9653)
[INFO] - 02-27 22:09:47 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:09:47 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:09:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:09:47 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:09:47 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:09:47 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:09:47 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:09:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.453
[INFO] - 02-27 22:09:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.453
[INFO] - 02-27 22:09:49 - [main.summary_metrics:168]: Epoch 464/500 - Test Results:
{'auc': 0.846406002045426,
 'f1': 0.4092287457912458,
 'loss': 0.43824436293291164,
 'ndcg': 0.7215854600972511,
 'precision': 0.546875,
 'recall': 0.3274290966386555}
[INFO] - 02-27 22:09:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[464] Complete. Time taken: 00:00:30.863
[INFO] - 02-27 22:09:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:09:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:09:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:09:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:09:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:09:49 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2207, 2213, 1]
[INFO] - 02-27 22:09:50 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:09:56 - [main.backward:225]: Epoch 465/500 - Iteration 20/95 - Time 0.318 batch, 0.064 data, 0.290 forward
[INFO] - 02-27 22:09:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0032)
[INFO] - 02-27 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5821 (0.5860)
[INFO] - 02-27 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5484 (-287.5454)
[INFO] - 02-27 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9006 (31.7982)
[INFO] - 02-27 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1114 (371.2154)
[INFO] - 02-27 22:09:56 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:09:56 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9656)
[INFO] - 02-27 22:10:10 - [main.backward:225]: Epoch 465/500 - Iteration 70/95 - Time 0.289 batch, 0.037 data, 0.262 forward
[INFO] - 02-27 22:10:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:10:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0033)
[INFO] - 02-27 22:10:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5856 (0.5852)
[INFO] - 02-27 22:10:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5442 (-287.5477)
[INFO] - 02-27 22:10:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7464 (31.7955)
[INFO] - 02-27 22:10:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7313 (371.3501)
[INFO] - 02-27 22:10:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:10:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9617)
[INFO] - 02-27 22:10:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:10:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:10:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:10:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:10:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:10:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:10:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:10:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.522
[INFO] - 02-27 22:10:19 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.523
[INFO] - 02-27 22:10:19 - [main.summary_metrics:168]: Epoch 465/500 - Test Results:
{'auc': 0.8463864729102426,
 'f1': 0.40738846801346806,
 'loss': 0.4382768338949524,
 'ndcg': 0.7167276948471868,
 'precision': 0.54375,
 'recall': 0.3262298669467787}
[INFO] - 02-27 22:10:19 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[465] Complete. Time taken: 00:00:29.597
[INFO] - 02-27 22:10:19 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:10:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:10:19 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:10:19 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:10:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:10:19 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3062, 2204, 2233, 1]
[INFO] - 02-27 22:10:20 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:10:27 - [main.backward:225]: Epoch 466/500 - Iteration 25/95 - Time 0.301 batch, 0.050 data, 0.275 forward
[INFO] - 02-27 22:10:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0013 (0.0030)
[INFO] - 02-27 22:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5829 (0.5857)
[INFO] - 02-27 22:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5454 (-287.5452)
[INFO] - 02-27 22:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7296 (31.7802)
[INFO] - 02-27 22:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.0383 (371.1263)
[INFO] - 02-27 22:10:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:10:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9664)
[INFO] - 02-27 22:10:42 - [main.backward:225]: Epoch 466/500 - Iteration 75/95 - Time 0.309 batch, 0.037 data, 0.279 forward
[INFO] - 02-27 22:10:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0030)
[INFO] - 02-27 22:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5885 (0.5858)
[INFO] - 02-27 22:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5443 (-287.5437)
[INFO] - 02-27 22:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7697 (31.7852)
[INFO] - 02-27 22:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6070 (371.1142)
[INFO] - 02-27 22:10:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:10:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9705)
[INFO] - 02-27 22:10:48 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:10:48 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:10:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:10:48 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:10:48 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:10:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:10:48 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:10:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.659
[INFO] - 02-27 22:10:50 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.659
[INFO] - 02-27 22:10:50 - [main.summary_metrics:168]: Epoch 466/500 - Test Results:
{'auc': 0.8470971476213034,
 'f1': 0.4184880050505051,
 'loss': 0.4373352392713328,
 'ndcg': 0.7161576409558335,
 'precision': 0.559375,
 'recall': 0.33478203781512605}
[INFO] - 02-27 22:10:50 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[466] Complete. Time taken: 00:00:31.248
[INFO] - 02-27 22:10:50 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:10:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:10:50 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:10:50 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:10:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:10:50 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2173, 2211, 1]
[INFO] - 02-27 22:10:51 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:10:59 - [main.backward:225]: Epoch 467/500 - Iteration 30/95 - Time 0.299 batch, 0.048 data, 0.273 forward
[INFO] - 02-27 22:10:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0031)
[INFO] - 02-27 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5882 (0.5850)
[INFO] - 02-27 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5411 (-287.5408)
[INFO] - 02-27 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.6666 (31.7933)
[INFO] - 02-27 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.7823 (371.1634)
[INFO] - 02-27 22:10:59 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:10:59 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9644)
[INFO] - 02-27 22:11:14 - [main.backward:225]: Epoch 467/500 - Iteration 80/95 - Time 0.298 batch, 0.035 data, 0.271 forward
[INFO] - 02-27 22:11:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:11:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0031)
[INFO] - 02-27 22:11:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5815 (0.5852)
[INFO] - 02-27 22:11:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5462 (-287.5454)
[INFO] - 02-27 22:11:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8933 (31.7950)
[INFO] - 02-27 22:11:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4025 (371.1339)
[INFO] - 02-27 22:11:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:11:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9675)
[INFO] - 02-27 22:11:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:11:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:11:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:11:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:11:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:11:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:11:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:11:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.478
[INFO] - 02-27 22:11:21 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.479
[INFO] - 02-27 22:11:21 - [main.summary_metrics:168]: Epoch 467/500 - Test Results:
{'auc': 0.8460023622806967,
 'f1': 0.4115435606060606,
 'loss': 0.43845427852711094,
 'ndcg': 0.720079127126415,
 'precision': 0.55,
 'recall': 0.32926733193277313}
[INFO] - 02-27 22:11:21 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[467] Complete. Time taken: 00:00:30.799
[INFO] - 02-27 22:11:21 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:11:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:11:21 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:11:21 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:11:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:11:21 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2193, 2217, 1]
[INFO] - 02-27 22:11:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:11:32 - [main.backward:225]: Epoch 468/500 - Iteration 35/95 - Time 0.307 batch, 0.045 data, 0.280 forward
[INFO] - 02-27 22:11:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0036 (0.0031)
[INFO] - 02-27 22:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5930 (0.5847)
[INFO] - 02-27 22:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5485 (-287.5478)
[INFO] - 02-27 22:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7921 (31.7899)
[INFO] - 02-27 22:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1039 (371.2076)
[INFO] - 02-27 22:11:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:11:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9673)
[INFO] - 02-27 22:11:46 - [main.backward:225]: Epoch 468/500 - Iteration 85/95 - Time 0.293 batch, 0.034 data, 0.266 forward
[INFO] - 02-27 22:11:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0029)
[INFO] - 02-27 22:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5853)
[INFO] - 02-27 22:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5483 (-287.5481)
[INFO] - 02-27 22:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7743 (31.8080)
[INFO] - 02-27 22:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.4950 (371.2669)
[INFO] - 02-27 22:11:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:11:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9686)
[INFO] - 02-27 22:11:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:11:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:11:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:11:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:11:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:11:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:11:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:11:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.386
[INFO] - 02-27 22:11:51 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.387
[INFO] - 02-27 22:11:51 - [main.summary_metrics:168]: Epoch 468/500 - Test Results:
{'auc': 0.8458544435543826,
 'f1': 0.41635837542087545,
 'loss': 0.4385003199454052,
 'ndcg': 0.7174508349468041,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 22:11:51 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[468] Complete. Time taken: 00:00:30.051
[INFO] - 02-27 22:11:51 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:11:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:11:51 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:11:51 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:11:51 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:11:51 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3100, 2176, 2212, 1]
[INFO] - 02-27 22:11:52 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:12:03 - [main.backward:225]: Epoch 469/500 - Iteration 40/95 - Time 0.302 batch, 0.042 data, 0.274 forward
[INFO] - 02-27 22:12:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:12:03 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0030)
[INFO] - 02-27 22:12:03 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5768 (0.5852)
[INFO] - 02-27 22:12:03 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5449 (-287.5442)
[INFO] - 02-27 22:12:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7660 (31.7736)
[INFO] - 02-27 22:12:03 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6842 (370.9152)
[INFO] - 02-27 22:12:03 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:12:03 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9677)
[INFO] - 02-27 22:12:18 - [main.backward:225]: Epoch 469/500 - Iteration 90/95 - Time 0.295 batch, 0.033 data, 0.268 forward
[INFO] - 02-27 22:12:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:12:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0040 (0.0031)
[INFO] - 02-27 22:12:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5866 (0.5843)
[INFO] - 02-27 22:12:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5425 (-287.5418)
[INFO] - 02-27 22:12:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7648 (31.7973)
[INFO] - 02-27 22:12:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0604 (371.1820)
[INFO] - 02-27 22:12:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:12:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9664)
[INFO] - 02-27 22:12:19 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:12:19 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:12:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:12:19 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:12:19 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:12:19 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:12:19 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:12:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.490
[INFO] - 02-27 22:12:22 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.491
[INFO] - 02-27 22:12:22 - [main.summary_metrics:168]: Epoch 469/500 - Test Results:
{'auc': 0.8475842583356872,
 'f1': 0.42590698653198655,
 'loss': 0.43723723101103146,
 'ndcg': 0.7224041021414803,
 'precision': 0.5687500000000001,
 'recall': 0.3409357492997199}
[INFO] - 02-27 22:12:22 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[469] Complete. Time taken: 00:00:30.484
[INFO] - 02-27 22:12:22 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:12:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:12:22 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:12:22 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:12:22 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:12:22 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3068, 2201, 2213, 1]
[INFO] - 02-27 22:12:22 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:12:36 - [main.backward:225]: Epoch 470/500 - Iteration 45/95 - Time 0.308 batch, 0.040 data, 0.281 forward
[INFO] - 02-27 22:12:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:12:36 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0019 (0.0031)
[INFO] - 02-27 22:12:36 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5854)
[INFO] - 02-27 22:12:36 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5407 (-287.5429)
[INFO] - 02-27 22:12:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7331 (31.7935)
[INFO] - 02-27 22:12:36 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6779 (371.0864)
[INFO] - 02-27 22:12:36 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:12:36 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9667)
[INFO] - 02-27 22:12:50 - [main.backward:225]: Epoch 470/500 - Iteration 0/95 - Time 0.296 batch, 0.033 data, 0.269 forward
[INFO] - 02-27 22:12:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:12:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0022 (0.0029)
[INFO] - 02-27 22:12:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5878 (0.5858)
[INFO] - 02-27 22:12:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5419)
[INFO] - 02-27 22:12:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8377 (31.7861)
[INFO] - 02-27 22:12:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1280 (371.1231)
[INFO] - 02-27 22:12:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:12:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9711)
[INFO] - 02-27 22:12:50 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:12:50 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:12:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:12:50 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:12:50 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:12:50 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:12:50 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:12:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.432
[INFO] - 02-27 22:12:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.433
[INFO] - 02-27 22:12:52 - [main.summary_metrics:168]: Epoch 470/500 - Test Results:
{'auc': 0.8461422803802894,
 'f1': 0.4235921717171717,
 'loss': 0.4385293729451687,
 'ndcg': 0.724000001911375,
 'precision': 0.565625,
 'recall': 0.33909751400560223}
[INFO] - 02-27 22:12:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[470] Complete. Time taken: 00:00:30.518
[INFO] - 02-27 22:12:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:12:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:12:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:12:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:12:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:12:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3040, 2196, 2208, 1]
[INFO] - 02-27 22:12:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:13:07 - [main.backward:225]: Epoch 471/500 - Iteration 50/95 - Time 0.297 batch, 0.039 data, 0.270 forward
[INFO] - 02-27 22:13:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:13:07 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0030)
[INFO] - 02-27 22:13:07 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5894 (0.5869)
[INFO] - 02-27 22:13:07 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5458)
[INFO] - 02-27 22:13:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7876 (31.7946)
[INFO] - 02-27 22:13:07 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4261 (371.2513)
[INFO] - 02-27 22:13:07 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:13:07 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9669)
[INFO] - 02-27 22:13:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:13:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:13:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:13:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:13:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:13:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:13:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:13:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.042
[INFO] - 02-27 22:13:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.043
[INFO] - 02-27 22:13:24 - [main.summary_metrics:168]: Epoch 471/500 - Test Results:
{'auc': 0.8459856769913848,
 'f1': 0.4163583754208754,
 'loss': 0.43830580171841993,
 'ndcg': 0.7219317810542124,
 'precision': 0.55625,
 'recall': 0.3331889005602241}
[INFO] - 02-27 22:13:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[471] Complete. Time taken: 00:00:31.522
[INFO] - 02-27 22:13:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:13:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:13:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:13:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:13:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:13:24 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3009, 2200, 2232, 1]
[INFO] - 02-27 22:13:24 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:13:26 - [main.backward:225]: Epoch 472/500 - Iteration 5/95 - Time 0.458 batch, 0.157 data, 0.424 forward
[INFO] - 02-27 22:13:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:13:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0031)
[INFO] - 02-27 22:13:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5846 (0.5856)
[INFO] - 02-27 22:13:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5438 (-287.5439)
[INFO] - 02-27 22:13:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7620 (31.7961)
[INFO] - 02-27 22:13:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8186 (371.2136)
[INFO] - 02-27 22:13:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:13:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9637)
[INFO] - 02-27 22:13:42 - [main.backward:225]: Epoch 472/500 - Iteration 55/95 - Time 0.334 batch, 0.040 data, 0.306 forward
[INFO] - 02-27 22:13:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0045 (0.0031)
[INFO] - 02-27 22:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5864)
[INFO] - 02-27 22:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5440)
[INFO] - 02-27 22:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7741 (31.8042)
[INFO] - 02-27 22:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7961 (371.1530)
[INFO] - 02-27 22:13:42 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:13:42 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9666)
[INFO] - 02-27 22:13:55 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:13:55 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:13:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:13:55 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:13:55 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:13:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:13:55 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:13:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.019
[INFO] - 02-27 22:13:58 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.020
[INFO] - 02-27 22:13:58 - [main.summary_metrics:168]: Epoch 472/500 - Test Results:
{'auc': 0.8467223933691124,
 'f1': 0.42340698653198655,
 'loss': 0.43760136836096036,
 'ndcg': 0.7148870357844146,
 'precision': 0.5656249999999999,
 'recall': 0.33885241596638654}
[INFO] - 02-27 22:13:58 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[472] Complete. Time taken: 00:00:34.141
[INFO] - 02-27 22:13:58 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:13:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:13:58 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:13:58 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:13:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:13:58 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2210, 2212, 1]
[INFO] - 02-27 22:13:59 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:14:02 - [main.backward:225]: Epoch 473/500 - Iteration 10/95 - Time 0.391 batch, 0.100 data, 0.362 forward
[INFO] - 02-27 22:14:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:14:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0030)
[INFO] - 02-27 22:14:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5896 (0.5855)
[INFO] - 02-27 22:14:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5459 (-287.5447)
[INFO] - 02-27 22:14:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7169 (31.8069)
[INFO] - 02-27 22:14:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.7475 (371.2552)
[INFO] - 02-27 22:14:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:14:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9698)
[INFO] - 02-27 22:14:18 - [main.backward:225]: Epoch 473/500 - Iteration 60/95 - Time 0.334 batch, 0.041 data, 0.305 forward
[INFO] - 02-27 22:14:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:14:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0030)
[INFO] - 02-27 22:14:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5840 (0.5860)
[INFO] - 02-27 22:14:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5424 (-287.5441)
[INFO] - 02-27 22:14:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8153 (31.8048)
[INFO] - 02-27 22:14:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3034 (371.2012)
[INFO] - 02-27 22:14:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:14:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9658)
[INFO] - 02-27 22:14:29 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:14:29 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:14:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:14:29 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:14:29 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:14:29 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:14:29 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:14:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.973
[INFO] - 02-27 22:14:32 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.974
[INFO] - 02-27 22:14:32 - [main.summary_metrics:168]: Epoch 473/500 - Test Results:
{'auc': 0.8466377085147785,
 'f1': 0.41201809764309766,
 'loss': 0.4375613443759863,
 'ndcg': 0.7139904154018617,
 'precision': 0.55,
 'recall': 0.32990633753501397}
[INFO] - 02-27 22:14:32 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[473] Complete. Time taken: 00:00:34.045
[INFO] - 02-27 22:14:32 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:14:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:14:32 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:14:32 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:14:32 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:14:32 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3036, 2223, 2209, 1]
[INFO] - 02-27 22:14:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:14:37 - [main.backward:225]: Epoch 474/500 - Iteration 15/95 - Time 0.362 batch, 0.066 data, 0.335 forward
[INFO] - 02-27 22:14:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:14:37 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0030)
[INFO] - 02-27 22:14:37 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5878 (0.5854)
[INFO] - 02-27 22:14:37 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5437 (-287.5426)
[INFO] - 02-27 22:14:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9274 (31.8056)
[INFO] - 02-27 22:14:37 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0387 (371.1183)
[INFO] - 02-27 22:14:37 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:14:37 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9664)
[INFO] - 02-27 22:14:54 - [main.backward:225]: Epoch 474/500 - Iteration 65/95 - Time 0.333 batch, 0.037 data, 0.305 forward
[INFO] - 02-27 22:14:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0020 (0.0031)
[INFO] - 02-27 22:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5802 (0.5852)
[INFO] - 02-27 22:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5464 (-287.5425)
[INFO] - 02-27 22:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8418 (31.7960)
[INFO] - 02-27 22:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.6112 (371.4618)
[INFO] - 02-27 22:14:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:14:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9658)
[INFO] - 02-27 22:15:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:15:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:15:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:15:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:15:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:15:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:15:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:15:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.840
[INFO] - 02-27 22:15:06 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.840
[INFO] - 02-27 22:15:06 - [main.summary_metrics:168]: Epoch 474/500 - Test Results:
{'auc': 0.8468316012679582,
 'f1': 0.411121632996633,
 'loss': 0.43794046108281337,
 'ndcg': 0.7181161456861863,
 'precision': 0.5499999999999999,
 'recall': 0.3286502100840336}
[INFO] - 02-27 22:15:06 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[474] Complete. Time taken: 00:00:34.492
[INFO] - 02-27 22:15:06 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:15:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:15:06 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:15:06 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:15:06 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:15:06 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3064, 2203, 2209, 1]
[INFO] - 02-27 22:15:07 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:15:14 - [main.backward:225]: Epoch 475/500 - Iteration 20/95 - Time 0.359 batch, 0.060 data, 0.330 forward
[INFO] - 02-27 22:15:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:15:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0038 (0.0032)
[INFO] - 02-27 22:15:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5817 (0.5846)
[INFO] - 02-27 22:15:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5430 (-287.5435)
[INFO] - 02-27 22:15:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8368 (31.7972)
[INFO] - 02-27 22:15:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1042 (371.4718)
[INFO] - 02-27 22:15:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:15:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9644)
[INFO] - 02-27 22:15:29 - [main.backward:225]: Epoch 475/500 - Iteration 70/95 - Time 0.329 batch, 0.038 data, 0.301 forward
[INFO] - 02-27 22:15:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:15:29 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0029)
[INFO] - 02-27 22:15:29 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5930 (0.5848)
[INFO] - 02-27 22:15:29 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5470 (-287.5456)
[INFO] - 02-27 22:15:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7336 (31.7776)
[INFO] - 02-27 22:15:29 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.1473 (371.1304)
[INFO] - 02-27 22:15:29 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:15:29 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9689)
[INFO] - 02-27 22:15:37 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:15:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:15:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:15:37 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:15:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.888
[INFO] - 02-27 22:15:40 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.888
[INFO] - 02-27 22:15:40 - [main.summary_metrics:168]: Epoch 475/500 - Test Results:
{'auc': 0.8454655666801034,
 'f1': 0.4017582070707071,
 'loss': 0.4387636496986619,
 'ndcg': 0.7208334429261154,
 'precision': 0.5375000000000001,
 'recall': 0.32114845938375347}
[INFO] - 02-27 22:15:40 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[475] Complete. Time taken: 00:00:33.856
[INFO] - 02-27 22:15:40 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:15:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:15:40 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:15:40 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:15:40 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:15:40 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2205, 2197, 1]
[INFO] - 02-27 22:15:41 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:15:49 - [main.backward:225]: Epoch 476/500 - Iteration 25/95 - Time 0.347 batch, 0.054 data, 0.319 forward
[INFO] - 02-27 22:15:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:15:49 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0033)
[INFO] - 02-27 22:15:49 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5838 (0.5856)
[INFO] - 02-27 22:15:49 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5457 (-287.5430)
[INFO] - 02-27 22:15:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7228 (31.7818)
[INFO] - 02-27 22:15:49 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3792 (371.1480)
[INFO] - 02-27 22:15:49 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:15:49 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9375 (0.9633)
[INFO] - 02-27 22:16:05 - [main.backward:225]: Epoch 476/500 - Iteration 75/95 - Time 0.326 batch, 0.037 data, 0.298 forward
[INFO] - 02-27 22:16:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:16:05 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0029)
[INFO] - 02-27 22:16:05 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5817 (0.5854)
[INFO] - 02-27 22:16:05 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5480 (-287.5449)
[INFO] - 02-27 22:16:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8343 (31.7919)
[INFO] - 02-27 22:16:05 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8478 (371.3283)
[INFO] - 02-27 22:16:05 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:16:05 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9697)
[INFO] - 02-27 22:16:11 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:16:11 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:16:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:16:11 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:16:11 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:16:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:16:11 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:16:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.866
[INFO] - 02-27 22:16:14 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.867
[INFO] - 02-27 22:16:14 - [main.summary_metrics:168]: Epoch 476/500 - Test Results:
{'auc': 0.846616228844479,
 'f1': 0.4257218013468014,
 'loss': 0.4378026144438829,
 'ndcg': 0.7208295198515349,
 'precision': 0.5687500000000001,
 'recall': 0.3406906512605042}
[INFO] - 02-27 22:16:14 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[476] Complete. Time taken: 00:00:33.667
[INFO] - 02-27 22:16:14 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:16:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:16:14 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:16:14 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:16:14 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:16:14 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3040, 2178, 2205, 1]
[INFO] - 02-27 22:16:15 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:16:24 - [main.backward:225]: Epoch 477/500 - Iteration 30/95 - Time 0.348 batch, 0.051 data, 0.319 forward
[INFO] - 02-27 22:16:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:16:24 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0031)
[INFO] - 02-27 22:16:24 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5909 (0.5855)
[INFO] - 02-27 22:16:24 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5466 (-287.5465)
[INFO] - 02-27 22:16:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8164 (31.7827)
[INFO] - 02-27 22:16:24 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0186 (371.0608)
[INFO] - 02-27 22:16:24 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:16:24 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9650)
[INFO] - 02-27 22:16:41 - [main.backward:225]: Epoch 477/500 - Iteration 80/95 - Time 0.333 batch, 0.037 data, 0.304 forward
[INFO] - 02-27 22:16:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0031)
[INFO] - 02-27 22:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5846 (0.5850)
[INFO] - 02-27 22:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5432 (-287.5450)
[INFO] - 02-27 22:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8117 (31.7972)
[INFO] - 02-27 22:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.6588 (371.1534)
[INFO] - 02-27 22:16:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:16:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9664)
[INFO] - 02-27 22:16:46 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:16:46 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:16:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:16:46 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:16:46 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:16:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:16:46 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:16:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.082
[INFO] - 02-27 22:16:49 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.083
[INFO] - 02-27 22:16:49 - [main.summary_metrics:168]: Epoch 477/500 - Test Results:
{'auc': 0.8461918858229567,
 'f1': 0.4164625420875421,
 'loss': 0.43747939372347966,
 'ndcg': 0.7231601503903464,
 'precision': 0.55625,
 'recall': 0.3333377100840336}
[INFO] - 02-27 22:16:49 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[477] Complete. Time taken: 00:00:34.743
[INFO] - 02-27 22:16:49 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:16:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:16:49 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:16:49 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:16:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:16:49 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3050, 2185, 2217, 1]
[INFO] - 02-27 22:16:49 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:17:01 - [main.backward:225]: Epoch 478/500 - Iteration 35/95 - Time 0.355 batch, 0.047 data, 0.325 forward
[INFO] - 02-27 22:17:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0032)
[INFO] - 02-27 22:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5882 (0.5861)
[INFO] - 02-27 22:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5467 (-287.5441)
[INFO] - 02-27 22:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8684 (31.7996)
[INFO] - 02-27 22:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4709 (371.1463)
[INFO] - 02-27 22:17:01 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:17:01 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9625)
[INFO] - 02-27 22:17:18 - [main.backward:225]: Epoch 478/500 - Iteration 85/95 - Time 0.346 batch, 0.037 data, 0.316 forward
[INFO] - 02-27 22:17:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:17:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 22:17:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5855)
[INFO] - 02-27 22:17:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5405 (-287.5441)
[INFO] - 02-27 22:17:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7582 (31.8145)
[INFO] - 02-27 22:17:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9257 (371.1588)
[INFO] - 02-27 22:17:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:17:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9642)
[INFO] - 02-27 22:17:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:17:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:17:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:17:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:17:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:17:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:17:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:17:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.881
[INFO] - 02-27 22:17:24 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.882
[INFO] - 02-27 22:17:24 - [main.summary_metrics:168]: Epoch 478/500 - Test Results:
{'auc': 0.8470679325038839,
 'f1': 0.41617319023569027,
 'loss': 0.4376511789821196,
 'ndcg': 0.7266302468532065,
 'precision': 0.55625,
 'recall': 0.3329438025210084}
[INFO] - 02-27 22:17:24 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[478] Complete. Time taken: 00:00:35.724
[INFO] - 02-27 22:17:24 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:17:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:17:24 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:17:24 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:17:24 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:17:24 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2181, 2197, 1]
[INFO] - 02-27 22:17:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:17:38 - [main.backward:225]: Epoch 479/500 - Iteration 40/95 - Time 0.352 batch, 0.046 data, 0.322 forward
[INFO] - 02-27 22:17:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:17:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0032)
[INFO] - 02-27 22:17:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5854 (0.5859)
[INFO] - 02-27 22:17:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5447 (-287.5439)
[INFO] - 02-27 22:17:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7285 (31.7870)
[INFO] - 02-27 22:17:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8095 (371.0143)
[INFO] - 02-27 22:17:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:17:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9647)
[INFO] - 02-27 22:17:55 - [main.backward:225]: Epoch 479/500 - Iteration 90/95 - Time 0.345 batch, 0.037 data, 0.315 forward
[INFO] - 02-27 22:17:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0030)
[INFO] - 02-27 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5827 (0.5862)
[INFO] - 02-27 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5430 (-287.5451)
[INFO] - 02-27 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8877 (31.7877)
[INFO] - 02-27 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5405 (371.1845)
[INFO] - 02-27 22:17:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:17:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9675)
[INFO] - 02-27 22:17:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:17:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:17:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:17:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:17:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:17:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:17:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:18:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.947
[INFO] - 02-27 22:18:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.948
[INFO] - 02-27 22:18:00 - [main.summary_metrics:168]: Epoch 479/500 - Test Results:
{'auc': 0.846570508227801,
 'f1': 0.4212773569023569,
 'loss': 0.4375525300384605,
 'ndcg': 0.7223561098640486,
 'precision': 0.5625,
 'recall': 0.3372592787114846}
[INFO] - 02-27 22:18:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[479] Complete. Time taken: 00:00:35.674
[INFO] - 02-27 22:18:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:18:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:18:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:18:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:18:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:18:00 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3058, 2170, 2223, 1]
[INFO] - 02-27 22:18:01 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:18:17 - [main.backward:225]: Epoch 480/500 - Iteration 45/95 - Time 0.371 batch, 0.046 data, 0.340 forward
[INFO] - 02-27 22:18:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:18:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0029)
[INFO] - 02-27 22:18:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5791 (0.5845)
[INFO] - 02-27 22:18:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5440)
[INFO] - 02-27 22:18:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8327 (31.8010)
[INFO] - 02-27 22:18:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.9145 (371.1980)
[INFO] - 02-27 22:18:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:18:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9922 (0.9692)
[INFO] - 02-27 22:18:34 - [main.backward:225]: Epoch 480/500 - Iteration 0/95 - Time 0.360 batch, 0.039 data, 0.329 forward
[INFO] - 02-27 22:18:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0031)
[INFO] - 02-27 22:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5878 (0.5857)
[INFO] - 02-27 22:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5444 (-287.5446)
[INFO] - 02-27 22:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8081 (31.8076)
[INFO] - 02-27 22:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3782 (371.2035)
[INFO] - 02-27 22:18:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:18:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9691)
[INFO] - 02-27 22:18:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:18:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:18:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:18:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:18:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:18:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:18:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:18:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.900
[INFO] - 02-27 22:18:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.901
[INFO] - 02-27 22:18:37 - [main.summary_metrics:168]: Epoch 480/500 - Test Results:
{'auc': 0.8452872105950224,
 'f1': 0.41830281986531986,
 'loss': 0.4391190241879725,
 'ndcg': 0.7190804595826845,
 'precision': 0.559375,
 'recall': 0.33453693977591037}
[INFO] - 02-27 22:18:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[480] Complete. Time taken: 00:00:37.089
[INFO] - 02-27 22:18:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:18:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:18:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:18:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:18:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:18:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2199, 2212, 1]
[INFO] - 02-27 22:18:38 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:18:55 - [main.backward:225]: Epoch 481/500 - Iteration 50/95 - Time 0.351 batch, 0.046 data, 0.321 forward
[INFO] - 02-27 22:18:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:18:55 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0058 (0.0031)
[INFO] - 02-27 22:18:55 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5786 (0.5859)
[INFO] - 02-27 22:18:55 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5462 (-287.5436)
[INFO] - 02-27 22:18:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8461 (31.7932)
[INFO] - 02-27 22:18:55 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.1754 (371.1764)
[INFO] - 02-27 22:18:55 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:18:55 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.8984 (0.9683)
[INFO] - 02-27 22:19:10 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:19:10 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:19:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:19:10 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:19:10 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:19:10 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:19:10 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:19:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.834
[INFO] - 02-27 22:19:13 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.834
[INFO] - 02-27 22:19:13 - [main.summary_metrics:168]: Epoch 481/500 - Test Results:
{'auc': 0.8462223302924111,
 'f1': 0.41598800505050504,
 'loss': 0.43915864008067074,
 'ndcg': 0.7193710972234251,
 'precision': 0.5562499999999999,
 'recall': 0.33269870448179273}
[INFO] - 02-27 22:19:13 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[481] Complete. Time taken: 00:00:35.730
[INFO] - 02-27 22:19:13 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:19:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:19:13 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:19:13 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:19:13 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:19:13 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3055, 2200, 2217, 1]
[INFO] - 02-27 22:19:13 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:19:15 - [main.backward:225]: Epoch 482/500 - Iteration 5/95 - Time 0.455 batch, 0.162 data, 0.418 forward
[INFO] - 02-27 22:19:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:19:15 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0039 (0.0032)
[INFO] - 02-27 22:19:15 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5834 (0.5859)
[INFO] - 02-27 22:19:15 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5455 (-287.5445)
[INFO] - 02-27 22:19:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7107 (31.7829)
[INFO] - 02-27 22:19:15 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.6465 (371.1493)
[INFO] - 02-27 22:19:15 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:19:15 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9655)
[INFO] - 02-27 22:19:32 - [main.backward:225]: Epoch 482/500 - Iteration 55/95 - Time 0.346 batch, 0.042 data, 0.315 forward
[INFO] - 02-27 22:19:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0032)
[INFO] - 02-27 22:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5798 (0.5863)
[INFO] - 02-27 22:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5454)
[INFO] - 02-27 22:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7927 (31.7966)
[INFO] - 02-27 22:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0879 (371.2276)
[INFO] - 02-27 22:19:32 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:19:32 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9653)
[INFO] - 02-27 22:19:45 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:19:45 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:19:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:19:45 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:19:45 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:19:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:19:45 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:19:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.834
[INFO] - 02-27 22:19:48 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.835
[INFO] - 02-27 22:19:48 - [main.summary_metrics:168]: Epoch 482/500 - Test Results:
{'auc': 0.8462603028956681,
 'f1': 0.4235921717171717,
 'loss': 0.43779972650272053,
 'ndcg': 0.7189845351768054,
 'precision': 0.565625,
 'recall': 0.3390975140056023}
[INFO] - 02-27 22:19:48 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[482] Complete. Time taken: 00:00:34.933
[INFO] - 02-27 22:19:48 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:19:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:19:48 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:19:48 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:19:48 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:19:48 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3068, 2217, 2211, 1]
[INFO] - 02-27 22:19:48 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:19:52 - [main.backward:225]: Epoch 483/500 - Iteration 10/95 - Time 0.409 batch, 0.096 data, 0.375 forward
[INFO] - 02-27 22:19:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:19:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0044 (0.0031)
[INFO] - 02-27 22:19:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5915 (0.5867)
[INFO] - 02-27 22:19:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5452 (-287.5438)
[INFO] - 02-27 22:19:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8334 (31.7919)
[INFO] - 02-27 22:19:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6834 (371.2766)
[INFO] - 02-27 22:19:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:19:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9666)
[INFO] - 02-27 22:20:09 - [main.backward:225]: Epoch 483/500 - Iteration 60/95 - Time 0.348 batch, 0.041 data, 0.317 forward
[INFO] - 02-27 22:20:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0030)
[INFO] - 02-27 22:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5799 (0.5860)
[INFO] - 02-27 22:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5472 (-287.5458)
[INFO] - 02-27 22:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8734 (31.7969)
[INFO] - 02-27 22:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.8994 (371.2368)
[INFO] - 02-27 22:20:09 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:20:09 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9695)
[INFO] - 02-27 22:20:21 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:20:21 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:20:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:20:21 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:20:21 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:20:21 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:20:21 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:20:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.161
[INFO] - 02-27 22:20:25 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.162
[INFO] - 02-27 22:20:25 - [main.summary_metrics:168]: Epoch 483/500 - Test Results:
{'auc': 0.84633871134238,
 'f1': 0.4282218013468013,
 'loss': 0.437870922204771,
 'ndcg': 0.7190217428194907,
 'precision': 0.5718749999999999,
 'recall': 0.34277398459383757}
[INFO] - 02-27 22:20:25 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[483] Complete. Time taken: 00:00:36.733
[INFO] - 02-27 22:20:25 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:20:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:20:25 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:20:25 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:20:25 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:20:25 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3040, 2194, 2210, 1]
[INFO] - 02-27 22:20:25 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:20:31 - [main.backward:225]: Epoch 484/500 - Iteration 15/95 - Time 0.420 batch, 0.077 data, 0.385 forward
[INFO] - 02-27 22:20:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0031)
[INFO] - 02-27 22:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5819 (0.5865)
[INFO] - 02-27 22:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5447 (-287.5469)
[INFO] - 02-27 22:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8269 (31.7958)
[INFO] - 02-27 22:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.2389 (371.2791)
[INFO] - 02-27 22:20:31 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:20:31 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9650)
[INFO] - 02-27 22:20:48 - [main.backward:225]: Epoch 484/500 - Iteration 65/95 - Time 0.359 batch, 0.041 data, 0.328 forward
[INFO] - 02-27 22:20:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0029)
[INFO] - 02-27 22:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5820 (0.5853)
[INFO] - 02-27 22:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5448 (-287.5459)
[INFO] - 02-27 22:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8039 (31.8126)
[INFO] - 02-27 22:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7140 (371.2103)
[INFO] - 02-27 22:20:48 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:20:48 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9663)
[INFO] - 02-27 22:20:58 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:20:58 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:20:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:20:58 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:20:58 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:20:58 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:20:58 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:21:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.990
[INFO] - 02-27 22:21:01 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.992
[INFO] - 02-27 22:21:01 - [main.summary_metrics:168]: Epoch 484/500 - Test Results:
{'auc': 0.846197692373518,
 'f1': 0.4161731902356902,
 'loss': 0.4379981914945518,
 'ndcg': 0.7222314212794796,
 'precision': 0.5562500000000001,
 'recall': 0.3329438025210084}
[INFO] - 02-27 22:21:01 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[484] Complete. Time taken: 00:00:36.323
[INFO] - 02-27 22:21:01 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:21:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:21:01 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:21:01 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:21:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:21:01 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3040, 2196, 2217, 1]
[INFO] - 02-27 22:21:02 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:21:08 - [main.backward:225]: Epoch 485/500 - Iteration 20/95 - Time 0.353 batch, 0.065 data, 0.324 forward
[INFO] - 02-27 22:21:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0030)
[INFO] - 02-27 22:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5877 (0.5858)
[INFO] - 02-27 22:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5439 (-287.5428)
[INFO] - 02-27 22:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7732 (31.8006)
[INFO] - 02-27 22:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5375 (371.2703)
[INFO] - 02-27 22:21:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:21:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9678)
[INFO] - 02-27 22:21:26 - [main.backward:225]: Epoch 485/500 - Iteration 70/95 - Time 0.353 batch, 0.043 data, 0.321 forward
[INFO] - 02-27 22:21:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0033)
[INFO] - 02-27 22:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5825 (0.5849)
[INFO] - 02-27 22:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5454 (-287.5446)
[INFO] - 02-27 22:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7740 (31.8226)
[INFO] - 02-27 22:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0353 (371.3937)
[INFO] - 02-27 22:21:26 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:21:26 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9620)
[INFO] - 02-27 22:21:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:21:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:21:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:21:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:21:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:21:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:21:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:21:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:03.291
[INFO] - 02-27 22:21:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:03.304
[INFO] - 02-27 22:21:37 - [main.summary_metrics:168]: Epoch 485/500 - Test Results:
{'auc': 0.8468876173018227,
 'f1': 0.4117287457912458,
 'loss': 0.43761512135617164,
 'ndcg': 0.7180225542565009,
 'precision': 0.55,
 'recall': 0.3295124299719888}
[INFO] - 02-27 22:21:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[485] Complete. Time taken: 00:00:36.039
[INFO] - 02-27 22:21:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:21:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:21:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:21:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:21:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:21:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3042, 2197, 2205, 1]
[INFO] - 02-27 22:21:38 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:21:46 - [main.backward:225]: Epoch 486/500 - Iteration 25/95 - Time 0.363 batch, 0.059 data, 0.332 forward
[INFO] - 02-27 22:21:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0027 (0.0031)
[INFO] - 02-27 22:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5800 (0.5851)
[INFO] - 02-27 22:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5383 (-287.5436)
[INFO] - 02-27 22:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8785 (31.8010)
[INFO] - 02-27 22:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5474 (371.0131)
[INFO] - 02-27 22:21:46 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:21:46 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9688)
[INFO] - 02-27 22:22:02 - [main.backward:225]: Epoch 486/500 - Iteration 75/95 - Time 0.333 batch, 0.039 data, 0.304 forward
[INFO] - 02-27 22:22:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:22:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0035)
[INFO] - 02-27 22:22:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5814 (0.5852)
[INFO] - 02-27 22:22:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5375 (-287.5377)
[INFO] - 02-27 22:22:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8051 (31.7899)
[INFO] - 02-27 22:22:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7279 (371.0903)
[INFO] - 02-27 22:22:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:22:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9572)
[INFO] - 02-27 22:22:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:22:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:22:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:22:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:22:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:22:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:22:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:22:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.834
[INFO] - 02-27 22:22:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.834
[INFO] - 02-27 22:22:11 - [main.summary_metrics:168]: Epoch 486/500 - Test Results:
{'auc': 0.8467275181518685,
 'f1': 0.41351746632996633,
 'loss': 0.4382045371861739,
 'ndcg': 0.720243573365569,
 'precision': 0.553125,
 'recall': 0.33058473389355747}
[INFO] - 02-27 22:22:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[486] Complete. Time taken: 00:00:34.215
[INFO] - 02-27 22:22:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:22:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:22:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:22:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:22:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:22:11 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3056, 2197, 2233, 1]
[INFO] - 02-27 22:22:12 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:22:21 - [main.backward:225]: Epoch 487/500 - Iteration 30/95 - Time 0.345 batch, 0.050 data, 0.315 forward
[INFO] - 02-27 22:22:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:22:21 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0047 (0.0034)
[INFO] - 02-27 22:22:21 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5883 (0.5855)
[INFO] - 02-27 22:22:21 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5453 (-287.5420)
[INFO] - 02-27 22:22:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8742 (31.7974)
[INFO] - 02-27 22:22:21 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2894 (371.1931)
[INFO] - 02-27 22:22:21 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:22:21 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9453 (0.9617)
[INFO] - 02-27 22:22:38 - [main.backward:225]: Epoch 487/500 - Iteration 80/95 - Time 0.337 batch, 0.038 data, 0.307 forward
[INFO] - 02-27 22:22:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:22:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0032)
[INFO] - 02-27 22:22:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5810 (0.5860)
[INFO] - 02-27 22:22:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5425 (-287.5447)
[INFO] - 02-27 22:22:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8264 (31.7912)
[INFO] - 02-27 22:22:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2224 (371.3801)
[INFO] - 02-27 22:22:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:22:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9652)
[INFO] - 02-27 22:22:43 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:22:43 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:22:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:22:43 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:22:43 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:22:43 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:22:43 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:22:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.869
[INFO] - 02-27 22:22:46 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.869
[INFO] - 02-27 22:22:46 - [main.summary_metrics:168]: Epoch 487/500 - Test Results:
{'auc': 0.8467924003547497,
 'f1': 0.4164625420875421,
 'loss': 0.43863659052463866,
 'ndcg': 0.7211593699033642,
 'precision': 0.5562499999999999,
 'recall': 0.3333377100840337}
[INFO] - 02-27 22:22:46 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[487] Complete. Time taken: 00:00:34.723
[INFO] - 02-27 22:22:46 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:22:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:22:46 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:22:46 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:22:46 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:22:46 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3018, 2175, 2221, 1]
[INFO] - 02-27 22:22:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:22:58 - [main.backward:225]: Epoch 488/500 - Iteration 35/95 - Time 0.346 batch, 0.049 data, 0.317 forward
[INFO] - 02-27 22:22:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0029)
[INFO] - 02-27 22:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5861 (0.5861)
[INFO] - 02-27 22:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5449 (-287.5441)
[INFO] - 02-27 22:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9042 (31.8058)
[INFO] - 02-27 22:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.6415 (371.3163)
[INFO] - 02-27 22:22:58 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:22:58 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9678)
[INFO] - 02-27 22:23:14 - [main.backward:225]: Epoch 488/500 - Iteration 85/95 - Time 0.332 batch, 0.037 data, 0.303 forward
[INFO] - 02-27 22:23:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:23:14 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0042 (0.0030)
[INFO] - 02-27 22:23:14 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5820 (0.5858)
[INFO] - 02-27 22:23:14 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5468 (-287.5445)
[INFO] - 02-27 22:23:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7758 (31.8004)
[INFO] - 02-27 22:23:14 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3005 (371.0906)
[INFO] - 02-27 22:23:14 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:23:14 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9714)
[INFO] - 02-27 22:23:17 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:23:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:23:17 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:23:17 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:23:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.992
[INFO] - 02-27 22:23:20 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.993
[INFO] - 02-27 22:23:20 - [main.summary_metrics:168]: Epoch 488/500 - Test Results:
{'auc': 0.8468494253706385,
 'f1': 0.40875420875420876,
 'loss': 0.4384770751813354,
 'ndcg': 0.7211168998338017,
 'precision': 0.546875,
 'recall': 0.32679009103641454}
[INFO] - 02-27 22:23:20 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[488] Complete. Time taken: 00:00:34.609
[INFO] - 02-27 22:23:20 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:23:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:23:20 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:23:20 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:23:20 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:23:20 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3035, 2198, 2217, 1]
[INFO] - 02-27 22:23:21 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:23:34 - [main.backward:225]: Epoch 489/500 - Iteration 40/95 - Time 0.342 batch, 0.046 data, 0.314 forward
[INFO] - 02-27 22:23:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:23:34 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0028 (0.0030)
[INFO] - 02-27 22:23:34 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5902 (0.5871)
[INFO] - 02-27 22:23:34 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5445 (-287.5464)
[INFO] - 02-27 22:23:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7847 (31.8011)
[INFO] - 02-27 22:23:34 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.2615 (371.1732)
[INFO] - 02-27 22:23:34 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:23:34 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9675)
[INFO] - 02-27 22:23:50 - [main.backward:225]: Epoch 489/500 - Iteration 90/95 - Time 0.334 batch, 0.037 data, 0.305 forward
[INFO] - 02-27 22:23:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:23:50 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0013 (0.0029)
[INFO] - 02-27 22:23:50 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5918 (0.5858)
[INFO] - 02-27 22:23:50 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5411 (-287.5414)
[INFO] - 02-27 22:23:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8373 (31.7903)
[INFO] - 02-27 22:23:50 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.2762 (371.2142)
[INFO] - 02-27 22:23:50 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:23:50 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 1.0000 (0.9694)
[INFO] - 02-27 22:23:52 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:23:52 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:23:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:23:52 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:23:52 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:23:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:23:52 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:23:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.887
[INFO] - 02-27 22:23:55 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.888
[INFO] - 02-27 22:23:55 - [main.summary_metrics:168]: Epoch 489/500 - Test Results:
{'auc': 0.8478793277114768,
 'f1': 0.420513468013468,
 'loss': 0.4377409766993321,
 'ndcg': 0.7253606427992992,
 'precision': 0.5625,
 'recall': 0.33622636554621854}
[INFO] - 02-27 22:23:55 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[489] Complete. Time taken: 00:00:34.524
[INFO] - 02-27 22:23:55 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:23:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:23:55 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:23:55 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:23:55 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:23:55 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3060, 2207, 2211, 1]
[INFO] - 02-27 22:23:56 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:24:10 - [main.backward:225]: Epoch 490/500 - Iteration 45/95 - Time 0.338 batch, 0.041 data, 0.310 forward
[INFO] - 02-27 22:24:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:24:10 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0030)
[INFO] - 02-27 22:24:10 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5840 (0.5867)
[INFO] - 02-27 22:24:10 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5388 (-287.5407)
[INFO] - 02-27 22:24:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8614 (31.7973)
[INFO] - 02-27 22:24:10 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.8118 (371.1661)
[INFO] - 02-27 22:24:10 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:24:10 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9698)
[INFO] - 02-27 22:24:27 - [main.backward:225]: Epoch 490/500 - Iteration 0/95 - Time 0.335 batch, 0.034 data, 0.307 forward
[INFO] - 02-27 22:24:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:24:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0029)
[INFO] - 02-27 22:24:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5819 (0.5848)
[INFO] - 02-27 22:24:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5463 (-287.5417)
[INFO] - 02-27 22:24:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8683 (31.8178)
[INFO] - 02-27 22:24:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.0281 (371.3383)
[INFO] - 02-27 22:24:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:24:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9703)
[INFO] - 02-27 22:24:27 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:24:27 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:24:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:24:27 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:24:27 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:24:27 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:24:27 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:24:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.740
[INFO] - 02-27 22:24:30 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.741
[INFO] - 02-27 22:24:30 - [main.summary_metrics:168]: Epoch 490/500 - Test Results:
{'auc': 0.8481619687703512,
 'f1': 0.41375420875420876,
 'loss': 0.43632814498342,
 'ndcg': 0.7211281291016547,
 'precision': 0.553125,
 'recall': 0.33095675770308125}
[INFO] - 02-27 22:24:30 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[490] Complete. Time taken: 00:00:34.599
[INFO] - 02-27 22:24:30 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:24:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:24:30 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:24:30 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:24:30 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:24:30 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3054, 2200, 2212, 1]
[INFO] - 02-27 22:24:30 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:24:47 - [main.backward:225]: Epoch 491/500 - Iteration 50/95 - Time 0.340 batch, 0.042 data, 0.312 forward
[INFO] - 02-27 22:24:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0032)
[INFO] - 02-27 22:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5856)
[INFO] - 02-27 22:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5422 (-287.5419)
[INFO] - 02-27 22:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7489 (31.7895)
[INFO] - 02-27 22:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7650 (371.2860)
[INFO] - 02-27 22:24:47 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:24:47 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9650)
[INFO] - 02-27 22:25:01 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:25:01 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:25:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:25:01 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:25:01 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:25:01 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:25:01 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:25:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.717
[INFO] - 02-27 22:25:04 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.717
[INFO] - 02-27 22:25:04 - [main.summary_metrics:168]: Epoch 491/500 - Test Results:
{'auc': 0.8480139984915535,
 'f1': 0.4140435606060606,
 'loss': 0.43662242817821667,
 'ndcg': 0.7203290730729114,
 'precision': 0.5531250000000001,
 'recall': 0.33135066526610646}
[INFO] - 02-27 22:25:04 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[491] Complete. Time taken: 00:00:34.108
[INFO] - 02-27 22:25:04 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:25:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:25:04 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:25:04 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:25:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:25:04 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3045, 2213, 2234, 1]
[INFO] - 02-27 22:25:04 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:25:06 - [main.backward:225]: Epoch 492/500 - Iteration 5/95 - Time 0.436 batch, 0.159 data, 0.402 forward
[INFO] - 02-27 22:25:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:25:06 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0053 (0.0029)
[INFO] - 02-27 22:25:06 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5819 (0.5854)
[INFO] - 02-27 22:25:06 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5429 (-287.5430)
[INFO] - 02-27 22:25:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8301 (31.7918)
[INFO] - 02-27 22:25:06 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4149 (371.3794)
[INFO] - 02-27 22:25:06 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:25:06 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9219 (0.9706)
[INFO] - 02-27 22:25:22 - [main.backward:225]: Epoch 492/500 - Iteration 55/95 - Time 0.332 batch, 0.041 data, 0.302 forward
[INFO] - 02-27 22:25:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0023 (0.0029)
[INFO] - 02-27 22:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5850 (0.5851)
[INFO] - 02-27 22:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5442 (-287.5429)
[INFO] - 02-27 22:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8284 (31.7844)
[INFO] - 02-27 22:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.5823 (371.2654)
[INFO] - 02-27 22:25:22 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:25:22 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9694)
[INFO] - 02-27 22:25:34 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:25:34 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:25:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:25:34 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:25:34 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:25:34 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:25:34 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:25:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.664
[INFO] - 02-27 22:25:37 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.667
[INFO] - 02-27 22:25:37 - [main.summary_metrics:168]: Epoch 492/500 - Test Results:
{'auc': 0.8481788354434912,
 'f1': 0.4233028198653199,
 'loss': 0.43587014989284434,
 'ndcg': 0.7233914869686477,
 'precision': 0.565625,
 'recall': 0.338703606442577}
[INFO] - 02-27 22:25:37 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[492] Complete. Time taken: 00:00:33.407
[INFO] - 02-27 22:25:37 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:25:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:25:37 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:25:37 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:25:37 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:25:37 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3059, 2197, 2206, 1]
[INFO] - 02-27 22:25:38 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:25:41 - [main.backward:225]: Epoch 493/500 - Iteration 10/95 - Time 0.392 batch, 0.096 data, 0.359 forward
[INFO] - 02-27 22:25:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:25:41 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0028)
[INFO] - 02-27 22:25:41 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5851 (0.5851)
[INFO] - 02-27 22:25:41 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5451 (-287.5448)
[INFO] - 02-27 22:25:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7905 (31.8050)
[INFO] - 02-27 22:25:41 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3403 (371.4631)
[INFO] - 02-27 22:25:41 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:25:41 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9698)
[INFO] - 02-27 22:25:57 - [main.backward:225]: Epoch 493/500 - Iteration 60/95 - Time 0.330 batch, 0.039 data, 0.302 forward
[INFO] - 02-27 22:25:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0029)
[INFO] - 02-27 22:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5921 (0.5851)
[INFO] - 02-27 22:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5472 (-287.5446)
[INFO] - 02-27 22:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7192 (31.7836)
[INFO] - 02-27 22:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1422 (371.1089)
[INFO] - 02-27 22:25:57 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:25:57 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9669)
[INFO] - 02-27 22:26:08 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:26:08 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:26:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:26:08 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:26:08 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:26:08 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:26:08 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:26:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.684
[INFO] - 02-27 22:26:11 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.685
[INFO] - 02-27 22:26:11 - [main.summary_metrics:168]: Epoch 493/500 - Test Results:
{'auc': 0.8452830718071542,
 'f1': 0.4117287457912458,
 'loss': 0.43810434181075186,
 'ndcg': 0.713423705006675,
 'precision': 0.55,
 'recall': 0.3295124299719888}
[INFO] - 02-27 22:26:11 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[493] Complete. Time taken: 00:00:33.560
[INFO] - 02-27 22:26:11 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:26:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:26:11 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:26:11 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:26:11 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:26:11 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3070, 2189, 2209, 1]
[INFO] - 02-27 22:26:11 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:26:17 - [main.backward:225]: Epoch 494/500 - Iteration 15/95 - Time 0.394 batch, 0.072 data, 0.363 forward
[INFO] - 02-27 22:26:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0018 (0.0032)
[INFO] - 02-27 22:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5829 (0.5851)
[INFO] - 02-27 22:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5435 (-287.5450)
[INFO] - 02-27 22:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8277 (31.7980)
[INFO] - 02-27 22:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4889 (371.1463)
[INFO] - 02-27 22:26:17 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:26:17 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9664)
[INFO] - 02-27 22:26:33 - [main.backward:225]: Epoch 494/500 - Iteration 65/95 - Time 0.337 batch, 0.037 data, 0.309 forward
[INFO] - 02-27 22:26:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:26:33 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0050 (0.0032)
[INFO] - 02-27 22:26:33 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5915 (0.5863)
[INFO] - 02-27 22:26:33 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5391 (-287.5436)
[INFO] - 02-27 22:26:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.9011 (31.7925)
[INFO] - 02-27 22:26:33 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 372.7731 (371.2052)
[INFO] - 02-27 22:26:33 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:26:33 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9141 (0.9653)
[INFO] - 02-27 22:26:42 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:26:42 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:26:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:26:42 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:26:42 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:26:42 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:26:42 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:26:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.689
[INFO] - 02-27 22:26:45 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.691
[INFO] - 02-27 22:26:45 - [main.summary_metrics:168]: Epoch 494/500 - Test Results:
{'auc': 0.8450654185693884,
 'f1': 0.40025883838383836,
 'loss': 0.43737947352816675,
 'ndcg': 0.713752003941797,
 'precision': 0.534375,
 'recall': 0.3204700630252101}
[INFO] - 02-27 22:26:45 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[494] Complete. Time taken: 00:00:34.259
[INFO] - 02-27 22:26:45 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:26:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:26:45 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:26:45 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:26:45 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:26:45 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3052, 2174, 2213, 1]
[INFO] - 02-27 22:26:46 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:26:52 - [main.backward:225]: Epoch 495/500 - Iteration 20/95 - Time 0.357 batch, 0.059 data, 0.329 forward
[INFO] - 02-27 22:26:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:26:52 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0033 (0.0030)
[INFO] - 02-27 22:26:52 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5908 (0.5851)
[INFO] - 02-27 22:26:52 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5440 (-287.5413)
[INFO] - 02-27 22:26:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7494 (31.8151)
[INFO] - 02-27 22:26:52 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7131 (371.0693)
[INFO] - 02-27 22:26:52 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:26:52 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9531 (0.9653)
[INFO] - 02-27 22:27:08 - [main.backward:225]: Epoch 495/500 - Iteration 70/95 - Time 0.325 batch, 0.036 data, 0.298 forward
[INFO] - 02-27 22:27:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0025 (0.0031)
[INFO] - 02-27 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5825 (0.5853)
[INFO] - 02-27 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5408 (-287.5434)
[INFO] - 02-27 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7497 (31.8011)
[INFO] - 02-27 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.4031 (371.1475)
[INFO] - 02-27 22:27:08 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:27:08 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9661)
[INFO] - 02-27 22:27:15 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:27:15 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:27:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:27:15 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:27:15 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:27:15 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:27:15 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:27:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.749
[INFO] - 02-27 22:27:18 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.750
[INFO] - 02-27 22:27:18 - [main.summary_metrics:168]: Epoch 495/500 - Test Results:
{'auc': 0.8452691297720069,
 'f1': 0.4072032828282829,
 'loss': 0.4379668610287032,
 'ndcg': 0.7145934725265136,
 'precision': 0.54375,
 'recall': 0.325984768907563}
[INFO] - 02-27 22:27:18 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[495] Complete. Time taken: 00:00:33.326
[INFO] - 02-27 22:27:18 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:27:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:27:18 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:27:18 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:27:18 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:27:18 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3037, 2190, 2222, 1]
[INFO] - 02-27 22:27:19 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:27:27 - [main.backward:225]: Epoch 496/500 - Iteration 25/95 - Time 0.340 batch, 0.056 data, 0.312 forward
[INFO] - 02-27 22:27:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0034 (0.0030)
[INFO] - 02-27 22:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5922 (0.5860)
[INFO] - 02-27 22:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5415 (-287.5418)
[INFO] - 02-27 22:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8782 (31.8023)
[INFO] - 02-27 22:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.9593 (371.0673)
[INFO] - 02-27 22:27:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:27:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9681)
[INFO] - 02-27 22:27:43 - [main.backward:225]: Epoch 496/500 - Iteration 75/95 - Time 0.329 batch, 0.038 data, 0.301 forward
[INFO] - 02-27 22:27:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:27:43 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0031 (0.0031)
[INFO] - 02-27 22:27:43 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5817 (0.5855)
[INFO] - 02-27 22:27:43 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5420 (-287.5427)
[INFO] - 02-27 22:27:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7521 (31.7742)
[INFO] - 02-27 22:27:43 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.5359 (370.9030)
[INFO] - 02-27 22:27:43 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:27:43 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9688 (0.9652)
[INFO] - 02-27 22:27:49 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:27:49 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:27:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:27:49 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:27:49 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:27:49 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:27:49 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:27:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.735
[INFO] - 02-27 22:27:52 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.736
[INFO] - 02-27 22:27:52 - [main.summary_metrics:168]: Epoch 496/500 - Test Results:
{'auc': 0.8470740744827343,
 'f1': 0.4087026515151515,
 'loss': 0.43729351270147654,
 'ndcg': 0.723497405552384,
 'precision': 0.546875,
 'recall': 0.32666316526610645}
[INFO] - 02-27 22:27:52 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[496] Complete. Time taken: 00:00:33.741
[INFO] - 02-27 22:27:52 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:27:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:27:52 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:27:52 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:27:52 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:27:52 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3037, 2195, 2211, 1]
[INFO] - 02-27 22:27:53 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:28:02 - [main.backward:225]: Epoch 497/500 - Iteration 30/95 - Time 0.340 batch, 0.050 data, 0.312 forward
[INFO] - 02-27 22:28:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0021 (0.0028)
[INFO] - 02-27 22:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5864 (0.5851)
[INFO] - 02-27 22:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5415 (-287.5420)
[INFO] - 02-27 22:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8698 (31.8015)
[INFO] - 02-27 22:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.3276 (371.2378)
[INFO] - 02-27 22:28:02 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:28:02 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9717)
[INFO] - 02-27 22:28:18 - [main.backward:225]: Epoch 497/500 - Iteration 80/95 - Time 0.330 batch, 0.036 data, 0.302 forward
[INFO] - 02-27 22:28:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0024 (0.0029)
[INFO] - 02-27 22:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5784 (0.5858)
[INFO] - 02-27 22:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5383 (-287.5386)
[INFO] - 02-27 22:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8032 (31.7867)
[INFO] - 02-27 22:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 369.9929 (371.0309)
[INFO] - 02-27 22:28:18 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:28:18 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9844 (0.9694)
[INFO] - 02-27 22:28:23 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:28:23 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:28:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:28:23 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:28:23 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:28:23 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:28:23 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:28:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.723
[INFO] - 02-27 22:28:26 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.724
[INFO] - 02-27 22:28:26 - [main.summary_metrics:168]: Epoch 497/500 - Test Results:
{'auc': 0.8465126999329143,
 'f1': 0.40899200336700336,
 'loss': 0.4382103051179764,
 'ndcg': 0.7166521115217602,
 'precision': 0.546875,
 'recall': 0.32705707282913166}
[INFO] - 02-27 22:28:26 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[497] Complete. Time taken: 00:00:33.985
[INFO] - 02-27 22:28:26 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:28:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:28:26 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:28:26 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:28:26 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:28:26 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3044, 2195, 2196, 1]
[INFO] - 02-27 22:28:27 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:28:38 - [main.backward:225]: Epoch 498/500 - Iteration 35/95 - Time 0.340 batch, 0.047 data, 0.312 forward
[INFO] - 02-27 22:28:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:28:38 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0035 (0.0032)
[INFO] - 02-27 22:28:38 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5859 (0.5857)
[INFO] - 02-27 22:28:38 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5406 (-287.5398)
[INFO] - 02-27 22:28:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7631 (31.7876)
[INFO] - 02-27 22:28:38 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7385 (371.0864)
[INFO] - 02-27 22:28:38 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:28:38 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9633)
[INFO] - 02-27 22:28:54 - [main.backward:225]: Epoch 498/500 - Iteration 85/95 - Time 0.326 batch, 0.035 data, 0.299 forward
[INFO] - 02-27 22:28:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:28:54 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0026 (0.0032)
[INFO] - 02-27 22:28:54 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5893 (0.5867)
[INFO] - 02-27 22:28:54 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5462 (-287.5415)
[INFO] - 02-27 22:28:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8060 (31.7909)
[INFO] - 02-27 22:28:54 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.0522 (371.2387)
[INFO] - 02-27 22:28:54 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:28:54 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9652)
[INFO] - 02-27 22:28:57 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:28:57 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:28:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:28:57 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:28:57 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:28:57 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:28:57 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:29:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.937
[INFO] - 02-27 22:29:00 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.939
[INFO] - 02-27 22:29:00 - [main.summary_metrics:168]: Epoch 498/500 - Test Results:
{'auc': 0.8467434695692002,
 'f1': 0.40701809764309765,
 'loss': 0.43820676768282063,
 'ndcg': 0.721398821446317,
 'precision': 0.54375,
 'recall': 0.3257396708683473}
[INFO] - 02-27 22:29:00 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[498] Complete. Time taken: 00:00:33.789
[INFO] - 02-27 22:29:00 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:29:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:29:00 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:29:00 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:29:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:29:00 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3052, 2182, 2225, 1]
[INFO] - 02-27 22:29:00 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:29:13 - [main.backward:225]: Epoch 499/500 - Iteration 40/95 - Time 0.323 batch, 0.043 data, 0.296 forward
[INFO] - 02-27 22:29:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0041 (0.0029)
[INFO] - 02-27 22:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5900 (0.5865)
[INFO] - 02-27 22:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5454 (-287.5465)
[INFO] - 02-27 22:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8424 (31.7836)
[INFO] - 02-27 22:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.0939 (371.2857)
[INFO] - 02-27 22:29:13 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:29:13 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9667)
[INFO] - 02-27 22:29:27 - [main.backward:225]: Epoch 499/500 - Iteration 90/95 - Time 0.302 batch, 0.034 data, 0.275 forward
[INFO] - 02-27 22:29:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:29:27 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0029 (0.0031)
[INFO] - 02-27 22:29:27 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5842 (0.5863)
[INFO] - 02-27 22:29:27 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5475 (-287.5483)
[INFO] - 02-27 22:29:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7229 (31.7902)
[INFO] - 02-27 22:29:27 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 370.7257 (371.1720)
[INFO] - 02-27 22:29:27 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:29:27 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9667)
[INFO] - 02-27 22:29:28 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:29:28 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:29:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:29:28 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:29:28 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:29:28 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:29:28 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:29:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.835
[INFO] - 02-27 22:29:31 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.835
[INFO] - 02-27 22:29:31 - [main.summary_metrics:168]: Epoch 499/500 - Test Results:
{'auc': 0.8472702474985092,
 'f1': 0.4141477272727273,
 'loss': 0.43713044142411617,
 'ndcg': 0.7240340811672881,
 'precision': 0.5531250000000001,
 'recall': 0.331499474789916}
[INFO] - 02-27 22:29:31 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[499] Complete. Time taken: 00:00:31.478
[INFO] - 02-27 22:29:31 - [outfit_datasets.dataset.PairwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:29:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with Resample(ratio=0.015) mode.
[INFO] - 02-27 22:29:31 - [outfit_datasets.dataset.PairwiseOutfit.build:59]: Positive tuples shape: (2432, 10)
[INFO] - 02-27 22:29:31 - [outfit_datasets.dataset.PairwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:29:31 - [outfit_datasets.generator.__call__:48]: Generating tuples with RandomMix(ratio=5, type_aware=True) mode.
[INFO] - 02-27 22:29:31 - [outfit_datasets.generator.run:142]: Sampling 5x outfits from 4 sets: [3093, 2197, 2224, 1]
[INFO] - 02-27 22:29:32 - [outfit_datasets.dataset.PairwiseOutfit.build:62]: Negative tuples shape: (12160, 10)
[INFO] - 02-27 22:29:45 - [main.backward:225]: Epoch 500/500 - Iteration 45/95 - Time 0.307 batch, 0.042 data, 0.280 forward
[INFO] - 02-27 22:29:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:29:45 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0030 (0.0031)
[INFO] - 02-27 22:29:45 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5852)
[INFO] - 02-27 22:29:45 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5437 (-287.5476)
[INFO] - 02-27 22:29:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.7413 (31.7795)
[INFO] - 02-27 22:29:45 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.1971 (371.3372)
[INFO] - 02-27 22:29:45 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:29:45 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9766 (0.9656)
[INFO] - 02-27 22:30:00 - [main.backward:225]: Epoch 500/500 - Iteration 0/95 - Time 0.302 batch, 0.035 data, 0.274 forward
[INFO] - 02-27 22:30:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: loss
[INFO] - 02-27 22:30:00 - [torchutils.meter.GroupMeter.logging:252]: -------- rank_loss: 0.0037 (0.0032)
[INFO] - 02-27 22:30:00 - [torchutils.meter.GroupMeter.logging:252]: -------- proto_loss: 0.5871 (0.5855)
[INFO] - 02-27 22:30:00 - [torchutils.meter.GroupMeter.logging:252]: -------- div_reg: -287.5480 (-287.5458)
[INFO] - 02-27 22:30:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l2_reg: 31.8549 (31.8063)
[INFO] - 02-27 22:30:00 - [torchutils.meter.GroupMeter.logging:252]: -------- l1_reg: 371.3588 (371.4549)
[INFO] - 02-27 22:30:00 - [torchutils.meter.GroupMeter.logging:250]: -------- Group: accuracy
[INFO] - 02-27 22:30:00 - [torchutils.meter.GroupMeter.logging:252]: -------- accuracy: 0.9609 (0.9619)
[INFO] - 02-27 22:30:00 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:30:00 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:30:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:30:00 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (534, 10)
[INFO] - 02-27 22:30:00 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:30:00 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:30:00 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (5340, 10)
[INFO] - 02-27 22:30:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:02.674
[INFO] - 02-27 22:30:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:02.676
[INFO] - 02-27 22:30:03 - [main.summary_metrics:168]: Epoch 500/500 - Test Results:
{'auc': 0.8468752150369951,
 'f1': 0.4120180976430977,
 'loss': 0.4369683058363768,
 'ndcg': 0.7244570223251781,
 'precision': 0.55,
 'recall': 0.329906337535014}
[INFO] - 02-27 22:30:03 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[500] Complete. Time taken: 00:00:31.410
[INFO] - 02-27 22:30:03 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 04:42:06.935
[INFO] - 02-27 22:30:03 - [main.evaluate:264]: Start Compatibility Evaluation
[INFO] - 02-27 22:30:03 - [main.get_net:27]: Creating net: 
FashionRecommenderParam: {
  factory: FashionRecommenderParam,
  name: FashionRecommender,
  num_users: 32,
  backbone: resnet34,
  embd_dim: 128,
  num_transformer_layers: 4,
  num_heads: 2,
  num_proto: 128,
  dropout: 0.3,
  num_points: 0,
  num_seeds: 1,
  loss_weight: {
    rank_loss: 1.0,
    l1reg: 0.01,
    l2reg: 0.0001,
  },
  use_visual: True,
  use_semantic: False,
  use_nn_feature: False,
  max_items: 3,
  drop_path_rate: 0.1,
  margin: 0.5,
  temperature: 0.1,
  l2_scale: 0.001,
  l1_scale: 0.0001,
  proto_reg_weight: 0.1,
  momentum: 0.9,
  curriculum_epochs: 50,
}
[INFO] - 02-27 22:30:03 - [torchutils.misc.load_pretrained:292]: Loading pre-trained model from logs\2025exp_tuple32_Outfit5_78\checkpoints\best_model_79_val_auc=0.8533.pt.
[INFO] - 02-27 22:30:04 - [torchutils.misc.load_pretrained:305]: Missing keys: 
[INFO] - 02-27 22:30:04 - [torchutils.misc.load_pretrained:306]: Unexpected keys: 
[INFO] - 02-27 22:30:04 - [torchutils.misc.load_pretrained:307]: Unmatched keys: 
[INFO] - 02-27 22:30:04 - [outfit_datasets.dataloader.__init__:28]: Loading [32mtest[0m data
[INFO] - 02-27 22:30:04 - [outfit_datasets.dataloader.__init__:29]: DataLoader: batch size ([32m128[0m), number of workers ([32m0[0m)
[INFO] - 02-27 22:30:04 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_32\test_pos
[INFO] - 02-27 22:30:04 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mtest positive[0m tuples with shape: [32m(898, 10)[0m
[INFO] - 02-27 22:30:04 - [outfit_datasets.utils.load_outfit_tuples:30]: Loading tuples from file: ./outfit-datasets/polyvore-u/processed/original/tuples_32\test_neg
[INFO] - 02-27 22:30:04 - [outfit_datasets.utils.load_outfit_tuples:33]: Loaded [32mtest negative[0m tuples with shape: [32m(8980, 10)[0m
[INFO] - 02-27 22:30:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:30:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:30:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (898, 10)
[INFO] - 02-27 22:30:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:30:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:30:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (8980, 10)
[INFO] - 02-27 22:30:04 - [ignite.engine.engine.Engine.run:871]: Engine run starting with max_epochs=1.
[INFO] - 02-27 22:30:04 - [outfit_datasets.dataset.PointwiseOutfit.build:57]: Generating positive tuples.
[INFO] - 02-27 22:30:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:30:04 - [outfit_datasets.dataset.PointwiseOutfit.build:59]: Positive tuples shape: (898, 10)
[INFO] - 02-27 22:30:04 - [outfit_datasets.dataset.PointwiseOutfit.build:60]: Generating negative tuples.
[INFO] - 02-27 22:30:04 - [outfit_datasets.generator.__call__:48]: Generating tuples with Fix() mode.
[INFO] - 02-27 22:30:04 - [outfit_datasets.dataset.PointwiseOutfit.build:62]: Negative tuples shape: (8980, 10)
[INFO] - 02-27 22:30:09 - [ignite.engine.engine.Engine._internal_run_as_gen:969]: Epoch[1] Complete. Time taken: 00:00:04.850
[INFO] - 02-27 22:30:09 - [ignite.engine.engine.Engine._internal_run_as_gen:985]: Engine run complete. Time taken: 00:00:04.851
[CRITICAL] - 02-27 22:30:09 - [main.evaluate:272]: Test results:
{'auc': 0.8785031694381081,
 'f1': 0.36943319838056676,
 'loss': 0.4379517151818857,
 'ndcg': 0.7896549637238095,
 'precision': 0.703125,
 'recall': 0.2505387931034483}
[INFO] - 02-27 22:30:09 - [main.evaluate:278]: Averaged loss: mean - 0.4380, std - 0.0000
[INFO] - 02-27 22:30:09 - [main.evaluate:278]: Averaged ndcg: mean - 0.7897, std - 0.0000
[INFO] - 02-27 22:30:09 - [main.evaluate:278]: Averaged auc: mean - 0.8785, std - 0.0000
[INFO] - 02-27 22:30:09 - [main.evaluate:278]: Averaged recall: mean - 0.2505, std - 0.0000
[INFO] - 02-27 22:30:09 - [main.evaluate:278]: Averaged f1: mean - 0.3694, std - 0.0000
[INFO] - 02-27 22:30:09 - [main.evaluate:278]: Averaged precision: mean - 0.7031, std - 0.0000
